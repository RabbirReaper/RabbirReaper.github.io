<!DOCTYPE html><html lang="zh-TW" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>專案筆記 (一) | Hexo</title><meta name="author" content="Rabbir_Reaper"><meta name="copyright" content="Rabbir_Reaper"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="專案簡介這個專案由Vue3 + mongoDB + Cloudflare R2打造 Schema 設計Dish餐點相關，餐點部分採用模板-實例設計 DishTemplate123456789101112131415const DishTemplateSchema &#x3D; new mongoose.Schema(&#123;  name: &#123; type: String, required: t">
<meta property="og:type" content="article">
<meta property="og:title" content="專案筆記 (一)">
<meta property="og:url" content="https://rabbirreaper.github.io/2025/02/07/%E5%B0%88%E6%A1%88%E7%AD%86%E8%A8%98-%E4%B8%80/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="專案簡介這個專案由Vue3 + mongoDB + Cloudflare R2打造 Schema 設計Dish餐點相關，餐點部分採用模板-實例設計 DishTemplate123456789101112131415const DishTemplateSchema &#x3D; new mongoose.Schema(&#123;  name: &#123; type: String, required: t">
<meta property="og:locale" content="zh_TW">
<meta property="og:image" content="https://rabbirreaper.github.io/img/butterfly-icon.png">
<meta property="article:published_time" content="2025-02-07T07:13:50.000Z">
<meta property="article:modified_time" content="2025-09-20T05:21:48.780Z">
<meta property="article:author" content="Rabbir_Reaper">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://rabbirreaper.github.io/img/butterfly-icon.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "專案筆記 (一)",
  "url": "https://rabbirreaper.github.io/2025/02/07/%E5%B0%88%E6%A1%88%E7%AD%86%E8%A8%98-%E4%B8%80/",
  "image": "https://rabbirreaper.github.io/img/butterfly-icon.png",
  "datePublished": "2025-02-07T07:13:50.000Z",
  "dateModified": "2025-09-20T05:21:48.780Z",
  "author": [
    {
      "@type": "Person",
      "name": "Rabbir_Reaper",
      "url": "https://rabbirreaper.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://rabbirreaper.github.io/2025/02/07/%E5%B0%88%E6%A1%88%E7%AD%86%E8%A8%98-%E4%B8%80/index.html"><link rel="preconnect" href="//unpkg.com"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://unpkg.com/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '複製成功',
    error: '複製失敗',
    noSupport: '瀏覽器不支援'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '剛剛',
    min: '分鐘前',
    hour: '小時前',
    day: '天前',
    month: '個月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://unpkg.com/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '載入更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '專案筆記 (一)',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="https://unpkg.com/mermaid/dist/mermaid.min.css"><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">82</div></a><a href="/tags/"><div class="headline">標籤</div><div class="length-num">33</div></a><a href="/categories/"><div class="headline">分類</div><div class="length-num">10</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Hexo</span></a><a class="nav-page-title" href="/"><span class="site-name">專案筆記 (一)</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首頁</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">專案筆記 (一)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">發表於</span><time class="post-meta-date-created" datetime="2025-02-07T07:13:50.000Z" title="發表於 2025-02-07 15:13:50">2025-02-07</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新於</span><time class="post-meta-date-updated" datetime="2025-09-20T05:21:48.780Z" title="更新於 2025-09-20 13:21:48">2025-09-20</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">瀏覽量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="專案簡介"><a href="#專案簡介" class="headerlink" title="專案簡介"></a>專案簡介</h1><p>這個專案由<code>Vue3</code> + <code>mongoDB</code> + <code>Cloudflare R2</code>打造</p>
<h1 id="Schema-設計"><a href="#Schema-設計" class="headerlink" title="Schema 設計"></a>Schema 設計</h1><h2 id="Dish"><a href="#Dish" class="headerlink" title="Dish"></a>Dish</h2><p>餐點相關，餐點部分採用<code>模板-實例</code>設計</p>
<h3 id="DishTemplate"><a href="#DishTemplate" class="headerlink" title="DishTemplate"></a>DishTemplate</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">DishTemplateSchema</span> = <span class="keyword">new</span> mongoose.<span class="title class_">Schema</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: &#123; <span class="attr">type</span>: <span class="title class_">String</span>, <span class="attr">required</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">  <span class="attr">basePrice</span>: &#123; <span class="attr">type</span>: <span class="title class_">Number</span>, <span class="attr">required</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">  <span class="attr">optionCategories</span>: [&#123;</span><br><span class="line">    <span class="attr">categoryId</span>: &#123; <span class="attr">type</span>: mongoose.<span class="property">Schema</span>.<span class="property">Types</span>.<span class="property">ObjectId</span>, <span class="attr">ref</span>: <span class="string">&#x27;OptionCategory&#x27;</span> &#125;,</span><br><span class="line">    <span class="attr">order</span>: &#123; <span class="attr">type</span>: <span class="title class_">Number</span>, <span class="attr">default</span>: <span class="number">0</span> &#125;</span><br><span class="line">  &#125;],</span><br><span class="line">  <span class="attr">image</span>: &#123;</span><br><span class="line">    <span class="attr">url</span>: &#123; <span class="attr">type</span>: <span class="title class_">String</span>, <span class="attr">required</span>: <span class="literal">true</span> &#125;,    <span class="comment">// 圖片的實際連結，例如 R2 上的公網地址</span></span><br><span class="line">    <span class="attr">key</span>: &#123; <span class="attr">type</span>: <span class="title class_">String</span>, <span class="attr">required</span>: <span class="literal">true</span> &#125;,    <span class="comment">// 儲存在 R2 的 object key（等同於檔名，可用於刪除）</span></span><br><span class="line">    <span class="attr">alt</span>: &#123; <span class="attr">type</span>: <span class="title class_">String</span> &#125;                     <span class="comment">// 可選：給前端 img alt 屬性</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">description</span>: &#123; <span class="attr">type</span>: <span class="title class_">String</span> &#125;,</span><br><span class="line">  <span class="attr">tags</span>: [&#123; <span class="attr">type</span>: <span class="title class_">String</span> &#125;]</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="DishInstance"><a href="#DishInstance" class="headerlink" title="DishInstance"></a>DishInstance</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">DishInstanceSchema</span> = <span class="keyword">new</span> mongoose.<span class="title class_">Schema</span>(&#123;</span><br><span class="line">  <span class="attr">templateId</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: mongoose.<span class="property">Schema</span>.<span class="property">Types</span>.<span class="property">ObjectId</span>,</span><br><span class="line">    <span class="attr">ref</span>: <span class="string">&#x27;DishTemplate&#x27;</span>,</span><br><span class="line">    <span class="attr">required</span>: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 冗餘儲存一些模板資訊</span></span><br><span class="line">  <span class="attr">name</span>: &#123; <span class="attr">type</span>: <span class="title class_">String</span>, <span class="attr">required</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">  <span class="attr">basePrice</span>: &#123; <span class="attr">type</span>: <span class="title class_">Number</span>, <span class="attr">required</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">  <span class="comment">// 客製化選項</span></span><br><span class="line">  <span class="attr">options</span>: [&#123;</span><br><span class="line">    <span class="attr">_id</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">optionCategoryId</span>: &#123; <span class="attr">type</span>: mongoose.<span class="property">Schema</span>.<span class="property">Types</span>.<span class="property">ObjectId</span>, <span class="attr">ref</span>: <span class="string">&#x27;OptionCategory&#x27;</span> &#125;,</span><br><span class="line">    <span class="attr">optionCategoryName</span>: &#123; <span class="attr">type</span>: <span class="title class_">String</span>, <span class="attr">required</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">    <span class="attr">selections</span>: [&#123;</span><br><span class="line">      <span class="attr">optionId</span>: &#123; <span class="attr">type</span>: mongoose.<span class="property">Schema</span>.<span class="property">Types</span>.<span class="property">ObjectId</span>, <span class="attr">ref</span>: <span class="string">&#x27;Option&#x27;</span> &#125;,</span><br><span class="line">      <span class="attr">name</span>: &#123; <span class="attr">type</span>: <span class="title class_">String</span>, <span class="attr">required</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">      <span class="attr">price</span>: &#123; <span class="attr">type</span>: <span class="title class_">Number</span>, <span class="attr">default</span>: <span class="number">0</span> &#125;</span><br><span class="line">    &#125;]</span><br><span class="line">  &#125;],</span><br><span class="line">  <span class="attr">specialInstructions</span>: &#123; <span class="attr">type</span>: <span class="title class_">String</span>, <span class="attr">maxlength</span>: <span class="number">200</span> &#125;, <span class="comment">// 特殊要求</span></span><br><span class="line">  <span class="attr">finalPrice</span>: &#123; <span class="attr">type</span>: <span class="title class_">Number</span>, <span class="attr">required</span>: <span class="literal">true</span> &#125;, <span class="comment">// 計算後的最終價格</span></span><br><span class="line">&#125;, &#123; <span class="attr">timestamps</span>: <span class="literal">true</span> &#125;);</span><br></pre></td></tr></table></figure>

<h3 id="OptionCategory"><a href="#OptionCategory" class="headerlink" title="OptionCategory"></a>OptionCategory</h3><p><code>refOption</code>採取類別指向選項，而不是反過來<br>原因：<code>options</code>不會過多，這樣可以節省搜查效率 (<strong>O(1) 對比 O(logN)</strong>)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">OptionCategorySchema</span> = <span class="keyword">new</span> mongoose.<span class="title class_">Schema</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: &#123; <span class="attr">type</span>: <span class="title class_">String</span>, <span class="attr">required</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">  <span class="attr">inputType</span>: &#123; <span class="attr">type</span>: <span class="title class_">String</span>, <span class="attr">enum</span>: [<span class="string">&#x27;single&#x27;</span>, <span class="string">&#x27;multiple&#x27;</span>], <span class="attr">required</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">  <span class="attr">options</span>: [&#123;</span><br><span class="line">    <span class="attr">refOption</span>: &#123; <span class="attr">type</span>: mongoose.<span class="property">Schema</span>.<span class="property">Types</span>.<span class="property">ObjectId</span>, <span class="attr">ref</span>: <span class="string">&#x27;Option&#x27;</span> &#125;,</span><br><span class="line">    <span class="attr">order</span>: &#123; <span class="attr">type</span>: <span class="title class_">Number</span>, <span class="attr">default</span>: <span class="number">0</span> &#125;</span><br><span class="line">  &#125;]</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Option"><a href="#Option" class="headerlink" title="Option"></a>Option</h3><p>refDishTemplate 可選<br>用在庫存管理時可以連動</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">OptionSchema</span> = <span class="keyword">new</span> mongoose.<span class="title class_">Schema</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: &#123; <span class="attr">type</span>: <span class="title class_">String</span>, <span class="attr">required</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">  <span class="attr">refDishTemplate</span>: &#123; <span class="attr">type</span>: mongoose.<span class="property">Schema</span>.<span class="property">Types</span>.<span class="property">ObjectId</span>, <span class="attr">ref</span>: <span class="string">&#x27;DishTemplate&#x27;</span> &#125;,</span><br><span class="line">  <span class="attr">price</span>: &#123; <span class="attr">type</span>: <span class="title class_">Number</span>, <span class="attr">default</span>: <span class="number">0</span> &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>



<h2 id="Store"><a href="#Store" class="headerlink" title="Store"></a>Store</h2><h3 id="Store-1"><a href="#Store-1" class="headerlink" title="Store"></a>Store</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> storeSchema = <span class="keyword">new</span> mongoose.<span class="title class_">Schema</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: &#123; <span class="attr">type</span>: <span class="title class_">String</span>, <span class="attr">required</span>: <span class="literal">true</span> &#125;, <span class="comment">// 店家名稱</span></span><br><span class="line">  <span class="attr">menuItem</span>: &#123; <span class="attr">type</span>: mongoose.<span class="property">Schema</span>.<span class="property">Types</span>.<span class="property">ObjectId</span>, <span class="attr">ref</span>: <span class="string">&#x27;Menu&#x27;</span> &#125;, <span class="comment">// 菜單</span></span><br><span class="line">  <span class="attr">announcements</span>: [&#123;</span><br><span class="line">    <span class="attr">title</span>: &#123; <span class="attr">type</span>: <span class="title class_">String</span>, <span class="attr">required</span>: <span class="literal">true</span> &#125;, <span class="comment">// 公告名稱</span></span><br><span class="line">    <span class="attr">content</span>: &#123; <span class="attr">type</span>: <span class="title class_">String</span>, <span class="attr">required</span>: <span class="literal">true</span> &#125; <span class="comment">// 公告內容</span></span><br><span class="line">  &#125;],</span><br><span class="line">  <span class="attr">image</span>: &#123;</span><br><span class="line">    <span class="attr">url</span>: &#123; <span class="attr">type</span>: <span class="title class_">String</span>, <span class="attr">required</span>: <span class="literal">true</span> &#125;,    <span class="comment">// 圖片的實際連結，例如 R2 上的公網地址</span></span><br><span class="line">    <span class="attr">key</span>: &#123; <span class="attr">type</span>: <span class="title class_">String</span>, <span class="attr">required</span>: <span class="literal">true</span> &#125;,    <span class="comment">// 儲存在 R2 的 object key（等同於檔名，可用於刪除）</span></span><br><span class="line">    <span class="attr">alt</span>: &#123; <span class="attr">type</span>: <span class="title class_">String</span> &#125;                     <span class="comment">// 可選：給前端 img alt 屬性</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="StockLog"><a href="#StockLog" class="headerlink" title="StockLog"></a>StockLog</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">StockLogSchema</span> = <span class="keyword">new</span> mongoose.<span class="title class_">Schema</span>(&#123;</span><br><span class="line">  <span class="attr">dish</span>: &#123; </span><br><span class="line">    <span class="attr">type</span>: mongoose.<span class="property">Schema</span>.<span class="property">Types</span>.<span class="property">ObjectId</span>, </span><br><span class="line">    <span class="attr">ref</span>: <span class="string">&#x27;DishTemplate&#x27;</span>, </span><br><span class="line">    <span class="attr">required</span>: <span class="literal">true</span> </span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">dishName</span>: &#123; <span class="attr">type</span>: <span class="title class_">String</span>, <span class="attr">required</span>: <span class="literal">true</span> &#125;, <span class="comment">// 冗餘儲存餐點名稱，方便查詢</span></span><br><span class="line">  <span class="attr">previousStock</span>: &#123; <span class="attr">type</span>: <span class="title class_">Number</span>, <span class="attr">required</span>: <span class="literal">true</span> &#125;, <span class="comment">// 變動前庫存</span></span><br><span class="line">  <span class="attr">newStock</span>: &#123; <span class="attr">type</span>: <span class="title class_">Number</span>, <span class="attr">required</span>: <span class="literal">true</span> &#125;, <span class="comment">// 變動後庫存</span></span><br><span class="line">  <span class="attr">changeAmount</span>: &#123; <span class="attr">type</span>: <span class="title class_">Number</span>, <span class="attr">required</span>: <span class="literal">true</span> &#125;, <span class="comment">// 變動數量 (正數為增加，負數為減少)</span></span><br><span class="line">  <span class="attr">changeType</span>: &#123; </span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">String</span>, </span><br><span class="line">    <span class="attr">enum</span>: [<span class="string">&#x27;manual_add&#x27;</span>, <span class="string">&#x27;manual_subtract&#x27;</span>, <span class="string">&#x27;order&#x27;</span>, <span class="string">&#x27;system_adjustment&#x27;</span>, <span class="string">&#x27;initial_stock&#x27;</span>],</span><br><span class="line">    <span class="attr">required</span>: <span class="literal">true</span></span><br><span class="line">  &#125;, <span class="comment">// 變動類型</span></span><br><span class="line">  <span class="attr">reason</span>: &#123; <span class="attr">type</span>: <span class="title class_">String</span> &#125;, <span class="comment">// 變動原因說明 (手動調整時必須提供)</span></span><br><span class="line">  <span class="attr">order</span>: &#123; </span><br><span class="line">    <span class="attr">type</span>: mongoose.<span class="property">Schema</span>.<span class="property">Types</span>.<span class="property">ObjectId</span>, </span><br><span class="line">    <span class="attr">ref</span>: <span class="string">&#x27;Order&#x27;</span> </span><br><span class="line">  &#125;, <span class="comment">// 關聯訂單 (如果是訂單消耗)</span></span><br><span class="line">  <span class="attr">admin</span>: &#123; </span><br><span class="line">    <span class="attr">type</span>: mongoose.<span class="property">Schema</span>.<span class="property">Types</span>.<span class="property">ObjectId</span>, </span><br><span class="line">    <span class="attr">ref</span>: <span class="string">&#x27;Admin&#x27;</span> </span><br><span class="line">  &#125;, <span class="comment">// 關聯管理員 (如果是手動調整)</span></span><br><span class="line">  <span class="attr">createdAt</span>: &#123; <span class="attr">type</span>: <span class="title class_">Date</span>, <span class="attr">default</span>: <span class="title class_">Date</span>.<span class="property">now</span> &#125;, <span class="comment">// 變動時間</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="User"><a href="#User" class="headerlink" title="User"></a>User</h2><h1 id="管理員介面"><a href="#管理員介面" class="headerlink" title="管理員介面"></a>管理員介面</h1><h2 id="管理員分級制度實作細節"><a href="#管理員分級制度實作細節" class="headerlink" title="管理員分級制度實作細節"></a>管理員分級制度實作細節</h2><h2 id="登錄系統"><a href="#登錄系統" class="headerlink" title="登錄系統"></a>登錄系統</h2><h3 id="後端設置"><a href="#後端設置" class="headerlink" title="後端設置"></a>後端設置</h3><p>路徑<strong>routes&#x2F;authentication.js</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> express <span class="keyword">from</span> <span class="string">&quot;express&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> bcrypt <span class="keyword">from</span> <span class="string">&#x27;bcrypt&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> session <span class="keyword">from</span> <span class="string">&#x27;express-session&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Administrator</span> <span class="keyword">from</span> <span class="string">&#x27;../schemas/administratorSchema.js&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>();</span><br><span class="line">router.<span class="title function_">use</span>(express.<span class="title function_">json</span>());</span><br><span class="line">router.<span class="title function_">use</span>(<span class="title function_">session</span>(&#123;</span><br><span class="line">  <span class="attr">secret</span>: process.<span class="property">env</span>.<span class="property">SESSION_SECRET</span> || <span class="string">&#x27;your-secret-key&#x27;</span>,</span><br><span class="line">  <span class="attr">resave</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">saveUninitialized</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">cookie</span>: &#123;</span><br><span class="line">    <span class="attr">maxAge</span>: <span class="number">30</span> * <span class="number">60</span> * <span class="number">1000</span> <span class="comment">// 30 分鐘後過期</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/login&#x27;</span>, <span class="title function_">async</span> (req, res) =&gt; &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; name, password &#125; = req.<span class="property">body</span>;</span><br><span class="line">    <span class="keyword">const</span> admin = <span class="keyword">await</span> <span class="title class_">Administrator</span>.<span class="title function_">findOne</span>(&#123; name &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!admin) &#123; <span class="comment">// adminname not found</span></span><br><span class="line">      <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">401</span>).<span class="title function_">send</span>(<span class="string">&#x27;adminname or password arrors&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> validPassword = <span class="keyword">await</span> bcrypt.<span class="title function_">compare</span>(password, admin.<span class="property">password</span>);</span><br><span class="line">    <span class="keyword">if</span> (validPassword) &#123;</span><br><span class="line">      req.<span class="property">session</span>.<span class="property">user_id</span> = admin.<span class="property">_id</span>;</span><br><span class="line">      <span class="keyword">return</span> res.<span class="title function_">send</span>(<span class="string">&#x27;Login successful&#x27;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123; <span class="comment">// invalid password</span></span><br><span class="line">      <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">401</span>).<span class="title function_">send</span>(<span class="string">&#x27;adminname or password arrors&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Login error:&#x27;</span>, error);</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">send</span>(<span class="string">&#x27;Internal server error&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/logout&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  req.<span class="property">session</span>.<span class="property">user_id</span> = <span class="literal">null</span>;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;Logout successful&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/current_user&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (req.<span class="property">session</span>.<span class="property">user_id</span>) &#123;</span><br><span class="line">    <span class="comment">// 根據需要回傳更多使用者資料</span></span><br><span class="line">    res.<span class="title function_">json</span>(&#123; <span class="attr">loggedIn</span>: <span class="literal">true</span>, <span class="attr">user_id</span>: req.<span class="property">session</span>.<span class="property">user_id</span> &#125;);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    res.<span class="title function_">json</span>(&#123; <span class="attr">loggedIn</span>: <span class="literal">false</span> &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/createUser&#x27;</span>, <span class="title function_">async</span> (req, res) =&gt; &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; name, password &#125; = req.<span class="property">body</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!req.<span class="property">session</span>.<span class="property">user_id</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">401</span>).<span class="title function_">send</span>(<span class="string">&#x27;Unauthorized&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> salt = <span class="keyword">await</span> bcrypt.<span class="title function_">genSalt</span>(<span class="number">10</span>);</span><br><span class="line">    <span class="keyword">const</span> hashedPassword = <span class="keyword">await</span> bcrypt.<span class="title function_">hash</span>(password, salt);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> newAdmin = <span class="keyword">new</span> <span class="title class_">Administrator</span>(&#123;</span><br><span class="line">      name,</span><br><span class="line">      <span class="attr">password</span>: hashedPassword</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">await</span> newAdmin.<span class="title function_">save</span>();</span><br><span class="line">    res.<span class="title function_">status</span>(<span class="number">201</span>).<span class="title function_">send</span>(<span class="string">&#x27;User created successfully&#x27;</span>);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Create user error:&#x27;</span>, error);</span><br><span class="line">    res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">send</span>(<span class="string">&#x27;Internal server error&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">delete</span>(<span class="string">&#x27;/deleteUser/:id&#x27;</span>, <span class="title function_">async</span> (req, res) =&gt; &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!req.<span class="property">session</span>.<span class="property">user_id</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">401</span>).<span class="title function_">send</span>(<span class="string">&#x27;Unauthorized&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> userId = req.<span class="property">params</span>.<span class="property">id</span>;</span><br><span class="line">    <span class="keyword">const</span> result = <span class="keyword">await</span> <span class="title class_">Administrator</span>.<span class="title function_">findByIdAndDelete</span>(userId);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!result) &#123;</span><br><span class="line">      <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">404</span>).<span class="title function_">send</span>(<span class="string">&#x27;User not found&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&#x27;User deleted successfully&#x27;</span>);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Delete user error:&#x27;</span>, error);</span><br><span class="line">    res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">send</span>(<span class="string">&#x27;Internal server error&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router;</span><br></pre></td></tr></table></figure>

<h3 id="前端登錄頁面"><a href="#前端登錄頁面" class="headerlink" title="前端登錄頁面"></a>前端登錄頁面</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;login-container&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>Login<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> @<span class="attr">submit.prevent</span>=<span class="string">&quot;handleLogin&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;username&quot;</span>&gt;</span>Username:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;username&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;username&quot;</span> <span class="attr">required</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;password&quot;</span>&gt;</span>Password:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">id</span>=<span class="string">&quot;password&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;password&quot;</span> <span class="attr">required</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span>Login<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123; useRouter, useRoute &#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> username = <span class="title function_">ref</span>(<span class="string">&#x27;&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> password = <span class="title function_">ref</span>(<span class="string">&#x27;&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> router = <span class="title function_">useRouter</span>()</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> route = <span class="title function_">useRoute</span>()</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="variable constant_">API_BASE_URL</span> = <span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">env</span>.<span class="property">VITE_API_BASE_URL</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 登入函數</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">handleLogin</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> response = <span class="keyword">await</span> axios.<span class="title function_">post</span>(<span class="string">`<span class="subst">$&#123;API_BASE_URL&#125;</span>/authentication/login`</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">name</span>: username.<span class="property">value</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">password</span>: password.<span class="property">value</span></span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (response.<span class="property">data</span> === <span class="string">&#x27;Login successful&#x27;</span>) &#123;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 讀取 query 中的 redirect 參數，若無則預設跳轉到 /admin</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> redirectPath = route.<span class="property">query</span>.<span class="property">redirect</span> || <span class="string">&#x27;/admin&#x27;</span></span></span><br><span class="line"><span class="language-javascript">      router.<span class="title function_">push</span>(redirectPath)</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">catch</span> (error) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Login failed:&#x27;</span>, error.<span class="property">response</span> ? error.<span class="property">response</span>.<span class="property">data</span> : error)</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(<span class="string">&#x27;Login failed: &#x27;</span> + (error.<span class="property">response</span> ? error.<span class="property">response</span>.<span class="property">data</span> : error.<span class="property">message</span>))</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 共用登出函數（也可放在全局，方便其他元件調用）</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">handleLogout</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">await</span> axios.<span class="title function_">post</span>(<span class="string">`<span class="subst">$&#123;API_BASE_URL&#125;</span>/authentication/logout`</span>)</span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">catch</span> (error) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Logout error:&#x27;</span>, error.<span class="property">response</span> ? error.<span class="property">response</span>.<span class="property">data</span> : error)</span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">finally</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">localStorage</span>.<span class="title function_">removeItem</span>(<span class="string">&#x27;authToken&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">localStorage</span>.<span class="title function_">removeItem</span>(<span class="string">&#x27;loginTime&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">clearAutoLogout</span>()</span></span><br><span class="line"><span class="language-javascript">    router.<span class="title function_">push</span>(<span class="string">&#x27;/login&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.login-container</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">max-width</span>: <span class="number">400px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">padding</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ccc</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">10px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.1</span>);</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.form-group</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">margin-bottom</span>: <span class="number">15px</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-tag">label</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">display</span>: block;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">margin-bottom</span>: <span class="number">5px</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-tag">input</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">padding</span>: <span class="number">8px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">box-sizing</span>: border-box;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-tag">button</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">padding</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">background-color</span>: <span class="number">#007bff</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">color</span>: white;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">border</span>: none;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">cursor</span>: pointer;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-tag">button</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">background-color</span>: <span class="number">#0056b3</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="router-自動跳轉到登錄介面"><a href="#router-自動跳轉到登錄介面" class="headerlink" title="router 自動跳轉到登錄介面"></a>router 自動跳轉到登錄介面</h3><p>在<code>routes</code>裡面設置<code>meta: &#123; requiresAuth: true &#125;</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">isLoggedIn</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> response = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">`/authentication/current_user`</span>);</span><br><span class="line">    <span class="keyword">return</span> response.<span class="property">data</span>.<span class="property">loggedIn</span>;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;檢查登入狀態失敗&#x27;</span>, error);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">beforeEach</span>(<span class="title function_">async</span> (to, <span class="keyword">from</span>, next) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (to.<span class="property">meta</span>.<span class="property">requiresAuth</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> loggedIn = <span class="keyword">await</span> <span class="title function_">isLoggedIn</span>();</span><br><span class="line">    <span class="keyword">if</span> (!loggedIn) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">next</span>(&#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&#x27;/login&#x27;</span>,</span><br><span class="line">        <span class="attr">query</span>: &#123; <span class="attr">redirect</span>: to.<span class="property">fullPath</span> &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">next</span>();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="文檔網址"><a href="#文檔網址" class="headerlink" title="文檔網址"></a>文檔網址</h3><ul>
<li>express-session<br><a target="_blank" rel="noopener" href="https://github.com/expressjs/session">https://github.com/expressjs/session</a></li>
<li>bcrypto<br><a target="_blank" rel="noopener" href="https://github.com/bcoin-org/bcrypto">https://github.com/bcoin-org/bcrypto</a></li>
</ul>
<h2 id="餐點顯示，新增、修改與刪除介面"><a href="#餐點顯示，新增、修改與刪除介面" class="headerlink" title="餐點顯示，新增、修改與刪除介面"></a>餐點顯示，新增、修改與刪除介面</h2><h3 id="API"><a href="#API" class="headerlink" title="API"></a>API</h3><p><code>src\api\modules\dishTemplate.js</code><br><code>src\api\modules\comboInstance.js</code><br><code>src\api\modules\comboTemplate.js</code><br><code>src\api\modules\optionCategory.js</code><br><code>src\api\modules\option.js</code><br><code>src\api\modules\image.js</code></p>
<h3 id="顯示"><a href="#顯示" class="headerlink" title="顯示"></a>顯示</h3><ul>
<li>上方navbar 需要有三項</li>
<li>[<code>dishTemplate</code>,<code>combo</code>,<code>option</code>]</li>
<li>每項顯示的方式都差不多每個是一個card點進去 進入到 edit介面 裡面會有儲存修改 或是刪除的按鈕</li>
<li>option 因為沒有圖片 可以條列式顯示 這樣比較節省空間 顯示optionCatrgory 即可</li>
<li>套餐模板頁面 需列出所有套餐 每個是一個card點進去 進入到 edit介面 裡面會有儲存修改 或是刪除的按鈕</li>
<li>option的模式是這樣的 外層是optionCategory 新增修改刪除，然後card 點進去會進去那個optionCategory裡面，這邊是option 的新增修改刪除介面(這裡的option可以調整順序)</li>
</ul>
<h3 id="新增及修改頁面"><a href="#新增及修改頁面" class="headerlink" title="新增及修改頁面"></a>新增及修改頁面</h3><ul>
<li>主要頁面是顯示頁面上個段落說明的，右上角會有新增頁面</li>
<li>主要三項新增頁面，</li>
<li>餐點模板 根據模板<code>schema</code> 該有的要有，然後有選單從現有的<code>optionCategory</code>中選擇，可以調每個<code>optionCategory</code>的順序，這邊的寫法參考<code>src\views\admin\menu\add.vue</code>裡面的箭頭調整順序</li>
<li>修改頁面 跟新增頁面是同個頁面，差在修改頁面需要從資料庫拉原本的資料，然後<strong>儲存</strong>按鈕改成<strong>儲存修改</strong>然後多一個<strong>刪除</strong>按鈕</li>
</ul>
<h2 id="menu新增介面"><a href="#menu新增介面" class="headerlink" title="menu新增介面"></a><code>menu</code>新增介面</h2><h3 id="API-1"><a href="#API-1" class="headerlink" title="API"></a>API</h3><p>根據<code>menuSchema.js</code> 還有一些身分驗證</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> express <span class="keyword">from</span> <span class="string">&#x27;express&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Menu</span> <span class="keyword">from</span> <span class="string">&#x27;../schemas/menuSchema.js&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">checkAuth</span> = (<span class="params">req, res, next</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (!req.<span class="property">session</span>.<span class="property">user_id</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">401</span>).<span class="title function_">json</span>(&#123; <span class="attr">message</span>: <span class="string">&#x27;Unauthorized&#x27;</span> &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">next</span>();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 取得 menu</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="title function_">async</span> (req, res) =&gt; &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> menu = <span class="keyword">await</span> <span class="title class_">Menu</span>.<span class="title function_">find</span>(&#123;&#125;);</span><br><span class="line">    <span class="keyword">if</span> (!menu) <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">404</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Menu not found&#x27;</span> &#125;);</span><br><span class="line"></span><br><span class="line">    res.<span class="title function_">json</span>(menu);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error getting menu:&#x27;</span>, error);</span><br><span class="line">    res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">send</span>(<span class="string">&#x27;Internal server error&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 取得單個 menu</span></span><br><span class="line"></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/:id&#x27;</span>, <span class="title function_">async</span> (req, res) =&gt; &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; id &#125; = req.<span class="property">params</span>;</span><br><span class="line">    <span class="keyword">const</span> menu = <span class="keyword">await</span> <span class="title class_">Menu</span>.<span class="title function_">findById</span>(id);</span><br><span class="line">    <span class="keyword">if</span> (!menu) <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">404</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Menu not found&#x27;</span> &#125;);</span><br><span class="line"></span><br><span class="line">    res.<span class="title function_">json</span>(menu);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error getting menu:&#x27;</span>, error);</span><br><span class="line">    res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">send</span>(<span class="string">&#x27;Internal server error&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 創建 menu</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/&#x27;</span>, checkAuth, <span class="title function_">async</span> (req, res) =&gt; &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> newMenu = <span class="keyword">new</span> <span class="title class_">Menu</span>(req.<span class="property">body</span>);</span><br><span class="line">    <span class="keyword">await</span> newMenu.<span class="title function_">save</span>();</span><br><span class="line"></span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&#x27;Menu created successfully&#x27;</span>);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error creating menu:&#x27;</span>, error);</span><br><span class="line">    res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">send</span>(<span class="string">&#x27;Internal server error&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 更新 menu</span></span><br><span class="line">router.<span class="title function_">put</span>(<span class="string">&#x27;/:id&#x27;</span>, checkAuth, <span class="title function_">async</span> (req, res) =&gt; &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; id &#125; = req.<span class="property">params</span>;</span><br><span class="line">    <span class="keyword">await</span> <span class="title class_">Menu</span>.<span class="title function_">findByIdAndUpdate</span>(id, req.<span class="property">body</span>);</span><br><span class="line"></span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&#x27;Menu updated successfully&#x27;</span>);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error updating menu:&#x27;</span>, error);</span><br><span class="line">    res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">send</span>(<span class="string">&#x27;Internal server error&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 刪除 menu</span></span><br><span class="line">router.<span class="title function_">delete</span>(<span class="string">&#x27;/:id&#x27;</span>, checkAuth, <span class="title function_">async</span> (req, res) =&gt; &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; id &#125; = req.<span class="property">params</span>;</span><br><span class="line">    <span class="keyword">await</span> <span class="title class_">Menu</span>.<span class="title function_">findByIdAndDelete</span>(id);</span><br><span class="line"></span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&#x27;Menu deleted successfully&#x27;</span>);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error deleting menu:&#x27;</span>, error);</span><br><span class="line">    res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">send</span>(<span class="string">&#x27;Internal server error&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router;</span><br></pre></td></tr></table></figure>

<h3 id="新增"><a href="#新增" class="headerlink" title="新增"></a>新增</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container py-4&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 菜單名稱 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card mb-4&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card-body&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;form-label&quot;</span>&gt;</span>菜單名稱<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> </span></span><br><span class="line"><span class="tag">          <span class="attr">v-model</span>=<span class="string">&quot;menuName&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">type</span>=<span class="string">&quot;text&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">placeholder</span>=<span class="string">&quot;輸入菜單名稱&quot;</span></span></span><br><span class="line"><span class="tag">        /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- 菜單類別列表 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;mb-4&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-for</span>=<span class="string">&quot;(category, categoryIndex) in menuData&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;categoryIndex&quot;</span> <span class="attr">class</span>=<span class="string">&quot;card mb-3&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card-body&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;d-flex justify-content-between align-items-start mb-3&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 類別名稱 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex-grow-1 me-3&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;form-label&quot;</span>&gt;</span>類別名稱<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">input</span> </span></span><br><span class="line"><span class="tag">                <span class="attr">v-model</span>=<span class="string">&quot;category.categoryName&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">type</span>=<span class="string">&quot;text&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">placeholder</span>=<span class="string">&quot;輸入類別名稱（例如：主餐、附餐）&quot;</span></span></span><br><span class="line"><span class="tag">              /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 類別排序控制 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;btn-group&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">button</span> </span></span><br><span class="line"><span class="tag">                @<span class="attr">click</span>=<span class="string">&quot;moveCategory(categoryIndex, -1)&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">class</span>=<span class="string">&quot;btn btn-outline-secondary&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">:disabled</span>=<span class="string">&quot;categoryIndex === 0&quot;</span></span></span><br><span class="line"><span class="tag">              &gt;</span></span><br><span class="line">                ↑</span><br><span class="line">              <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">button</span> </span></span><br><span class="line"><span class="tag">                @<span class="attr">click</span>=<span class="string">&quot;moveCategory(categoryIndex, 1)&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">class</span>=<span class="string">&quot;btn btn-outline-secondary&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">:disabled</span>=<span class="string">&quot;categoryIndex === menuData.length - 1&quot;</span></span></span><br><span class="line"><span class="tag">              &gt;</span></span><br><span class="line">                ↓</span><br><span class="line">              <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">          <span class="comment">&lt;!-- 餐點列表 --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;mb-3&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h5</span> <span class="attr">class</span>=<span class="string">&quot;card-title&quot;</span>&gt;</span>餐點項目<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;list-group&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> </span></span><br><span class="line"><span class="tag">                <span class="attr">v-for</span>=<span class="string">&quot;(item, itemIndex) in category.items&quot;</span> </span></span><br><span class="line"><span class="tag">                <span class="attr">:key</span>=<span class="string">&quot;itemIndex&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">class</span>=<span class="string">&quot;list-group-item&quot;</span></span></span><br><span class="line"><span class="tag">              &gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;row align-items-center&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">select</span> </span></span><br><span class="line"><span class="tag">                      <span class="attr">v-model</span>=<span class="string">&quot;item.itemModel&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;form-select mb-2&quot;</span></span></span><br><span class="line"><span class="tag">                      @<span class="attr">change</span>=<span class="string">&quot;item.itemId = null&quot;</span></span></span><br><span class="line"><span class="tag">                    &gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span>&gt;</span>選擇餐點類型<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;MainDish&quot;</span>&gt;</span>主餐<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;ElseDish&quot;</span>&gt;</span>其他餐點<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;RawMeat&quot;</span>&gt;</span>食材<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">                    </span><br><span class="line">                    <span class="tag">&lt;<span class="name">select</span> </span></span><br><span class="line"><span class="tag">                      <span class="attr">v-if</span>=<span class="string">&quot;item.itemModel&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">v-model</span>=<span class="string">&quot;item.itemId&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;form-select&quot;</span></span></span><br><span class="line"><span class="tag">                    &gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span>&gt;</span>選擇餐點<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">option</span> </span></span><br><span class="line"><span class="tag">                        <span class="attr">v-for</span>=<span class="string">&quot;dish in getDishes(item.itemModel)&quot;</span> </span></span><br><span class="line"><span class="tag">                        <span class="attr">:key</span>=<span class="string">&quot;dish._id&quot;</span> </span></span><br><span class="line"><span class="tag">                        <span class="attr">:value</span>=<span class="string">&quot;dish._id&quot;</span></span></span><br><span class="line"><span class="tag">                      &gt;</span></span><br><span class="line">                        &#123;&#123; dish.name &#125;&#125; - $&#123;&#123; dish.price &#125;&#125;</span><br><span class="line">                      <span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col-auto&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;btn-group&quot;</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">button</span> </span></span><br><span class="line"><span class="tag">                        @<span class="attr">click</span>=<span class="string">&quot;moveItem(categoryIndex, itemIndex, -1)&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">class</span>=<span class="string">&quot;btn btn-outline-secondary&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">:disabled</span>=<span class="string">&quot;itemIndex === 0&quot;</span></span></span><br><span class="line"><span class="tag">                      &gt;</span></span><br><span class="line">                        ↑</span><br><span class="line">                      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">button</span> </span></span><br><span class="line"><span class="tag">                        @<span class="attr">click</span>=<span class="string">&quot;moveItem(categoryIndex, itemIndex, 1)&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">class</span>=<span class="string">&quot;btn btn-outline-secondary&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">:disabled</span>=<span class="string">&quot;itemIndex === category.items.length - 1&quot;</span></span></span><br><span class="line"><span class="tag">                      &gt;</span></span><br><span class="line">                        ↓</span><br><span class="line">                      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">button</span> </span></span><br><span class="line"><span class="tag">                        @<span class="attr">click</span>=<span class="string">&quot;removeItem(categoryIndex, itemIndex)&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">class</span>=<span class="string">&quot;btn btn-outline-danger&quot;</span></span></span><br><span class="line"><span class="tag">                      &gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;bi bi-trash&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">button</span> </span></span><br><span class="line"><span class="tag">              @<span class="attr">click</span>=<span class="string">&quot;addItem(category)&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">class</span>=<span class="string">&quot;btn btn-outline-primary mt-2&quot;</span></span></span><br><span class="line"><span class="tag">            &gt;</span></span><br><span class="line">              新增餐點</span><br><span class="line">            <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">          <span class="tag">&lt;<span class="name">button</span> </span></span><br><span class="line"><span class="tag">            @<span class="attr">click</span>=<span class="string">&quot;removeCategory(categoryIndex)&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">class</span>=<span class="string">&quot;btn btn-danger&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span></span><br><span class="line">            刪除類別</span><br><span class="line">          <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 控制按鈕 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;d-flex gap-2&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> </span></span><br><span class="line"><span class="tag">        @<span class="attr">click</span>=<span class="string">&quot;addCategory&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;btn btn-primary&quot;</span></span></span><br><span class="line"><span class="tag">      &gt;</span></span><br><span class="line">        新增類別</span><br><span class="line">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">      </span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> </span></span><br><span class="line"><span class="tag">        @<span class="attr">click</span>=<span class="string">&quot;saveMenu&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;btn btn-success&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:disabled</span>=<span class="string">&quot;!isValid&quot;</span></span></span><br><span class="line"><span class="tag">      &gt;</span></span><br><span class="line">        儲存菜單</span><br><span class="line">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123; ref, computed, onMounted &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123; useRouter &#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> router = <span class="title function_">useRouter</span>()</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="variable constant_">API_BASE_URL</span> = <span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">env</span>.<span class="property">VITE_API_BASE_URL</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 資料狀態</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> menuName = <span class="title function_">ref</span>(<span class="string">&#x27;&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> menuData = <span class="title function_">ref</span>([])</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> mainDishes = <span class="title function_">ref</span>([])</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> elseDishes = <span class="title function_">ref</span>([])</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> rawMeats = <span class="title function_">ref</span>([])</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 根據餐點類型獲取對應的餐點列表</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">getDishes</span> = (<span class="params">itemModel</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">switch</span> (itemModel) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">case</span> <span class="string">&#x27;MainDish&#x27;</span>:</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> mainDishes.<span class="property">value</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">case</span> <span class="string">&#x27;ElseDish&#x27;</span>:</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> elseDishes.<span class="property">value</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">case</span> <span class="string">&#x27;RawMeat&#x27;</span>:</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> rawMeats.<span class="property">value</span></span></span><br><span class="line"><span class="language-javascript">    <span class="attr">default</span>:</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> []</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 獲取指定類型的餐點</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">fetchDishes</span> = <span class="keyword">async</span> (<span class="params">endpoint</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> response = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">`<span class="subst">$&#123;API_BASE_URL&#125;</span>/dish<span class="subst">$&#123;endpoint&#125;</span>`</span>)</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> response.<span class="property">data</span></span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">catch</span> (error) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error fetching dishes:&#x27;</span>, error)</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> []</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 初始化時獲取所有類型的餐點</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">initializeDishes</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> [mainResponse, elseResponse, rawResponse] = <span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">all</span>([</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">fetchDishes</span>(<span class="string">&#x27;/mainDish&#x27;</span>),</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">fetchDishes</span>(<span class="string">&#x27;/elseDish&#x27;</span>),</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">fetchDishes</span>(<span class="string">&#x27;/rawMeat&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    ])</span></span><br><span class="line"><span class="language-javascript">    </span></span><br><span class="line"><span class="language-javascript">    mainDishes.<span class="property">value</span> = mainResponse</span></span><br><span class="line"><span class="language-javascript">    elseDishes.<span class="property">value</span> = elseResponse</span></span><br><span class="line"><span class="language-javascript">    rawMeats.<span class="property">value</span> = rawResponse</span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">catch</span> (error) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error initializing dishes:&#x27;</span>, error)</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 新增類別</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">addCategory</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  menuData.<span class="property">value</span>.<span class="title function_">push</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">categoryName</span>: <span class="string">&#x27;&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">items</span>: [],</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">order</span>: menuData.<span class="property">value</span>.<span class="property">length</span></span></span><br><span class="line"><span class="language-javascript">  &#125;)</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 刪除類別</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">removeCategory</span> = (<span class="params">index</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  menuData.<span class="property">value</span>.<span class="title function_">splice</span>(index, <span class="number">1</span>)</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">updateCategoryOrders</span>()</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 新增餐點項目</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">addItem</span> = (<span class="params">category</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  category.<span class="property">items</span>.<span class="title function_">push</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">itemModel</span>: <span class="string">&#x27;&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">itemId</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">order</span>: category.<span class="property">items</span>.<span class="property">length</span></span></span><br><span class="line"><span class="language-javascript">  &#125;)</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 刪除餐點項目</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">removeItem</span> = (<span class="params">categoryIndex, itemIndex</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  menuData.<span class="property">value</span>[categoryIndex].<span class="property">items</span>.<span class="title function_">splice</span>(itemIndex, <span class="number">1</span>)</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">updateItemOrders</span>(categoryIndex)</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 移動類別</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">moveCategory</span> = (<span class="params">categoryIndex, direction</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> newIndex = categoryIndex + direction</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (newIndex &gt;= <span class="number">0</span> &amp;&amp; newIndex &lt; menuData.<span class="property">value</span>.<span class="property">length</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> temp = menuData.<span class="property">value</span>[categoryIndex]</span></span><br><span class="line"><span class="language-javascript">    menuData.<span class="property">value</span>[categoryIndex] = menuData.<span class="property">value</span>[newIndex]</span></span><br><span class="line"><span class="language-javascript">    menuData.<span class="property">value</span>[newIndex] = temp</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">updateCategoryOrders</span>()</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 移動項目</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">moveItem</span> = (<span class="params">categoryIndex, itemIndex, direction</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> newIndex = itemIndex + direction</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> items = menuData.<span class="property">value</span>[categoryIndex].<span class="property">items</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (newIndex &gt;= <span class="number">0</span> &amp;&amp; newIndex &lt; items.<span class="property">length</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> temp = items[itemIndex]</span></span><br><span class="line"><span class="language-javascript">    items[itemIndex] = items[newIndex]</span></span><br><span class="line"><span class="language-javascript">    items[newIndex] = temp</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">updateItemOrders</span>(categoryIndex)</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 更新類別順序</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">updateCategoryOrders</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  menuData.<span class="property">value</span>.<span class="title function_">forEach</span>(<span class="function">(<span class="params">category, index</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    category.<span class="property">order</span> = index</span></span><br><span class="line"><span class="language-javascript">  &#125;)</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 更新項目順序</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">updateItemOrders</span> = (<span class="params">categoryIndex</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  menuData.<span class="property">value</span>[categoryIndex].<span class="property">items</span>.<span class="title function_">forEach</span>(<span class="function">(<span class="params">item, index</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    item.<span class="property">order</span> = index</span></span><br><span class="line"><span class="language-javascript">  &#125;)</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 驗證表單</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> isValid = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">return</span> menuName.<span class="property">value</span>.<span class="title function_">trim</span>() !== <span class="string">&#x27;&#x27;</span> &amp;&amp; </span></span><br><span class="line"><span class="language-javascript">    menuData.<span class="property">value</span>.<span class="title function_">every</span>(<span class="function"><span class="params">category</span> =&gt;</span> </span></span><br><span class="line"><span class="language-javascript">      category.<span class="property">categoryName</span>.<span class="title function_">trim</span>() !== <span class="string">&#x27;&#x27;</span> &amp;&amp;</span></span><br><span class="line"><span class="language-javascript">      category.<span class="property">items</span>.<span class="title function_">every</span>(<span class="function"><span class="params">item</span> =&gt;</span> </span></span><br><span class="line"><span class="language-javascript">        item.<span class="property">itemModel</span> &amp;&amp; item.<span class="property">itemId</span></span></span><br><span class="line"><span class="language-javascript">      )</span></span><br><span class="line"><span class="language-javascript">    )</span></span><br><span class="line"><span class="language-javascript">&#125;)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 儲存菜單</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">saveMenu</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> menuToSave = &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">name</span>: menuName.<span class="property">value</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">list</span>: menuData.<span class="property">value</span>.<span class="title function_">map</span>(<span class="function">(<span class="params">category, categoryIndex</span>) =&gt;</span> (&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">categoryName</span>: category.<span class="property">categoryName</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">order</span>: categoryIndex,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">items</span>: category.<span class="property">items</span>.<span class="title function_">map</span>(<span class="function">(<span class="params">item, itemIndex</span>) =&gt;</span> (&#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">itemModel</span>: item.<span class="property">itemModel</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">itemId</span>: item.<span class="property">itemId</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">order</span>: itemIndex</span></span><br><span class="line"><span class="language-javascript">        &#125;))</span></span><br><span class="line"><span class="language-javascript">      &#125;))</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    </span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">await</span> axios.<span class="title function_">post</span>(<span class="string">`<span class="subst">$&#123;API_BASE_URL&#125;</span>/menu`</span>, menuToSave)</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(<span class="string">&#x27;菜單儲存成功！&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    router.<span class="title function_">push</span>(<span class="string">&#x27;./show&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">catch</span> (error) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error saving menu:&#x27;</span>, error)</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(<span class="string">&#x27;儲存失敗，請稍後再試&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 初始化</span></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">initializeDishes</span>()</span></span><br><span class="line"><span class="language-javascript">&#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="顯示-1"><a href="#顯示-1" class="headerlink" title="顯示"></a>顯示</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container py-4&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;d-flex justify-content-between align-items-center mb-4&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>菜單列表<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">&quot;./add&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary&quot;</span>&gt;</span></span><br><span class="line">        新增菜單</span><br><span class="line">      <span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 讀取中提示 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">&quot;loading&quot;</span> <span class="attr">class</span>=<span class="string">&quot;text-center py-5&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;spinner-border&quot;</span> <span class="attr">role</span>=<span class="string">&quot;status&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;visually-hidden&quot;</span>&gt;</span>Loading...<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 錯誤提示 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-else-if</span>=<span class="string">&quot;error&quot;</span> <span class="attr">class</span>=<span class="string">&quot;alert alert-danger&quot;</span> <span class="attr">role</span>=<span class="string">&quot;alert&quot;</span>&gt;</span></span><br><span class="line">      &#123;&#123; error &#125;&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 菜單列表 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-else</span> <span class="attr">class</span>=<span class="string">&quot;row g-4&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-for</span>=<span class="string">&quot;menu in menus&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;menu._id&quot;</span> <span class="attr">class</span>=<span class="string">&quot;col-12&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card h-100 hover-shadow&quot;</span> <span class="attr">style</span>=<span class="string">&quot;cursor: pointer;&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;goToEdit(menu._id)&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card-body&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;d-flex justify-content-between align-items-start&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">h5</span> <span class="attr">class</span>=<span class="string">&quot;card-title&quot;</span>&gt;</span>&#123;&#123; menu.name &#125;&#125;<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;card-text text-muted&quot;</span>&gt;</span></span><br><span class="line">                  &#123;&#123; menu.list.length &#125;&#125; 個類別，</span><br><span class="line">                  總計 &#123;&#123; getTotalItems(menu) &#125;&#125; 個項目</span><br><span class="line">                <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">&lt;!-- 類別預覽 --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;small text-muted&quot;</span>&gt;</span></span><br><span class="line">                  類別：</span><br><span class="line">                  <span class="tag">&lt;<span class="name">span</span> <span class="attr">v-for</span>=<span class="string">&quot;(category, index) in menu.list&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;index&quot;</span>&gt;</span></span><br><span class="line">                    &#123;&#123; category.categoryName &#125;&#125;&#123;&#123; index &lt; menu.list.length - 1 ? &#x27;、&#x27; : &#x27;&#x27; &#125;&#125; <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="comment">&lt;!-- 操作按鈕 --&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;btn-group&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-outline-primary btn-sm&quot;</span> @<span class="attr">click.stop</span>=<span class="string">&quot;goToEdit(menu._id)&quot;</span>&gt;</span></span><br><span class="line">                  編輯</span><br><span class="line">                <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-outline-danger btn-sm&quot;</span> @<span class="attr">click.stop</span>=<span class="string">&quot;confirmDelete(menu)&quot;</span>&gt;</span></span><br><span class="line">                  刪除</span><br><span class="line">                <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">&lt;!-- 無資料提示 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">&quot;menus.length === 0&quot;</span> <span class="attr">class</span>=<span class="string">&quot;col-12&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;text-center py-5 text-muted&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">p</span>&gt;</span>目前沒有菜單<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">&quot;./add&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary&quot;</span>&gt;</span></span><br><span class="line">            新增第一個菜單</span><br><span class="line">          <span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123; ref, onMounted &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123; useRouter &#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> router = <span class="title function_">useRouter</span>()</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="variable constant_">API_BASE_URL</span> = <span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">env</span>.<span class="property">VITE_API_BASE_URL</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> menus = <span class="title function_">ref</span>([])</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> loading = <span class="title function_">ref</span>(<span class="literal">true</span>)</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> error = <span class="title function_">ref</span>(<span class="literal">null</span>)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 獲取所有菜單</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">fetchMenus</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    loading.<span class="property">value</span> = <span class="literal">true</span></span></span><br><span class="line"><span class="language-javascript">    error.<span class="property">value</span> = <span class="literal">null</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> response = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">`<span class="subst">$&#123;API_BASE_URL&#125;</span>/menu`</span>)</span></span><br><span class="line"><span class="language-javascript">    menus.<span class="property">value</span> = response.<span class="property">data</span></span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">catch</span> (err) &#123;</span></span><br><span class="line"><span class="language-javascript">    error.<span class="property">value</span> = <span class="string">&#x27;獲取菜單列表失敗，請稍後再試&#x27;</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error fetching menus:&#x27;</span>, err)</span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">finally</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    loading.<span class="property">value</span> = <span class="literal">false</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 計算總項目數</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">getTotalItems</span> = (<span class="params">menu</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">return</span> menu.<span class="property">list</span>.<span class="title function_">reduce</span>(<span class="function">(<span class="params">total, category</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> total + category.<span class="property">items</span>.<span class="property">length</span></span></span><br><span class="line"><span class="language-javascript">  &#125;, <span class="number">0</span>)</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 跳轉到菜單詳情頁</span></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// const goToMenu = (id) =&gt; &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 	router.push(`/menu/$&#123;id&#125;`)</span></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// &#125;</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 跳轉到編輯頁面</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">goToEdit</span> = (<span class="params">id</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  router.<span class="title function_">push</span>(<span class="string">`./<span class="subst">$&#123;id&#125;</span>`</span>)</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 確認刪除</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">confirmDelete</span> = <span class="keyword">async</span> (<span class="params">menu</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (<span class="title function_">confirm</span>(<span class="string">`確定要刪除菜單 &quot;<span class="subst">$&#123;menu.name&#125;</span>&quot; 嗎？`</span>)) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">await</span> axios.<span class="title function_">delete</span>(<span class="string">`<span class="subst">$&#123;API_BASE_URL&#125;</span>/menu/<span class="subst">$&#123;menu._id&#125;</span>`</span>)</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">await</span> <span class="title function_">fetchMenus</span>() <span class="comment">// 重新獲取列表</span></span></span><br><span class="line"><span class="language-javascript">    &#125; <span class="keyword">catch</span> (err) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">alert</span>(<span class="string">&#x27;刪除失敗，請稍後再試&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error deleting menu:&#x27;</span>, err)</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 初始化</span></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">fetchMenus</span>()</span></span><br><span class="line"><span class="language-javascript">&#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.hover-shadow</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">transition</span>: box-shadow <span class="number">0.3s</span> ease;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.hover-shadow</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0.5rem</span> <span class="number">1rem</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.15</span>);</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="修改與刪除"><a href="#修改與刪除" class="headerlink" title="修改與刪除"></a>修改與刪除</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container py-4&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 載入中提示 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">&quot;loading&quot;</span> <span class="attr">class</span>=<span class="string">&quot;text-center py-5&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;spinner-border&quot;</span> <span class="attr">role</span>=<span class="string">&quot;status&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;visually-hidden&quot;</span>&gt;</span>Loading...<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 錯誤提示 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-else-if</span>=<span class="string">&quot;error&quot;</span> <span class="attr">class</span>=<span class="string">&quot;alert alert-danger&quot;</span> <span class="attr">role</span>=<span class="string">&quot;alert&quot;</span>&gt;</span></span><br><span class="line">      &#123;&#123; error &#125;&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-else</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;d-flex justify-content-between align-items-center mb-4&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;&#123; isEditing ? &#x27;編輯菜單&#x27; : &#x27;菜單詳情&#x27; &#125;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;btn-group&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">button</span> </span></span><br><span class="line"><span class="tag">            <span class="attr">v-if</span>=<span class="string">&quot;!isEditing&quot;</span> </span></span><br><span class="line"><span class="tag">            @<span class="attr">click</span>=<span class="string">&quot;isEditing = true&quot;</span> </span></span><br><span class="line"><span class="tag">            <span class="attr">class</span>=<span class="string">&quot;btn btn-primary&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span></span><br><span class="line">            編輯</span><br><span class="line">          <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">button</span> </span></span><br><span class="line"><span class="tag">            <span class="attr">v-if</span>=<span class="string">&quot;!isEditing&quot;</span> </span></span><br><span class="line"><span class="tag">            @<span class="attr">click</span>=<span class="string">&quot;confirmDelete&quot;</span> </span></span><br><span class="line"><span class="tag">            <span class="attr">class</span>=<span class="string">&quot;btn btn-danger&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span></span><br><span class="line">            刪除</span><br><span class="line">          <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">button</span> </span></span><br><span class="line"><span class="tag">            <span class="attr">v-if</span>=<span class="string">&quot;isEditing&quot;</span> </span></span><br><span class="line"><span class="tag">            @<span class="attr">click</span>=<span class="string">&quot;cancelEdit&quot;</span> </span></span><br><span class="line"><span class="tag">            <span class="attr">class</span>=<span class="string">&quot;btn btn-secondary&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span></span><br><span class="line">            取消</span><br><span class="line">          <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">&lt;!-- 菜單內容 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 菜單名稱 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card mb-4&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card-body&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;form-label&quot;</span>&gt;</span>菜單名稱<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> </span></span><br><span class="line"><span class="tag">              <span class="attr">v-model</span>=<span class="string">&quot;menuName&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">type</span>=<span class="string">&quot;text&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">placeholder</span>=<span class="string">&quot;輸入菜單名稱&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">:disabled</span>=<span class="string">&quot;!isEditing&quot;</span></span></span><br><span class="line"><span class="tag">            /&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&lt;!-- 菜單類別列表 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;mb-4&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-for</span>=<span class="string">&quot;(category, categoryIndex) in menuData&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;categoryIndex&quot;</span> <span class="attr">class</span>=<span class="string">&quot;card mb-3&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card-body&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;d-flex justify-content-between align-items-start mb-3&quot;</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!-- 類別名稱 --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex-grow-1 me-3&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;form-label&quot;</span>&gt;</span>類別名稱<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">input</span> </span></span><br><span class="line"><span class="tag">                    <span class="attr">v-model</span>=<span class="string">&quot;category.categoryName&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">type</span>=<span class="string">&quot;text&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">placeholder</span>=<span class="string">&quot;輸入類別名稱（例如：主餐、附餐）&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">:disabled</span>=<span class="string">&quot;!isEditing&quot;</span></span></span><br><span class="line"><span class="tag">                  /&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!-- 類別排序控制 --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">&quot;isEditing&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn-group&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">button</span> </span></span><br><span class="line"><span class="tag">                    @<span class="attr">click</span>=<span class="string">&quot;moveCategory(categoryIndex, -1)&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">class</span>=<span class="string">&quot;btn btn-outline-secondary&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">:disabled</span>=<span class="string">&quot;categoryIndex === 0&quot;</span></span></span><br><span class="line"><span class="tag">                  &gt;</span></span><br><span class="line">                    ↑</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">button</span> </span></span><br><span class="line"><span class="tag">                    @<span class="attr">click</span>=<span class="string">&quot;moveCategory(categoryIndex, 1)&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">class</span>=<span class="string">&quot;btn btn-outline-secondary&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">:disabled</span>=<span class="string">&quot;categoryIndex === menuData.length - 1&quot;</span></span></span><br><span class="line"><span class="tag">                  &gt;</span></span><br><span class="line">                    ↓</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="comment">&lt;!-- 餐點列表 --&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;mb-3&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">h5</span> <span class="attr">class</span>=<span class="string">&quot;card-title&quot;</span>&gt;</span>餐點項目<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;list-group&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> </span></span><br><span class="line"><span class="tag">                    <span class="attr">v-for</span>=<span class="string">&quot;(item, itemIndex) in category.items&quot;</span> </span></span><br><span class="line"><span class="tag">                    <span class="attr">:key</span>=<span class="string">&quot;itemIndex&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">class</span>=<span class="string">&quot;list-group-item&quot;</span></span></span><br><span class="line"><span class="tag">                  &gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;row align-items-center&quot;</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">select</span> </span></span><br><span class="line"><span class="tag">                          <span class="attr">v-model</span>=<span class="string">&quot;item.itemModel&quot;</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">class</span>=<span class="string">&quot;form-select mb-2&quot;</span></span></span><br><span class="line"><span class="tag">                          @<span class="attr">change</span>=<span class="string">&quot;item.itemId = null&quot;</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">:disabled</span>=<span class="string">&quot;!isEditing&quot;</span></span></span><br><span class="line"><span class="tag">                        &gt;</span></span><br><span class="line">                          <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span>&gt;</span>選擇餐點類型<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">                          <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;MainDish&quot;</span>&gt;</span>主餐<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">                          <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;ElseDish&quot;</span>&gt;</span>其他餐點<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">                          <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;RawMeat&quot;</span>&gt;</span>食材<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">                        </span><br><span class="line">                        <span class="tag">&lt;<span class="name">select</span> </span></span><br><span class="line"><span class="tag">                          <span class="attr">v-if</span>=<span class="string">&quot;item.itemModel&quot;</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">v-model</span>=<span class="string">&quot;item.itemId&quot;</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">class</span>=<span class="string">&quot;form-select&quot;</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">:disabled</span>=<span class="string">&quot;!isEditing&quot;</span></span></span><br><span class="line"><span class="tag">                        &gt;</span></span><br><span class="line">                          <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span>&gt;</span>選擇餐點<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">                          <span class="tag">&lt;<span class="name">option</span> </span></span><br><span class="line"><span class="tag">                            <span class="attr">v-for</span>=<span class="string">&quot;dish in getDishes(item.itemModel)&quot;</span> </span></span><br><span class="line"><span class="tag">                            <span class="attr">:key</span>=<span class="string">&quot;dish._id&quot;</span> </span></span><br><span class="line"><span class="tag">                            <span class="attr">:value</span>=<span class="string">&quot;dish._id&quot;</span></span></span><br><span class="line"><span class="tag">                          &gt;</span></span><br><span class="line">                            &#123;&#123; dish.name &#125;&#125; - $&#123;&#123; dish.price &#125;&#125;</span><br><span class="line">                          <span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">&quot;isEditing&quot;</span> <span class="attr">class</span>=<span class="string">&quot;col-auto&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;btn-group&quot;</span>&gt;</span></span><br><span class="line">                          <span class="tag">&lt;<span class="name">button</span> </span></span><br><span class="line"><span class="tag">                            @<span class="attr">click</span>=<span class="string">&quot;moveItem(categoryIndex, itemIndex, -1)&quot;</span></span></span><br><span class="line"><span class="tag">                            <span class="attr">class</span>=<span class="string">&quot;btn btn-outline-secondary&quot;</span></span></span><br><span class="line"><span class="tag">                            <span class="attr">:disabled</span>=<span class="string">&quot;itemIndex === 0&quot;</span></span></span><br><span class="line"><span class="tag">                          &gt;</span></span><br><span class="line">                            ↑</span><br><span class="line">                          <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">                          <span class="tag">&lt;<span class="name">button</span> </span></span><br><span class="line"><span class="tag">                            @<span class="attr">click</span>=<span class="string">&quot;moveItem(categoryIndex, itemIndex, 1)&quot;</span></span></span><br><span class="line"><span class="tag">                            <span class="attr">class</span>=<span class="string">&quot;btn btn-outline-secondary&quot;</span></span></span><br><span class="line"><span class="tag">                            <span class="attr">:disabled</span>=<span class="string">&quot;itemIndex === category.items.length - 1&quot;</span></span></span><br><span class="line"><span class="tag">                          &gt;</span></span><br><span class="line">                            ↓</span><br><span class="line">                          <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">                          <span class="tag">&lt;<span class="name">button</span> </span></span><br><span class="line"><span class="tag">                            @<span class="attr">click</span>=<span class="string">&quot;removeItem(categoryIndex, itemIndex)&quot;</span></span></span><br><span class="line"><span class="tag">                            <span class="attr">class</span>=<span class="string">&quot;btn btn-outline-danger&quot;</span></span></span><br><span class="line"><span class="tag">                          &gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;bi bi-trash&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">                          <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="tag">&lt;<span class="name">button</span> </span></span><br><span class="line"><span class="tag">                  <span class="attr">v-if</span>=<span class="string">&quot;isEditing&quot;</span></span></span><br><span class="line"><span class="tag">                  @<span class="attr">click</span>=<span class="string">&quot;addItem(category)&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">class</span>=<span class="string">&quot;btn btn-outline-primary mt-2&quot;</span></span></span><br><span class="line"><span class="tag">                &gt;</span></span><br><span class="line">                  新增餐點</span><br><span class="line">                <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="tag">&lt;<span class="name">button</span> </span></span><br><span class="line"><span class="tag">                <span class="attr">v-if</span>=<span class="string">&quot;isEditing&quot;</span></span></span><br><span class="line"><span class="tag">                @<span class="attr">click</span>=<span class="string">&quot;removeCategory(categoryIndex)&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">class</span>=<span class="string">&quot;btn btn-danger&quot;</span></span></span><br><span class="line"><span class="tag">              &gt;</span></span><br><span class="line">                刪除類別</span><br><span class="line">              <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 控制按鈕 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">&quot;isEditing&quot;</span> <span class="attr">class</span>=<span class="string">&quot;d-flex gap-2&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">button</span> </span></span><br><span class="line"><span class="tag">            @<span class="attr">click</span>=<span class="string">&quot;addCategory&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">class</span>=<span class="string">&quot;btn btn-primary&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span></span><br><span class="line">            新增類別</span><br><span class="line">          <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">          </span><br><span class="line">          <span class="tag">&lt;<span class="name">button</span> </span></span><br><span class="line"><span class="tag">            @<span class="attr">click</span>=<span class="string">&quot;saveMenu&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">class</span>=<span class="string">&quot;btn btn-success&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">:disabled</span>=<span class="string">&quot;!isValid&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span></span><br><span class="line">            儲存菜單</span><br><span class="line">          <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123; ref, computed, onMounted &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123; useRoute, useRouter &#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> route = <span class="title function_">useRoute</span>()</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> router = <span class="title function_">useRouter</span>()</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="variable constant_">API_BASE_URL</span> = <span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">env</span>.<span class="property">VITE_API_BASE_URL</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> menuId = route.<span class="property">params</span>.<span class="property">id</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 狀態</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> loading = <span class="title function_">ref</span>(<span class="literal">true</span>)</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> error = <span class="title function_">ref</span>(<span class="literal">null</span>)</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> isEditing = <span class="title function_">ref</span>(<span class="literal">false</span>)</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> menuName = <span class="title function_">ref</span>(<span class="string">&#x27;&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> menuData = <span class="title function_">ref</span>([])</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> mainDishes = <span class="title function_">ref</span>([])</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> elseDishes = <span class="title function_">ref</span>([])</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> rawMeats = <span class="title function_">ref</span>([])</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 從伺服器獲取菜單數據</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">fetchMenu</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    loading.<span class="property">value</span> = <span class="literal">true</span></span></span><br><span class="line"><span class="language-javascript">    error.<span class="property">value</span> = <span class="literal">null</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> response = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">`<span class="subst">$&#123;API_BASE_URL&#125;</span>/menu/<span class="subst">$&#123;menuId&#125;</span>`</span>)</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> menu = response.<span class="property">data</span></span></span><br><span class="line"><span class="language-javascript">    </span></span><br><span class="line"><span class="language-javascript">    menuName.<span class="property">value</span> = menu.<span class="property">name</span></span></span><br><span class="line"><span class="language-javascript">    menuData.<span class="property">value</span> = menu.<span class="property">list</span></span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">catch</span> (err) &#123;</span></span><br><span class="line"><span class="language-javascript">    error.<span class="property">value</span> = <span class="string">&#x27;獲取菜單數據失敗，請稍後再試&#x27;</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error fetching menu:&#x27;</span>, err)</span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">finally</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    loading.<span class="property">value</span> = <span class="literal">false</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 獲取指定類型的餐點</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">fetchDishes</span> = <span class="keyword">async</span> (<span class="params">endpoint</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> response = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">`<span class="subst">$&#123;API_BASE_URL&#125;</span>/dish<span class="subst">$&#123;endpoint&#125;</span>`</span>)</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> response.<span class="property">data</span></span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">catch</span> (error) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error fetching dishes:&#x27;</span>, error)</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> []</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 初始化時獲取所有類型的餐點</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">initializeDishes</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> [mainResponse, elseResponse, rawResponse] = <span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">all</span>([</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">fetchDishes</span>(<span class="string">&#x27;/mainDish&#x27;</span>),</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">fetchDishes</span>(<span class="string">&#x27;/elseDish&#x27;</span>),</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">fetchDishes</span>(<span class="string">&#x27;/rawMeat&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    ])</span></span><br><span class="line"><span class="language-javascript">    </span></span><br><span class="line"><span class="language-javascript">    mainDishes.<span class="property">value</span> = mainResponse</span></span><br><span class="line"><span class="language-javascript">    elseDishes.<span class="property">value</span> = elseResponse</span></span><br><span class="line"><span class="language-javascript">    rawMeats.<span class="property">value</span> = rawResponse</span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">catch</span> (error) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error initializing dishes:&#x27;</span>, error)</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 根據餐點類型獲取對應的餐點列表</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">getDishes</span> = (<span class="params">itemModel</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">switch</span> (itemModel) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">case</span> <span class="string">&#x27;MainDish&#x27;</span>:</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> mainDishes.<span class="property">value</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">case</span> <span class="string">&#x27;ElseDish&#x27;</span>:</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> elseDishes.<span class="property">value</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">case</span> <span class="string">&#x27;RawMeat&#x27;</span>:</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> rawMeats.<span class="property">value</span></span></span><br><span class="line"><span class="language-javascript">    <span class="attr">default</span>:</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> []</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 類別操作</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">addCategory</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  menuData.<span class="property">value</span>.<span class="title function_">push</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">categoryName</span>: <span class="string">&#x27;&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">items</span>: [],</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">order</span>: menuData.<span class="property">value</span>.<span class="property">length</span></span></span><br><span class="line"><span class="language-javascript">  &#125;)</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">removeCategory</span> = (<span class="params">index</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  menuData.<span class="property">value</span>.<span class="title function_">splice</span>(index, <span class="number">1</span>)</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">updateCategoryOrders</span>()</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">moveCategory</span> = (<span class="params">categoryIndex, direction</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> newIndex = categoryIndex + direction</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (newIndex &gt;= <span class="number">0</span> &amp;&amp; newIndex &lt; menuData.<span class="property">value</span>.<span class="property">length</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> temp = menuData.<span class="property">value</span>[categoryIndex]</span></span><br><span class="line"><span class="language-javascript">    menuData.<span class="property">value</span>[categoryIndex] = menuData.<span class="property">value</span>[newIndex]</span></span><br><span class="line"><span class="language-javascript">    menuData.<span class="property">value</span>[newIndex] = temp</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">updateCategoryOrders</span>()</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 項目操作</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">addItem</span> = (<span class="params">category</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  category.<span class="property">items</span>.<span class="title function_">push</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">itemModel</span>: <span class="string">&#x27;&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">itemId</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">order</span>: category.<span class="property">items</span>.<span class="property">length</span></span></span><br><span class="line"><span class="language-javascript">  &#125;)</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">removeItem</span> = (<span class="params">categoryIndex, itemIndex</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  menuData.<span class="property">value</span>[categoryIndex].<span class="property">items</span>.<span class="title function_">splice</span>(itemIndex, <span class="number">1</span>)</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">updateItemOrders</span>(categoryIndex)</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">moveItem</span> = (<span class="params">categoryIndex, itemIndex, direction</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> newIndex = itemIndex + direction</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> items = menuData.<span class="property">value</span>[categoryIndex].<span class="property">items</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (newIndex &gt;= <span class="number">0</span> &amp;&amp; newIndex &lt; items.<span class="property">length</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> temp = items[itemIndex]</span></span><br><span class="line"><span class="language-javascript">    items[itemIndex] = items[newIndex]</span></span><br><span class="line"><span class="language-javascript">    items[newIndex] = temp</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">updateItemOrders</span>(categoryIndex)</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 更新排序</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">updateCategoryOrders</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  menuData.<span class="property">value</span>.<span class="title function_">forEach</span>(<span class="function">(<span class="params">category, index</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    category.<span class="property">order</span> = index</span></span><br><span class="line"><span class="language-javascript">  &#125;)</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">updateItemOrders</span> = (<span class="params">categoryIndex</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  menuData.<span class="property">value</span>[categoryIndex].<span class="property">items</span>.<span class="title function_">forEach</span>(<span class="function">(<span class="params">item, index</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    item.<span class="property">order</span> = index</span></span><br><span class="line"><span class="language-javascript">  &#125;)</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 表單驗證</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> isValid = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">return</span> menuName.<span class="property">value</span>.<span class="title function_">trim</span>() !== <span class="string">&#x27;&#x27;</span> &amp;&amp; </span></span><br><span class="line"><span class="language-javascript">    menuData.<span class="property">value</span>.<span class="title function_">every</span>(<span class="function"><span class="params">category</span> =&gt;</span> </span></span><br><span class="line"><span class="language-javascript">      category.<span class="property">categoryName</span>.<span class="title function_">trim</span>() !== <span class="string">&#x27;&#x27;</span> &amp;&amp;</span></span><br><span class="line"><span class="language-javascript">      category.<span class="property">items</span>.<span class="title function_">every</span>(<span class="function"><span class="params">item</span> =&gt;</span> </span></span><br><span class="line"><span class="language-javascript">        item.<span class="property">itemModel</span> &amp;&amp; item.<span class="property">itemId</span></span></span><br><span class="line"><span class="language-javascript">      )</span></span><br><span class="line"><span class="language-javascript">    )</span></span><br><span class="line"><span class="language-javascript">&#125;)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 儲存菜單</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">saveMenu</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> menuToSave = &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">name</span>: menuName.<span class="property">value</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">list</span>: menuData.<span class="property">value</span>.<span class="title function_">map</span>(<span class="function">(<span class="params">category, categoryIndex</span>) =&gt;</span> (&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">categoryName</span>: category.<span class="property">categoryName</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">order</span>: categoryIndex,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">items</span>: category.<span class="property">items</span>.<span class="title function_">map</span>(<span class="function">(<span class="params">item, itemIndex</span>) =&gt;</span> (&#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">itemModel</span>: item.<span class="property">itemModel</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">itemId</span>: item.<span class="property">itemId</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">order</span>: itemIndex</span></span><br><span class="line"><span class="language-javascript">        &#125;))</span></span><br><span class="line"><span class="language-javascript">      &#125;))</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    </span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">await</span> axios.<span class="title function_">put</span>(<span class="string">`<span class="subst">$&#123;API_BASE_URL&#125;</span>/menu/<span class="subst">$&#123;menuId&#125;</span>`</span>, menuToSave)</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(<span class="string">&#x27;菜單更新成功！&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    isEditing.<span class="property">value</span> = <span class="literal">false</span></span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">catch</span> (error) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error saving menu:&#x27;</span>, error)</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(<span class="string">&#x27;儲存失敗，請稍後再試&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 取消編輯</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">cancelEdit</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  isEditing.<span class="property">value</span> = <span class="literal">false</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">await</span> <span class="title function_">fetchMenu</span>() <span class="comment">// 重新獲取數據，恢復原始狀態</span></span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 確認刪除</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">confirmDelete</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (<span class="title function_">confirm</span>(<span class="string">`確定要刪除菜單 &quot;<span class="subst">$&#123;menuName.value&#125;</span>&quot; 嗎？`</span>)) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">await</span> axios.<span class="title function_">delete</span>(<span class="string">`<span class="subst">$&#123;API_BASE_URL&#125;</span>/menu/<span class="subst">$&#123;menuId&#125;</span>`</span>)</span></span><br><span class="line"><span class="language-javascript">      router.<span class="title function_">push</span>(<span class="string">&#x27;/menu&#x27;</span>) <span class="comment">// 刪除後返回列表頁</span></span></span><br><span class="line"><span class="language-javascript">    &#125; <span class="keyword">catch</span> (err) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">alert</span>(<span class="string">&#x27;刪除失敗，請稍後再試&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error deleting menu:&#x27;</span>, err)</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 初始化</span></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">onMounted</span>(<span class="title function_">async</span> () =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">all</span>([</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">fetchMenu</span>(),</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">initializeDishes</span>()</span></span><br><span class="line"><span class="language-javascript">  ])</span></span><br><span class="line"><span class="language-javascript">&#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>




<h2 id="店家管理"><a href="#店家管理" class="headerlink" title="店家管理"></a>店家管理</h2><h3 id="API-2"><a href="#API-2" class="headerlink" title="API"></a>API</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> express <span class="keyword">from</span> <span class="string">&#x27;express&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Store</span> <span class="keyword">from</span> <span class="string">&#x27;../schemas/storeSchema.js&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 取得 store</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="title function_">async</span> (req, res) =&gt; &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> store = <span class="keyword">await</span> <span class="title class_">Store</span>.<span class="title function_">find</span>(&#123;&#125;);</span><br><span class="line">    <span class="keyword">if</span> (!store) <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">404</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Store not found&#x27;</span> &#125;);</span><br><span class="line"></span><br><span class="line">    res.<span class="title function_">json</span>(store);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error getting store:&#x27;</span>, error);</span><br><span class="line">    res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">send</span>(<span class="string">&#x27;Internal server error&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 取得單個 store</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/:id&#x27;</span>, <span class="title function_">async</span> (req, res) =&gt; &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; id &#125; = req.<span class="property">params</span>;</span><br><span class="line">    <span class="keyword">const</span> store = <span class="keyword">await</span> <span class="title class_">Store</span>.<span class="title function_">findById</span>(id).<span class="title function_">populate</span>(<span class="string">&#x27;menuItem&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> (!store) <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">404</span>).<span class="title function_">json</span>(&#123; <span class="attr">error</span>: <span class="string">&#x27;Store not found&#x27;</span> &#125;);</span><br><span class="line"></span><br><span class="line">    res.<span class="title function_">json</span>(store);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error getting store:&#x27;</span>, error);</span><br><span class="line">    res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">send</span>(<span class="string">&#x27;Internal server error&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 創建 store</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/&#x27;</span>, <span class="title function_">async</span> (req, res) =&gt; &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> newStore = <span class="keyword">new</span> <span class="title class_">Store</span>(req.<span class="property">body</span>);</span><br><span class="line">    <span class="keyword">await</span> newStore.<span class="title function_">save</span>();</span><br><span class="line"></span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&#x27;Store created successfully&#x27;</span>);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error creating store:&#x27;</span>, error);</span><br><span class="line">    res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">send</span>(<span class="string">&#x27;Internal server error&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 更新 store</span></span><br><span class="line">router.<span class="title function_">put</span>(<span class="string">&#x27;/:id&#x27;</span>, <span class="title function_">async</span> (req, res) =&gt; &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; id &#125; = req.<span class="property">params</span>;</span><br><span class="line">    <span class="keyword">await</span> <span class="title class_">Store</span>.<span class="title function_">findByIdAndUpdate</span>(id, req.<span class="property">body</span>);</span><br><span class="line"></span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&#x27;Store updated successfully&#x27;</span>);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error updating store:&#x27;</span>, error);</span><br><span class="line">    res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">send</span>(<span class="string">&#x27;Internal server error&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 刪除 store</span></span><br><span class="line">router.<span class="title function_">delete</span>(<span class="string">&#x27;/:id&#x27;</span>, <span class="title function_">async</span> (req, res) =&gt; &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; id &#125; = req.<span class="property">params</span>;</span><br><span class="line">    <span class="keyword">await</span> <span class="title class_">Store</span>.<span class="title function_">findByIdAndDelete</span>(id);</span><br><span class="line"></span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&#x27;Store deleted successfully&#x27;</span>);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error deleting store:&#x27;</span>, error);</span><br><span class="line">    res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">send</span>(<span class="string">&#x27;Internal server error&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router;</span><br></pre></td></tr></table></figure>

<h3 id="新增-1"><a href="#新增-1" class="headerlink" title="新增"></a>新增</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container py-4&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;row justify-content-center&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col-md-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card-header&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h2</span> <span class="attr">class</span>=<span class="string">&quot;mb-0&quot;</span>&gt;</span>新增店家<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card-body&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">form</span> @<span class="attr">submit.prevent</span>=<span class="string">&quot;handleSubmit&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;mb-3&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;storeName&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-label&quot;</span>&gt;</span>店家名稱<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">type</span>=<span class="string">&quot;text&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">id</span>=<span class="string">&quot;storeName&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">v-model</span>=<span class="string">&quot;storeForm.name&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">required</span></span></span><br><span class="line"><span class="tag">                /&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;mb-3&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;menuSelect&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-label&quot;</span>&gt;</span>選擇菜單<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">select</span> </span></span><br><span class="line"><span class="tag">                  <span class="attr">class</span>=<span class="string">&quot;form-select&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">id</span>=<span class="string">&quot;menuSelect&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">v-model</span>=<span class="string">&quot;storeForm.menuItem&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">required</span></span></span><br><span class="line"><span class="tag">                &gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span>&gt;</span>請選擇菜單<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">option</span> </span></span><br><span class="line"><span class="tag">                    <span class="attr">v-for</span>=<span class="string">&quot;menu in menus&quot;</span> </span></span><br><span class="line"><span class="tag">                    <span class="attr">:key</span>=<span class="string">&quot;menu._id&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">:value</span>=<span class="string">&quot;menu._id&quot;</span></span></span><br><span class="line"><span class="tag">                  &gt;</span></span><br><span class="line">                    &#123;&#123; menu.name &#125;&#125;</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;d-flex justify-content-between&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">&quot;./show&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-secondary&quot;</span>&gt;</span></span><br><span class="line">                  返回</span><br><span class="line">                <span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary&quot;</span> <span class="attr">:disabled</span>=<span class="string">&quot;loading&quot;</span>&gt;</span></span><br><span class="line">                  &#123;&#123; loading ? &#x27;儲存中...&#x27; : &#x27;儲存&#x27; &#125;&#125;</span><br><span class="line">                <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123; ref, onMounted &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123; useRouter &#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> router = <span class="title function_">useRouter</span>()</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="variable constant_">API_BASE_URL</span> = <span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">env</span>.<span class="property">VITE_API_BASE_URL</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> loading = <span class="title function_">ref</span>(<span class="literal">false</span>)</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> menus = <span class="title function_">ref</span>([])</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> storeForm = <span class="title function_">ref</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">name</span>: <span class="string">&#x27;&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">menuItem</span>: <span class="string">&#x27;&#x27;</span></span></span><br><span class="line"><span class="language-javascript">&#125;)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 獲取所有菜單</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">fetchMenus</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> response = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">`<span class="subst">$&#123;API_BASE_URL&#125;</span>/menu`</span>)</span></span><br><span class="line"><span class="language-javascript">    menus.<span class="property">value</span> = response.<span class="property">data</span></span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">catch</span> (error) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;獲取菜單失敗:&#x27;</span>, error)</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(<span class="string">&#x27;獲取菜單失敗&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">handleSubmit</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    loading.<span class="property">value</span> = <span class="literal">true</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">await</span> axios.<span class="title function_">post</span>(<span class="string">`<span class="subst">$&#123;API_BASE_URL&#125;</span>/store`</span>, storeForm.<span class="property">value</span>)</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// alert(&#x27;新增成功！&#x27;)</span></span></span><br><span class="line"><span class="language-javascript">    router.<span class="title function_">push</span>(<span class="string">&#x27;./show&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">catch</span> (error) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;新增失敗:&#x27;</span>, error)</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(<span class="string">&#x27;新增失敗，請稍後再試&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">finally</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    loading.<span class="property">value</span> = <span class="literal">false</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">fetchMenus</span>()</span></span><br><span class="line"><span class="language-javascript">&#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="修改與刪除-1"><a href="#修改與刪除-1" class="headerlink" title="修改與刪除"></a>修改與刪除</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container py-4&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;row justify-content-center&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col-md-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card-header d-flex justify-content-between align-items-center&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h2</span> <span class="attr">class</span>=<span class="string">&quot;mb-0&quot;</span>&gt;</span>編輯店家<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">button</span> </span></span><br><span class="line"><span class="tag">              <span class="attr">class</span>=<span class="string">&quot;btn btn-danger&quot;</span></span></span><br><span class="line"><span class="tag">              @<span class="attr">click</span>=<span class="string">&quot;handleDelete&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">:disabled</span>=<span class="string">&quot;loading&quot;</span></span></span><br><span class="line"><span class="tag">            &gt;</span></span><br><span class="line">              刪除店家</span><br><span class="line">            <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card-body&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">&quot;loading&quot;</span> <span class="attr">class</span>=<span class="string">&quot;text-center py-4&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;spinner-border&quot;</span> <span class="attr">role</span>=<span class="string">&quot;status&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;visually-hidden&quot;</span>&gt;</span>Loading...<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">form</span> <span class="attr">v-else</span> @<span class="attr">submit.prevent</span>=<span class="string">&quot;handleSubmit&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;mb-3&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;storeName&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-label&quot;</span>&gt;</span>店家名稱<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">type</span>=<span class="string">&quot;text&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">id</span>=<span class="string">&quot;storeName&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">v-model</span>=<span class="string">&quot;storeForm.name&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">required</span></span></span><br><span class="line"><span class="tag">                /&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;mb-3&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;menuSelect&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-label&quot;</span>&gt;</span>選擇菜單<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">select</span> </span></span><br><span class="line"><span class="tag">                  <span class="attr">class</span>=<span class="string">&quot;form-select&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">id</span>=<span class="string">&quot;menuSelect&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">v-model</span>=<span class="string">&quot;storeForm.menuItem&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">required</span></span></span><br><span class="line"><span class="tag">                &gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span>&gt;</span>請選擇菜單<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">option</span> </span></span><br><span class="line"><span class="tag">                    <span class="attr">v-for</span>=<span class="string">&quot;menu in menus&quot;</span> </span></span><br><span class="line"><span class="tag">                    <span class="attr">:key</span>=<span class="string">&quot;menu._id&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">:value</span>=<span class="string">&quot;menu._id&quot;</span></span></span><br><span class="line"><span class="tag">                  &gt;</span></span><br><span class="line">                    &#123;&#123; menu.name &#125;&#125;</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;d-flex justify-content-between&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">&quot;./show&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-secondary&quot;</span>&gt;</span></span><br><span class="line">                  返回</span><br><span class="line">                <span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary&quot;</span> <span class="attr">:disabled</span>=<span class="string">&quot;loading&quot;</span>&gt;</span></span><br><span class="line">                  &#123;&#123; loading ? &#x27;儲存中...&#x27; : &#x27;儲存&#x27; &#125;&#125;</span><br><span class="line">                <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123; ref, onMounted &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123; useRouter, useRoute &#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> router = <span class="title function_">useRouter</span>()</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> route = <span class="title function_">useRoute</span>()</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="variable constant_">API_BASE_URL</span> = <span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">env</span>.<span class="property">VITE_API_BASE_URL</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> loading = <span class="title function_">ref</span>(<span class="literal">false</span>)</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> menus = <span class="title function_">ref</span>([])</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> storeForm = <span class="title function_">ref</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">name</span>: <span class="string">&#x27;&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">menuItem</span>: <span class="string">&#x27;&#x27;</span></span></span><br><span class="line"><span class="language-javascript">&#125;)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 獲取所有菜單</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">fetchMenus</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> response = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">`<span class="subst">$&#123;API_BASE_URL&#125;</span>/menu`</span>)</span></span><br><span class="line"><span class="language-javascript">    menus.<span class="property">value</span> = response.<span class="property">data</span></span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">catch</span> (error) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;獲取菜單失敗:&#x27;</span>, error)</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(<span class="string">&#x27;獲取菜單失敗&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 獲取店家資料</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">fetchStore</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    loading.<span class="property">value</span> = <span class="literal">true</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> storeId = route.<span class="property">params</span>.<span class="property">id</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> &#123; <span class="attr">data</span>: storeData &#125; = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">`<span class="subst">$&#123;API_BASE_URL&#125;</span>/store/<span class="subst">$&#123;storeId&#125;</span>`</span>)</span></span><br><span class="line"><span class="language-javascript">    </span></span><br><span class="line"><span class="language-javascript">    storeForm.<span class="property">value</span> = &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">name</span>: storeData.<span class="property">name</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">menuItem</span>: storeData.<span class="property">menuItem</span></span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">catch</span> (error) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;獲取店家資料失敗:&#x27;</span>, error)</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(<span class="string">&#x27;獲取店家資料失敗&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    router.<span class="title function_">push</span>(<span class="string">&#x27;./show&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">finally</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    loading.<span class="property">value</span> = <span class="literal">false</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">handleSubmit</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    loading.<span class="property">value</span> = <span class="literal">true</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> storeId = route.<span class="property">params</span>.<span class="property">id</span></span></span><br><span class="line"><span class="language-javascript">    </span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">await</span> axios.<span class="title function_">put</span>(<span class="string">`<span class="subst">$&#123;API_BASE_URL&#125;</span>/store/<span class="subst">$&#123;storeId&#125;</span>`</span>, storeForm.<span class="property">value</span>)</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// alert(&#x27;更新成功！&#x27;)</span></span></span><br><span class="line"><span class="language-javascript">    router.<span class="title function_">push</span>(<span class="string">&#x27;./show&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">catch</span> (error) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;更新失敗:&#x27;</span>, error)</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(<span class="string">&#x27;更新失敗，請稍後再試&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">finally</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    loading.<span class="property">value</span> = <span class="literal">false</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">handleDelete</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (!<span class="title function_">confirm</span>(<span class="string">&#x27;確定要刪除這個店家嗎？&#x27;</span>)) <span class="keyword">return</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    loading.<span class="property">value</span> = <span class="literal">true</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> storeId = route.<span class="property">params</span>.<span class="property">id</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">await</span> axios.<span class="title function_">delete</span>(<span class="string">`<span class="subst">$&#123;API_BASE_URL&#125;</span>/store/<span class="subst">$&#123;storeId&#125;</span>`</span>)</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// alert(&#x27;刪除成功！&#x27;)</span></span></span><br><span class="line"><span class="language-javascript">    router.<span class="title function_">push</span>(<span class="string">&#x27;./show&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">catch</span> (error) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;刪除失敗:&#x27;</span>, error)</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(<span class="string">&#x27;刪除失敗，請稍後再試&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">finally</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    loading.<span class="property">value</span> = <span class="literal">false</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="title class_">Promise</span>.<span class="title function_">all</span>([<span class="title function_">fetchStore</span>(), <span class="title function_">fetchMenus</span>()])</span></span><br><span class="line"><span class="language-javascript">&#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="顯示-2"><a href="#顯示-2" class="headerlink" title="顯示"></a>顯示</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container py-4&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;d-flex justify-content-between align-items-center mb-4&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>分店列表<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">&quot;./add&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary&quot;</span>&gt;</span></span><br><span class="line">        新增分店</span><br><span class="line">      <span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 店家列表 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;row&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">&quot;loading&quot;</span> <span class="attr">class</span>=<span class="string">&quot;col-12 text-center&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;spinner-border&quot;</span> <span class="attr">role</span>=<span class="string">&quot;status&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;visually-hidden&quot;</span>&gt;</span>Loading...<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-else-if</span>=<span class="string">&quot;stores.length === 0&quot;</span> <span class="attr">class</span>=<span class="string">&quot;col-12&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;alert alert-info&quot;</span>&gt;</span></span><br><span class="line">          目前還沒有任何分店資料</span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-else</span> <span class="attr">class</span>=<span class="string">&quot;col-12&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;table-responsive&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">&quot;table table-hover&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>分店名稱<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>操作<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">tr</span> <span class="attr">v-for</span>=<span class="string">&quot;store in stores&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;store._id&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123; store.name &#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;btn-group&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">router-link</span> </span></span><br><span class="line"><span class="tag">                      <span class="attr">:to</span>=<span class="string">&quot;`./$&#123;store._id&#125;`&quot;</span> </span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;btn btn-sm btn-outline-primary&quot;</span></span></span><br><span class="line"><span class="tag">                    &gt;</span></span><br><span class="line">                      編輯</span><br><span class="line">                    <span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">button</span> </span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;btn btn-sm btn-outline-danger&quot;</span></span></span><br><span class="line"><span class="tag">                      @<span class="attr">click</span>=<span class="string">&quot;handleDelete(store._id)&quot;</span></span></span><br><span class="line"><span class="tag">                    &gt;</span></span><br><span class="line">                      刪除</span><br><span class="line">                    <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123; ref, onMounted &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123; useRouter &#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> router = <span class="title function_">useRouter</span>()</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="variable constant_">API_BASE_URL</span> = <span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">env</span>.<span class="property">VITE_API_BASE_URL</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> stores = <span class="title function_">ref</span>([])</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> loading = <span class="title function_">ref</span>(<span class="literal">true</span>)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 獲取所有店家資料</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">fetchStores</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    loading.<span class="property">value</span> = <span class="literal">true</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> response = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">`<span class="subst">$&#123;API_BASE_URL&#125;</span>/store`</span>)</span></span><br><span class="line"><span class="language-javascript">    stores.<span class="property">value</span> = response.<span class="property">data</span></span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">catch</span> (error) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;獲取店家資料失敗:&#x27;</span>, error)</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(<span class="string">&#x27;獲取店家資料失敗&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">finally</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    loading.<span class="property">value</span> = <span class="literal">false</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 刪除店家</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">handleDelete</span> = <span class="keyword">async</span> (<span class="params">storeId</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (!<span class="title function_">confirm</span>(<span class="string">&#x27;確定要刪除這個店家嗎？&#x27;</span>)) <span class="keyword">return</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">await</span> axios.<span class="title function_">delete</span>(<span class="string">`<span class="subst">$&#123;API_BASE_URL&#125;</span>/store/<span class="subst">$&#123;storeId&#125;</span>`</span>)</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">await</span> <span class="title function_">fetchStores</span>() <span class="comment">// 重新獲取列表</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// alert(&#x27;刪除成功&#x27;)</span></span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">catch</span> (error) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;刪除店家失敗:&#x27;</span>, error)</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(<span class="string">&#x27;刪除店家失敗&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 組件掛載時獲取資料</span></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">fetchStores</span>()</span></span><br><span class="line"><span class="language-javascript">&#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.table</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">margin-bottom</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.btn-group</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">gap</span>: <span class="number">0.5rem</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="訂單列表"><a href="#訂單列表" class="headerlink" title="訂單列表"></a>訂單列表</h2><h3 id="訂單首頁"><a href="#訂單首頁" class="headerlink" title="訂單首頁"></a>訂單首頁</h3><p>首先分成兩部分</p>
<ol>
<li>上方選擇即設定部分 (頁面大約占20%)</li>
</ol>
<ul>
<li>選擇要顯示的天數 [1,10,30]</li>
<li>兩個按鈕[往前,往後]，假設上方是選擇10天那麼往後就是本來區間[20:11] -&gt; [10:1]</li>
<li>移動區間範圍</li>
</ul>
<ol start="2">
<li>下方顯示訂單部分 (頁面大約佔80%)</li>
</ol>
<ul>
<li>每個<code>card</code> 代表一天</li>
<li><code>card header</code> 顯示當天利潤</li>
<li><code>card body</code> 顯示兩行 [總收入,手續費]</li>
<li>手續費 根據 <code>paymentMethod</code>: enum: [‘現金’:0%,’linepay’:3%,’FoodPanda’:25%,’UberEat’:33%]</li>
<li>現金沒有手續費，其他三種方式有，計算方式為:假設為<code>UberEat</code> 收入是150 那手續費是 150 * 0.33 &#x3D; 49 (手續費皆為無條件捨去)</li>
<li>利潤 &#x3D; 總收入 - 手續費</li>
<li>給個 <code>card</code> 都可以點擊 進入當天 detail</li>
</ul>
<h3 id="當天-detail"><a href="#當天-detail" class="headerlink" title="當天 detail"></a>當天 detail</h3><ol>
<li>首先是圖表</li>
</ol>
<ul>
<li>圓餅圖: 顯示當天總收入中，利潤與手續費所占的比率</li>
<li>圓餅圖: 顯示[內用,自取,Foodpanda,Ubereat]各個得占比</li>
<li>直方圖: 顯示當天個餐點銷量由大排到小 (加點肉品需加到那個肉品的銷量統計)</li>
<li>折線圖: 顯示每半個小時為區間的，主餐數量，來判斷哪個區段的時間最為繁忙</li>
</ul>
<ol start="2">
<li>顯示所有訂單</li>
</ol>
<ul>
<li>每行需顯示 [store,orderNumber,platform,pickupMethod,paymentMethod,totalMoney,orderStatus] 最後有一個詳細資料的按鈕</li>
<li>點開詳細資料後 打開一個modal 顯示所有資料</li>
</ul>
<p>我正在設計線上點餐系統的後台<br>我在想怎麼設計 顯示那些東西 會是客戶真正需要的<br>目前客戶 他覺得以前的系統不好 可是他不知道怎麼改善<br>我現在有全部的決定權</p>
<p>這邊為顯示數據的部分<br>我的想法首先第一個page<br>每個card header顯示每日的營業額 body為可切換三種模式第一種顯示所有餐點的銷售額即占比%數 第二種 顯示內用 外帶 外送 的銷售額即占比 第三種顯示現金付款與線上付款的占比 百分比統一四捨五入到小數點第一位 每個card 可以點進去查看當日所有訂單的細節 因為訂單細節有點多 目前打算顯示 一些重要資料 後面放一個 詳細資料的按鈕 點擊會跳出一個 顯示所有資料個框框</p>
<p>第二個page 顯示統計圖表<br>第一個圖表為折線圖縱軸為銷售額 橫軸為星期 一星期連成一條線<br>顯示一個月 共四星期 用來比較每日的銷售額與星期的關聯 還有各個星期的銷售數據<br>第二個圖表 為圓餅圖顯示各個時段的銷售數據顯示一個月內的數據<br>第三個圖表 為圓餅圖顯示各個餐點的銷售數據顯示一個月內的數據<br>第四個圖表 為圓餅圖顯示線上付款與現金付款的占比數據 一個月內的數據</p>
<p>上述的四個圖表 下列再增加四個一樣的圖表只是改成1年的<br>第一個圖表 共12個月 用來比較每月的銷售額與星期的關聯 還有各個月的銷售數據<br>第二個圖表 為圓餅圖顯示各個時段的銷售數據顯示一年內的數據<br>第三個圖表 為圓餅圖顯示各個餐點的銷售數據顯示一年內的數據<br>第四個圖表 為圓餅圖顯示線上付款與現金付款的占比數據 一年的數據</p>
<h2 id="數據統計"><a href="#數據統計" class="headerlink" title="數據統計"></a>數據統計</h2><blockquote>
<p>想要呈現的資料：</p>
</blockquote>
<h1 id="客人點餐介面"><a href="#客人點餐介面" class="headerlink" title="客人點餐介面"></a>客人點餐介面</h1><h2 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h2><ol>
<li>基本需求</li>
</ol>
<ul>
<li>網址<code>/customer/:store</code></li>
<li>需要區分分店</li>
<li>需要區分內用與自取</li>
<li>內用需要有桌號</li>
<li>自取需要可以設定時間或是立即取餐</li>
<li>開頭一張圖片及店名</li>
<li>下方餐點上方有個 滾動導覽</li>
<li>餐點類別的navbar</li>
<li>有個巢狀迴圈外迴圈是餐點類別，內迴圈是那個類別的各個餐點(card)</li>
<li>每個餐點card上面是一張餐點圖 下方顯示名稱與價錢</li>
<li>點進去之後顯示(同個網址不同component)點餐細節及加點，按鈕加入購物車旁邊顯示價錢 </li>
<li>購物車內不為0時顯示於下方</li>
<li>點開購物車(同個網址不同component)後顯示點餐的品項下方有前往結帳</li>
<li>換到下一個(同個網址不同component)可以選內用，自取，外送</li>
<li>內用需要桌號</li>
<li>自許需要選時間(需要填電話，姓名)，或是立即取餐(不用填)</li>
<li>外送需要地址，電話，姓名</li>
<li>接下來按鈕是送出訂單</li>
<li>挑轉到完成訂單的介面(不同網址)</li>
</ul>
<ol start="2">
<li>進階需求</li>
</ol>
<ul>
<li>需處理<code>兌換券</code>、<code>折價券</code>邏輯</li>
<li>使用<code>nav-tags</code>上方資訊結束後接著[<code>菜單</code>,<code>兌換券</code>,<code>折價券</code>]</li>
<li></li>
</ul>
<h2 id="各個頁面"><a href="#各個頁面" class="headerlink" title="各個頁面"></a>各個頁面</h2><h3 id="主要整合頁面"><a href="#主要整合頁面" class="headerlink" title="主要整合頁面"></a>主要整合頁面</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;main-container&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;center-container&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">transition</span> <span class="attr">name</span>=<span class="string">&quot;fade&quot;</span> <span class="attr">mode</span>=<span class="string">&quot;out-in&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">MenuListing</span> <span class="attr">v-if</span>=<span class="string">&quot;!selectedItem &amp;&amp; !showCart&quot;</span> <span class="attr">:store-name</span>=<span class="string">&quot;store.name&quot;</span> <span class="attr">:announcements</span>=<span class="string">&quot;store.announcements&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">:menu-list</span>=<span class="string">&quot;menu.list&quot;</span> <span class="attr">:menu-items</span>=<span class="string">&quot;menuItems&quot;</span> @<span class="attr">select-item</span>=<span class="string">&quot;openItemDetails&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">transition</span> <span class="attr">name</span>=<span class="string">&quot;fade&quot;</span> <span class="attr">mode</span>=<span class="string">&quot;out-in&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ItemDetail</span> <span class="attr">v-if</span>=<span class="string">&quot;selectedItem &amp;&amp; !showCart&quot;</span> <span class="attr">:item</span>=<span class="string">&quot;selectedItem&quot;</span> <span class="attr">:addon-items</span>=<span class="string">&quot;addonItems&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">:menu-items</span>=<span class="string">&quot;menuItems&quot;</span> @<span class="attr">close</span>=<span class="string">&quot;closeItemDetails&quot;</span> @<span class="attr">add-to-cart</span>=<span class="string">&quot;addToCart&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">transition</span> <span class="attr">name</span>=<span class="string">&quot;fade&quot;</span> <span class="attr">mode</span>=<span class="string">&quot;out-in&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ShoppingCart</span> <span class="attr">v-if</span>=<span class="string">&quot;showCart&quot;</span> <span class="attr">:cart</span>=<span class="string">&quot;cart&quot;</span> <span class="attr">:order-type</span>=<span class="string">&quot;orderType&quot;</span> <span class="attr">:store-id</span>=<span class="string">&quot;storeId&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">:remove-from-cart</span>=<span class="string">&quot;removeFromCart&quot;</span> <span class="attr">:update-cart-item-quantity</span>=<span class="string">&quot;updateCartItemQuantity&quot;</span></span></span><br><span class="line"><span class="tag">          @<span class="attr">go-back</span>=<span class="string">&quot;showCart = false&quot;</span> @<span class="attr">edit-item</span>=<span class="string">&quot;editCartItem&quot;</span> @<span class="attr">order-submitted</span>=<span class="string">&quot;handleOrderSubmitted&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">&lt;!-- Shopping Cart Button --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">&quot;cart.length &gt; 0 &amp;&amp; !selectedItem &amp;&amp; !showCart&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;position-fixed bottom-0 start-50 translate-middle-x mb-4&quot;</span> <span class="attr">style</span>=<span class="string">&quot;z-index: 1030;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary rounded-pill shadow px-4 py-2&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;showCart = true&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;bi bi-cart-fill me-2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">          &#123;&#123; getTotalItems() &#125;&#125; 項商品 - $&#123;&#123; calculateTotal() &#125;&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123; onMounted, ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123; useRoute, useRouter &#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> <span class="title class_">MenuListing</span> <span class="keyword">from</span> <span class="string">&#x27;@/components/OrderComponents/Main.vue&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> <span class="title class_">ItemDetail</span> <span class="keyword">from</span> <span class="string">&#x27;@/components/OrderComponents/ItemDetail.vue&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> <span class="title class_">ShoppingCart</span> <span class="keyword">from</span> <span class="string">&#x27;@/components/OrderComponents/ShoppingCart.vue&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> route = <span class="title function_">useRoute</span>();</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> router = <span class="title function_">useRouter</span>();</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="variable constant_">API_BASE_URL</span> = <span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">env</span>.<span class="property">VITE_API_BASE_URL</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> storeId = route.<span class="property">params</span>.<span class="property">store</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> queryOrderType = route.<span class="property">query</span>.<span class="property">orderType</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> queryTable = route.<span class="property">query</span>.<span class="property">table</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// State</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> store = <span class="title function_">ref</span>(&#123;&#125;);</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> menu = <span class="title function_">ref</span>(&#123;&#125;);</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> menuItems = <span class="title function_">ref</span>([]);</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> addonItems = <span class="title function_">ref</span>([]);</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> orderType = <span class="title function_">ref</span>(queryOrderType || <span class="string">&#x27;dineIn&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> tableNumber = <span class="title function_">ref</span>(queryTable || <span class="string">&#x27;0&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> selectedItem = <span class="title function_">ref</span>(<span class="literal">null</span>);</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> cart = <span class="title function_">ref</span>([]);</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> showCart = <span class="title function_">ref</span>(<span class="literal">false</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// Bootstrap modal instance</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">let</span> cartModal = <span class="literal">null</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">fetchStore</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> response = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">`<span class="subst">$&#123;API_BASE_URL&#125;</span>/store/<span class="subst">$&#123;storeId&#125;</span>`</span>);</span></span><br><span class="line"><span class="language-javascript">    store.<span class="property">value</span> = response.<span class="property">data</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// console.log(store.value);</span></span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">catch</span> (error) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error fetching store:&#x27;</span>, error);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">fetchMenu</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  menu.<span class="property">value</span> = store.<span class="property">value</span>.<span class="property">menuItem</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// console.log(&#x27;menu&#x27;, menu.value);</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> itemPromises = [];</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">for</span> (<span class="keyword">const</span> category <span class="keyword">of</span> menu.<span class="property">value</span>.<span class="property">list</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">for</span> (<span class="keyword">const</span> item <span class="keyword">of</span> category.<span class="property">items</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      itemPromises.<span class="title function_">push</span>(axios.<span class="title function_">get</span>(<span class="string">`<span class="subst">$&#123;API_BASE_URL&#125;</span>/dish/<span class="subst">$&#123;item.itemModel.charAt(<span class="number">0</span>).toLowerCase() + item.itemModel.slice(<span class="number">1</span>)&#125;</span>/<span class="subst">$&#123;item.itemId&#125;</span>`</span>));</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> dishModelMapping = &#123;&#125;;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (menu.<span class="property">value</span> &amp;&amp; menu.<span class="property">value</span>.<span class="property">list</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    menu.<span class="property">value</span>.<span class="property">list</span>.<span class="title function_">forEach</span>(<span class="function"><span class="params">category</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      category.<span class="property">items</span>.<span class="title function_">forEach</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        dishModelMapping[item.<span class="property">itemId</span>] = item.<span class="property">itemModel</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> itemResponses = <span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">all</span>(itemPromises);</span></span><br><span class="line"><span class="language-javascript">  menuItems.<span class="property">value</span> = itemResponses.<span class="title function_">map</span>(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      ...response.<span class="property">data</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">itemModel</span>: dishModelMapping[response.<span class="property">data</span>.<span class="property">_id</span>]</span></span><br><span class="line"><span class="language-javascript">    &#125;;</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// console.log(&#x27;menuItems&#x27;, menuItems.value);</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> &#123; <span class="attr">data</span>: addons &#125; = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">`<span class="subst">$&#123;API_BASE_URL&#125;</span>/dish/addon`</span>);</span></span><br><span class="line"><span class="language-javascript">  addonItems.<span class="property">value</span> = addons;</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">openItemDetails</span> = (<span class="params">item</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  selectedItem.<span class="property">value</span> = item;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// console.log(item);</span></span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">closeItemDetails</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  selectedItem.<span class="property">value</span> = <span class="literal">null</span>;</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">addToCart</span> = (<span class="params">item</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  cart.<span class="property">value</span>.<span class="title function_">push</span>(item);</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// console.log(cart.value);</span></span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">openCartModal</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  cartModal.<span class="title function_">show</span>();</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">updateCartItemQuantity</span> = (<span class="params">index, change</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> newQuantity = cart.<span class="property">value</span>[index].<span class="property">quantity</span> + change;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (newQuantity &gt; <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    cart.<span class="property">value</span>[index].<span class="property">quantity</span> = newQuantity;</span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">removeFromCart</span>(index);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">removeFromCart</span> = (<span class="params">index</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  cart.<span class="property">value</span>.<span class="title function_">splice</span>(index, <span class="number">1</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// If cart is empty, go back to menu</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (cart.<span class="property">value</span>.<span class="property">length</span> === <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    showCart.<span class="property">value</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">editCartItem</span> = (<span class="params">index</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> item = menuItems.<span class="property">value</span>.<span class="title function_">find</span>(<span class="function"><span class="params">menuItem</span> =&gt;</span> menuItem.<span class="property">_id</span> === cart.<span class="property">value</span>[index].<span class="property">id</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (item) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// Remove the item from cart first</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> itemToEdit = cart.<span class="property">value</span>[index];</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">removeFromCart</span>(index);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// Open the item detail with pre-filled selections</span></span></span><br><span class="line"><span class="language-javascript">    selectedItem.<span class="property">value</span> = &#123;</span></span><br><span class="line"><span class="language-javascript">      ...item,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">preFilled</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">quantity</span>: itemToEdit.<span class="property">quantity</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">doneness</span>: itemToEdit.<span class="property">doneness</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">sauce</span>: itemToEdit.<span class="property">sauce</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">addons</span>: itemToEdit.<span class="property">addons</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">additionalMeats</span>: itemToEdit.<span class="property">additionalMeats</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">extraOptions</span>: itemToEdit.<span class="property">extraOptions</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">remarks</span>: itemToEdit.<span class="property">remarks</span></span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    showCart.<span class="property">value</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">handleOrderSubmitted</span> = (<span class="params">order</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// Clear the cart after order is submitted</span></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// console.log(&#x27;Order submitted:&#x27;, order);</span></span></span><br><span class="line"><span class="language-javascript">  cart.<span class="property">value</span> = [];</span></span><br><span class="line"><span class="language-javascript">  showCart.<span class="property">value</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">getTotalItems</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">return</span> cart.<span class="property">value</span>.<span class="title function_">reduce</span>(<span class="function">(<span class="params">total, item</span>) =&gt;</span> total + item.<span class="property">quantity</span>, <span class="number">0</span>);</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">calculateTotal</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">return</span> cart.<span class="property">value</span>.<span class="title function_">reduce</span>(<span class="function">(<span class="params">total, item</span>) =&gt;</span> total + (item.<span class="property">price</span> * item.<span class="property">quantity</span>), <span class="number">0</span>);</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">formatAddons</span> = (<span class="params">addons</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">return</span> addons.<span class="title function_">map</span>(<span class="function"><span class="params">addon</span> =&gt;</span> addon.<span class="property">name</span>).<span class="title function_">join</span>(<span class="string">&#x27;, &#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">formatAddationMeats</span> = (<span class="params">additionalMeats</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">return</span> additionalMeats.<span class="title function_">map</span>(<span class="function"><span class="params">meat</span> =&gt;</span> meat.<span class="property">name</span>).<span class="title function_">join</span>(<span class="string">&#x27;, &#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">checkout</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (orderType.<span class="property">value</span> === <span class="string">&#x27;dineIn&#x27;</span> &amp;&amp; !tableNumber.<span class="property">value</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(<span class="string">&#x27;請輸入桌號&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> orderItems = cart.<span class="property">value</span>.<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> (&#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">itemModel</span>: item.<span class="property">itemModel</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">itemId</span>: item.<span class="property">id</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">amount</span>: item.<span class="property">quantity</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">options</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">doneness</span>: item.<span class="property">doneness</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">sauce</span>: item.<span class="property">sauce</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">addons</span>: item.<span class="property">addons</span>.<span class="title function_">map</span>(<span class="function"><span class="params">a</span> =&gt;</span> a.<span class="property">id</span>),</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">extraOptions</span>: item.<span class="property">extraOptions</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">additionalMeats</span>: item.<span class="property">additionalMeats</span>?.<span class="title function_">map</span>(<span class="function"><span class="params">m</span> =&gt;</span> m.<span class="property">id</span>) || [],</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">remarks</span>: item.<span class="property">remarks</span></span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;));</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> orderAmount = <span class="built_in">parseFloat</span>(<span class="title function_">calculateTotal</span>());</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> orderData = &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">store</span>: storeId,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">orderNumber</span>: <span class="title class_">String</span>(<span class="keyword">await</span> <span class="title function_">generateOrderNumber</span>()),</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">platform</span>: <span class="string">&#x27;web&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">pickupMethod</span>: orderType.<span class="property">value</span> === <span class="string">&#x27;dineIn&#x27;</span> ? <span class="string">&#x27;內用&#x27;</span> : <span class="string">&#x27;外帶&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">paymentMethod</span>: <span class="string">&#x27;store&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">      orderAmount,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">totalPaid</span>: orderAmount,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">tableNumber</span>: orderType.<span class="property">value</span> === <span class="string">&#x27;dineIn&#x27;</span> ? tableNumber.<span class="property">value</span> : <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">items</span>: orderItems,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">remarks</span>: cart.<span class="property">value</span>.<span class="title function_">some</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="property">remarks</span>) ? cart.<span class="property">value</span>.<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="property">remarks</span>).<span class="title function_">filter</span>(<span class="title class_">Boolean</span>).<span class="title function_">join</span>(<span class="string">&#x27; / &#x27;</span>) : <span class="literal">null</span></span></span><br><span class="line"><span class="language-javascript">    &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> &#123; <span class="attr">data</span>: newOrder &#125; = <span class="keyword">await</span> axios.<span class="title function_">post</span>(<span class="string">`<span class="subst">$&#123;API_BASE_URL&#125;</span>/order`</span>, orderData);</span></span><br><span class="line"><span class="language-javascript">    cartModal.<span class="title function_">hide</span>();</span></span><br><span class="line"><span class="language-javascript">    router.<span class="title function_">push</span>(<span class="string">`/customer/confirmation/<span class="subst">$&#123;newOrder._id&#125;</span>`</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">catch</span> (error) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error creating order:&#x27;</span>, error);</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(<span class="string">&#x27;訂單建立失敗，請重試&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">generateOrderNumber</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> number = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">`<span class="subst">$&#123;API_BASE_URL&#125;</span>/order/number`</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">return</span> number.<span class="property">data</span>.<span class="property">number</span>;</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// Initialize Bootstrap modal</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">initModal</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// Import Bootstrap&#x27;s modal JavaScript</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span>(<span class="string">&#x27;bootstrap/js/dist/modal&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">module</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> <span class="title class_">Modal</span> = <span class="variable language_">module</span>.<span class="property">default</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// Initialize cart modal</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> cartModalElement = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;cartModal&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (cartModalElement) &#123;</span></span><br><span class="line"><span class="language-javascript">      cartModal = <span class="keyword">new</span> <span class="title class_">Modal</span>(cartModalElement);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">onMounted</span>(<span class="title function_">async</span> () =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (!store.<span class="property">value</span>.<span class="property">name</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">await</span> <span class="title function_">fetchStore</span>();</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (!menu.<span class="property">value</span>.<span class="property">list</span> || menu.<span class="property">value</span>.<span class="property">list</span>.<span class="property">length</span> === <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">await</span> <span class="title function_">fetchMenu</span>();</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">initModal</span>();</span></span><br><span class="line"><span class="language-javascript">&#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.main-container</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">min-height</span>: <span class="number">100vh</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">background-color</span>: <span class="number">#eaeae668</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.center-container</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">max-width</span>: <span class="number">768px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">background-color</span>: <span class="number">#ffffff</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">min-height</span>: <span class="number">100vh</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">10px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.2</span>);</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="comment">/* 定義過渡動畫 */</span></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.fade-enter-active</span>,</span></span><br><span class="line"><span class="language-css"><span class="selector-class">.fade-leave-active</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">transition</span>: opacity <span class="number">0.3s</span> ease;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.fade-enter-from</span>,</span></span><br><span class="line"><span class="language-css"><span class="selector-class">.fade-leave-to</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="餐點列表-及-navbar"><a href="#餐點列表-及-navbar" class="headerlink" title="餐點列表 及 navbar"></a>餐點列表 及 navbar</h3><ul>
<li>圖片高度 240px</li>
<li>餐點名稱</li>
<li>分隔線</li>
<li>細節選項</li>
<li>分隔線</li>
<li>備註</li>
<li>數量</li>
<li>加入購物車(之後跳回主頁面)</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- MenuListing.vue --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;nav-container&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;nav-wrapper autohide&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">nav</span> <span class="attr">class</span>=<span class="string">&quot;navbar navbar-expand-lg navbar-light&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container-fluid&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;navbar-brand&quot;</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span> <span class="attr">style</span>=<span class="string">&quot;font-weight: bold;&quot;</span>&gt;</span>奔野牛排 &#123;&#123; storeName &#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;nav-link&quot;</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span> Menu item <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;nav-border&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;content-wrapper&quot;</span> <span class="attr">style</span>=<span class="string">&quot;padding: 0;&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">img</span> <span class="attr">style</span>=<span class="string">&quot;max-height: 200px; width: 100%; padding: 0;&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">src</span>=<span class="string">&quot;https://media.discordapp.net/attachments/1180694061573750784/1343283614644699166/dsa95wawd9_Shinkai_Makoto_dark_city_ocean_mountain_Sword_Art_On_6bf493b4-a797-4e49-b8e8-6f026f259430.png?ex=67bcb5da&amp;is=67bb645a&amp;hm=526a63515c6780ee1600c34b89182880d9457752e869138f9dec2dc96477b88c&amp;=&amp;format=webp&amp;quality=lossless&amp;width=1202&amp;height=676&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">alt</span>=<span class="string">&quot;pic&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;content-wrapper mt-4&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h3</span> <span class="attr">class</span>=<span class="string">&quot;fw-bold&quot;</span>&gt;</span>奔野牛排 &#123;&#123; storeName &#125;&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>營業時間： 早上：11:30 ~ 13:30 晚上：5:00 ~ 8:30<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;nav-border&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;content-wrapper mt-4&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h3</span> <span class="attr">class</span>=<span class="string">&quot;fw-bold&quot;</span>&gt;</span>公告：<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-for</span>=<span class="string">&quot;(announcement, index) in announcements&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;announcement._id&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;mt-3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">h5</span> <span class="attr">class</span>=<span class="string">&quot;mb-2 fw-bold&quot;</span>&gt;</span>&#123;&#123; announcement.title &#125;&#125;<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;mb-0&quot;</span>&gt;</span>&#123;&#123; announcement.content &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">hr</span> <span class="attr">v-if</span>=<span class="string">&quot;index &lt; announcements.length - 1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;my-2&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;nav-border mt-4&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;content-wrapper mt-4&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h3</span> <span class="attr">class</span>=<span class="string">&quot;fw-bold&quot;</span>&gt;</span>菜單：<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-for</span>=<span class="string">&quot;category in menuList&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;category._id&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h4</span> <span class="attr">class</span>=<span class="string">&quot;fw-bold mt-3&quot;</span>&gt;</span>&#123;&#123; category.categoryName &#125;&#125;<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 g-4&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-for</span>=<span class="string">&quot;item in getItemsInCategory(category)&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;item._id&quot;</span> <span class="attr">class</span>=<span class="string">&quot;col&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card h-100 shadow-sm&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;$emit(&#x27;select-item&#x27;, item)&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card-img-top&quot;</span> <span class="attr">style</span>=<span class="string">&quot;aspect-ratio: 1/1; overflow: hidden;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">img</span> <span class="attr">:src</span>=<span class="string">&quot;item.image?.url || &#x27;/placeholder.jpg&#x27;&quot;</span> <span class="attr">:alt</span>=<span class="string">&quot;item.name&quot;</span> <span class="attr">class</span>=<span class="string">&quot;w-100 h-100&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">style</span>=<span class="string">&quot;object-fit: cover;&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card-body&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">h5</span> <span class="attr">class</span>=<span class="string">&quot;card-title&quot;</span>&gt;</span>&#123;&#123; item.name &#125;&#125;<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;card-text text-danger fw-bold&quot;</span>&gt;</span>$&#123;&#123; item.price &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;nav-border mt-4&quot;</span> <span class="attr">style</span>=<span class="string">&quot;height: 2px;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123; onMounted, onUnmounted &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> props = <span class="title function_">defineProps</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">storeName</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">type</span>: <span class="title class_">String</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">required</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">default</span>: <span class="string">&#x27;&#x27;</span></span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">announcements</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">type</span>: <span class="title class_">Array</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">required</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">default</span>: <span class="function">() =&gt;</span> []</span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">menuList</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">type</span>: <span class="title class_">Array</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">required</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">default</span>: <span class="function">() =&gt;</span> []</span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">menuItems</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">type</span>: <span class="title class_">Array</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">required</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">default</span>: <span class="function">() =&gt;</span> []</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> emit = <span class="title function_">defineEmits</span>([<span class="string">&#x27;select-item&#x27;</span>]);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">getItemsInCategory</span> = (<span class="params">category</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">return</span> props.<span class="property">menuItems</span>.<span class="title function_">filter</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> category.<span class="property">items</span>.<span class="title function_">some</span>(<span class="function"><span class="params">catItem</span> =&gt;</span> catItem.<span class="property">itemId</span> === item.<span class="property">_id</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125;).<span class="title function_">sort</span>(<span class="function">(<span class="params">a, b</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> aOrder = category.<span class="property">items</span>.<span class="title function_">find</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="property">itemId</span> === a.<span class="property">_id</span>)?.<span class="property">order</span> || <span class="number">0</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> bOrder = category.<span class="property">items</span>.<span class="title function_">find</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="property">itemId</span> === b.<span class="property">_id</span>)?.<span class="property">order</span> || <span class="number">0</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> aOrder - bOrder;</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">navbarInit</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> el_autohide = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.autohide&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> navbar_height = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.navbar&#x27;</span>).<span class="property">offsetHeight</span> + <span class="number">1</span></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.content-wrapper&#x27;</span>).<span class="property">style</span>.<span class="property">paddingTop</span> = <span class="string">`<span class="subst">$&#123;navbar_height&#125;</span>px`</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (el_autohide) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> last_scroll_top = <span class="number">0</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> <span class="title function_">scrollHandler</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> scroll_top = <span class="variable language_">window</span>.<span class="property">scrollY</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (scroll_top &gt; navbar_height) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (scroll_top &lt; last_scroll_top) &#123;</span></span><br><span class="line"><span class="language-javascript">          el_autohide.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&#x27;scrolled-down&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">          el_autohide.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;scrolled-up&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">        &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          el_autohide.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&#x27;scrolled-up&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">          el_autohide.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;scrolled-down&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      last_scroll_top = scroll_top</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;scroll&#x27;</span>, scrollHandler)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">onUnmounted</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">window</span>.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;scroll&#x27;</span>, scrollHandler)</span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">navbarInit</span>()</span></span><br><span class="line"><span class="language-javascript">&#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.nav-container</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">position</span>: fixed;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">top</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">max-width</span>: <span class="number">768px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">z-index</span>: <span class="number">1030</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">left</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">transform</span>: <span class="built_in">translateX</span>(-<span class="number">50%</span>);</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.nav-wrapper</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">background-color</span>: <span class="number">#ffffff</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.navbar</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">background-color</span>: <span class="number">#ffffff</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">margin-bottom</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.nav-border</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">height</span>: <span class="number">1px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">background-color</span>: <span class="number">#dee2e6</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.scrolled-down</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-<span class="number">100%</span>);</span></span><br><span class="line"><span class="language-css">  <span class="attribute">transition</span>: all <span class="number">0.3s</span> ease-in-out;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.scrolled-up</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">0</span>);</span></span><br><span class="line"><span class="language-css">  <span class="attribute">transition</span>: all <span class="number">0.3s</span> ease-in-out;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.content-wrapper</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">15px</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.card</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">cursor</span>: pointer;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="各項餐點點餐detail"><a href="#各項餐點點餐detail" class="headerlink" title="各項餐點點餐detail"></a>各項餐點點餐detail</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item-detail&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Header with back button positioned over the image --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;header d-flex align-items-center p-3 position-absolute top-0 start-0 w-100 bg-transparent&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-sm rounded-circle shadow&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;$emit(&#x27;close&#x27;)&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">style</span>=<span class="string">&quot;background-color: rgba(255, 255, 255, 0.8); width: 40px; height: 40px; display: flex; align-items: center; justify-content: center;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;bi bi-arrow-left fs-4&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Image --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;image-container&quot;</span> <span class="attr">style</span>=<span class="string">&quot;height: 240px; overflow: hidden; position: relative;&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">img</span> <span class="attr">:src</span>=<span class="string">&quot;item.image?.url &quot;</span> <span class="attr">:alt</span>=<span class="string">&quot;item.name&quot;</span> <span class="attr">class</span>=<span class="string">&quot;w-100 h-100&quot;</span> <span class="attr">style</span>=<span class="string">&quot;object-fit: cover;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Item name and price --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;p-3 border-bottom&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h4</span> <span class="attr">class</span>=<span class="string">&quot;mb-2&quot;</span>&gt;</span>&#123;&#123; item.name &#125;&#125;<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;text-danger fw-bold mb-2&quot;</span>&gt;</span>$&#123;&#123; item.price &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;text-muted small&quot;</span> <span class="attr">style</span>=<span class="string">&quot;white-space: pre-line&quot;</span>&gt;</span>&#123;&#123; item.description &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Options section --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;options p-3 border-bottom&quot;</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- Steak Doneness options (if applicable) --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">&quot;item.category === &#x27;Steak&#x27;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;mb-4&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h6</span> <span class="attr">class</span>=<span class="string">&quot;fw-bold mb-2&quot;</span>&gt;</span>熟度選擇<span class="tag">&lt;/<span class="name">h6</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;d-flex flex-wrap&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-for</span>=<span class="string">&quot;doneness in item.steakDoneness&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;doneness&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-check me-3 mb-2&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;form-check-input&quot;</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">:id</span>=<span class="string">&quot;&#x27;doneness-&#x27; + doneness&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;selectedDoneness&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">:value</span>=<span class="string">&quot;doneness&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;form-check-label&quot;</span> <span class="attr">:for</span>=<span class="string">&quot;&#x27;doneness-&#x27; + doneness&quot;</span>&gt;</span>&#123;&#123; doneness &#125;&#125;<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">&lt;!-- Sauce options (if applicable) --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">&quot;item.sauceOptions &amp;&amp; item.sauceOptions.length&quot;</span> <span class="attr">class</span>=<span class="string">&quot;mb-4&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h6</span> <span class="attr">class</span>=<span class="string">&quot;fw-bold mb-2&quot;</span>&gt;</span>醬料選擇<span class="tag">&lt;/<span class="name">h6</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;d-flex flex-wrap&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-for</span>=<span class="string">&quot;sauce in item.sauceOptions&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;sauce&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-check me-3 mb-2&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;form-check-input&quot;</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">:id</span>=<span class="string">&quot;&#x27;sauce-&#x27; + sauce&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;selectedSauce&quot;</span> <span class="attr">:value</span>=<span class="string">&quot;sauce&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;form-check-label&quot;</span> <span class="attr">:for</span>=<span class="string">&quot;&#x27;sauce-&#x27; + sauce&quot;</span>&gt;</span>&#123;&#123; sauce &#125;&#125;<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">&lt;!-- Add-ons (if applicable for MainDish) --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">&quot;addonItems.length &gt; 0 &amp;&amp; item.itemModel === &#x27;MainDish&#x27;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;mb-4&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h6</span> <span class="attr">class</span>=<span class="string">&quot;fw-bold mb-2&quot;</span>&gt;</span>加點選項<span class="tag">&lt;/<span class="name">h6</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;d-flex flex-wrap&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-for</span>=<span class="string">&quot;addon in addonItems&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;addon._id&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-check me-3 mb-2&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;form-check-input&quot;</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">:id</span>=<span class="string">&quot;&#x27;addon-&#x27; + addon._id&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;selectedAddons&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">:value</span>=<span class="string">&quot;addon._id&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;form-check-label&quot;</span> <span class="attr">:for</span>=<span class="string">&quot;&#x27;addon-&#x27; + addon._id&quot;</span>&gt;</span></span><br><span class="line">              &#123;&#123; addon.name &#125;&#125; (+$&#123;&#123; addon.price &#125;&#125;)</span><br><span class="line">            <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">&lt;!-- Extra options (if applicable) --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">&quot;item.extraOptions &amp;&amp; item.extraOptions.length&quot;</span> <span class="attr">class</span>=<span class="string">&quot;mb-4&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h6</span> <span class="attr">class</span>=<span class="string">&quot;fw-bold mb-2&quot;</span>&gt;</span>額外需求<span class="tag">&lt;/<span class="name">h6</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;d-flex flex-wrap&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-for</span>=<span class="string">&quot;option in item.extraOptions&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;option&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-check me-3 mb-2&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;form-check-input&quot;</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">:id</span>=<span class="string">&quot;&#x27;extra-&#x27; + option&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;selectedExtraOptions&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">:value</span>=<span class="string">&quot;option&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;form-check-label&quot;</span> <span class="attr">:for</span>=<span class="string">&quot;&#x27;extra-&#x27; + option&quot;</span>&gt;</span></span><br><span class="line">              &#123;&#123; option &#125;&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">&lt;!-- Additional meat dishes (if applicable for MainDish) --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">&quot;additionalMeatDishes.length &gt; 0 &amp;&amp; item.itemModel === &#x27;MainDish&#x27;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;mb-4&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h6</span> <span class="attr">class</span>=<span class="string">&quot;fw-bold mb-2&quot;</span>&gt;</span>加點其他肉食單品<span class="tag">&lt;/<span class="name">h6</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;d-flex flex-wrap&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-for</span>=<span class="string">&quot;meat in additionalMeatDishes&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;meat._id&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-check me-3 mb-2&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;form-check-input&quot;</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">:id</span>=<span class="string">&quot;&#x27;meat-&#x27; + meat._id&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;selectedMeatDishes&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">:value</span>=<span class="string">&quot;meat._id&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;form-check-label&quot;</span> <span class="attr">:for</span>=<span class="string">&quot;&#x27;meat-&#x27; + meat._id&quot;</span>&gt;</span></span><br><span class="line">              &#123;&#123; meat.name &#125;&#125; (+$&#123;&#123; meat.extraPrice &#125;&#125;)</span><br><span class="line">            <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Remarks section --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;p-3 border-bottom&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h6</span> <span class="attr">class</span>=<span class="string">&quot;fw-bold mb-2&quot;</span>&gt;</span>特殊要求<span class="tag">&lt;/<span class="name">h6</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;remarks&quot;</span> <span class="attr">rows</span>=<span class="string">&quot;3&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;例如：不要洋蔥...&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Quantity section --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;p-3 d-flex align-items-center justify-content-between&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h6</span> <span class="attr">class</span>=<span class="string">&quot;fw-bold mb-0&quot;</span>&gt;</span>數量<span class="tag">&lt;/<span class="name">h6</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;input-group&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 140px;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-outline-secondary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;decreaseQuantity&quot;</span>&gt;</span>-<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;form-control text-center&quot;</span>&gt;</span>&#123;&#123; quantity &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-outline-secondary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;increaseQuantity&quot;</span>&gt;</span>+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Add to cart button --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;p-3 position-sticky bottom-0 bg-white border-top&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary w-100 py-2&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;addToCart&quot;</span>&gt;</span></span><br><span class="line">        加入購物車 - $&#123;&#123; calculateItemTotal() &#125;&#125;</span><br><span class="line">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123; ref, computed, watch &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> props = <span class="title function_">defineProps</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">item</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">type</span>: <span class="title class_">Object</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">required</span>: <span class="literal">true</span></span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">addonItems</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">type</span>: <span class="title class_">Array</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">default</span>: <span class="function">() =&gt;</span> []</span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">menuItems</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">type</span>: <span class="title class_">Array</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">default</span>: <span class="function">() =&gt;</span> []</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> emit = <span class="title function_">defineEmits</span>([<span class="string">&#x27;close&#x27;</span>, <span class="string">&#x27;add-to-cart&#x27;</span>]);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// State</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> quantity = <span class="title function_">ref</span>(<span class="number">1</span>);</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> remarks = <span class="title function_">ref</span>(<span class="string">&#x27;&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> selectedDoneness = <span class="title function_">ref</span>(<span class="string">&#x27;&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> selectedSauce = <span class="title function_">ref</span>(<span class="string">&#x27;&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> selectedAddons = <span class="title function_">ref</span>([]);</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> selectedExtraOptions = <span class="title function_">ref</span>([]);</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> selectedMeatDishes = <span class="title function_">ref</span>([]);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// Set default values when item changes</span></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">watch</span>(<span class="function">() =&gt;</span> props.<span class="property">item</span>, <span class="function">(<span class="params">newItem</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (newItem) &#123;</span></span><br><span class="line"><span class="language-javascript">    quantity.<span class="property">value</span> = <span class="number">1</span>;</span></span><br><span class="line"><span class="language-javascript">    remarks.<span class="property">value</span> = <span class="string">&#x27;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">    selectedDoneness.<span class="property">value</span> = newItem.<span class="property">steakDoneness</span> ? newItem.<span class="property">steakDoneness</span>[<span class="number">0</span>] : <span class="string">&#x27;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">    selectedSauce.<span class="property">value</span> = newItem.<span class="property">sauceOptions</span> ? newItem.<span class="property">sauceOptions</span>[<span class="number">0</span>] : <span class="string">&#x27;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">    selectedAddons.<span class="property">value</span> = [];</span></span><br><span class="line"><span class="language-javascript">    selectedExtraOptions.<span class="property">value</span> = [];</span></span><br><span class="line"><span class="language-javascript">    selectedMeatDishes.<span class="property">value</span> = [];</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;, &#123; <span class="attr">immediate</span>: <span class="literal">true</span> &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// Computed</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> additionalMeatDishes = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">return</span> props.<span class="property">menuItems</span>.<span class="title function_">filter</span>(<span class="function"><span class="params">item</span> =&gt;</span></span></span><br><span class="line"><span class="language-javascript">    item.<span class="property">itemModel</span> === <span class="string">&#x27;MainDish&#x27;</span> &amp;&amp;</span></span><br><span class="line"><span class="language-javascript">    item.<span class="property">extraPrice</span> &amp;&amp;</span></span><br><span class="line"><span class="language-javascript">    item.<span class="property">_id</span> !== props.<span class="property">item</span>?.<span class="property">_id</span></span></span><br><span class="line"><span class="language-javascript">  );</span></span><br><span class="line"><span class="language-javascript">&#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// Methods</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">increaseQuantity</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  quantity.<span class="property">value</span>++;</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">decreaseQuantity</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (quantity.<span class="property">value</span> &gt; <span class="number">1</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    quantity.<span class="property">value</span>--;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">calculateItemTotal</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> total = props.<span class="property">item</span>.<span class="property">price</span> * quantity.<span class="property">value</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// Add price for selected addons</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">for</span> (<span class="keyword">const</span> addonId <span class="keyword">of</span> selectedAddons.<span class="property">value</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> addon = props.<span class="property">addonItems</span>.<span class="title function_">find</span>(<span class="function"><span class="params">a</span> =&gt;</span> a.<span class="property">_id</span> === addonId);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (addon) &#123;</span></span><br><span class="line"><span class="language-javascript">      total += addon.<span class="property">price</span> * quantity.<span class="property">value</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// Add price for selected additional meat dishes</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">for</span> (<span class="keyword">const</span> meatId <span class="keyword">of</span> selectedMeatDishes.<span class="property">value</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> meat = props.<span class="property">menuItems</span>.<span class="title function_">find</span>(<span class="function"><span class="params">m</span> =&gt;</span> m.<span class="property">_id</span> === meatId);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (meat &amp;&amp; meat.<span class="property">extraPrice</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      total += meat.<span class="property">extraPrice</span> * quantity.<span class="property">value</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">return</span> total.<span class="title function_">toFixed</span>(<span class="number">2</span>);</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">addToCart</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// Get selected addon details</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> addons = selectedAddons.<span class="property">value</span>.<span class="title function_">map</span>(<span class="function"><span class="params">id</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> addon = props.<span class="property">addonItems</span>.<span class="title function_">find</span>(<span class="function"><span class="params">a</span> =&gt;</span> a.<span class="property">_id</span> === id);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">id</span>: addon.<span class="property">_id</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">name</span>: addon.<span class="property">name</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">price</span>: addon.<span class="property">price</span></span></span><br><span class="line"><span class="language-javascript">    &#125;;</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// Get selected additional meat dishes</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> additionalMeats = selectedMeatDishes.<span class="property">value</span>.<span class="title function_">map</span>(<span class="function"><span class="params">id</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> meat = props.<span class="property">menuItems</span>.<span class="title function_">find</span>(<span class="function"><span class="params">m</span> =&gt;</span> m.<span class="property">_id</span> === id);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">id</span>: meat.<span class="property">_id</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">name</span>: meat.<span class="property">name</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">price</span>: meat.<span class="property">extraPrice</span></span></span><br><span class="line"><span class="language-javascript">    &#125;;</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> cartItem = &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">id</span>: props.<span class="property">item</span>.<span class="property">_id</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">itemModel</span>: props.<span class="property">item</span>.<span class="property">itemModel</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">name</span>: props.<span class="property">item</span>.<span class="property">name</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">price</span>: <span class="title function_">calculateItemTotal</span>() / quantity.<span class="property">value</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">quantity</span>: quantity.<span class="property">value</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">doneness</span>: selectedDoneness.<span class="property">value</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">sauce</span>: selectedSauce.<span class="property">value</span>,</span></span><br><span class="line"><span class="language-javascript">    addons,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">extraOptions</span>: selectedExtraOptions.<span class="property">value</span>,</span></span><br><span class="line"><span class="language-javascript">    additionalMeats,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">remarks</span>: remarks.<span class="property">value</span></span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">emit</span>(<span class="string">&#x27;add-to-cart&#x27;</span>, cartItem);</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">emit</span>(<span class="string">&#x27;close&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.item-detail</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">flex-direction</span>: column;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">background-color</span>: white;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.header</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">background-color</span>: white;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">position</span>: sticky;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">top</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">z-index</span>: <span class="number">10</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.options</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">overflow-y</span>: auto;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="ShoppingCart"><a href="#ShoppingCart" class="headerlink" title="ShoppingCart"></a>ShoppingCart</h3><ul>
<li>最上層有個返回按鈕 還有中間顯示購物車</li>
<li>分隔線</li>
<li>訂單內容 顯示所有訂購餐點 每個餐點的細節也都顯示，熟度(如果是牛排)，醬料，加點(如果有)，加點肉品(如果有)，額外需求(如果有)，備註</li>
<li>顯示餐點價格跟刪除還有修改按鈕</li>
<li>訂單備註</li>
<li>會員折價券</li>
<li>取餐時間</li>
<li>付款方式</li>
<li>總計金額</li>
<li>送出訂單(按鈕 顯示總價)，會有確認modal跳出</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;cart-page&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Header --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;cart-header p-3 d-flex align-items-center bg-white shadow-sm&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-link text-dark p-0&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;goBack&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;bi bi-arrow-left fs-4&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h5</span> <span class="attr">class</span>=<span class="string">&quot;mb-0 mx-auto&quot;</span>&gt;</span>購物車<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;divider&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Empty Cart Message --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">&quot;cart.length === 0&quot;</span> <span class="attr">class</span>=<span class="string">&quot;text-center p-5 text-muted&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;bi bi-cart-x fs-1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;mt-3&quot;</span>&gt;</span>購物車是空的<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary mt-3&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;goBack&quot;</span>&gt;</span>返回菜單<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Cart Content --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-else</span> <span class="attr">class</span>=<span class="string">&quot;cart-content p-3&quot;</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- Order Items --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;order-items mb-4&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h6</span> <span class="attr">class</span>=<span class="string">&quot;mb-3 fw-bold&quot;</span>&gt;</span>訂單內容<span class="tag">&lt;/<span class="name">h6</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-for</span>=<span class="string">&quot;(item, index) in cart&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;index&quot;</span> <span class="attr">class</span>=<span class="string">&quot;cart-item card mb-3 border-0 shadow-sm&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card-body&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;d-flex justify-content-between align-items-start mb-2&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">h6</span> <span class="attr">class</span>=<span class="string">&quot;card-title mb-0 fw-bold&quot;</span>&gt;</span>&#123;&#123; item.name &#125;&#125;<span class="tag">&lt;/<span class="name">h6</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item-price fw-bold&quot;</span>&gt;</span>$&#123;&#123; (item.price * item.quantity) &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item-details mb-3&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;card-text small mb-1&quot;</span> <span class="attr">v-if</span>=<span class="string">&quot;item.doneness&quot;</span>&gt;</span>熟度: &#123;&#123; item.doneness &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;card-text small mb-1&quot;</span> <span class="attr">v-if</span>=<span class="string">&quot;item.sauce&quot;</span>&gt;</span>醬料: &#123;&#123; item.sauce &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;card-text small mb-1&quot;</span> <span class="attr">v-if</span>=<span class="string">&quot;item.addons &amp;&amp; item.addons.length&quot;</span>&gt;</span></span><br><span class="line">                加點: &#123;&#123; formatAddons(item.addons) &#125;&#125;</span><br><span class="line">              <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;card-text small mb-1&quot;</span> <span class="attr">v-if</span>=<span class="string">&quot;item.additionalMeats &amp;&amp; item.additionalMeats.length&quot;</span>&gt;</span></span><br><span class="line">                加點肉品: &#123;&#123; formatAdditionalMeats(item.additionalMeats) &#125;&#125;</span><br><span class="line">              <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;card-text small mb-1&quot;</span> <span class="attr">v-if</span>=<span class="string">&quot;item.extraOptions &amp;&amp; item.extraOptions.length&quot;</span>&gt;</span></span><br><span class="line">                額外需求: &#123;&#123; item.extraOptions.join(&#x27;, &#x27;) &#125;&#125;</span><br><span class="line">              <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;card-text small mb-1&quot;</span> <span class="attr">v-if</span>=<span class="string">&quot;item.remarks&quot;</span>&gt;</span></span><br><span class="line">                備註: &#123;&#123; item.remarks &#125;&#125;</span><br><span class="line">              <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;d-flex justify-content-between align-items-center&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;d-flex&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-sm btn-outline-danger me-2&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;removeFromCart(index)&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;bi bi-trash&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-sm btn-outline-secondary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;editItem(index)&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;bi bi-pencil&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;quantity-control d-flex align-items-center&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-sm btn-outline-secondary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;updateCartItemQuantity(index, -1)&quot;</span>&gt;</span>-<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;mx-2&quot;</span>&gt;</span>&#123;&#123; item.quantity &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-sm btn-outline-secondary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;updateCartItemQuantity(index, 1)&quot;</span>&gt;</span>+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;divider&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">&lt;!-- Order Notes --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;order-notes mb-4&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h6</span> <span class="attr">class</span>=<span class="string">&quot;mb-3 fw-bold&quot;</span>&gt;</span>訂單備註<span class="tag">&lt;/<span class="name">h6</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">rows</span>=<span class="string">&quot;2&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;有特殊需求嗎？請告訴我們&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;orderRemarks&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;divider&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">&lt;!-- Member Coupon --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;member-coupon mb-4&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h6</span> <span class="attr">class</span>=<span class="string">&quot;mb-3 fw-bold&quot;</span>&gt;</span>會員折價券<span class="tag">&lt;/<span class="name">h6</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;d-flex align-items-center&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">select</span> <span class="attr">class</span>=<span class="string">&quot;form-select&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;selectedCoupon&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span>&gt;</span>不使用優惠券<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">option</span> <span class="attr">v-for</span>=<span class="string">&quot;coupon in availableCoupons&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;coupon.id&quot;</span> <span class="attr">:value</span>=<span class="string">&quot;coupon.id&quot;</span>&gt;</span></span><br><span class="line">              &#123;&#123; coupon.name &#125;&#125; - 折抵 $&#123;&#123; coupon.value &#125;&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;divider&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">&lt;!-- Pickup Method --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;pickup-method mb-4&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h6</span> <span class="attr">class</span>=<span class="string">&quot;mb-3 fw-bold&quot;</span>&gt;</span>取餐方式<span class="tag">&lt;/<span class="name">h6</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;d-flex flex-wrap&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-check me-4 mb-3&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;form-check-input&quot;</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;pickupMethod&quot;</span> <span class="attr">id</span>=<span class="string">&quot;dineIn&quot;</span> <span class="attr">value</span>=<span class="string">&quot;dineIn&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;pickupMethod&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;form-check-label&quot;</span> <span class="attr">for</span>=<span class="string">&quot;dineIn&quot;</span>&gt;</span>內用<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-check me-4 mb-3&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;form-check-input&quot;</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;pickupMethod&quot;</span> <span class="attr">id</span>=<span class="string">&quot;selfPickup&quot;</span> <span class="attr">value</span>=<span class="string">&quot;selfPickup&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;pickupMethod&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;form-check-label&quot;</span> <span class="attr">for</span>=<span class="string">&quot;selfPickup&quot;</span>&gt;</span>自取<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-check mb-3&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;form-check-input&quot;</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;pickupMethod&quot;</span> <span class="attr">id</span>=<span class="string">&quot;delivery&quot;</span> <span class="attr">value</span>=<span class="string">&quot;delivery&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;pickupMethod&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;form-check-label&quot;</span> <span class="attr">for</span>=<span class="string">&quot;delivery&quot;</span>&gt;</span>外送<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- Conditional fields based on pickup method --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">&quot;pickupMethod === &#x27;dineIn&#x27;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;mt-3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;tableNumber&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-label&quot;</span>&gt;</span>桌號<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">id</span>=<span class="string">&quot;tableNumber&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;tableNumber&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;請輸入桌號&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">&quot;pickupMethod === &#x27;delivery&#x27;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;mt-3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;deliveryAddress&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-label&quot;</span>&gt;</span>外送地址<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">id</span>=<span class="string">&quot;deliveryAddress&quot;</span> <span class="attr">rows</span>=<span class="string">&quot;2&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;deliveryAddress&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;請輸入詳細外送地址&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;divider&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">&lt;!-- Pickup Time --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;pickup-time mt-2&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h6</span> <span class="attr">class</span>=<span class="string">&quot;mb-3 fw-bold&quot;</span>&gt;</span>取餐時間<span class="tag">&lt;/<span class="name">h6</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;d-flex&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-check me-4&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;form-check-input&quot;</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;pickupTime&quot;</span> <span class="attr">id</span>=<span class="string">&quot;asap&quot;</span> <span class="attr">value</span>=<span class="string">&quot;asap&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;pickupTime&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;form-check-label&quot;</span> <span class="attr">for</span>=<span class="string">&quot;asap&quot;</span>&gt;</span>盡快取餐<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-check&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;form-check-input&quot;</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;pickupTime&quot;</span> <span class="attr">id</span>=<span class="string">&quot;scheduled&quot;</span> <span class="attr">value</span>=<span class="string">&quot;scheduled&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">v-model</span>=<span class="string">&quot;pickupTime&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;form-check-label&quot;</span> <span class="attr">for</span>=<span class="string">&quot;scheduled&quot;</span>&gt;</span>預約時間<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">&quot;pickupTime === &#x27;scheduled&#x27;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;mt-3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;datetime-local&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;scheduledTime&quot;</span> <span class="attr">:min</span>=<span class="string">&quot;minPickupTime&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;divider&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">&lt;!-- Payment Method --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;payment-method mt-2 mb-2&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h6</span> <span class="attr">class</span>=<span class="string">&quot;mb-3 fw-bold&quot;</span>&gt;</span>付款方式<span class="tag">&lt;/<span class="name">h6</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;d-flex flex-wrap&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-check me-4 mb-2&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;form-check-input&quot;</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;paymentMethod&quot;</span> <span class="attr">id</span>=<span class="string">&quot;cash&quot;</span> <span class="attr">value</span>=<span class="string">&quot;cash&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">v-model</span>=<span class="string">&quot;paymentMethod&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;form-check-label&quot;</span> <span class="attr">for</span>=<span class="string">&quot;cash&quot;</span>&gt;</span>現金支付<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-check me-4 mb-2&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;form-check-input&quot;</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;paymentMethod&quot;</span> <span class="attr">id</span>=<span class="string">&quot;creditCard&quot;</span> <span class="attr">value</span>=<span class="string">&quot;creditCard&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">v-model</span>=<span class="string">&quot;paymentMethod&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;form-check-label&quot;</span> <span class="attr">for</span>=<span class="string">&quot;creditCard&quot;</span>&gt;</span>信用卡<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-check mb-2&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;form-check-input&quot;</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;paymentMethod&quot;</span> <span class="attr">id</span>=<span class="string">&quot;linePay&quot;</span> <span class="attr">value</span>=<span class="string">&quot;linePay&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">v-model</span>=<span class="string">&quot;paymentMethod&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;form-check-label&quot;</span> <span class="attr">for</span>=<span class="string">&quot;linePay&quot;</span>&gt;</span>LINE Pay<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;divider&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">&lt;!-- Order Total --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;order-total mb-4&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;d-flex justify-content-between mb-2&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span>&gt;</span>小計<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span>&gt;</span>$&#123;&#123; calculateSubtotal() &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;d-flex justify-content-between mb-2&quot;</span> <span class="attr">v-if</span>=<span class="string">&quot;couponDiscount &gt; 0&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span>&gt;</span>優惠折扣<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span>&gt;</span>-$&#123;&#123; couponDiscount &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;d-flex justify-content-between mb-2&quot;</span> <span class="attr">v-if</span>=<span class="string">&quot;deliveryFee &gt; 0&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span>&gt;</span>外送費<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span>&gt;</span>$&#123;&#123; deliveryFee &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;d-flex justify-content-between fw-bold&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span>&gt;</span>總計<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span>&gt;</span>$&#123;&#123; calculateTotal() &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Fixed Bottom Button --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">&quot;cart.length &gt; 0&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">class</span>=<span class="string">&quot;checkout-button position-fixed bottom-0 start-25 w-100 bg-white p-3 shadow-lg d-flex justify-content-center&quot;</span> <span class="attr">style</span>=<span class="string">&quot;max-width: 768px;&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container-button&quot;</span> <span class="attr">style</span>=<span class="string">&quot;max-width: 768px;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn w-100 py-2 checkout-btn&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;showConfirmation&quot;</span> <span class="attr">:disabled</span>=<span class="string">&quot;isSubmitDisabled&quot;</span>&gt;</span></span><br><span class="line">          前往結帳 - $&#123;&#123; calculateTotal() &#125;&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Confirmation Modal --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;modal fade&quot;</span> <span class="attr">id</span>=<span class="string">&quot;confirmOrderModal&quot;</span> <span class="attr">tabindex</span>=<span class="string">&quot;-1&quot;</span> <span class="attr">aria-labelledby</span>=<span class="string">&quot;confirmOrderModalLabel&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;modal-dialog modal-dialog-centered&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;modal-content&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;modal-header&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h5</span> <span class="attr">class</span>=<span class="string">&quot;modal-title&quot;</span> <span class="attr">id</span>=<span class="string">&quot;confirmOrderModalLabel&quot;</span>&gt;</span>確認訂單<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn-close&quot;</span> <span class="attr">data-bs-dismiss</span>=<span class="string">&quot;modal&quot;</span> <span class="attr">aria-label</span>=<span class="string">&quot;Close&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;modal-body&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>請確認您的訂單資訊：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;mb-3&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">strong</span>&gt;</span>取餐方式：<span class="tag">&lt;/<span class="name">strong</span>&gt;</span> &#123;&#123; formatPickupMethod() &#125;&#125;</span><br><span class="line">              <span class="tag">&lt;<span class="name">span</span> <span class="attr">v-if</span>=<span class="string">&quot;pickupMethod === &#x27;dineIn&#x27;&quot;</span>&gt;</span>（桌號：&#123;&#123; tableNumber &#125;&#125;）<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">&quot;pickupMethod === &#x27;delivery&#x27;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;mt-2&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">strong</span>&gt;</span>外送地址：<span class="tag">&lt;/<span class="name">strong</span>&gt;</span> &#123;&#123; deliveryAddress &#125;&#125;</span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;mb-3&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">strong</span>&gt;</span>取餐時間：<span class="tag">&lt;/<span class="name">strong</span>&gt;</span></span><br><span class="line">              &#123;&#123; pickupTime === &#x27;asap&#x27; ? &#x27;盡快取餐&#x27; : &#x27;預約時間：&#x27; + formatScheduledTime() &#125;&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;mb-3&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">strong</span>&gt;</span>付款方式：<span class="tag">&lt;/<span class="name">strong</span>&gt;</span> &#123;&#123; formatPaymentMethod() &#125;&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;mb-3&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">strong</span>&gt;</span>總金額：<span class="tag">&lt;/<span class="name">strong</span>&gt;</span> $&#123;&#123; calculateTotal() &#125;&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;modal-footer&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-secondary&quot;</span> <span class="attr">data-bs-dismiss</span>=<span class="string">&quot;modal&quot;</span>&gt;</span>返回修改<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;submitOrder&quot;</span>&gt;</span>確認送出<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123; ref, computed, onMounted, watch &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123; useRouter, useRoute &#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> props = <span class="title function_">defineProps</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">cart</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">type</span>: <span class="title class_">Array</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">required</span>: <span class="literal">true</span></span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">storeId</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">type</span>: <span class="title class_">String</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">required</span>: <span class="literal">true</span></span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">removeFromCart</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">type</span>: <span class="title class_">Function</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">required</span>: <span class="literal">true</span></span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">updateCartItemQuantity</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">type</span>: <span class="title class_">Function</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">required</span>: <span class="literal">true</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> emit = <span class="title function_">defineEmits</span>([<span class="string">&#x27;goBack&#x27;</span>, <span class="string">&#x27;editItem&#x27;</span>, <span class="string">&#x27;orderSubmitted&#x27;</span>]);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> route = <span class="title function_">useRoute</span>();</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> router = <span class="title function_">useRouter</span>();</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="variable constant_">API_BASE_URL</span> = <span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">env</span>.<span class="property">VITE_API_BASE_URL</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// Query parameters</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> queryPickupMethod = route.<span class="property">query</span>.<span class="property">pickupMethod</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> queryTable = route.<span class="property">query</span>.<span class="property">table</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// State</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> orderRemarks = <span class="title function_">ref</span>(<span class="string">&#x27;&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> selectedCoupon = <span class="title function_">ref</span>(<span class="string">&#x27;&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> pickupTime = <span class="title function_">ref</span>(<span class="string">&#x27;asap&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> scheduledTime = <span class="title function_">ref</span>(<span class="string">&#x27;&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> paymentMethod = <span class="title function_">ref</span>(<span class="string">&#x27;cash&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> confirmModal = <span class="title function_">ref</span>(<span class="literal">null</span>);</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> couponDiscount = <span class="title function_">ref</span>(<span class="number">0</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// Pickup method state</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> pickupMethod = <span class="title function_">ref</span>(queryPickupMethod || <span class="string">&#x27;selfPickup&#x27;</span>); <span class="comment">// Default to self-pickup</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> tableNumber = <span class="title function_">ref</span>(queryTable || <span class="string">&#x27;&#x27;</span>); <span class="comment">// For dine-in</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> deliveryAddress = <span class="title function_">ref</span>(<span class="string">&#x27;&#x27;</span>); <span class="comment">// For delivery</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> deliveryFee = <span class="title function_">ref</span>(<span class="number">0</span>); <span class="comment">// Delivery fee</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// Sample available coupons (would be fetched from API in real implementation)</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> availableCoupons = <span class="title function_">ref</span>([</span></span><br><span class="line"><span class="language-javascript">  &#123; <span class="attr">id</span>: <span class="string">&#x27;coupon1&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;新會員折扣&#x27;</span>, <span class="attr">value</span>: <span class="number">50</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">  &#123; <span class="attr">id</span>: <span class="string">&#x27;coupon2&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;生日特惠&#x27;</span>, <span class="attr">value</span>: <span class="number">100</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">  &#123; <span class="attr">id</span>: <span class="string">&#x27;coupon3&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;滿千折百&#x27;</span>, <span class="attr">value</span>: <span class="number">100</span> &#125;</span></span><br><span class="line"><span class="language-javascript">]);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// Minimum pickup time (current time + 15 minutes)</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> minPickupTime = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> date = <span class="keyword">new</span> <span class="title class_">Date</span>();</span></span><br><span class="line"><span class="language-javascript">  date.<span class="title function_">setMinutes</span>(date.<span class="title function_">getMinutes</span>() + <span class="number">15</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">return</span> date.<span class="title function_">toISOString</span>().<span class="title function_">slice</span>(<span class="number">0</span>, <span class="number">16</span>);</span></span><br><span class="line"><span class="language-javascript">&#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// Check if submit button should be disabled</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> isSubmitDisabled = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (pickupMethod.<span class="property">value</span> === <span class="string">&#x27;dineIn&#x27;</span> &amp;&amp; !tableNumber.<span class="property">value</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (pickupMethod.<span class="property">value</span> === <span class="string">&#x27;delivery&#x27;</span> &amp;&amp; !deliveryAddress.<span class="property">value</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (pickupTime.<span class="property">value</span> === <span class="string">&#x27;scheduled&#x27;</span> &amp;&amp; !scheduledTime.<span class="property">value</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">return</span> <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">&#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">calculateSubtotal</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">return</span> props.<span class="property">cart</span>.<span class="title function_">reduce</span>(<span class="function">(<span class="params">total, item</span>) =&gt;</span> total + (item.<span class="property">price</span> * item.<span class="property">quantity</span>), <span class="number">0</span>);</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">calculateTotal</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> subtotal = <span class="built_in">parseFloat</span>(<span class="title function_">calculateSubtotal</span>());</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">return</span> (subtotal - couponDiscount.<span class="property">value</span> + deliveryFee.<span class="property">value</span>);</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">formatAddons</span> = (<span class="params">addons</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">return</span> addons.<span class="title function_">map</span>(<span class="function"><span class="params">addon</span> =&gt;</span> addon.<span class="property">name</span>).<span class="title function_">join</span>(<span class="string">&#x27;, &#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">formatAdditionalMeats</span> = (<span class="params">additionalMeats</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">return</span> additionalMeats.<span class="title function_">map</span>(<span class="function"><span class="params">meat</span> =&gt;</span> meat.<span class="property">name</span>).<span class="title function_">join</span>(<span class="string">&#x27;, &#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">formatPaymentMethod</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> methods = &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&#x27;cash&#x27;</span>: <span class="string">&#x27;現金支付&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&#x27;creditCard&#x27;</span>: <span class="string">&#x27;信用卡&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&#x27;linePay&#x27;</span>: <span class="string">&#x27;LINE Pay&#x27;</span></span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">return</span> methods[paymentMethod.<span class="property">value</span>] || paymentMethod.<span class="property">value</span>;</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">formatPickupMethod</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> methods = &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&#x27;dineIn&#x27;</span>: <span class="string">&#x27;內用&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&#x27;selfPickup&#x27;</span>: <span class="string">&#x27;自取&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&#x27;delivery&#x27;</span>: <span class="string">&#x27;外送&#x27;</span></span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">return</span> methods[pickupMethod.<span class="property">value</span>] || pickupMethod.<span class="property">value</span>;</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">formatScheduledTime</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (!scheduledTime.<span class="property">value</span>) <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> date = <span class="keyword">new</span> <span class="title class_">Date</span>(scheduledTime.<span class="property">value</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;date.toLocaleDateString()&#125;</span> <span class="subst">$&#123;date.toLocaleTimeString([], &#123; hour: <span class="string">&#x27;2-digit&#x27;</span>, minute: <span class="string">&#x27;2-digit&#x27;</span> &#125;)&#125;</span>`</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">catch</span> (e) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> scheduledTime.<span class="property">value</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">goBack</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">emit</span>(<span class="string">&#x27;goBack&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">editItem</span> = (<span class="params">index</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">emit</span>(<span class="string">&#x27;editItem&#x27;</span>, index);</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">showConfirmation</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  confirmModal.<span class="property">value</span>.<span class="title function_">show</span>();</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">generateOrderNumber</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> number = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">`<span class="subst">$&#123;API_BASE_URL&#125;</span>/order/number`</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">return</span> number.<span class="property">data</span>.<span class="property">number</span>;</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">submitOrder</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> orderItems = props.<span class="property">cart</span>.<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> (&#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">itemModel</span>: item.<span class="property">itemModel</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">itemId</span>: item.<span class="property">id</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">amount</span>: item.<span class="property">quantity</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">options</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">doneness</span>: item.<span class="property">doneness</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">sauce</span>: item.<span class="property">sauce</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">addons</span>: item.<span class="property">addons</span>.<span class="title function_">map</span>(<span class="function"><span class="params">a</span> =&gt;</span> a.<span class="property">id</span>),</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">extraOptions</span>: item.<span class="property">extraOptions</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">additionalMeats</span>: item.<span class="property">additionalMeats</span>?.<span class="title function_">map</span>(<span class="function"><span class="params">m</span> =&gt;</span> m.<span class="property">id</span>) || [],</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">remarks</span>: item.<span class="property">remarks</span></span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;));</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> orderAmount = <span class="built_in">parseFloat</span>(<span class="title function_">calculateTotal</span>());</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> pickupTimeValue = pickupTime.<span class="property">value</span> === <span class="string">&#x27;asap&#x27;</span> ? <span class="literal">null</span> : scheduledTime.<span class="property">value</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> orderData = &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">store</span>: props.<span class="property">storeId</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">orderNumber</span>: <span class="title class_">String</span>(<span class="keyword">await</span> <span class="title function_">generateOrderNumber</span>()),</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">platform</span>: <span class="string">&#x27;web&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">pickupMethod</span>: <span class="title function_">formatPickupMethod</span>(),</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">paymentMethod</span>: paymentMethod.<span class="property">value</span>,</span></span><br><span class="line"><span class="language-javascript">      orderAmount,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">totalMoney</span>: orderAmount,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">tableNumber</span>: pickupMethod.<span class="property">value</span> === <span class="string">&#x27;dineIn&#x27;</span> ? tableNumber.<span class="property">value</span> : <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">deliveryAddress</span>: pickupMethod.<span class="property">value</span> === <span class="string">&#x27;delivery&#x27;</span> ? deliveryAddress.<span class="property">value</span> : <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">items</span>: orderItems,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">remarks</span>: orderRemarks.<span class="property">value</span> || <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">scheduledPickupTime</span>: pickupTimeValue,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">couponId</span>: selectedCoupon.<span class="property">value</span> || <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">deliveryFee</span>: pickupMethod.<span class="property">value</span> === <span class="string">&#x27;delivery&#x27;</span> ? deliveryFee.<span class="property">value</span> : <span class="number">0</span></span></span><br><span class="line"><span class="language-javascript">    &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Submitting order:&#x27;</span>, orderData);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> &#123; <span class="attr">data</span>: newOrder &#125; = <span class="keyword">await</span> axios.<span class="title function_">post</span>(<span class="string">`<span class="subst">$&#123;API_BASE_URL&#125;</span>/order`</span>, orderData);</span></span><br><span class="line"><span class="language-javascript">    confirmModal.<span class="property">value</span>.<span class="title function_">hide</span>();</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// Emit event that order was submitted</span></span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">emit</span>(<span class="string">&#x27;orderSubmitted&#x27;</span>, newOrder);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// Redirect to confirmation page</span></span></span><br><span class="line"><span class="language-javascript">    router.<span class="title function_">push</span>(<span class="string">`/confirmation/<span class="subst">$&#123;newOrder.id&#125;</span>`</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">catch</span> (error) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error creating order:&#x27;</span>, error);</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(<span class="string">&#x27;訂單建立失敗，請重試&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// Watch for coupon selection</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">updateCouponDiscount</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (selectedCoupon.<span class="property">value</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> coupon = availableCoupons.<span class="property">value</span>.<span class="title function_">find</span>(<span class="function"><span class="params">c</span> =&gt;</span> c.<span class="property">id</span> === selectedCoupon.<span class="property">value</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (coupon) &#123;</span></span><br><span class="line"><span class="language-javascript">      couponDiscount.<span class="property">value</span> = coupon.<span class="property">value</span>;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  couponDiscount.<span class="property">value</span> = <span class="number">0</span>;</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// Set delivery fee when pickup method changes</span></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">watch</span>(pickupMethod, <span class="function">(<span class="params">newValue</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (newValue === <span class="string">&#x27;delivery&#x27;</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    deliveryFee.<span class="property">value</span> = <span class="number">60</span>; <span class="comment">// Set a default delivery fee</span></span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    deliveryFee.<span class="property">value</span> = <span class="number">0</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// Initialize Bootstrap modal</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">initModal</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// Import Bootstrap&#x27;s modal JavaScript</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span>(<span class="string">&#x27;bootstrap/js/dist/modal&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">module</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> <span class="title class_">Modal</span> = <span class="variable language_">module</span>.<span class="property">default</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// Initialize confirmation modal</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> confirmOrderModalElement = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;confirmOrderModal&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (confirmOrderModalElement) &#123;</span></span><br><span class="line"><span class="language-javascript">      confirmModal.<span class="property">value</span> = <span class="keyword">new</span> <span class="title class_">Modal</span>(confirmOrderModalElement);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">initModal</span>();</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (!scheduledTime.<span class="property">value</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    scheduledTime.<span class="property">value</span> = minPickupTime.<span class="property">value</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  </span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// Watch for coupon changes</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">watch</span>(selectedCoupon, updateCouponDiscount);</span></span><br><span class="line"><span class="language-javascript">&#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.cart-page</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">min-height</span>: <span class="number">100vh</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">background-color</span>: <span class="number">#f8f9fa</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">padding-bottom</span>: <span class="number">80px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="comment">/* Space for the fixed bottom button */</span></span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.cart-header</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">position</span>: sticky;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">top</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">z-index</span>: <span class="number">1000</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.divider</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">height</span>: <span class="number">8px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">background-color</span>: <span class="number">#f0f0f0</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">margin</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">width</span>: <span class="number">100%</span></span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.cart-item</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">overflow</span>: hidden;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.quantity-control</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">min-width</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.quantity-control</span> <span class="selector-tag">button</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">width</span>: <span class="number">30px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">height</span>: <span class="number">30px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">justify-content</span>: center;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">padding</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.checkout-btn</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">border-radius</span>: <span class="number">8px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">background-color</span>: <span class="number">#7a5b0c</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">color</span>: white;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">transition</span>: background-color <span class="number">0.3s</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.checkout-btn</span><span class="selector-pseudo">:hover</span><span class="selector-pseudo">:not</span>(<span class="selector-pseudo">:disabled</span>) &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">background-color</span>: <span class="number">#4a7dde</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.checkout-btn</span><span class="selector-pseudo">:disabled</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">background-color</span>: <span class="number">#b9cdf2</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">color</span>: <span class="number">#ffffff</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.container-button</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">15px</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="comment">/* Fix for iOS input styling */</span></span></span><br><span class="line"><span class="language-css"><span class="selector-tag">input</span><span class="selector-attr">[type=<span class="string">&quot;datetime-local&quot;</span>]</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">appearance</span>: none;</span></span><br><span class="line"><span class="language-css">  -webkit-<span class="attribute">appearance</span>: none;</span></span><br><span class="line"><span class="language-css">  -moz-<span class="attribute">appearance</span>: none;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>




<h2 id="訂單Object"><a href="#訂單Object" class="headerlink" title="訂單Object"></a>訂單Object</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br></pre></td><td class="code"><pre><span class="line">//第一單</span><br><span class="line">&#123;</span><br><span class="line">  &quot;_id&quot;: &quot;67c1459c5c73c8569433776f&quot;,</span><br><span class="line">  &quot;store&quot;: &quot;67bc667213a41635fe5129fb&quot;,</span><br><span class="line">  &quot;orderNumber&quot;: &quot;2&quot;,</span><br><span class="line">  &quot;scheduledPickupTime&quot;: null,</span><br><span class="line">  &quot;platform&quot;: &quot;web&quot;,</span><br><span class="line">  &quot;pickupMethod&quot;: &quot;內用&quot;,</span><br><span class="line">  &quot;paymentMethod&quot;: &quot;cash&quot;,</span><br><span class="line">  &quot;orderAmount&quot;: 1295,</span><br><span class="line">  &quot;discounts&quot;: 0,</span><br><span class="line">  &quot;pointsDiscount&quot;: 0,</span><br><span class="line">  &quot;deliveryFee&quot;: 0,</span><br><span class="line">  &quot;totalMoney&quot;: 1295,</span><br><span class="line">  &quot;isCancelled&quot;: false,</span><br><span class="line">  &quot;orderStatus&quot;: &quot;Unpaid&quot;,</span><br><span class="line">  &quot;tableNumber&quot;: &quot;1&quot;,</span><br><span class="line">  &quot;remarks&quot;: &quot;訂單備註&quot;,</span><br><span class="line">  &quot;deliveryAddress&quot;: null,</span><br><span class="line">  &quot;logisticsCancelled&quot;: false,</span><br><span class="line">  &quot;couponId&quot;: null,</span><br><span class="line">  &quot;items&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;options&quot;: &#123;</span><br><span class="line">        &quot;doneness&quot;: &quot;7分熟&quot;,</span><br><span class="line">        &quot;sauce&quot;: &quot;綜合醬&quot;,</span><br><span class="line">        &quot;addons&quot;: [</span><br><span class="line">          &quot;67bc62c813a41635fe512851&quot;,</span><br><span class="line">          &quot;67bc62d213a41635fe512855&quot;,</span><br><span class="line">          &quot;67bc630b13a41635fe512858&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;extraOptions&quot;: [</span><br><span class="line">          &quot;加麵&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;additionalMeats&quot;: [</span><br><span class="line">          &quot;67bc601713a41635fe512829&quot;,</span><br><span class="line">          &quot;67bc612613a41635fe512831&quot;,</span><br><span class="line">          &quot;67bc615513a41635fe512834&quot;,</span><br><span class="line">          &quot;67bc619b13a41635fe512837&quot;,</span><br><span class="line">          &quot;67bc5fe313a41635fe512824&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;remarks&quot;: &quot;特殊要求&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;itemModel&quot;: &quot;MainDish&quot;,</span><br><span class="line">      &quot;itemId&quot;: &quot;67bc61c313a41635fe51283a&quot;,</span><br><span class="line">      &quot;amount&quot;: 1,</span><br><span class="line">      &quot;_id&quot;: &quot;67c1459c5c73c85694337770&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  &quot;createdAt&quot;: &quot;2025-02-28T13:11:56.003Z&quot;,</span><br><span class="line">  &quot;updatedAt&quot;: &quot;2025-02-28T13:11:56.003Z&quot;,</span><br><span class="line">  &quot;weekday&quot;: &quot;Friday&quot;,</span><br><span class="line">  &quot;__v&quot;: 0</span><br><span class="line">&#125;</span><br><span class="line">// 第二單</span><br><span class="line">&#123;</span><br><span class="line">  &quot;_id&quot;: &quot;67c1475c5c73c85694337795&quot;,</span><br><span class="line">  &quot;store&quot;: &quot;67bc667213a41635fe5129fb&quot;,</span><br><span class="line">  &quot;orderNumber&quot;: &quot;3&quot;,</span><br><span class="line">  &quot;scheduledPickupTime&quot;: null,</span><br><span class="line">  &quot;platform&quot;: &quot;web&quot;,</span><br><span class="line">  &quot;pickupMethod&quot;: &quot;自取&quot;,</span><br><span class="line">  &quot;paymentMethod&quot;: &quot;cash&quot;,</span><br><span class="line">  &quot;orderAmount&quot;: 1640,</span><br><span class="line">  &quot;discounts&quot;: 0,</span><br><span class="line">  &quot;pointsDiscount&quot;: 0,</span><br><span class="line">  &quot;deliveryFee&quot;: 0,</span><br><span class="line">  &quot;totalMoney&quot;: 1640,</span><br><span class="line">  &quot;isCancelled&quot;: false,</span><br><span class="line">  &quot;orderStatus&quot;: &quot;Unpaid&quot;,</span><br><span class="line">  &quot;tableNumber&quot;: null,</span><br><span class="line">  &quot;remarks&quot;: null,</span><br><span class="line">  &quot;deliveryAddress&quot;: null,</span><br><span class="line">  &quot;logisticsCancelled&quot;: false,</span><br><span class="line">  &quot;couponId&quot;: null,</span><br><span class="line">  &quot;items&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;options&quot;: &#123;</span><br><span class="line">        &quot;doneness&quot;: &quot;7分熟&quot;,</span><br><span class="line">        &quot;sauce&quot;: &quot;黑胡椒醬&quot;,</span><br><span class="line">        &quot;addons&quot;: [</span><br><span class="line">          &quot;67bc62c813a41635fe512851&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;extraOptions&quot;: [</span><br><span class="line">          &quot;加麵&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;additionalMeats&quot;: [</span><br><span class="line">          &quot;67bc619b13a41635fe512837&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;remarks&quot;: &quot;特殊要求&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;itemModel&quot;: &quot;MainDish&quot;,</span><br><span class="line">      &quot;itemId&quot;: &quot;67bc601713a41635fe512829&quot;,</span><br><span class="line">      &quot;amount&quot;: 1,</span><br><span class="line">      &quot;_id&quot;: &quot;67c1475c5c73c85694337796&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;options&quot;: &#123;</span><br><span class="line">        &quot;doneness&quot;: &quot;&quot;,</span><br><span class="line">        &quot;sauce&quot;: &quot;&quot;,</span><br><span class="line">        &quot;addons&quot;: [],</span><br><span class="line">        &quot;extraOptions&quot;: [],</span><br><span class="line">        &quot;additionalMeats&quot;: [],</span><br><span class="line">        &quot;remarks&quot;: &quot;&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;itemModel&quot;: &quot;ElseDish&quot;,</span><br><span class="line">      &quot;itemId&quot;: &quot;67bc627b13a41635fe512848&quot;,</span><br><span class="line">      &quot;amount&quot;: 1,</span><br><span class="line">      &quot;_id&quot;: &quot;67c1475c5c73c85694337797&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;options&quot;: &#123;</span><br><span class="line">        &quot;doneness&quot;: &quot;9分熟&quot;,</span><br><span class="line">        &quot;sauce&quot;: &quot;黑胡椒醬&quot;,</span><br><span class="line">        &quot;addons&quot;: [</span><br><span class="line">          &quot;67bc62d213a41635fe512855&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;extraOptions&quot;: [</span><br><span class="line">          &quot;麵換蛋&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;additionalMeats&quot;: [</span><br><span class="line">          &quot;67bc612613a41635fe512831&quot;,</span><br><span class="line">          &quot;67bc5fe313a41635fe512824&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;remarks&quot;: &quot;特殊要求&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;itemModel&quot;: &quot;MainDish&quot;,</span><br><span class="line">      &quot;itemId&quot;: &quot;67bc61c313a41635fe51283a&quot;,</span><br><span class="line">      &quot;amount&quot;: 1,</span><br><span class="line">      &quot;_id&quot;: &quot;67c1475c5c73c85694337798&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;options&quot;: &#123;</span><br><span class="line">        &quot;doneness&quot;: &quot;&quot;,</span><br><span class="line">        &quot;sauce&quot;: &quot;&quot;,</span><br><span class="line">        &quot;addons&quot;: [],</span><br><span class="line">        &quot;extraOptions&quot;: [],</span><br><span class="line">        &quot;additionalMeats&quot;: [],</span><br><span class="line">        &quot;remarks&quot;: &quot;特殊要求&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;itemModel&quot;: &quot;ElseDish&quot;,</span><br><span class="line">      &quot;itemId&quot;: &quot;67bc62a813a41635fe51284c&quot;,</span><br><span class="line">      &quot;amount&quot;: 3,</span><br><span class="line">      &quot;_id&quot;: &quot;67c1475c5c73c85694337799&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;options&quot;: &#123;</span><br><span class="line">        &quot;doneness&quot;: &quot;5分熟&quot;,</span><br><span class="line">        &quot;sauce&quot;: &quot;綜合醬&quot;,</span><br><span class="line">        &quot;addons&quot;: [],</span><br><span class="line">        &quot;extraOptions&quot;: [],</span><br><span class="line">        &quot;additionalMeats&quot;: [],</span><br><span class="line">        &quot;remarks&quot;: &quot;&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;itemModel&quot;: &quot;MainDish&quot;,</span><br><span class="line">      &quot;itemId&quot;: &quot;67bc612613a41635fe512831&quot;,</span><br><span class="line">      &quot;amount&quot;: 1,</span><br><span class="line">      &quot;_id&quot;: &quot;67c1475c5c73c8569433779a&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  &quot;createdAt&quot;: &quot;2025-02-28T13:19:24.708Z&quot;,</span><br><span class="line">  &quot;updatedAt&quot;: &quot;2025-02-28T13:19:24.708Z&quot;,</span><br><span class="line">  &quot;weekday&quot;: &quot;Friday&quot;,</span><br><span class="line">  &quot;__v&quot;: 0</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h2 id="完成訂單的介面"><a href="#完成訂單的介面" class="headerlink" title="完成訂單的介面"></a>完成訂單的介面</h2><p><code>:confirmation/:id</code></p>
<ul>
<li>顯示 內用或自取</li>
<li>內用顯示桌號</li>
<li>顯示流水編號</li>
<li>顯示餐點細節</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;main-container&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;center-container&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">transition</span> <span class="attr">name</span>=<span class="string">&quot;fade&quot;</span> <span class="attr">mode</span>=<span class="string">&quot;out-in&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">MenuListing</span> <span class="attr">v-if</span>=<span class="string">&quot;!selectedItem &amp;&amp; !showCart&quot;</span> <span class="attr">:store-name</span>=<span class="string">&quot;store.name&quot;</span> <span class="attr">:announcements</span>=<span class="string">&quot;store.announcements&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">:menu-list</span>=<span class="string">&quot;menu.list&quot;</span> <span class="attr">:menu-items</span>=<span class="string">&quot;menuItems&quot;</span> @<span class="attr">select-item</span>=<span class="string">&quot;openItemDetails&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">transition</span> <span class="attr">name</span>=<span class="string">&quot;fade&quot;</span> <span class="attr">mode</span>=<span class="string">&quot;out-in&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ItemDetail</span> <span class="attr">v-if</span>=<span class="string">&quot;selectedItem &amp;&amp; !showCart&quot;</span> <span class="attr">:item</span>=<span class="string">&quot;selectedItem&quot;</span> <span class="attr">:addon-items</span>=<span class="string">&quot;addonItems&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">:menu-items</span>=<span class="string">&quot;menuItems&quot;</span> @<span class="attr">close</span>=<span class="string">&quot;closeItemDetails&quot;</span> @<span class="attr">add-to-cart</span>=<span class="string">&quot;addToCart&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">transition</span> <span class="attr">name</span>=<span class="string">&quot;fade&quot;</span> <span class="attr">mode</span>=<span class="string">&quot;out-in&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ShoppingCart</span> <span class="attr">v-if</span>=<span class="string">&quot;showCart&quot;</span> <span class="attr">:cart</span>=<span class="string">&quot;cart&quot;</span> <span class="attr">:order-type</span>=<span class="string">&quot;orderType&quot;</span> <span class="attr">:store-id</span>=<span class="string">&quot;storeId&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">:remove-from-cart</span>=<span class="string">&quot;removeFromCart&quot;</span> <span class="attr">:update-cart-item-quantity</span>=<span class="string">&quot;updateCartItemQuantity&quot;</span></span></span><br><span class="line"><span class="tag">          @<span class="attr">go-back</span>=<span class="string">&quot;showCart = false&quot;</span> @<span class="attr">edit-item</span>=<span class="string">&quot;editCartItem&quot;</span> @<span class="attr">order-submitted</span>=<span class="string">&quot;handleOrderSubmitted&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">&lt;!-- Shopping Cart Button --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">&quot;cart.length &gt; 0 &amp;&amp; !selectedItem &amp;&amp; !showCart&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;position-fixed bottom-0 start-50 translate-middle-x mb-4&quot;</span> <span class="attr">style</span>=<span class="string">&quot;z-index: 1030;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary rounded-pill shadow px-4 py-2&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;showCart = true&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;bi bi-cart-fill me-2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">          &#123;&#123; getTotalItems() &#125;&#125; 項商品 - $&#123;&#123; calculateTotal() &#125;&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123; onMounted, ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123; useRoute, useRouter &#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> <span class="title class_">MenuListing</span> <span class="keyword">from</span> <span class="string">&#x27;@/components/OrderComponents/Main.vue&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> <span class="title class_">ItemDetail</span> <span class="keyword">from</span> <span class="string">&#x27;@/components/OrderComponents/ItemDetail.vue&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> <span class="title class_">ShoppingCart</span> <span class="keyword">from</span> <span class="string">&#x27;@/components/OrderComponents/ShoppingCart.vue&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> route = <span class="title function_">useRoute</span>();</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> router = <span class="title function_">useRouter</span>();</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="variable constant_">API_BASE_URL</span> = <span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">env</span>.<span class="property">VITE_API_BASE_URL</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> storeId = route.<span class="property">params</span>.<span class="property">store</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> queryOrderType = route.<span class="property">query</span>.<span class="property">orderType</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> queryTable = route.<span class="property">query</span>.<span class="property">table</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// State</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> store = <span class="title function_">ref</span>(&#123;&#125;);</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> menu = <span class="title function_">ref</span>(&#123;&#125;);</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> menuItems = <span class="title function_">ref</span>([]);</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> addonItems = <span class="title function_">ref</span>([]);</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> orderType = <span class="title function_">ref</span>(queryOrderType || <span class="string">&#x27;dineIn&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> tableNumber = <span class="title function_">ref</span>(queryTable || <span class="string">&#x27;0&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> selectedItem = <span class="title function_">ref</span>(<span class="literal">null</span>);</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> cart = <span class="title function_">ref</span>([]);</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> showCart = <span class="title function_">ref</span>(<span class="literal">false</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// Bootstrap modal instance</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">let</span> cartModal = <span class="literal">null</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">fetchStore</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> response = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">`<span class="subst">$&#123;API_BASE_URL&#125;</span>/store/<span class="subst">$&#123;storeId&#125;</span>`</span>);</span></span><br><span class="line"><span class="language-javascript">    store.<span class="property">value</span> = response.<span class="property">data</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// console.log(store.value);</span></span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">catch</span> (error) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error fetching store:&#x27;</span>, error);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">fetchMenu</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  menu.<span class="property">value</span> = store.<span class="property">value</span>.<span class="property">menuItem</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// console.log(&#x27;menu&#x27;, menu.value);</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> itemPromises = [];</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">for</span> (<span class="keyword">const</span> category <span class="keyword">of</span> menu.<span class="property">value</span>.<span class="property">list</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">for</span> (<span class="keyword">const</span> item <span class="keyword">of</span> category.<span class="property">items</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      itemPromises.<span class="title function_">push</span>(axios.<span class="title function_">get</span>(<span class="string">`<span class="subst">$&#123;API_BASE_URL&#125;</span>/dish/<span class="subst">$&#123;item.itemModel.charAt(<span class="number">0</span>).toLowerCase() + item.itemModel.slice(<span class="number">1</span>)&#125;</span>/<span class="subst">$&#123;item.itemId&#125;</span>`</span>));</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> dishModelMapping = &#123;&#125;;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (menu.<span class="property">value</span> &amp;&amp; menu.<span class="property">value</span>.<span class="property">list</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    menu.<span class="property">value</span>.<span class="property">list</span>.<span class="title function_">forEach</span>(<span class="function"><span class="params">category</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      category.<span class="property">items</span>.<span class="title function_">forEach</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        dishModelMapping[item.<span class="property">itemId</span>] = item.<span class="property">itemModel</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> itemResponses = <span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">all</span>(itemPromises);</span></span><br><span class="line"><span class="language-javascript">  menuItems.<span class="property">value</span> = itemResponses.<span class="title function_">map</span>(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      ...response.<span class="property">data</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">itemModel</span>: dishModelMapping[response.<span class="property">data</span>.<span class="property">_id</span>]</span></span><br><span class="line"><span class="language-javascript">    &#125;;</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// console.log(&#x27;menuItems&#x27;, menuItems.value);</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> &#123; <span class="attr">data</span>: addons &#125; = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">`<span class="subst">$&#123;API_BASE_URL&#125;</span>/dish/addon`</span>);</span></span><br><span class="line"><span class="language-javascript">  addonItems.<span class="property">value</span> = addons;</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">openItemDetails</span> = (<span class="params">item</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  selectedItem.<span class="property">value</span> = item;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// console.log(item);</span></span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">closeItemDetails</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  selectedItem.<span class="property">value</span> = <span class="literal">null</span>;</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">addToCart</span> = (<span class="params">item</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  cart.<span class="property">value</span>.<span class="title function_">push</span>(item);</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// console.log(cart.value);</span></span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">openCartModal</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  cartModal.<span class="title function_">show</span>();</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">updateCartItemQuantity</span> = (<span class="params">index, change</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> newQuantity = cart.<span class="property">value</span>[index].<span class="property">quantity</span> + change;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (newQuantity &gt; <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    cart.<span class="property">value</span>[index].<span class="property">quantity</span> = newQuantity;</span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">removeFromCart</span>(index);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">removeFromCart</span> = (<span class="params">index</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  cart.<span class="property">value</span>.<span class="title function_">splice</span>(index, <span class="number">1</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// If cart is empty, go back to menu</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (cart.<span class="property">value</span>.<span class="property">length</span> === <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    showCart.<span class="property">value</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">editCartItem</span> = (<span class="params">index</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> item = menuItems.<span class="property">value</span>.<span class="title function_">find</span>(<span class="function"><span class="params">menuItem</span> =&gt;</span> menuItem.<span class="property">_id</span> === cart.<span class="property">value</span>[index].<span class="property">id</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (item) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// Remove the item from cart first</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> itemToEdit = cart.<span class="property">value</span>[index];</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">removeFromCart</span>(index);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// Open the item detail with pre-filled selections</span></span></span><br><span class="line"><span class="language-javascript">    selectedItem.<span class="property">value</span> = &#123;</span></span><br><span class="line"><span class="language-javascript">      ...item,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">preFilled</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">quantity</span>: itemToEdit.<span class="property">quantity</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">doneness</span>: itemToEdit.<span class="property">doneness</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">sauce</span>: itemToEdit.<span class="property">sauce</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">addons</span>: itemToEdit.<span class="property">addons</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">additionalMeats</span>: itemToEdit.<span class="property">additionalMeats</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">extraOptions</span>: itemToEdit.<span class="property">extraOptions</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">remarks</span>: itemToEdit.<span class="property">remarks</span></span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    showCart.<span class="property">value</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">handleOrderSubmitted</span> = (<span class="params">order</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// Clear the cart after order is submitted</span></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// console.log(&#x27;Order submitted:&#x27;, order);</span></span></span><br><span class="line"><span class="language-javascript">  cart.<span class="property">value</span> = [];</span></span><br><span class="line"><span class="language-javascript">  showCart.<span class="property">value</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">getTotalItems</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">return</span> cart.<span class="property">value</span>.<span class="title function_">reduce</span>(<span class="function">(<span class="params">total, item</span>) =&gt;</span> total + item.<span class="property">quantity</span>, <span class="number">0</span>);</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">calculateTotal</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">return</span> cart.<span class="property">value</span>.<span class="title function_">reduce</span>(<span class="function">(<span class="params">total, item</span>) =&gt;</span> total + (item.<span class="property">price</span> * item.<span class="property">quantity</span>), <span class="number">0</span>);</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">formatAddons</span> = (<span class="params">addons</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">return</span> addons.<span class="title function_">map</span>(<span class="function"><span class="params">addon</span> =&gt;</span> addon.<span class="property">name</span>).<span class="title function_">join</span>(<span class="string">&#x27;, &#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">formatAddationMeats</span> = (<span class="params">additionalMeats</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">return</span> additionalMeats.<span class="title function_">map</span>(<span class="function"><span class="params">meat</span> =&gt;</span> meat.<span class="property">name</span>).<span class="title function_">join</span>(<span class="string">&#x27;, &#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">checkout</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (orderType.<span class="property">value</span> === <span class="string">&#x27;dineIn&#x27;</span> &amp;&amp; !tableNumber.<span class="property">value</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(<span class="string">&#x27;請輸入桌號&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> orderItems = cart.<span class="property">value</span>.<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> (&#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">itemModel</span>: item.<span class="property">itemModel</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">itemId</span>: item.<span class="property">id</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">amount</span>: item.<span class="property">quantity</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">options</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">doneness</span>: item.<span class="property">doneness</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">sauce</span>: item.<span class="property">sauce</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">addons</span>: item.<span class="property">addons</span>.<span class="title function_">map</span>(<span class="function"><span class="params">a</span> =&gt;</span> a.<span class="property">id</span>),</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">extraOptions</span>: item.<span class="property">extraOptions</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">additionalMeats</span>: item.<span class="property">additionalMeats</span>?.<span class="title function_">map</span>(<span class="function"><span class="params">m</span> =&gt;</span> m.<span class="property">id</span>) || [],</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">remarks</span>: item.<span class="property">remarks</span></span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;));</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> orderAmount = <span class="built_in">parseFloat</span>(<span class="title function_">calculateTotal</span>());</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> orderData = &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">store</span>: storeId,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">orderNumber</span>: <span class="title class_">String</span>(<span class="keyword">await</span> <span class="title function_">generateOrderNumber</span>()),</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">platform</span>: <span class="string">&#x27;web&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">pickupMethod</span>: orderType.<span class="property">value</span> === <span class="string">&#x27;dineIn&#x27;</span> ? <span class="string">&#x27;內用&#x27;</span> : <span class="string">&#x27;外帶&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">paymentMethod</span>: <span class="string">&#x27;store&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">      orderAmount,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">totalPaid</span>: orderAmount,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">tableNumber</span>: orderType.<span class="property">value</span> === <span class="string">&#x27;dineIn&#x27;</span> ? tableNumber.<span class="property">value</span> : <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">items</span>: orderItems,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">remarks</span>: cart.<span class="property">value</span>.<span class="title function_">some</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="property">remarks</span>) ? cart.<span class="property">value</span>.<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="property">remarks</span>).<span class="title function_">filter</span>(<span class="title class_">Boolean</span>).<span class="title function_">join</span>(<span class="string">&#x27; / &#x27;</span>) : <span class="literal">null</span></span></span><br><span class="line"><span class="language-javascript">    &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> &#123; <span class="attr">data</span>: newOrder &#125; = <span class="keyword">await</span> axios.<span class="title function_">post</span>(<span class="string">`<span class="subst">$&#123;API_BASE_URL&#125;</span>/order`</span>, orderData);</span></span><br><span class="line"><span class="language-javascript">    cartModal.<span class="title function_">hide</span>();</span></span><br><span class="line"><span class="language-javascript">    router.<span class="title function_">push</span>(<span class="string">`/customer/confirmation/<span class="subst">$&#123;newOrder._id&#125;</span>`</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">catch</span> (error) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error creating order:&#x27;</span>, error);</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(<span class="string">&#x27;訂單建立失敗，請重試&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">generateOrderNumber</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> number = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">`<span class="subst">$&#123;API_BASE_URL&#125;</span>/order/number`</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">return</span> number.<span class="property">data</span>.<span class="property">number</span>;</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// Initialize Bootstrap modal</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">initModal</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// Import Bootstrap&#x27;s modal JavaScript</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span>(<span class="string">&#x27;bootstrap/js/dist/modal&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">module</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> <span class="title class_">Modal</span> = <span class="variable language_">module</span>.<span class="property">default</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// Initialize cart modal</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> cartModalElement = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;cartModal&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (cartModalElement) &#123;</span></span><br><span class="line"><span class="language-javascript">      cartModal = <span class="keyword">new</span> <span class="title class_">Modal</span>(cartModalElement);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">onMounted</span>(<span class="title function_">async</span> () =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (!store.<span class="property">value</span>.<span class="property">name</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">await</span> <span class="title function_">fetchStore</span>();</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (!menu.<span class="property">value</span>.<span class="property">list</span> || menu.<span class="property">value</span>.<span class="property">list</span>.<span class="property">length</span> === <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">await</span> <span class="title function_">fetchMenu</span>();</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">initModal</span>();</span></span><br><span class="line"><span class="language-javascript">&#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.main-container</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">min-height</span>: <span class="number">100vh</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">background-color</span>: <span class="number">#eaeae668</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.center-container</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">max-width</span>: <span class="number">768px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">background-color</span>: <span class="number">#ffffff</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">min-height</span>: <span class="number">100vh</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">10px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.2</span>);</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="comment">/* 定義過渡動畫 */</span></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.fade-enter-active</span>,</span></span><br><span class="line"><span class="language-css"><span class="selector-class">.fade-leave-active</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">transition</span>: opacity <span class="number">0.3s</span> ease;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.fade-enter-from</span>,</span></span><br><span class="line"><span class="language-css"><span class="selector-class">.fade-leave-to</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="員工點餐介面"><a href="#員工點餐介面" class="headerlink" title="員工點餐介面"></a>員工點餐介面</h1><h2 id="頁面需求"><a href="#頁面需求" class="headerlink" title="頁面需求"></a>頁面需求</h2><p><code>staff/:store</code></p>
<ul>
<li><p>獲取今日 order api <code>/store/:id&#39;</code></p>
</li>
<li><p>左側 navbar 由上到下 顯示日期時間 內用(button) 外帶(button) 訂單(button)</p>
</li>
<li><p>中間為顯示選的哪個component  </p>
</li>
<li><p>右邊 右中上顯示訂單細節 右下顯示取消訂單 重印定單 結帳 如果為訂單頁面component 這三個按鈕不能點 </p>
</li>
<li><p>內用頁面</p>
</li>
<li><p>這個頁面需要把中間切成兩半 上半部顯示所有主餐所有附餐點擊後新增然後選定為當前餐點 下半部為加點或額外需求選項</p>
</li>
<li><p>新增的餐點會在右上角顯示</p>
</li>
<li><p>餐點額外選項 用顏色分區</p>
</li>
<li><p>外帶頁面</p>
</li>
<li><p>這個頁面需要把中間切成兩半 上半部顯示所有主餐所有附餐點擊後新增然後選定為當前餐點 下半部為加點或額外需求選項</p>
</li>
<li><p>新增的餐點會在右上角顯示</p>
</li>
<li><p>訂單頁面</p>
</li>
<li><p>訂單列表 由左至右顯示 updatedAt orderNumber pickupMethod totalMoney orderStatus</p>
</li>
<li><p>中間每個訂單都可以選擇 </p>
</li>
<li><p>線上付款 : 訂單直接完成 paymentMethod 寫入 “線上付款”</p>
</li>
<li><p>現場付款</p>
</li>
<li><p>右側顯示 另外一個 modal 是一個計算機 顯示應付金額與輸入金額還有找錢金額</p>
</li>
<li><p>輸入金額是 店員手動輸入的 顯示找錢金額(輸入金額 - 應付金額) 方便店員快速計算</p>
</li>
<li><p>下方一個完成按鈕 paymentMethod 寫入 “現金”</p>
</li>
<li><p>以上兩種方法 最終都會到訂單完成</p>
</li>
</ul>
<h2 id="語法筆記"><a href="#語法筆記" class="headerlink" title="語法筆記"></a>語法筆記</h2><ol>
<li><strong>在設定<code>.table-striped.table-active</code>遇到了一些問題</strong><br>檔案: <code>src\components\Staff\Orders.vue</code><br><strong>問題分析：</strong></li>
</ol>
<p>Bootstrap 5 的表格樣式機制：</p>
<p>Bootstrap 5 使用 CSS 變數(如 –bs-table-accent-bg, –bs-table-striped-bg, –bs-table-active-bg) 來控制表格的背景顏色。<br>當同時使用 .table-striped 和 .table-active 時，它們都試圖設置同一個變數 –bs-table-accent-bg，但因為選擇器特異性(specificity)和執行順序的關係，.table-striped 的設置可能會覆蓋 .table-active 的設置。</p>
<p>CSS 變數覆蓋問題：</p>
<p>在 Bootstrap 5 中，.table-striped 會為奇數&#x2F;偶數行設置 –bs-table-accent-bg: var(–bs-table-striped-bg)<br>而 .table-active 會設置 –bs-table-accent-bg: var(–bs-table-active-bg)<br>當一個元素同時具有這兩個類時，根據 CSS 規則的加載順序和特異性，後一個設定可能會覆蓋前一個</p>
<p>您之前嘗試的方法無效的原因：</p>
<p>即使您用 !important 直接設置了 background-color，但 Bootstrap 的樣式是通過 CSS 變數工作的，所以您的樣式並不會覆蓋 Bootstrap 的 CSS 變數機制。</p>
<blockquote>
<p>解決方案是在 .table-active 類上直接設置 Bootstrap 的 CSS 變數：</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">.<span class="property">table</span>-active &#123;</span><br><span class="line">  --bs-table-active-<span class="attr">bg</span>: <span class="title function_">rgba</span>(<span class="number">83</span>, <span class="number">109</span>, <span class="number">254</span>, <span class="number">0.35</span>) !important;</span><br><span class="line">  <span class="comment">/* 被選中行」的文字顏色 */</span></span><br><span class="line">  --bs-table-active-<span class="attr">color</span>: #<span class="number">000</span> !important; </span><br><span class="line">  <span class="comment">/* 當滑鼠懸停 (hover) 在表格行時，背景色變為 --bs-table-active-bg */</span></span><br><span class="line">  --bs-table-hover-<span class="attr">bg</span>: <span class="title function_">var</span>(--bs-table-active-bg) !important;</span><br><span class="line">  <span class="comment">/* 當滑鼠懸停 (hover) 在表格行時，文字顏色變為黑色 */</span></span><br><span class="line">  --bs-table-hover-<span class="attr">color</span>: <span class="title function_">var</span>(--bs-table-active-color) !important;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h1 id="會員功能"><a href="#會員功能" class="headerlink" title="會員功能"></a>會員功能</h1><h2 id="會員儲存"><a href="#會員儲存" class="headerlink" title="會員儲存"></a>會員儲存</h2><ol>
<li><p>整個系統統一儲存會員</p>
</li>
<li><p>每個分店各別儲存會員</p>
</li>
</ol>
<blockquote>
<p><code>1.</code>與<code>2.</code>的選擇會影響到集點系統的設計</p>
</blockquote>
<h2 id="前端畫面"><a href="#前端畫面" class="headerlink" title="前端畫面"></a>前端畫面</h2><p>線上點餐網址 改為<code>/customer/ordering/:store_id</code></p>
<ol>
<li>登入&#x2F;註冊畫面<code>/customer/login</code></li>
</ol>
<ul>
<li>上方顯示 <code>會員登入/註冊</code></li>
<li>接續一張圖片 中間文字<code>犇野牛排 &#123;&#123; storeName &#125;&#125;</code></li>
<li>圖片下方 接續文字 <code>登入／註冊 iCHEF 帳號，即可加入餐廳會員。</code></li>
<li>一個選單 選擇電話前面格式 預設為 <code>+886</code></li>
<li>輸入電話號碼</li>
<li>下一步按鈕</li>
</ul>
<ol start="2">
<li>如果電話號碼未註冊 跳到<code>帳號註冊</code>頁面(網址不變 不同component) <code>/customer/login</code></li>
</ol>
<ul>
<li><p>上方顯示 帳號註冊 大標題 與一個上一步按鈕</p>
</li>
<li><p>下面顯示 手機號碼 (+886) 09xxxxxxxx 尚未註冊過 犇野牛排 帳號，請點擊「註冊帳號」按鈕，系統將寄送驗證訊息到此手機號碼。</p>
</li>
<li><p>註冊帳號按鈕</p>
</li>
<li><p>驗證碼輸入</p>
</li>
<li><p>確認送出</p>
</li>
<li><p>重新傳送驗證碼 (60s cd)</p>
</li>
<li><p>註冊畫面要有</p>
</li>
<li><p>姓名</p>
</li>
<li><p>生日(可選)</p>
</li>
<li><p>性別(可選)</p>
</li>
<li><p>地址(可選)</p>
</li>
<li><p>密碼 (規定 8 ~ 32 個字元，英數及常見特殊符號(這邊是可選不是客人必要))</p>
</li>
<li><p>重複輸入一次密碼</p>
</li>
<li><p>通過後 跳出modal跳回登入畫面 (避免使用alert 這對手機使用者體驗不好 都改用modal設計)</p>
</li>
</ul>
<ol start="3">
<li>登入畫面 <code>/customer/login</code></li>
</ol>
<ul>
<li>根據上面輸入過的電話號碼</li>
<li>這邊顯示 大標題<code>登入</code> 接續<code>請輸入密碼。</code></li>
<li>密碼輸入框</li>
<li>忘記密碼按鈕</li>
<li>登入</li>
<li>登入後跳回<code>/customer/ordering/:store_id</code> 然後遠本右上角登入的字改為客戶名字</li>
</ul>
<ol start="4">
<li>忘記密碼頁面 <code>/customer/login</code></li>
</ol>
<ul>
<li>這個頁面使用簡訊重新傳送驗證碼至客戶電話號碼</li>
<li>簡訊驗證碼已發送至 (+886) 0979999412，請於 5 分鐘內完成驗證。</li>
<li>驗證碼輸入正確就 跳至重新輸入密碼component</li>
</ul>
<ol start="5">
<li>重新輸入密碼component<code>/customer/login</code></li>
</ol>
<ul>
<li>新密碼</li>
<li>重複新密碼</li>
<li>送出</li>
<li>沒問題的話跳回登入畫面</li>
</ul>
<ol start="6">
<li>會員專區 <code>/customer/my-account</code></li>
</ol>
<ul>
<li><p>登入後客人再次點擊右上角按鈕</p>
</li>
<li><p>接下來會有一連串<code>&lt;a&gt;</code></p>
</li>
<li><p><code>&#123;&#123;customer.name&#125;&#125; &#123;&#123;customer.phoneNumber&#125;&#125; </code> to <code>/customer/my-account/edit</code></p>
</li>
<li><p>我的點數 <code>/customer/my-account/points</code></p>
</li>
<li><p>我的優惠券 <code>/customer/my-account/coupons</code></p>
</li>
<li><p>我的訂單<code>/customer/my-account/orders</code></p>
</li>
<li><p>修改密碼<code>/customer/my-account/password/edit</code></p>
</li>
<li><p>登出 直接登使用API登出 跳回<code>/customer/ordering/:store_id</code></p>
</li>
<li><p>一堆問題 待修正</p>
</li>
</ul>
<h1 id="各類銷售系統"><a href="#各類銷售系統" class="headerlink" title="各類銷售系統"></a>各類銷售系統</h1><ol>
<li><strong>直接購買</strong></li>
</ol>
<ul>
<li>定義：使用金錢(包括現金或是線上付款)購買</li>
<li>可以在<code>主要點餐頁面</code>直接購買餐點</li>
<li>可以在<code>兌換券購買頁面</code>購買兌換券(會有促銷活動，例如：一次買10張會有優惠(是否能混搭需要再討論))</li>
</ul>
<ol start="2">
<li><strong>點數獲得</strong></li>
</ol>
<ul>
<li>無法購買，由<strong>直接購買</strong>時依據機制獲得</li>
<li>點數可以在<code>兌換券/折價券購買頁面</code>購買兌換券或折價券</li>
</ul>
<ol start="3">
<li><strong>兌換券兌換及折價券使用</strong></li>
</ol>
<ul>
<li>兌換券獲得：由上述兩種方式獲得的兌換券</li>
<li>折價券獲得：只能由點數購買</li>
<li>這邊的獲得只包括一般情況，不包括特殊活動獲得</li>
<li>如何使用<strong>兌換券及折價券</strong>? : 在購物車的地方，會顯示所有可以使用<strong>兌換券兌換及折價券</strong><code>card</code>並且會有一個複選框，讓顧客自由選擇是否使用，使用後會將折扣顯示出來一橫排並扣掉價錢。</li>
<li>如果使用完後價錢為負的，則警告客人不會退還多出的的金額，並且最後金額顯示為<code>0</code>。</li>
</ul>
<ol start="4">
<li>技術總結</li>
</ol>
<ul>
<li>點數儲存在顧客的<code>schema</code></li>
<li>集點機制另外增加一個<code>schema</code>，店家可以創建多種機制，方便不同時期切換活動</li>
<li>一張兌換券只能兌換一種商品，不論是一個加點、一個餐點、一個套餐，限定為特定一個</li>
<li>一張折價券可以折價多種商品，所以需要記錄所有可以折價的商品或是所有商品都可折扣，如果折價項目為空代表所有商品皆可折價</li>
<li>一張折價券是否只能折價一份餐點這需要在確認，或是以總金額折價的方式</li>
<li></li>
</ul>
<h2 id="集點機制"><a href="#集點機制" class="headerlink" title="集點機制"></a>集點機制</h2><ul>
<li>消費滿<strong>x</strong>元獲得<code>1</code>點</li>
<li>滿<strong>2x</strong>元獲得<code>2</code>點</li>
<li>採固定累進機制</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> mongoose <span class="keyword">from</span> <span class="string">&quot;mongoose&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> pointSystemSchema = <span class="keyword">new</span> mongoose.<span class="title class_">Schema</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: &#123; <span class="attr">type</span>: <span class="title class_">String</span>, <span class="attr">required</span>: <span class="literal">true</span> &#125;, <span class="comment">// 例如 &quot;標準轉換&quot; 或 &quot;雙倍點數日&quot;</span></span><br><span class="line">  <span class="attr">minAmount</span>: &#123; <span class="attr">type</span>: <span class="title class_">Number</span>, <span class="attr">required</span>: <span class="literal">true</span> &#125;, <span class="comment">// 最低消費金額</span></span><br><span class="line">  <span class="attr">formula</span>: &#123; <span class="attr">type</span>: <span class="title class_">String</span>, <span class="attr">required</span>: <span class="literal">true</span> &#125;, <span class="comment">// 儲存公式，如 &quot;floor(x/300)&quot;</span></span><br><span class="line">  <span class="attr">desciption</span>: &#123; <span class="attr">type</span>: <span class="title class_">String</span> &#125;, <span class="comment">// 描述</span></span><br><span class="line">  <span class="attr">active</span>: &#123; <span class="attr">type</span>: <span class="title class_">Boolean</span>, <span class="attr">default</span>: <span class="literal">false</span> &#125;, <span class="comment">// 是否啟用</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> mongoose.<span class="title function_">model</span>(<span class="string">&quot;PointSystem&quot;</span>, pointSystemSchema);</span><br></pre></td></tr></table></figure>
<h2 id="折價券"><a href="#折價券" class="headerlink" title="折價券"></a>折價券</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> discountCouponSchema = <span class="keyword">new</span> mongoose.<span class="title class_">Schema</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">String</span>,</span><br><span class="line">    <span class="attr">required</span>: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">discount</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">Number</span>,</span><br><span class="line">    <span class="attr">required</span>: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">admitItems</span>: [&#123;</span><br><span class="line">    <span class="attr">itemModel</span>: &#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="title class_">String</span>,</span><br><span class="line">      <span class="attr">required</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">itemId</span>: &#123;</span><br><span class="line">      <span class="attr">type</span>: mongoose.<span class="property">Schema</span>.<span class="property">Types</span>.<span class="property">ObjectId</span>,</span><br><span class="line">      <span class="attr">required</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">refPath</span>: <span class="string">&#x27;admitItems.itemModel&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;],</span><br><span class="line">  <span class="attr">description</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">String</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">isUsed</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">Boolean</span>,</span><br><span class="line">    <span class="attr">default</span>: <span class="literal">false</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">startAt</span>:&#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">Date</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">expireAt</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">Date</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">owner</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: mongoose.<span class="property">Schema</span>.<span class="property">Types</span>.<span class="property">ObjectId</span>,</span><br><span class="line">    <span class="attr">required</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">ref</span>: <span class="string">&#x27;Customer&#x27;</span>,</span><br><span class="line">    <span class="attr">index</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="預購券"><a href="#預購券" class="headerlink" title="預購券"></a>預購券</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> exchangeCouponSchema = <span class="keyword">new</span> mongoose.<span class="title class_">Schema</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">String</span>,</span><br><span class="line">    <span class="attr">required</span>: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">exchangeItem</span>: &#123;</span><br><span class="line">    <span class="attr">itemModel</span>: &#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="title class_">String</span>,</span><br><span class="line">      <span class="attr">required</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">itemId</span>: &#123;</span><br><span class="line">      <span class="attr">type</span>: mongoose.<span class="property">Schema</span>.<span class="property">Types</span>.<span class="property">ObjectId</span>,</span><br><span class="line">      <span class="attr">required</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">refPath</span>: <span class="string">&#x27;exchangeItem.itemModel&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">description</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">String</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">isUsed</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">Boolean</span>,</span><br><span class="line">    <span class="attr">default</span>: <span class="literal">false</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">startAt</span>:&#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">Date</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">expireAt</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">Date</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">owner</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: mongoose.<span class="property">Schema</span>.<span class="property">Types</span>.<span class="property">ObjectId</span>,</span><br><span class="line">    <span class="attr">required</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">ref</span>: <span class="string">&#x27;Customer&#x27;</span>,</span><br><span class="line">    <span class="attr">index</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h1 id="伺服器流量計算"><a href="#伺服器流量計算" class="headerlink" title="伺服器流量計算"></a>伺服器流量計算</h1><h2 id="mongoDB"><a href="#mongoDB" class="headerlink" title="mongoDB"></a>mongoDB</h2><h3 id="免費額度"><a href="#免費額度" class="headerlink" title="免費額度"></a>免費額度</h3><ul>
<li>STORAGE 512MB</li>
<li>RAM Shared</li>
<li>vCPU Shared</li>
</ul>
<h3 id="預計用量"><a href="#預計用量" class="headerlink" title="預計用量"></a>預計用量</h3><ul>
<li>假設每張訂單資料約2KB (實際不到2KB)</li>
<li>每月新增訂單資料：1,500訂單 × 2KB 約 3MB&#x2F;月</li>
<li>商店、菜單和商品資料 因為不會一直增加所以忽略</li>
<li>總計：約3MB&#x2F;月</li>
<li>免費額度：512MB</li>
<li>每月使用比例：約0.5%</li>
</ul>
<h3 id="結論"><a href="#結論" class="headerlink" title="結論"></a>結論</h3><blockquote>
<p>可以使用超過100個月<br>遠小於免費用量</p>
</blockquote>
<h2 id="google-run"><a href="#google-run" class="headerlink" title="google run"></a>google run</h2><h3 id="免費額度-1"><a href="#免費額度-1" class="headerlink" title="免費額度"></a>免費額度</h3><ul>
<li>CPU 每月前 240,000 vCPU-秒免費</li>
<li>記憶體 每月前 450,000 GiB-秒免費</li>
</ul>
<h3 id="預計用量-1"><a href="#預計用量-1" class="headerlink" title="預計用量"></a>預計用量</h3><ul>
<li>每次API請求平均消耗約0.1 CPU秒</li>
<li>每個訂單流程約需20次API請求(菜單載入、商品查詢、下單等)</li>
<li>後臺使用每日大約200次API請求(訂單列表載入)</li>
<li>每日API請求：50訂單 × 20次請求 + 200次請求 &#x3D; 1,200次請求&#x2F;日</li>
<li>每月CPU使用量：1,200次請求 × 0.1 CPU秒 × 30天 &#x3D; 3,600 CPU秒&#x2F;月</li>
<li>免費額度：240,000 CPU秒&#x2F;月</li>
<li>使用比例：約1.5%</li>
</ul>
<h3 id="結論-1"><a href="#結論-1" class="headerlink" title="結論"></a>結論</h3><blockquote>
<p> CPU和記憶體使用量僅佔免費額度的約1.5%</p>
</blockquote>
<h2 id="cloudinary"><a href="#cloudinary" class="headerlink" title="cloudinary"></a>cloudinary</h2><h3 id="免費額度-2"><a href="#免費額度-2" class="headerlink" title="免費額度"></a>免費額度</h3><ul>
<li>1單位Credit &#x3D; 1K Transformations ,1 GB ,1 GB Bandwidth</li>
<li>每月有25個Credit免費使用量</li>
</ul>
<h3 id="預計用量-2"><a href="#預計用量-2" class="headerlink" title="預計用量"></a>預計用量</h3><ol>
<li>儲存空間</li>
</ol>
<ul>
<li>20張圖片 × 200KB &#x3D; 4MB &#x3D; 0.004GB</li>
<li>需要：0.004 Credit</li>
</ul>
<ol start="2">
<li>圖片轉換</li>
</ol>
<ul>
<li>假設每月20次轉換 &#x3D; 0.02K轉換</li>
<li>需要：0.02 Credit</li>
</ul>
<ol start="3">
<li>頻寬使用量</li>
</ol>
<ul>
<li>每日：50訂單 × 20張圖片 × 200KB &#x3D; 195.31MB&#x2F;日</li>
<li>每月：195.31MB × 30天 &#x3D; 5,859.3MB &#x3D; 5.72GB</li>
<li>需要：5.72 Credits</li>
</ul>
<p>總計使用量</p>
<p>總計需要：5.72 Credits&#x2F;月<br>免費額度：25 Credits&#x2F;月<br>使用比例：約22.8%</p>
<h3 id="結論-2"><a href="#結論-2" class="headerlink" title="結論"></a>結論</h3><blockquote>
<p>每月使用率小於免費額度的四分之一</p>
</blockquote>
<h1 id="測試編寫"><a href="#測試編寫" class="headerlink" title="測試編寫"></a>測試編寫</h1><p>我現在要開始為每個檔案 編寫測試單元<br>由於目前專案已經有一定程度<br>現在開始會是一項大工程 不過這是必須的<br>參考我現在的檔案結構<br>告訴我每個階段該如何實作<br>給我大方向 必要的第三方套件<br>編寫測試的順序<br>以及如何連動在GITHUB 上面這樣之後push上去後會自動測試</p>
<h1 id="暫時筆記"><a href="#暫時筆記" class="headerlink" title="暫時筆記"></a>暫時筆記</h1><h2 id="代辦事項"><a href="#代辦事項" class="headerlink" title="代辦事項"></a>代辦事項</h2><p>後台總營收</p>
<p>外帶Uber 33%<br>foodpanda 25%<br>信用卡 line pay 3%</p>
<ul>
<li><p><del>counter 庫存管理</del></p>
</li>
<li><p>counter 贈送coupon (?)</p>
</li>
<li><p>記帳系統</p>
</li>
<li><p><del>處理menu dish 切換不流暢問題</del></p>
</li>
<li><p><del>order 顧客分析</del></p>
</li>
<li><p><del>點數系統修改</del></p>
</li>
<li><p><del>庫存管理 修改人員沒有正確顯示</del></p>
</li>
<li><p>line 端整合 </p>
</li>
<li><p>後台支援外送平台</p>
</li>
<li><p>處理schema</p>
</li>
<li><p>修改component</p>
</li>
<li><p>優先支援抓取order</p>
</li>
<li><p>處裡檔案耦合</p>
</li>
<li><p>信用卡 line pay API</p>
</li>
</ul>
<h2 id="資料夾命名規則"><a href="#資料夾命名規則" class="headerlink" title="資料夾命名規則"></a><strong>資料夾命名規則</strong></h2><ul>
<li>頂層目錄命名 (使用 camelCase)</li>
<li>業務邏輯子目錄 (使用 PascalCase)</li>
<li>組件目錄 (使用 PascalCase)</li>
<li>視圖目錄 (使用 camelCase)</li>
</ul>
<h2 id="檔案命名規則詳解"><a href="#檔案命名規則詳解" class="headerlink" title="檔案命名規則詳解"></a><strong>檔案命名規則詳解</strong></h2><ol>
<li>模型檔案 (Models)</li>
</ol>
<p>命名風格：PascalCase + 單數<br>原因：代表類或構造函數，符合OOP原則<br>範例：MainDish.js, Order.js</p>
<ol start="2">
<li>Vue組件檔案 (Components)</li>
</ol>
<p>命名風格：PascalCase<br>原因：Vue官方建議，與元件註冊名稱一致<br>範例：CartItem.vue, MenuList.vue</p>
<ol start="3">
<li>視圖檔案 (Views)</li>
</ol>
<p>命名風格：PascalCase<br>原因：實際上也是Vue組件，遵循相同規則<br>範例：Dashboard.vue, MenuPage.vue</p>
<ol start="4">
<li>工具函數檔案</li>
</ol>
<p>命名風格：camelCase<br>原因：包含普通函數，符合JavaScript慣例<br>範例：priceCalculator.js, dateFormatter.js</p>
<ol start="5">
<li>Store檔案</li>
</ol>
<p>命名風格：camelCase<br>原因：主要導出物件或函數，符合模組命名慣例<br>範例：cartStore.js, userStore.js</p>
<h2 id="權限控制"><a href="#權限控制" class="headerlink" title="權限控制"></a>權限控制</h2><h3 id="admin-schema"><a href="#admin-schema" class="headerlink" title="admin schema"></a>admin schema</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> mongoose <span class="keyword">from</span> <span class="string">&#x27;mongoose&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> bcrypt <span class="keyword">from</span> <span class="string">&#x27;bcrypt&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">AdminSchema</span> = <span class="keyword">new</span> mongoose.<span class="title class_">Schema</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">String</span>,</span><br><span class="line">    <span class="attr">required</span>: [<span class="literal">true</span>, <span class="string">&#x27;admin name cannot be blank&#x27;</span>],</span><br><span class="line">    <span class="attr">unique</span>: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">password</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">String</span>,</span><br><span class="line">    <span class="attr">required</span>: [<span class="literal">true</span>, <span class="string">&#x27;password cannot be blank&#x27;</span>],</span><br><span class="line">    <span class="attr">select</span>: <span class="literal">false</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">role</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">String</span>,</span><br><span class="line">    <span class="attr">enum</span>: [</span><br><span class="line">      <span class="string">&#x27;primary_system_admin&#x27;</span>,    <span class="comment">// 系統主管理員</span></span><br><span class="line">      <span class="string">&#x27;system_admin&#x27;</span>,            <span class="comment">// 系統管理員</span></span><br><span class="line">      <span class="string">&#x27;primary_brand_admin&#x27;</span>,     <span class="comment">// 品牌主管理員</span></span><br><span class="line">      <span class="string">&#x27;brand_admin&#x27;</span>,             <span class="comment">// 品牌管理員</span></span><br><span class="line">      <span class="string">&#x27;primary_store_admin&#x27;</span>,     <span class="comment">// 店鋪主管理員</span></span><br><span class="line">      <span class="string">&#x27;store_admin&#x27;</span>,             <span class="comment">// 店鋪管理員</span></span><br><span class="line">      <span class="string">&#x27;employee&#x27;</span>                 <span class="comment">// 員工</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">required</span>: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 所屬品牌 (系統級角色不需要)</span></span><br><span class="line">  <span class="attr">brand</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: mongoose.<span class="property">Schema</span>.<span class="property">Types</span>.<span class="property">ObjectId</span>,</span><br><span class="line">    <span class="attr">ref</span>: <span class="string">&#x27;Brand&#x27;</span>,</span><br><span class="line">    <span class="attr">required</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> ![<span class="string">&#x27;primary_system_admin&#x27;</span>, <span class="string">&#x27;system_admin&#x27;</span>].<span class="title function_">includes</span>(<span class="variable language_">this</span>.<span class="property">role</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">validate</span>: &#123;</span><br><span class="line">      <span class="attr">validator</span>: <span class="keyword">function</span>(<span class="params">value</span>) &#123;</span><br><span class="line">        <span class="comment">// 系統級角色不應該有品牌</span></span><br><span class="line">        <span class="keyword">if</span> ([<span class="string">&#x27;primary_system_admin&#x27;</span>, <span class="string">&#x27;system_admin&#x27;</span>].<span class="title function_">includes</span>(<span class="variable language_">this</span>.<span class="property">role</span>)) &#123;</span><br><span class="line">          <span class="keyword">return</span> !value;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 其他角色必須有品牌</span></span><br><span class="line">        <span class="keyword">return</span> !!value;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&#x27;角色與品牌設定不符&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 所屬店鋪 (只有店鋪級角色需要)</span></span><br><span class="line">  <span class="attr">store</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: mongoose.<span class="property">Schema</span>.<span class="property">Types</span>.<span class="property">ObjectId</span>,</span><br><span class="line">    <span class="attr">ref</span>: <span class="string">&#x27;Store&#x27;</span>,</span><br><span class="line">    <span class="attr">required</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> [<span class="string">&#x27;primary_store_admin&#x27;</span>, <span class="string">&#x27;store_admin&#x27;</span>, <span class="string">&#x27;employee&#x27;</span>].<span class="title function_">includes</span>(<span class="variable language_">this</span>.<span class="property">role</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">validate</span>: &#123;</span><br><span class="line">      <span class="attr">validator</span>: <span class="keyword">function</span>(<span class="params">value</span>) &#123;</span><br><span class="line">        <span class="comment">// 店鋪級角色必須有店鋪</span></span><br><span class="line">        <span class="keyword">if</span> ([<span class="string">&#x27;primary_store_admin&#x27;</span>, <span class="string">&#x27;store_admin&#x27;</span>, <span class="string">&#x27;employee&#x27;</span>].<span class="title function_">includes</span>(<span class="variable language_">this</span>.<span class="property">role</span>)) &#123;</span><br><span class="line">          <span class="keyword">return</span> !!value;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 其他角色不應該有店鋪</span></span><br><span class="line">        <span class="keyword">return</span> !value;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&#x27;角色與店鋪設定不符&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">isActive</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">Boolean</span>,</span><br><span class="line">    <span class="attr">default</span>: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">lastLogin</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">Date</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">createdBy</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: mongoose.<span class="property">Schema</span>.<span class="property">Types</span>.<span class="property">ObjectId</span>,</span><br><span class="line">    <span class="attr">ref</span>: <span class="string">&#x27;Admin&#x27;</span></span><br><span class="line">  &#125;, <span class="comment">// 記錄是誰創建的，用於權限追蹤</span></span><br><span class="line">&#125;, &#123; <span class="attr">timestamps</span>: <span class="literal">true</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 索引設定</span></span><br><span class="line"><span class="title class_">AdminSchema</span>.<span class="title function_">index</span>(&#123; <span class="attr">role</span>: <span class="number">1</span> &#125;);</span><br><span class="line"><span class="title class_">AdminSchema</span>.<span class="title function_">index</span>(&#123; <span class="attr">brand</span>: <span class="number">1</span>, <span class="attr">role</span>: <span class="number">1</span> &#125;);</span><br><span class="line"><span class="title class_">AdminSchema</span>.<span class="title function_">index</span>(&#123; <span class="attr">store</span>: <span class="number">1</span>, <span class="attr">role</span>: <span class="number">1</span> &#125;);</span><br><span class="line"><span class="title class_">AdminSchema</span>.<span class="title function_">index</span>(&#123; <span class="attr">brand</span>: <span class="number">1</span>, <span class="attr">store</span>: <span class="number">1</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 唯一性約束：確保primary角色的唯一性</span></span><br><span class="line"><span class="title class_">AdminSchema</span>.<span class="title function_">index</span>(</span><br><span class="line">  &#123; <span class="attr">role</span>: <span class="number">1</span> &#125;, </span><br><span class="line">  &#123; </span><br><span class="line">    <span class="attr">unique</span>: <span class="literal">true</span>, </span><br><span class="line">    <span class="attr">partialFilterExpression</span>: &#123; <span class="attr">role</span>: <span class="string">&#x27;primary_system_admin&#x27;</span> &#125; </span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="title class_">AdminSchema</span>.<span class="title function_">index</span>(</span><br><span class="line">  &#123; <span class="attr">brand</span>: <span class="number">1</span>, <span class="attr">role</span>: <span class="number">1</span> &#125;, </span><br><span class="line">  &#123; </span><br><span class="line">    <span class="attr">unique</span>: <span class="literal">true</span>, </span><br><span class="line">    <span class="attr">partialFilterExpression</span>: &#123; <span class="attr">role</span>: <span class="string">&#x27;primary_brand_admin&#x27;</span> &#125; </span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="title class_">AdminSchema</span>.<span class="title function_">index</span>(</span><br><span class="line">  &#123; <span class="attr">store</span>: <span class="number">1</span>, <span class="attr">role</span>: <span class="number">1</span> &#125;, </span><br><span class="line">  &#123; </span><br><span class="line">    <span class="attr">unique</span>: <span class="literal">true</span>, </span><br><span class="line">    <span class="attr">partialFilterExpression</span>: &#123; <span class="attr">role</span>: <span class="string">&#x27;primary_store_admin&#x27;</span> &#125; </span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 密碼加密</span></span><br><span class="line"><span class="title class_">AdminSchema</span>.<span class="title function_">pre</span>(<span class="string">&#x27;save&#x27;</span>, <span class="keyword">async</span> <span class="keyword">function</span> (<span class="params">next</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="title function_">isModified</span>(<span class="string">&#x27;password&#x27;</span>)) <span class="keyword">return</span> <span class="title function_">next</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> salt = <span class="keyword">await</span> bcrypt.<span class="title function_">genSalt</span>(<span class="number">12</span>);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">password</span> = <span class="keyword">await</span> bcrypt.<span class="title function_">hash</span>(<span class="variable language_">this</span>.<span class="property">password</span>, salt);</span><br><span class="line">    <span class="title function_">next</span>();</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="title function_">next</span>(error);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 驗證密碼方法</span></span><br><span class="line"><span class="title class_">AdminSchema</span>.<span class="property">methods</span>.<span class="property">comparePassword</span> = <span class="keyword">async</span> <span class="keyword">function</span> (<span class="params">candidatePassword</span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">await</span> bcrypt.<span class="title function_">compare</span>(candidatePassword, <span class="variable language_">this</span>.<span class="property">password</span>);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="keyword">throw</span> error;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 獲取角色權限級別的靜態方法</span></span><br><span class="line"><span class="title class_">AdminSchema</span>.<span class="property">statics</span>.<span class="property">getRoleLevel</span> = <span class="keyword">function</span>(<span class="params">role</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> levels = &#123;</span><br><span class="line">    <span class="string">&#x27;primary_system_admin&#x27;</span>: <span class="number">7</span>,</span><br><span class="line">    <span class="string">&#x27;system_admin&#x27;</span>: <span class="number">6</span>,</span><br><span class="line">    <span class="string">&#x27;primary_brand_admin&#x27;</span>: <span class="number">5</span>,</span><br><span class="line">    <span class="string">&#x27;brand_admin&#x27;</span>: <span class="number">4</span>,</span><br><span class="line">    <span class="string">&#x27;primary_store_admin&#x27;</span>: <span class="number">3</span>,</span><br><span class="line">    <span class="string">&#x27;store_admin&#x27;</span>: <span class="number">2</span>,</span><br><span class="line">    <span class="string">&#x27;employee&#x27;</span>: <span class="number">1</span></span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> levels[role] || <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 檢查是否為primary角色的實例方法</span></span><br><span class="line"><span class="title class_">AdminSchema</span>.<span class="property">methods</span>.<span class="property">isPrimaryRole</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">role</span>.<span class="title function_">startsWith</span>(<span class="string">&#x27;primary_&#x27;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 檢查角色層級的實例方法</span></span><br><span class="line"><span class="title class_">AdminSchema</span>.<span class="property">methods</span>.<span class="property">getRoleScope</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> ([<span class="string">&#x27;primary_system_admin&#x27;</span>, <span class="string">&#x27;system_admin&#x27;</span>].<span class="title function_">includes</span>(<span class="variable language_">this</span>.<span class="property">role</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;system&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ([<span class="string">&#x27;primary_brand_admin&#x27;</span>, <span class="string">&#x27;brand_admin&#x27;</span>].<span class="title function_">includes</span>(<span class="variable language_">this</span>.<span class="property">role</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;brand&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ([<span class="string">&#x27;primary_store_admin&#x27;</span>, <span class="string">&#x27;store_admin&#x27;</span>, <span class="string">&#x27;employee&#x27;</span>].<span class="title function_">includes</span>(<span class="variable language_">this</span>.<span class="property">role</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;store&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;unknown&#x27;</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 檢查是否可以管理特定角色的實例方法</span></span><br><span class="line"><span class="title class_">AdminSchema</span>.<span class="property">methods</span>.<span class="property">canManageRole</span> = <span class="keyword">function</span>(<span class="params">targetRole</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> currentLevel = <span class="variable language_">this</span>.<span class="property">constructor</span>.<span class="title function_">getRoleLevel</span>(<span class="variable language_">this</span>.<span class="property">role</span>);</span><br><span class="line">  <span class="keyword">const</span> targetLevel = <span class="variable language_">this</span>.<span class="property">constructor</span>.<span class="title function_">getRoleLevel</span>(targetRole);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 必須是primary角色才能管理成員</span></span><br><span class="line">  <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="title function_">isPrimaryRole</span>()) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 只能管理同級或下級角色</span></span><br><span class="line">  <span class="keyword">return</span> currentLevel &gt; targetLevel;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> mongoose.<span class="title function_">model</span>(<span class="string">&#x27;Admin&#x27;</span>, <span class="title class_">AdminSchema</span>);</span><br></pre></td></tr></table></figure>
<h1 id="temp"><a href="#temp" class="headerlink" title="temp"></a>temp</h1><p>假設燒一壺水你現在有一個空水壺 需要五個步驟</p>
<ul>
<li>裝滿水</li>
<li>砍柴</li>
<li>燒柴</li>
<li>把水放到爐架上</li>
<li>等待五分鐘</li>
</ul>
<p>如果你現在 有一個裝半滿水的水壺 你該怎麼做?</p>
<ul>
<li>把水倒出重複上面的動作</li>
</ul>
<p><strong>遷移檔案</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> mongoose <span class="keyword">from</span> <span class="string">&#x27;mongoose&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> dotenv <span class="keyword">from</span> <span class="string">&#x27;dotenv&#x27;</span>;</span><br><span class="line"></span><br><span class="line">dotenv.<span class="title function_">config</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">migrateAdminIndexes</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">await</span> mongoose.<span class="title function_">connect</span>(process.<span class="property">env</span>.<span class="property">MongoDB_url</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;MongoDB connected&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> collection = mongoose.<span class="property">connection</span>.<span class="property">db</span>.<span class="title function_">collection</span>(<span class="string">&#x27;admins&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;開始索引遷移...&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 1. 檢查現有索引</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;檢查現有索引...&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> existingIndexes = <span class="keyword">await</span> collection.<span class="title function_">indexes</span>();</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;現有索引:&quot;</span>, existingIndexes.<span class="title function_">map</span>(<span class="function"><span class="params">idx</span> =&gt;</span> (&#123; <span class="attr">name</span>: idx.<span class="property">name</span>, <span class="attr">key</span>: idx.<span class="property">key</span> &#125;)));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. 檢查是否存在有問題的 name 唯一索引</span></span><br><span class="line">    <span class="keyword">const</span> problematicIndex = existingIndexes.<span class="title function_">find</span>(<span class="function"><span class="params">idx</span> =&gt;</span></span><br><span class="line">      idx.<span class="property">name</span> === <span class="string">&#x27;name_1&#x27;</span> ||</span><br><span class="line">      (idx.<span class="property">key</span>.<span class="property">name</span> === <span class="number">1</span> &amp;&amp; idx.<span class="property">unique</span> === <span class="literal">true</span> &amp;&amp; !idx.<span class="property">partialFilterExpression</span>)</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (problematicIndex) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`發現有問題的索引: <span class="subst">$&#123;problematicIndex.name&#125;</span>`</span>);</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`刪除索引: <span class="subst">$&#123;problematicIndex.name&#125;</span>`</span>);</span><br><span class="line">      <span class="keyword">await</span> collection.<span class="title function_">dropIndex</span>(problematicIndex.<span class="property">name</span>);</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;索引刪除成功&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. 檢查數據一致性</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;檢查數據一致性...&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 為系統級管理員添加特殊的 brand 標識</span></span><br><span class="line">    <span class="keyword">const</span> systemAdmins = <span class="keyword">await</span> collection.<span class="title function_">find</span>(&#123;</span><br><span class="line">      <span class="attr">role</span>: &#123; <span class="attr">$in</span>: [<span class="string">&#x27;primary_system_admin&#x27;</span>, <span class="string">&#x27;system_admin&#x27;</span>] &#125;,</span><br><span class="line">      <span class="attr">$or</span>: [</span><br><span class="line">        &#123; <span class="attr">brand</span>: &#123; <span class="attr">$exists</span>: <span class="literal">false</span> &#125; &#125;,</span><br><span class="line">        &#123; <span class="attr">brand</span>: <span class="literal">null</span> &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;).<span class="title function_">toArray</span>();</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`發現 <span class="subst">$&#123;systemAdmins.length&#125;</span> 個系統級管理員需要處理`</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 為系統級管理員設置特殊的 brand 值</span></span><br><span class="line">    <span class="keyword">if</span> (systemAdmins.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">await</span> collection.<span class="title function_">updateMany</span>(</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">role</span>: &#123; <span class="attr">$in</span>: [<span class="string">&#x27;primary_system_admin&#x27;</span>, <span class="string">&#x27;system_admin&#x27;</span>] &#125;,</span><br><span class="line">          <span class="attr">$or</span>: [</span><br><span class="line">            &#123; <span class="attr">brand</span>: &#123; <span class="attr">$exists</span>: <span class="literal">false</span> &#125; &#125;,</span><br><span class="line">            &#123; <span class="attr">brand</span>: <span class="literal">null</span> &#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">$set</span>: &#123; <span class="attr">brand</span>: <span class="keyword">new</span> mongoose.<span class="property">Types</span>.<span class="title class_">ObjectId</span>(<span class="string">&#x27;000000000000000000000000&#x27;</span>) &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      );</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`已為 <span class="subst">$&#123;systemAdmins.length&#125;</span> 個系統級管理員設置特殊品牌標識`</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 4. 檢查是否有重複的 brand+name 組合</span></span><br><span class="line">    <span class="keyword">const</span> duplicates = <span class="keyword">await</span> collection.<span class="title function_">aggregate</span>([</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">$group</span>: &#123;</span><br><span class="line">          <span class="attr">_id</span>: &#123; <span class="attr">brand</span>: <span class="string">&quot;$brand&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;$name&quot;</span> &#125;,</span><br><span class="line">          <span class="attr">count</span>: &#123; <span class="attr">$sum</span>: <span class="number">1</span> &#125;,</span><br><span class="line">          <span class="attr">docs</span>: &#123; <span class="attr">$push</span>: &#123; <span class="attr">id</span>: <span class="string">&quot;$_id&quot;</span>, <span class="attr">role</span>: <span class="string">&quot;$role&quot;</span> &#125; &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123; <span class="attr">$match</span>: &#123; <span class="attr">count</span>: &#123; <span class="attr">$gt</span>: <span class="number">1</span> &#125; &#125; &#125;</span><br><span class="line">    ]).<span class="title function_">toArray</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (duplicates.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;警告：發現重複的品牌+名稱組合：&quot;</span>);</span><br><span class="line">      duplicates.<span class="title function_">forEach</span>(<span class="function"><span class="params">dup</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`品牌 <span class="subst">$&#123;dup._id.brand&#125;</span> 的名稱 &quot;<span class="subst">$&#123;dup._id.name&#125;</span>&quot; 重複 <span class="subst">$&#123;dup.count&#125;</span> 次:`</span>);</span><br><span class="line">        dup.<span class="property">docs</span>.<span class="title function_">forEach</span>(<span class="function"><span class="params">doc</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`  - ID: <span class="subst">$&#123;doc.id&#125;</span>, Role: <span class="subst">$&#123;doc.role&#125;</span>`</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;請先處理重複數據，然後重新運行此腳本&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 5. 創建新的複合唯一索引</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;創建品牌+名稱複合唯一索引...&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">await</span> collection.<span class="title function_">createIndex</span>(</span><br><span class="line">        &#123; <span class="attr">brand</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="number">1</span> &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">unique</span>: <span class="literal">true</span>,</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&quot;brand_name_unique&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      );</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;✓ 品牌+名稱複合唯一索引創建成功&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="keyword">if</span> (error.<span class="property">code</span> === <span class="number">85</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;品牌+名稱複合唯一索引已存在&quot;</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;創建索引失敗:&quot;</span>, error.<span class="property">message</span>);</span><br><span class="line">        <span class="keyword">throw</span> error;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 6. 驗證最終索引狀態</span></span><br><span class="line">    <span class="keyword">const</span> finalIndexes = <span class="keyword">await</span> collection.<span class="title function_">indexes</span>();</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;\n最終索引狀態:&quot;</span>);</span><br><span class="line">    finalIndexes.<span class="title function_">forEach</span>(<span class="function"><span class="params">idx</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`- <span class="subst">$&#123;idx.name&#125;</span>: <span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(idx.key)&#125;</span> <span class="subst">$&#123;idx.unique ? <span class="string">&#x27;(唯一)&#x27;</span> : <span class="string">&#x27;&#x27;</span>&#125;</span>`</span>);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 7. 測試索引效果</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;\n測試索引效果...&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> totalAdmins = <span class="keyword">await</span> collection.<span class="title function_">countDocuments</span>();</span><br><span class="line">    <span class="keyword">const</span> systemAdminsCount = <span class="keyword">await</span> collection.<span class="title function_">countDocuments</span>(&#123;</span><br><span class="line">      <span class="attr">brand</span>: <span class="keyword">new</span> mongoose.<span class="property">Types</span>.<span class="title class_">ObjectId</span>(<span class="string">&#x27;000000000000000000000000&#x27;</span>)</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">const</span> brandAdminsCount = <span class="keyword">await</span> collection.<span class="title function_">countDocuments</span>(&#123;</span><br><span class="line">      <span class="attr">brand</span>: &#123; <span class="attr">$ne</span>: <span class="keyword">new</span> mongoose.<span class="property">Types</span>.<span class="title class_">ObjectId</span>(<span class="string">&#x27;000000000000000000000000&#x27;</span>) &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`總管理員數量: <span class="subst">$&#123;totalAdmins&#125;</span>`</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`系統級管理員: <span class="subst">$&#123;systemAdminsCount&#125;</span>`</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`品牌級管理員: <span class="subst">$&#123;brandAdminsCount&#125;</span>`</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;\n索引遷移完成！&quot;</span>);</span><br><span class="line"></span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;索引遷移失敗:&#x27;</span>, error);</span><br><span class="line">  &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    <span class="keyword">await</span> mongoose.<span class="title function_">disconnect</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">migrateAdminIndexes</span>();</span><br></pre></td></tr></table></figure>

<p><strong>促銷系統規劃</strong></p>
<ul>
<li><p>先完成 現金購買 到達累積金額 獲得相對應point</p>
</li>
<li><p>新增 point 商店，使用point 可購買商品的pages</p>
</li>
<li><p>需要有point menu，需要調整models</p>
</li>
<li><p>新增預購券商店，可用現金購買預購券</p>
</li>
<li><p>新增綑綁販售功能，例如5張豬排兌換券 綁在一起販售 然後是自訂義的價格</p>
</li>
<li><p>綑綁販售實作邏輯，我打算紀錄menu裡面， 可以調整數量，最後覆蓋一個價格，然後後端API自動創建多張兌換券 這樣就達到我要的效果</p>
</li>
<li><p>兌換券 的point system可以與現金購買頁面的point system 獨立處理，例如為了鼓勵預購兌換券 轉換比例可以高一點</p>
</li>
<li><p>是否需要支援可以同時購買餐點及預購兌換券，需要處理point system轉換率的問題</p>
</li>
</ul>
<pre class="mermaid">sequenceDiagram
    participant 用戶
    participant 前端
    participant 後端API
    participant 支付服務提供商
    participant 資料庫

    %% 第一階段：處理支付請求
    用戶->>前端: 選擇支付方式並提交訂單
    前端->>後端API: POST /api/order/:orderId/payment
    後端API->>資料庫: 檢查訂單狀態(是否為待支付)
    資料庫-->>後端API: 返回訂單資訊
    後端API->>支付服務提供商: 發起支付請求(建立交易)
    支付服務提供商-->>後端API: 返回支付URL/參數
    後端API->>資料庫: 更新訂單狀態為"處理中"
    後端API-->>前端: 返回支付URL/參數
    前端->>用戶: 顯示支付頁面或重定向至支付網址
    用戶->>支付服務提供商: 進行支付操作

    %% 第二階段：支付回調處理
    支付服務提供商->>後端API: POST /api/order/:orderId/payment/callback
    後端API->>後端API: 驗證回調請求的真實性
    後端API->>資料庫: 更新訂單狀態(已支付/失敗)
    
    alt 支付成功
        後端API-->>支付服務提供商: 確認收到(200 OK)
        後端API->>前端: 推送支付成功通知(可選)
        前端->>用戶: 顯示支付成功頁面
    else 支付失敗
        後端API-->>支付服務提供商: 確認收到(200 OK)
        後端API->>前端: 推送支付失敗通知(可選)
        前端->>用戶: 顯示支付失敗，提供重試選項
    end</pre>


<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createRouter, createWebHistory &#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span><br><span class="line"><span class="keyword">import</span> api <span class="keyword">from</span> <span class="string">&#x27;@/api&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 檢查管理員登入狀態</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">checkAdminAuth</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// 測試階段直接返回已登入狀態和最高權限</span></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">loggedIn</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">role</span>: <span class="string">&#x27;boss&#x27;</span>,</span><br><span class="line">    <span class="attr">manage</span>: [] <span class="comment">// 可以根據需要添加模擬的店鋪權限</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// try &#123;</span></span><br><span class="line">  <span class="comment">//   const response = await api.auth.checkAdmin()</span></span><br><span class="line">  <span class="comment">//   return &#123;</span></span><br><span class="line">  <span class="comment">//     loggedIn: response.data.loggedIn,</span></span><br><span class="line">  <span class="comment">//     role: response.data.role,</span></span><br><span class="line">  <span class="comment">//     manage: response.data.manage || []</span></span><br><span class="line">  <span class="comment">//   &#125;</span></span><br><span class="line">  <span class="comment">// &#125; catch (error) &#123;</span></span><br><span class="line">  <span class="comment">//   console.error(&#x27;檢查管理員登入狀態失敗&#x27;, error)</span></span><br><span class="line">  <span class="comment">//   return &#123; loggedIn: false, role: null, manage: [] &#125;</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 檢查會員登入狀態 (目前在測試階段暫時不使用)</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">checkUserAuth</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// 測試階段直接返回已登入狀態</span></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">loggedIn</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">userData</span>: &#123; <span class="attr">id</span>: <span class="string">&#x27;test-user-id&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;測試用戶&#x27;</span> &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 正式環境程式碼 (暫時註解)</span></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">  try &#123;</span></span><br><span class="line"><span class="comment">    const response = await api.auth.checkUser()</span></span><br><span class="line"><span class="comment">    return &#123;</span></span><br><span class="line"><span class="comment">      loggedIn: response.data.loggedIn,</span></span><br><span class="line"><span class="comment">      userData: response.data.user</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">  &#125; catch (error) &#123;</span></span><br><span class="line"><span class="comment">    console.error(&#x27;檢查會員登入狀態失敗&#x27;, error)</span></span><br><span class="line"><span class="comment">    return &#123; loggedIn: false, userData: null &#125;</span></span><br><span class="line"><span class="comment">  &#125;</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>(&#123;</span><br><span class="line">  <span class="attr">history</span>: <span class="title function_">createWebHistory</span>(<span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">env</span>.<span class="property">BASE_URL</span>),</span><br><span class="line">  <span class="attr">routes</span>: [</span><br><span class="line">    <span class="comment">// // 首頁 - 重定向到適當的頁面</span></span><br><span class="line">    <span class="comment">// &#123;</span></span><br><span class="line">    <span class="comment">//   path: &#x27;/&#x27;,</span></span><br><span class="line">    <span class="comment">//   name: &#x27;home&#x27;,</span></span><br><span class="line">    <span class="comment">//   redirect: to =&gt; &#123;</span></span><br><span class="line">    <span class="comment">//     // 可以根據登入狀態決定重定向到哪個頁面</span></span><br><span class="line">    <span class="comment">//     return &#123; path: &#x27;/customer/stores&#x27; &#125;</span></span><br><span class="line">    <span class="comment">//   &#125;</span></span><br><span class="line">    <span class="comment">// &#125;,</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// // 管理員認證</span></span><br><span class="line">    <span class="comment">// &#123;</span></span><br><span class="line">    <span class="comment">//   path: &#x27;/admin/login&#x27;,</span></span><br><span class="line">    <span class="comment">//   name: &#x27;admin-login&#x27;,</span></span><br><span class="line">    <span class="comment">//   component: () =&gt; import(&#x27;@/views/auth/loginView.vue&#x27;),</span></span><br><span class="line">    <span class="comment">//   meta: &#123; guest: true &#125;</span></span><br><span class="line">    <span class="comment">// &#125;,</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 管理員後台</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">path</span>: <span class="string">&#x27;/admin&#x27;</span>,</span><br><span class="line">      <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/views/admin/index.vue&#x27;</span>),</span><br><span class="line">      <span class="attr">meta</span>: &#123; <span class="attr">requiresAdminAuth</span>: <span class="literal">false</span> &#125;,</span><br><span class="line">      <span class="attr">children</span>: [</span><br><span class="line">        <span class="comment">//     &#123;</span></span><br><span class="line">        <span class="comment">//       path: &#x27;&#x27;,</span></span><br><span class="line">        <span class="comment">//       name: &#x27;admin-dashboard&#x27;,</span></span><br><span class="line">        <span class="comment">//       component: () =&gt; import(&#x27;@/views/admin/dashboard.vue&#x27;)</span></span><br><span class="line">        <span class="comment">//     &#125;,</span></span><br><span class="line">        <span class="comment">//     // 餐點模板管理</span></span><br><span class="line">        <span class="comment">//     &#123;</span></span><br><span class="line">        <span class="comment">//       path: &#x27;dish-templates&#x27;,</span></span><br><span class="line">        <span class="comment">//       name: &#x27;admin-dish-templates&#x27;,</span></span><br><span class="line">        <span class="comment">//       component: () =&gt; import(&#x27;@/views/admin/dish/templates.vue&#x27;)</span></span><br><span class="line">        <span class="comment">//     &#125;,</span></span><br><span class="line">        <span class="comment">//     &#123;</span></span><br><span class="line">        <span class="comment">//       path: &#x27;dish-templates/create&#x27;,</span></span><br><span class="line">        <span class="comment">//       name: &#x27;admin-dish-template-create&#x27;,</span></span><br><span class="line">        <span class="comment">//       component: () =&gt; import(&#x27;@/views/admin/dish/templateForm.vue&#x27;)</span></span><br><span class="line">        <span class="comment">//     &#125;,</span></span><br><span class="line">        <span class="comment">//     &#123;</span></span><br><span class="line">        <span class="comment">//       path: &#x27;dish-templates/:id&#x27;,</span></span><br><span class="line">        <span class="comment">//       name: &#x27;admin-dish-template-edit&#x27;,</span></span><br><span class="line">        <span class="comment">//       component: () =&gt; import(&#x27;@/views/admin/dish/templateForm.vue&#x27;)</span></span><br><span class="line">        <span class="comment">//     &#125;,</span></span><br><span class="line">        <span class="comment">//     // 選項類別管理</span></span><br><span class="line">        <span class="comment">//     &#123;</span></span><br><span class="line">        <span class="comment">//       path: &#x27;option-categories&#x27;,</span></span><br><span class="line">        <span class="comment">//       name: &#x27;admin-option-categories&#x27;,</span></span><br><span class="line">        <span class="comment">//       component: () =&gt; import(&#x27;@/views/admin/option/categories.vue&#x27;)</span></span><br><span class="line">        <span class="comment">//     &#125;,</span></span><br><span class="line">        <span class="comment">//     &#123;</span></span><br><span class="line">        <span class="comment">//       path: &#x27;option-categories/create&#x27;,</span></span><br><span class="line">        <span class="comment">//       name: &#x27;admin-option-category-create&#x27;,</span></span><br><span class="line">        <span class="comment">//       component: () =&gt; import(&#x27;@/views/admin/option/categoryForm.vue&#x27;)</span></span><br><span class="line">        <span class="comment">//     &#125;,</span></span><br><span class="line">        <span class="comment">//     &#123;</span></span><br><span class="line">        <span class="comment">//       path: &#x27;option-categories/:id&#x27;,</span></span><br><span class="line">        <span class="comment">//       name: &#x27;admin-option-category-edit&#x27;,</span></span><br><span class="line">        <span class="comment">//       component: () =&gt; import(&#x27;@/views/admin/option/categoryForm.vue&#x27;)</span></span><br><span class="line">        <span class="comment">//     &#125;,</span></span><br><span class="line">        <span class="comment">//     // 選項管理</span></span><br><span class="line">        <span class="comment">//     &#123;</span></span><br><span class="line">        <span class="comment">//       path: &#x27;options&#x27;,</span></span><br><span class="line">        <span class="comment">//       name: &#x27;admin-options&#x27;,</span></span><br><span class="line">        <span class="comment">//       component: () =&gt; import(&#x27;@/views/admin/option/options.vue&#x27;)</span></span><br><span class="line">        <span class="comment">//     &#125;,</span></span><br><span class="line">        <span class="comment">//     &#123;</span></span><br><span class="line">        <span class="comment">//       path: &#x27;options/create&#x27;,</span></span><br><span class="line">        <span class="comment">//       name: &#x27;admin-option-create&#x27;,</span></span><br><span class="line">        <span class="comment">//       component: () =&gt; import(&#x27;@/views/admin/option/optionForm.vue&#x27;)</span></span><br><span class="line">        <span class="comment">//     &#125;,</span></span><br><span class="line">        <span class="comment">//     &#123;</span></span><br><span class="line">        <span class="comment">//       path: &#x27;options/:id&#x27;,</span></span><br><span class="line">        <span class="comment">//       name: &#x27;admin-option-edit&#x27;,</span></span><br><span class="line">        <span class="comment">//       component: () =&gt; import(&#x27;@/views/admin/option/optionForm.vue&#x27;)</span></span><br><span class="line">        <span class="comment">//     &#125;,</span></span><br><span class="line">        <span class="comment">//     // 品牌管理</span></span><br><span class="line">        <span class="comment">//     &#123;</span></span><br><span class="line">        <span class="comment">//       path: &#x27;brands&#x27;,</span></span><br><span class="line">        <span class="comment">//       name: &#x27;admin-brands&#x27;,</span></span><br><span class="line">        <span class="comment">//       component: () =&gt; import(&#x27;@/views/admin/brand/list.vue&#x27;),</span></span><br><span class="line">        <span class="comment">//       meta: &#123; role: &#x27;boss&#x27; &#125;</span></span><br><span class="line">        <span class="comment">//     &#125;,</span></span><br><span class="line">        <span class="comment">//     &#123;</span></span><br><span class="line">        <span class="comment">//       path: &#x27;brands/create&#x27;,</span></span><br><span class="line">        <span class="comment">//       name: &#x27;admin-brand-create&#x27;,</span></span><br><span class="line">        <span class="comment">//       component: () =&gt; import(&#x27;@/views/admin/brand/form.vue&#x27;),</span></span><br><span class="line">        <span class="comment">//       meta: &#123; role: &#x27;boss&#x27; &#125;</span></span><br><span class="line">        <span class="comment">//     &#125;,</span></span><br><span class="line">        <span class="comment">//     &#123;</span></span><br><span class="line">        <span class="comment">//       path: &#x27;brands/:id&#x27;,</span></span><br><span class="line">        <span class="comment">//       name: &#x27;admin-brand-edit&#x27;,</span></span><br><span class="line">        <span class="comment">//       component: () =&gt; import(&#x27;@/views/admin/brand/form.vue&#x27;),</span></span><br><span class="line">        <span class="comment">//       meta: &#123; role: &#x27;boss&#x27; &#125;</span></span><br><span class="line">        <span class="comment">//     &#125;,</span></span><br><span class="line">        <span class="comment">//     // 店鋪管理</span></span><br><span class="line">        <span class="comment">//     &#123;</span></span><br><span class="line">        <span class="comment">//       path: &#x27;stores&#x27;,</span></span><br><span class="line">        <span class="comment">//       name: &#x27;admin-stores&#x27;,</span></span><br><span class="line">        <span class="comment">//       component: () =&gt; import(&#x27;@/views/admin/store/list.vue&#x27;)</span></span><br><span class="line">        <span class="comment">//     &#125;,</span></span><br><span class="line">        <span class="comment">//     &#123;</span></span><br><span class="line">        <span class="comment">//       path: &#x27;stores/create&#x27;,</span></span><br><span class="line">        <span class="comment">//       name: &#x27;admin-store-create&#x27;,</span></span><br><span class="line">        <span class="comment">//       component: () =&gt; import(&#x27;@/views/admin/store/form.vue&#x27;),</span></span><br><span class="line">        <span class="comment">//       meta: &#123; role: &#x27;boss&#x27; &#125;</span></span><br><span class="line">        <span class="comment">//     &#125;,</span></span><br><span class="line">        <span class="comment">//     &#123;</span></span><br><span class="line">        <span class="comment">//       path: &#x27;stores/:id&#x27;,</span></span><br><span class="line">        <span class="comment">//       name: &#x27;admin-store-edit&#x27;,</span></span><br><span class="line">        <span class="comment">//       component: () =&gt; import(&#x27;@/views/admin/store/form.vue&#x27;)</span></span><br><span class="line">        <span class="comment">//     &#125;,</span></span><br><span class="line">        <span class="comment">//     // 菜單管理</span></span><br><span class="line">        <span class="comment">//     &#123;</span></span><br><span class="line">        <span class="comment">//       path: &#x27;menus&#x27;,</span></span><br><span class="line">        <span class="comment">//       name: &#x27;admin-menus&#x27;,</span></span><br><span class="line">        <span class="comment">//       component: () =&gt; import(&#x27;@/views/admin/menu/list.vue&#x27;)</span></span><br><span class="line">        <span class="comment">//     &#125;,</span></span><br><span class="line">        <span class="comment">//     &#123;</span></span><br><span class="line">        <span class="comment">//       path: &#x27;menus/create&#x27;,</span></span><br><span class="line">        <span class="comment">//       name: &#x27;admin-menu-create&#x27;,</span></span><br><span class="line">        <span class="comment">//       component: () =&gt; import(&#x27;@/views/admin/menu/form.vue&#x27;)</span></span><br><span class="line">        <span class="comment">//     &#125;,</span></span><br><span class="line">        <span class="comment">//     &#123;</span></span><br><span class="line">        <span class="comment">//       path: &#x27;menus/:id&#x27;,</span></span><br><span class="line">        <span class="comment">//       name: &#x27;admin-menu-edit&#x27;,</span></span><br><span class="line">        <span class="comment">//       component: () =&gt; import(&#x27;@/views/admin/menu/form.vue&#x27;)</span></span><br><span class="line">        <span class="comment">//     &#125;,</span></span><br><span class="line">        <span class="comment">//     // 庫存管理</span></span><br><span class="line">        <span class="comment">//     &#123;</span></span><br><span class="line">        <span class="comment">//       path: &#x27;inventory/:storeId&#x27;,</span></span><br><span class="line">        <span class="comment">//       name: &#x27;admin-inventory&#x27;,</span></span><br><span class="line">        <span class="comment">//       component: () =&gt; import(&#x27;@/views/admin/inventory/list.vue&#x27;)</span></span><br><span class="line">        <span class="comment">//     &#125;,</span></span><br><span class="line">        <span class="comment">//     // 訂單管理</span></span><br><span class="line">        <span class="comment">//     &#123;</span></span><br><span class="line">        <span class="comment">//       path: &#x27;orders/:storeId&#x27;,</span></span><br><span class="line">        <span class="comment">//       name: &#x27;admin-orders&#x27;,</span></span><br><span class="line">        <span class="comment">//       component: () =&gt; import(&#x27;@/views/admin/order/list.vue&#x27;)</span></span><br><span class="line">        <span class="comment">//     &#125;,</span></span><br><span class="line">        <span class="comment">//     &#123;</span></span><br><span class="line">        <span class="comment">//       path: &#x27;orders/:storeId/:orderId&#x27;,</span></span><br><span class="line">        <span class="comment">//       name: &#x27;admin-order-detail&#x27;,</span></span><br><span class="line">        <span class="comment">//       component: () =&gt; import(&#x27;@/views/admin/order/detail.vue&#x27;)</span></span><br><span class="line">        <span class="comment">//     &#125;,</span></span><br><span class="line">        <span class="comment">//     // 點數與優惠券管理</span></span><br><span class="line">        <span class="comment">//     &#123;</span></span><br><span class="line">        <span class="comment">//       path: &#x27;point-rules&#x27;,</span></span><br><span class="line">        <span class="comment">//       name: &#x27;admin-point-rules&#x27;,</span></span><br><span class="line">        <span class="comment">//       component: () =&gt; import(&#x27;@/views/admin/promotion/pointRules.vue&#x27;)</span></span><br><span class="line">        <span class="comment">//     &#125;,</span></span><br><span class="line">        <span class="comment">//     &#123;</span></span><br><span class="line">        <span class="comment">//       path: &#x27;coupons&#x27;,</span></span><br><span class="line">        <span class="comment">//       name: &#x27;admin-coupons&#x27;,</span></span><br><span class="line">        <span class="comment">//       component: () =&gt; import(&#x27;@/views/admin/promotion/coupons.vue&#x27;)</span></span><br><span class="line">        <span class="comment">//     &#125;,</span></span><br><span class="line">        <span class="comment">//     // 管理員管理</span></span><br><span class="line">        <span class="comment">//     &#123;</span></span><br><span class="line">        <span class="comment">//       path: &#x27;admins&#x27;,</span></span><br><span class="line">        <span class="comment">//       name: &#x27;admin-admins&#x27;,</span></span><br><span class="line">        <span class="comment">//       component: () =&gt; import(&#x27;@/views/admin/admin/list.vue&#x27;),</span></span><br><span class="line">        <span class="comment">//       meta: &#123; role: &#x27;boss&#x27; &#125;</span></span><br><span class="line">        <span class="comment">//     &#125;,</span></span><br><span class="line">        <span class="comment">//     &#123;</span></span><br><span class="line">        <span class="comment">//       path: &#x27;admins/create&#x27;,</span></span><br><span class="line">        <span class="comment">//       name: &#x27;admin-admin-create&#x27;,</span></span><br><span class="line">        <span class="comment">//       component: () =&gt; import(&#x27;@/views/admin/admin/form.vue&#x27;),</span></span><br><span class="line">        <span class="comment">//       meta: &#123; role: &#x27;boss&#x27; &#125;</span></span><br><span class="line">        <span class="comment">//     &#125;,</span></span><br><span class="line">        <span class="comment">//     &#123;</span></span><br><span class="line">        <span class="comment">//       path: &#x27;admins/:id&#x27;,</span></span><br><span class="line">        <span class="comment">//       name: &#x27;admin-admin-edit&#x27;,</span></span><br><span class="line">        <span class="comment">//       component: () =&gt; import(&#x27;@/views/admin/admin/form.vue&#x27;),</span></span><br><span class="line">        <span class="comment">//       meta: &#123; role: &#x27;boss&#x27; &#125;</span></span><br><span class="line">        <span class="comment">//     &#125;,</span></span><br><span class="line">        <span class="comment">//     // 用戶管理</span></span><br><span class="line">        <span class="comment">//     &#123;</span></span><br><span class="line">        <span class="comment">//       path: &#x27;users&#x27;,</span></span><br><span class="line">        <span class="comment">//       name: &#x27;admin-users&#x27;,</span></span><br><span class="line">        <span class="comment">//       component: () =&gt; import(&#x27;@/views/admin/user/list.vue&#x27;)</span></span><br><span class="line">        <span class="comment">//     &#125;,</span></span><br><span class="line">        <span class="comment">//     &#123;</span></span><br><span class="line">        <span class="comment">//       path: &#x27;users/:id&#x27;,</span></span><br><span class="line">        <span class="comment">//       name: &#x27;admin-user-detail&#x27;,</span></span><br><span class="line">        <span class="comment">//       component: () =&gt; import(&#x27;@/views/admin/user/detail.vue&#x27;)</span></span><br><span class="line">        <span class="comment">//     &#125;</span></span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// // 店員前台 (點餐系統)</span></span><br><span class="line">    <span class="comment">// &#123;</span></span><br><span class="line">    <span class="comment">//   path: &#x27;/staff/:storeId&#x27;,</span></span><br><span class="line">    <span class="comment">//   name: &#x27;staff&#x27;,</span></span><br><span class="line">    <span class="comment">//   component: () =&gt; import(&#x27;@/views/staff/index.vue&#x27;),</span></span><br><span class="line">    <span class="comment">//   meta: &#123; requiresAdminAuth: true &#125;</span></span><br><span class="line">    <span class="comment">// &#125;,</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// // 客人前台</span></span><br><span class="line">    <span class="comment">// &#123;</span></span><br><span class="line">    <span class="comment">//   path: &#x27;/customer&#x27;,</span></span><br><span class="line">    <span class="comment">//   component: () =&gt; import(&#x27;@/views/customer/layout.vue&#x27;),</span></span><br><span class="line">    <span class="comment">//   children: [</span></span><br><span class="line">    <span class="comment">//     // 店鋪列表</span></span><br><span class="line">    <span class="comment">//     &#123;</span></span><br><span class="line">    <span class="comment">//       path: &#x27;stores&#x27;,</span></span><br><span class="line">    <span class="comment">//       name: &#x27;customer-stores&#x27;,</span></span><br><span class="line">    <span class="comment">//       component: () =&gt; import(&#x27;@/views/customer/stores.vue&#x27;)</span></span><br><span class="line">    <span class="comment">//     &#125;,</span></span><br><span class="line">    <span class="comment">//     // 點餐頁面</span></span><br><span class="line">    <span class="comment">//     &#123;</span></span><br><span class="line">    <span class="comment">//       path: &#x27;ordering/:storeId&#x27;,</span></span><br><span class="line">    <span class="comment">//       name: &#x27;customer-ordering&#x27;,</span></span><br><span class="line">    <span class="comment">//       component: () =&gt; import(&#x27;@/views/customer/ordering.vue&#x27;)</span></span><br><span class="line">    <span class="comment">//     &#125;,</span></span><br><span class="line">    <span class="comment">//     // 訂單確認頁面</span></span><br><span class="line">    <span class="comment">//     &#123;</span></span><br><span class="line">    <span class="comment">//       path: &#x27;confirmation/:orderId&#x27;,</span></span><br><span class="line">    <span class="comment">//       name: &#x27;customer-confirmation&#x27;,</span></span><br><span class="line">    <span class="comment">//       component: () =&gt; import(&#x27;@/views/customer/confirmation.vue&#x27;)</span></span><br><span class="line">    <span class="comment">//     &#125;,</span></span><br><span class="line">    <span class="comment">//     // 會員登入/註冊</span></span><br><span class="line">    <span class="comment">//     &#123;</span></span><br><span class="line">    <span class="comment">//       path: &#x27;login&#x27;,</span></span><br><span class="line">    <span class="comment">//       name: &#x27;customer-login&#x27;,</span></span><br><span class="line">    <span class="comment">//       component: () =&gt; import(&#x27;@/views/customer/loginView.vue&#x27;),</span></span><br><span class="line">    <span class="comment">//       meta: &#123; customerGuest: true &#125;,</span></span><br><span class="line">    <span class="comment">//       children: [</span></span><br><span class="line">    <span class="comment">//         &#123;</span></span><br><span class="line">    <span class="comment">//           path: &#x27;&#x27;,</span></span><br><span class="line">    <span class="comment">//           name: &#x27;customer-login-form&#x27;,</span></span><br><span class="line">    <span class="comment">//           component: () =&gt; import(&#x27;@/components/Customer/LoginForm.vue&#x27;)</span></span><br><span class="line">    <span class="comment">//         &#125;,</span></span><br><span class="line">    <span class="comment">//         &#123;</span></span><br><span class="line">    <span class="comment">//           path: &#x27;register&#x27;,</span></span><br><span class="line">    <span class="comment">//           name: &#x27;customer-register&#x27;,</span></span><br><span class="line">    <span class="comment">//           component: () =&gt; import(&#x27;@/components/Customer/Register.vue&#x27;)</span></span><br><span class="line">    <span class="comment">//         &#125;,</span></span><br><span class="line">    <span class="comment">//         &#123;</span></span><br><span class="line">    <span class="comment">//           path: &#x27;forgot-password&#x27;,</span></span><br><span class="line">    <span class="comment">//           name: &#x27;customer-forgot-password&#x27;,</span></span><br><span class="line">    <span class="comment">//           component: () =&gt; import(&#x27;@/components/Customer/ForgotPassword.vue&#x27;)</span></span><br><span class="line">    <span class="comment">//         &#125;</span></span><br><span class="line">    <span class="comment">//       ]</span></span><br><span class="line">    <span class="comment">//     &#125;,</span></span><br><span class="line">    <span class="comment">//     // 會員中心</span></span><br><span class="line">    <span class="comment">//     &#123;</span></span><br><span class="line">    <span class="comment">//       path: &#x27;my-account&#x27;,</span></span><br><span class="line">    <span class="comment">//       name: &#x27;customer-my-account&#x27;,</span></span><br><span class="line">    <span class="comment">//       component: () =&gt; import(&#x27;@/views/customer/myAccount.vue&#x27;),</span></span><br><span class="line">    <span class="comment">//       meta: &#123; requiresCustomerAuth: true &#125;,</span></span><br><span class="line">    <span class="comment">//       children: [</span></span><br><span class="line">    <span class="comment">//         &#123;</span></span><br><span class="line">    <span class="comment">//           path: &#x27;&#x27;,</span></span><br><span class="line">    <span class="comment">//           name: &#x27;customer-account-home&#x27;,</span></span><br><span class="line">    <span class="comment">//           component: () =&gt; import(&#x27;@/components/Customer/AccountHome.vue&#x27;)</span></span><br><span class="line">    <span class="comment">//         &#125;,</span></span><br><span class="line">    <span class="comment">//         &#123;</span></span><br><span class="line">    <span class="comment">//           path: &#x27;edit&#x27;,</span></span><br><span class="line">    <span class="comment">//           name: &#x27;customer-account-edit&#x27;,</span></span><br><span class="line">    <span class="comment">//           component: () =&gt; import(&#x27;@/components/Customer/AccountEdit.vue&#x27;)</span></span><br><span class="line">    <span class="comment">//         &#125;,</span></span><br><span class="line">    <span class="comment">//         &#123;</span></span><br><span class="line">    <span class="comment">//           path: &#x27;points&#x27;,</span></span><br><span class="line">    <span class="comment">//           name: &#x27;customer-points&#x27;,</span></span><br><span class="line">    <span class="comment">//           component: () =&gt; import(&#x27;@/components/Customer/Points.vue&#x27;)</span></span><br><span class="line">    <span class="comment">//         &#125;,</span></span><br><span class="line">    <span class="comment">//         &#123;</span></span><br><span class="line">    <span class="comment">//           path: &#x27;coupons&#x27;,</span></span><br><span class="line">    <span class="comment">//           name: &#x27;customer-coupons&#x27;,</span></span><br><span class="line">    <span class="comment">//           component: () =&gt; import(&#x27;@/components/Customer/Coupons.vue&#x27;)</span></span><br><span class="line">    <span class="comment">//         &#125;,</span></span><br><span class="line">    <span class="comment">//         &#123;</span></span><br><span class="line">    <span class="comment">//           path: &#x27;orders&#x27;,</span></span><br><span class="line">    <span class="comment">//           name: &#x27;customer-orders&#x27;,</span></span><br><span class="line">    <span class="comment">//           component: () =&gt; import(&#x27;@/components/Customer/Orders.vue&#x27;)</span></span><br><span class="line">    <span class="comment">//         &#125;</span></span><br><span class="line">    <span class="comment">//       ]</span></span><br><span class="line">    <span class="comment">//     &#125;</span></span><br><span class="line">    <span class="comment">//   ]</span></span><br><span class="line">    <span class="comment">// &#125;,</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 404 頁面</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">path</span>: <span class="string">&#x27;/:pathMatch(.*)*&#x27;</span>,</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;not-found&#x27;</span>,</span><br><span class="line">      <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/views/notFound.vue&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 全局前置守衛</span></span><br><span class="line">router.<span class="title function_">beforeEach</span>(<span class="title function_">async</span> (to, <span class="keyword">from</span>, next) =&gt; &#123;</span><br><span class="line">  <span class="comment">// 管理員授權檢查</span></span><br><span class="line">  <span class="keyword">if</span> (to.<span class="property">matched</span>.<span class="title function_">some</span>(<span class="function"><span class="params">record</span> =&gt;</span> record.<span class="property">meta</span>.<span class="property">requiresAdminAuth</span>)) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; loggedIn, role, manage &#125; = <span class="keyword">await</span> <span class="title function_">checkAdminAuth</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!loggedIn) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">next</span>(&#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&#x27;/admin/login&#x27;</span>,</span><br><span class="line">        <span class="attr">query</span>: &#123; <span class="attr">redirect</span>: to.<span class="property">fullPath</span> &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 檢查角色權限</span></span><br><span class="line">    <span class="keyword">if</span> (to.<span class="property">meta</span>.<span class="property">role</span> &amp;&amp; to.<span class="property">meta</span>.<span class="property">role</span> !== role) &#123;</span><br><span class="line">      <span class="keyword">if</span> (role === <span class="string">&#x27;boss&#x27;</span>) &#123;</span><br><span class="line">        <span class="comment">// 老闆擁有所有權限</span></span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">next</span>()</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="title function_">alert</span>(<span class="string">&#x27;您沒有權限訪問此頁面&#x27;</span>)</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">next</span>(<span class="string">&#x27;/admin&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 檢查店鋪權限</span></span><br><span class="line">    <span class="keyword">if</span> (to.<span class="property">params</span>.<span class="property">storeId</span> &amp;&amp; role !== <span class="string">&#x27;boss&#x27;</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> hasStorePermission = manage.<span class="title function_">some</span>(</span><br><span class="line">        <span class="function"><span class="params">m</span> =&gt;</span> m.<span class="property">store</span> === to.<span class="property">params</span>.<span class="property">storeId</span></span><br><span class="line">      )</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (!hasStorePermission) &#123;</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&#x27;您沒有權限管理此店鋪&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">next</span>(<span class="string">&#x27;/admin&#x27;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 會員授權檢查</span></span><br><span class="line">  <span class="keyword">if</span> (to.<span class="property">matched</span>.<span class="title function_">some</span>(<span class="function"><span class="params">record</span> =&gt;</span> record.<span class="property">meta</span>.<span class="property">requiresCustomerAuth</span>)) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; loggedIn &#125; = <span class="keyword">await</span> <span class="title function_">checkUserAuth</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!loggedIn) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">next</span>(&#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&#x27;/customer/login&#x27;</span>,</span><br><span class="line">        <span class="attr">query</span>: &#123; <span class="attr">redirect</span>: to.<span class="property">fullPath</span> &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 已登入用戶重定向</span></span><br><span class="line">  <span class="keyword">if</span> (to.<span class="property">matched</span>.<span class="title function_">some</span>(<span class="function"><span class="params">record</span> =&gt;</span> record.<span class="property">meta</span>.<span class="property">guest</span>) &amp;&amp; (<span class="keyword">await</span> <span class="title function_">checkAdminAuth</span>()).<span class="property">loggedIn</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">next</span>(<span class="string">&#x27;/admin&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (to.<span class="property">matched</span>.<span class="title function_">some</span>(<span class="function"><span class="params">record</span> =&gt;</span> record.<span class="property">meta</span>.<span class="property">customerGuest</span>) &amp;&amp; (<span class="keyword">await</span> <span class="title function_">checkUserAuth</span>()).<span class="property">loggedIn</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">next</span>(<span class="string">&#x27;/customer/my-account&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">next</span>()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router</span><br></pre></td></tr></table></figure>

<p>collapse 模板</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 折疊標題區域 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;collapse-header&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;toggleCollapse&quot;</span>&gt;</span></span><br><span class="line">      &#123;&#123; title &#125;&#125;</span><br><span class="line">      <span class="tag">&lt;<span class="name">i</span> <span class="attr">:class</span>=<span class="string">&quot;isExpanded ? &#x27;icon-up&#x27; : &#x27;icon-down&#x27;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- 折疊內容區域 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> </span></span><br><span class="line"><span class="tag">      <span class="attr">class</span>=<span class="string">&quot;collapse-content&quot;</span> </span></span><br><span class="line"><span class="tag">      <span class="attr">ref</span>=<span class="string">&quot;collapseContentRef&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:style</span>=<span class="string">&quot;&#123; maxHeight: contentStyle &#125;&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123; ref, computed, onMounted, watch, nextTick &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 接收的屬性</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> props = <span class="title function_">defineProps</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">title</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">type</span>: <span class="title class_">String</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">default</span>: <span class="string">&#x27;折疊項目&#x27;</span></span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 可選屬性：初始是否展開</span></span></span><br><span class="line"><span class="language-javascript">  <span class="attr">initialExpanded</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">type</span>: <span class="title class_">Boolean</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">default</span>: <span class="literal">false</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 響應式狀態</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> isExpanded = <span class="title function_">ref</span>(props.<span class="property">initialExpanded</span>); <span class="comment">// 是否展開的狀態</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> collapseContentRef = <span class="title function_">ref</span>(<span class="literal">null</span>); <span class="comment">// 對折疊內容的引用</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> actualHeight = <span class="title function_">ref</span>(<span class="number">0</span>); <span class="comment">// 保存實際高度值(數字形式)</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> forceUpdate = <span class="title function_">ref</span>(<span class="number">0</span>); <span class="comment">// 用來強制更新computed的標記</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 使用computed來計算內容樣式</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> contentStyle = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 強制更新標記，當需要重新計算高度時增加此值</span></span></span><br><span class="line"><span class="language-javascript">  forceUpdate.<span class="property">value</span>;  </span></span><br><span class="line"><span class="language-javascript">  </span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (!isExpanded.<span class="property">value</span>) <span class="keyword">return</span> <span class="string">&#x27;0px&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">  </span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (collapseContentRef.<span class="property">value</span> &amp;&amp; actualHeight.<span class="property">value</span> === <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 需要計算高度</span></span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">updateActualHeight</span>();</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  </span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">return</span> actualHeight.<span class="property">value</span> &gt; <span class="number">0</span> ? <span class="string">`<span class="subst">$&#123;actualHeight.value&#125;</span>px`</span> : <span class="string">&#x27;auto&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">&#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 更新實際高度的函數</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">updateActualHeight</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (!collapseContentRef.<span class="property">value</span>) <span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript">  </span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 臨時移除高度限制來測量真實高度</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> originalStyle = collapseContentRef.<span class="property">value</span>.<span class="property">style</span>.<span class="property">maxHeight</span>;</span></span><br><span class="line"><span class="language-javascript">  collapseContentRef.<span class="property">value</span>.<span class="property">style</span>.<span class="property">maxHeight</span> = <span class="string">&#x27;none&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">  </span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 獲取實際高度</span></span></span><br><span class="line"><span class="language-javascript">  actualHeight.<span class="property">value</span> = collapseContentRef.<span class="property">value</span>.<span class="property">scrollHeight</span>;</span></span><br><span class="line"><span class="language-javascript">  </span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 恢復原始樣式</span></span></span><br><span class="line"><span class="language-javascript">  collapseContentRef.<span class="property">value</span>.<span class="property">style</span>.<span class="property">maxHeight</span> = originalStyle;</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 切換折疊狀態</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">toggleCollapse</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  isExpanded.<span class="property">value</span> = !isExpanded.<span class="property">value</span>;</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 處理窗口大小調整</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> <span class="title function_">handleResize</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 重置高度並觸發重新計算</span></span></span><br><span class="line"><span class="language-javascript">  actualHeight.<span class="property">value</span> = <span class="number">0</span>;</span></span><br><span class="line"><span class="language-javascript">  forceUpdate.<span class="property">value</span>++;</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 組件掛載後</span></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 初始計算內容高度</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">nextTick</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">updateActualHeight</span>();</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript">  </span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 監聽窗口大小變化，使用防抖處理優化性能</span></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;resize&#x27;</span>, handleResize);</span></span><br><span class="line"><span class="language-javascript">&#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 監聽內容變化</span></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">watch</span>(<span class="function">() =&gt;</span> collapseContentRef.<span class="property">value</span>?.<span class="property">innerHTML</span>, <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 內容變化時強制更新高度</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">handleResize</span>();</span></span><br><span class="line"><span class="language-javascript">&#125;, &#123; <span class="attr">deep</span>: <span class="literal">true</span> &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 組件卸載時清除事件監聽</span></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">onUnmounted</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">window</span>.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;resize&#x27;</span>, handleResize);</span></span><br><span class="line"><span class="language-javascript">&#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.collapse-header</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">cursor</span>: pointer;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">user-select</span>: none;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">padding</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">background-color</span>: <span class="number">#f1f1f1</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">border-radius</span>: <span class="number">4px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">justify-content</span>: space-between;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.collapse-content</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">overflow</span>: hidden;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">transition</span>: max-height <span class="number">0.5s</span> ease;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>


<pre class="mermaid">flowchart TD
    Start([前端：客戶填寫訂單內容<br/>+ 選擇付款方式]) --> PaymentChoice{前端判斷付款方式}
    
    %% 現場付款分支
    PaymentChoice -->|現場付款| CashFlow[準備現場付款資料<br/>orderData + paymentType: On-site]
    CashFlow --> CallAPI1[呼叫統一API<br/>POST /createOrder]
    
    %% 線上付款分支  
    PaymentChoice -->|信用卡付款| GetPrime[前端：TapPay SDK<br/>獲取 Prime Token]
    GetPrime --> PrimeResult{Prime Token 結果}
    PrimeResult -->|失敗| PrimeError[顯示信用卡錯誤<br/>用戶重新輸入]
    PrimeResult -->|成功| OnlineFlow[準備線上付款資料<br/>orderData + paymentType: Online<br/>+ primeToken]
    OnlineFlow --> CallAPI2[呼叫統一API<br/>POST /createOrder]
    
    %% 後端統一處理
    CallAPI1 --> BackendValidate[後端：驗證訂單資料]
    CallAPI2 --> BackendValidate
    BackendValidate --> ValidateResult{資料驗證}
    ValidateResult -->|失敗| ValidationError[返回驗證錯誤]
    ValidateResult -->|成功| CheckPaymentType{檢查 paymentType}
    
    %% 現場付款流程（簡單）
    CheckPaymentType -->|On-site| CashValidate[驗證現場付款資料]
    CashValidate --> CreateCashOrder[orderCustomer.createOrder<br/>創建 unpaid 訂單<br/> 不創建 Transaction]
    CreateCashOrder --> CashResponse[返回 unpaid 訂單<br/>status: cash_submitted]
    
    %% 線上付款流程（複雜）
    CheckPaymentType -->|Online + primeToken| OnlineValidate[驗證線上付款資料<br/>檢查 primeToken 存在]
    OnlineValidate --> GenTxnId[生成唯一 transactionId<br/>UUID 或時間戳]
    
    %% Transaction 創建（關鍵步驟）
    GenTxnId --> CreateTransaction[ Step 1: 創建 Transaction<br/>transactionService.createTransaction<br/>• tempOrderData: 完整訂單資訊<br/>• status: pending<br/>• amount: 訂單金額]
    
    CreateTransaction --> MarkProcessing[ Step 2: 標記處理中<br/>transactionService.markAsProcessing<br/>• status: processing]
    
    %% TapPay API 調用
    MarkProcessing --> CallTapPay[ Step 3: 呼叫 TapPay API<br/>tapPayService.payByPrime<br/>• primeToken<br/>• amount<br/>• orderDetails]
    
    CallTapPay --> TapPayResult{ Step 4: TapPay 付款結果}
    
    %% 付款成功分支
    TapPayResult -->|付款成功| MarkCompleted[ Step 5: 標記付款完成<br/>transactionService.markAsCompleted<br/>• status: completed<br/>• 記錄 TapPay 回應]
    
    MarkCompleted --> CreateOrderFromTxn[ Step 6: 創建正式訂單<br/>從 Transaction.tempOrderData<br/>創建 Order status: paid]
    
    CreateOrderFromTxn --> LinkOrderTxn[ Step 7: 關聯訂單與交易<br/>transaction.orderId = order._id<br/>清除 tempOrderData]
    
    LinkOrderTxn --> ProcessComplete[處理付款後續邏輯<br/>• 庫存扣減<br/>• 點數給予<br/>• 券類標記]
    
    ProcessComplete --> OnlineResponse[返回 paid 訂單<br/>status: online_success]
    
    %% 付款失敗分支
    TapPayResult -->|付款失敗| MarkFailed[標記付款失敗<br/>transactionService.markAsFailed<br/>• status: failed<br/>• 記錄失敗原因]
    
    MarkFailed --> CleanupFailed[清理失敗交易<br/>保留 Transaction 記錄供審計]
    CleanupFailed --> PaymentError[返回付款失敗錯誤<br/>status: payment_failed]
    
    %% 前端響應處理
    CashResponse --> FrontendCash[前端：顯示等待付款確認<br/>訂單編號 + 櫃檯付款提示]
    OnlineResponse --> FrontendOnline[前端：顯示付款成功<br/>訂單確認 + 清空購物車]
    PaymentError --> FrontendError[前端：顯示付款失敗<br/>保持購物車 + 重試選項]
    ValidationError --> FrontendValidation[前端：顯示驗證錯誤<br/>用戶修正後重新提交]
    PrimeError --> FrontendPrime[前端：信用卡錯誤<br/>用戶重新輸入卡片資訊]
    
    %% 樣式定義
    classDef frontendNode fill:#e3f2fd,stroke:#1976d2
    classDef backendNode fill:#f3e5f5,stroke:#7b1fa2
    classDef transactionNode fill:#fff59d,stroke:#f57c00,stroke-width:3px
    classDef decisionNode fill:#fff3e0,stroke:#ff8f00
    classDef successNode fill:#c8e6c9,stroke:#388e3c
    classDef errorNode fill:#ffcdd2,stroke:#d32f2f
    classDef cashNode fill:#e8f5e8,stroke:#4caf50
    
    class Start,GetPrime,OnlineFlow,CashFlow,CallAPI1,CallAPI2,FrontendCash,FrontendOnline,FrontendError,FrontendValidation,FrontendPrime frontendNode
    class BackendValidate,CashValidate,OnlineValidate,GenTxnId,CallTapPay,CreateOrderFromTxn,LinkOrderTxn,ProcessComplete,CleanupFailed backendNode
    class CreateTransaction,MarkProcessing,MarkCompleted,MarkFailed transactionNode
    class PaymentChoice,PrimeResult,ValidateResult,CheckPaymentType,TapPayResult decisionNode
    class OnlineResponse,CashResponse successNode
    class ValidationError,PaymentError,PrimeError errorNode
    class CreateCashOrder cashNode</pre>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://rabbirreaper.github.io">Rabbir_Reaper</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章連結: </span><span class="post-copyright-info"><a href="https://rabbirreaper.github.io/2025/02/07/%E5%B0%88%E6%A1%88%E7%AD%86%E8%A8%98-%E4%B8%80/">https://rabbirreaper.github.io/2025/02/07/%E5%B0%88%E6%A1%88%E7%AD%86%E8%A8%98-%E4%B8%80/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版權聲明: </span><span class="post-copyright-info">本部落格所有文章除特別聲明外，均採用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 授權協議。轉載請註明來源 <a href="https://rabbirreaper.github.io" target="_blank">Hexo</a>！</span></div></div><div class="tag_share"><div class="post-share"><div class="social-share" data-image="/img/butterfly-icon.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://unpkg.com/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://unpkg.com/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related  no-desc" href="/2025/02/21/Vue3-%E8%AA%9E%E6%B3%95%E7%AD%86%E8%A8%98/" title="Vue3 語法筆記"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">Vue3 語法筆記</div></div></div></a><a class="pagination-related" href="/2025/01/22/cookie-parser-%E8%AA%9E%E6%B3%95%E7%AD%86%E8%A8%98/" title="cookie-parser 語法筆記"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">cookie-parser 語法筆記</div></div><div class="info-2"><div class="info-item-1">這是一篇介紹cookie-parser功能的文章。</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Rabbir_Reaper</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">82</div></a><a href="/tags/"><div class="headline">標籤</div><div class="length-num">33</div></a><a href="/categories/"><div class="headline">分類</div><div class="length-num">10</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目錄</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B0%88%E6%A1%88%E7%B0%A1%E4%BB%8B"><span class="toc-number">1.</span> <span class="toc-text">專案簡介</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Schema-%E8%A8%AD%E8%A8%88"><span class="toc-number">2.</span> <span class="toc-text">Schema 設計</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Dish"><span class="toc-number">2.1.</span> <span class="toc-text">Dish</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#DishTemplate"><span class="toc-number">2.1.1.</span> <span class="toc-text">DishTemplate</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DishInstance"><span class="toc-number">2.1.2.</span> <span class="toc-text">DishInstance</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#OptionCategory"><span class="toc-number">2.1.3.</span> <span class="toc-text">OptionCategory</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Option"><span class="toc-number">2.1.4.</span> <span class="toc-text">Option</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Store"><span class="toc-number">2.2.</span> <span class="toc-text">Store</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Store-1"><span class="toc-number">2.2.1.</span> <span class="toc-text">Store</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#StockLog"><span class="toc-number">2.2.2.</span> <span class="toc-text">StockLog</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#User"><span class="toc-number">2.3.</span> <span class="toc-text">User</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AE%A1%E7%90%86%E5%93%A1%E4%BB%8B%E9%9D%A2"><span class="toc-number">3.</span> <span class="toc-text">管理員介面</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%A1%E7%90%86%E5%93%A1%E5%88%86%E7%B4%9A%E5%88%B6%E5%BA%A6%E5%AF%A6%E4%BD%9C%E7%B4%B0%E7%AF%80"><span class="toc-number">3.1.</span> <span class="toc-text">管理員分級制度實作細節</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%99%BB%E9%8C%84%E7%B3%BB%E7%B5%B1"><span class="toc-number">3.2.</span> <span class="toc-text">登錄系統</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BE%8C%E7%AB%AF%E8%A8%AD%E7%BD%AE"><span class="toc-number">3.2.1.</span> <span class="toc-text">後端設置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E7%99%BB%E9%8C%84%E9%A0%81%E9%9D%A2"><span class="toc-number">3.2.2.</span> <span class="toc-text">前端登錄頁面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#router-%E8%87%AA%E5%8B%95%E8%B7%B3%E8%BD%89%E5%88%B0%E7%99%BB%E9%8C%84%E4%BB%8B%E9%9D%A2"><span class="toc-number">3.2.3.</span> <span class="toc-text">router 自動跳轉到登錄介面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E6%AA%94%E7%B6%B2%E5%9D%80"><span class="toc-number">3.2.4.</span> <span class="toc-text">文檔網址</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A4%90%E9%BB%9E%E9%A1%AF%E7%A4%BA%EF%BC%8C%E6%96%B0%E5%A2%9E%E3%80%81%E4%BF%AE%E6%94%B9%E8%88%87%E5%88%AA%E9%99%A4%E4%BB%8B%E9%9D%A2"><span class="toc-number">3.3.</span> <span class="toc-text">餐點顯示，新增、修改與刪除介面</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#API"><span class="toc-number">3.3.1.</span> <span class="toc-text">API</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%AF%E7%A4%BA"><span class="toc-number">3.3.2.</span> <span class="toc-text">顯示</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B0%E5%A2%9E%E5%8F%8A%E4%BF%AE%E6%94%B9%E9%A0%81%E9%9D%A2"><span class="toc-number">3.3.3.</span> <span class="toc-text">新增及修改頁面</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#menu%E6%96%B0%E5%A2%9E%E4%BB%8B%E9%9D%A2"><span class="toc-number">3.4.</span> <span class="toc-text">menu新增介面</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#API-1"><span class="toc-number">3.4.1.</span> <span class="toc-text">API</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B0%E5%A2%9E"><span class="toc-number">3.4.2.</span> <span class="toc-text">新增</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%AF%E7%A4%BA-1"><span class="toc-number">3.4.3.</span> <span class="toc-text">顯示</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E8%88%87%E5%88%AA%E9%99%A4"><span class="toc-number">3.4.4.</span> <span class="toc-text">修改與刪除</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BA%97%E5%AE%B6%E7%AE%A1%E7%90%86"><span class="toc-number">3.5.</span> <span class="toc-text">店家管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#API-2"><span class="toc-number">3.5.1.</span> <span class="toc-text">API</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B0%E5%A2%9E-1"><span class="toc-number">3.5.2.</span> <span class="toc-text">新增</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E8%88%87%E5%88%AA%E9%99%A4-1"><span class="toc-number">3.5.3.</span> <span class="toc-text">修改與刪除</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%AF%E7%A4%BA-2"><span class="toc-number">3.5.4.</span> <span class="toc-text">顯示</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A8%82%E5%96%AE%E5%88%97%E8%A1%A8"><span class="toc-number">3.6.</span> <span class="toc-text">訂單列表</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A8%82%E5%96%AE%E9%A6%96%E9%A0%81"><span class="toc-number">3.6.1.</span> <span class="toc-text">訂單首頁</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%95%B6%E5%A4%A9-detail"><span class="toc-number">3.6.2.</span> <span class="toc-text">當天 detail</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B8%E6%93%9A%E7%B5%B1%E8%A8%88"><span class="toc-number">3.7.</span> <span class="toc-text">數據統計</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%A2%E4%BA%BA%E9%BB%9E%E9%A4%90%E4%BB%8B%E9%9D%A2"><span class="toc-number">4.</span> <span class="toc-text">客人點餐介面</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9C%80%E6%B1%82"><span class="toc-number">4.1.</span> <span class="toc-text">需求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%84%E5%80%8B%E9%A0%81%E9%9D%A2"><span class="toc-number">4.2.</span> <span class="toc-text">各個頁面</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E8%A6%81%E6%95%B4%E5%90%88%E9%A0%81%E9%9D%A2"><span class="toc-number">4.2.1.</span> <span class="toc-text">主要整合頁面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A4%90%E9%BB%9E%E5%88%97%E8%A1%A8-%E5%8F%8A-navbar"><span class="toc-number">4.2.2.</span> <span class="toc-text">餐點列表 及 navbar</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%84%E9%A0%85%E9%A4%90%E9%BB%9E%E9%BB%9E%E9%A4%90detail"><span class="toc-number">4.2.3.</span> <span class="toc-text">各項餐點點餐detail</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ShoppingCart"><span class="toc-number">4.2.4.</span> <span class="toc-text">ShoppingCart</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A8%82%E5%96%AEObject"><span class="toc-number">4.3.</span> <span class="toc-text">訂單Object</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%8C%E6%88%90%E8%A8%82%E5%96%AE%E7%9A%84%E4%BB%8B%E9%9D%A2"><span class="toc-number">4.4.</span> <span class="toc-text">完成訂單的介面</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%93%A1%E5%B7%A5%E9%BB%9E%E9%A4%90%E4%BB%8B%E9%9D%A2"><span class="toc-number">5.</span> <span class="toc-text">員工點餐介面</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A0%81%E9%9D%A2%E9%9C%80%E6%B1%82"><span class="toc-number">5.1.</span> <span class="toc-text">頁面需求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AA%9E%E6%B3%95%E7%AD%86%E8%A8%98"><span class="toc-number">5.2.</span> <span class="toc-text">語法筆記</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9C%83%E5%93%A1%E5%8A%9F%E8%83%BD"><span class="toc-number">6.</span> <span class="toc-text">會員功能</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%83%E5%93%A1%E5%84%B2%E5%AD%98"><span class="toc-number">6.1.</span> <span class="toc-text">會員儲存</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E7%95%AB%E9%9D%A2"><span class="toc-number">6.2.</span> <span class="toc-text">前端畫面</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%90%84%E9%A1%9E%E9%8A%B7%E5%94%AE%E7%B3%BB%E7%B5%B1"><span class="toc-number">7.</span> <span class="toc-text">各類銷售系統</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9B%86%E9%BB%9E%E6%A9%9F%E5%88%B6"><span class="toc-number">7.1.</span> <span class="toc-text">集點機制</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8A%98%E5%83%B9%E5%88%B8"><span class="toc-number">7.2.</span> <span class="toc-text">折價券</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A0%90%E8%B3%BC%E5%88%B8"><span class="toc-number">7.3.</span> <span class="toc-text">預購券</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BC%BA%E6%9C%8D%E5%99%A8%E6%B5%81%E9%87%8F%E8%A8%88%E7%AE%97"><span class="toc-number">8.</span> <span class="toc-text">伺服器流量計算</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#mongoDB"><span class="toc-number">8.1.</span> <span class="toc-text">mongoDB</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%8D%E8%B2%BB%E9%A1%8D%E5%BA%A6"><span class="toc-number">8.1.1.</span> <span class="toc-text">免費額度</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A0%90%E8%A8%88%E7%94%A8%E9%87%8F"><span class="toc-number">8.1.2.</span> <span class="toc-text">預計用量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B5%90%E8%AB%96"><span class="toc-number">8.1.3.</span> <span class="toc-text">結論</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#google-run"><span class="toc-number">8.2.</span> <span class="toc-text">google run</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%8D%E8%B2%BB%E9%A1%8D%E5%BA%A6-1"><span class="toc-number">8.2.1.</span> <span class="toc-text">免費額度</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A0%90%E8%A8%88%E7%94%A8%E9%87%8F-1"><span class="toc-number">8.2.2.</span> <span class="toc-text">預計用量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B5%90%E8%AB%96-1"><span class="toc-number">8.2.3.</span> <span class="toc-text">結論</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cloudinary"><span class="toc-number">8.3.</span> <span class="toc-text">cloudinary</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%8D%E8%B2%BB%E9%A1%8D%E5%BA%A6-2"><span class="toc-number">8.3.1.</span> <span class="toc-text">免費額度</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A0%90%E8%A8%88%E7%94%A8%E9%87%8F-2"><span class="toc-number">8.3.2.</span> <span class="toc-text">預計用量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B5%90%E8%AB%96-2"><span class="toc-number">8.3.3.</span> <span class="toc-text">結論</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%B8%AC%E8%A9%A6%E7%B7%A8%E5%AF%AB"><span class="toc-number">9.</span> <span class="toc-text">測試編寫</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9A%AB%E6%99%82%E7%AD%86%E8%A8%98"><span class="toc-number">10.</span> <span class="toc-text">暫時筆記</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A3%E8%BE%A6%E4%BA%8B%E9%A0%85"><span class="toc-number">10.1.</span> <span class="toc-text">代辦事項</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B3%87%E6%96%99%E5%A4%BE%E5%91%BD%E5%90%8D%E8%A6%8F%E5%89%87"><span class="toc-number">10.2.</span> <span class="toc-text">資料夾命名規則</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AA%94%E6%A1%88%E5%91%BD%E5%90%8D%E8%A6%8F%E5%89%87%E8%A9%B3%E8%A7%A3"><span class="toc-number">10.3.</span> <span class="toc-text">檔案命名規則詳解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AC%8A%E9%99%90%E6%8E%A7%E5%88%B6"><span class="toc-number">10.4.</span> <span class="toc-text">權限控制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#admin-schema"><span class="toc-number">10.4.1.</span> <span class="toc-text">admin schema</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#temp"><span class="toc-number">11.</span> <span class="toc-text">temp</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/31/251031/" title="251031">251031</a><time datetime="2025-10-30T23:49:20.000Z" title="發表於 2025-10-31 07:49:20">2025-10-31</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/29/Hono%E8%AA%9E%E6%B3%95%E7%AD%86%E8%A8%98/" title="Hono 語法筆記 (未完成)">Hono 語法筆記 (未完成)</a><time datetime="2025-10-29T05:31:19.000Z" title="發表於 2025-10-29 13:31:19">2025-10-29</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/24/%E8%B3%87%E6%96%99%E7%B5%90%E6%A7%8B-%E8%A8%88%E7%AE%97%E6%99%82%E9%96%93%E8%A4%87%E9%9B%9C%E5%BA%A6/" title="資料結構-計算時間複雜度 (未完成)">資料結構-計算時間複雜度 (未完成)</a><time datetime="2025-09-24T05:31:00.000Z" title="發表於 2025-09-24 13:31:00">2025-09-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/06/18/%E9%AB%98%E7%AD%89%E6%BC%94%E7%AE%97%E6%B3%95%E6%9C%9F%E6%9C%AB%E4%BD%9C%E6%A5%AD/" title="高等演算法期末作業">高等演算法期末作業</a><time datetime="2025-06-18T15:54:10.000Z" title="發表於 2025-06-18 23:54:10">2025-06-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/23/EEG%E5%88%86%E6%9E%90%E7%AD%86%E8%A8%98/" title="EEG分析筆記">EEG分析筆記</a><time datetime="2025-05-22T22:53:06.000Z" title="發表於 2025-05-23 06:53:06">2025-05-23</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;2019 - 2025 By Rabbir_Reaper</span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="閱讀模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日夜模式切換"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="單欄和雙欄切換"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="設定"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目錄"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到頂端"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = `%%{init:{ 'theme':'${theme}'}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (true) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://unpkg.com/mermaid/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script></div><script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script><script async data-pjax src="https://unpkg.com/busuanzi@2.3.0/bsz.pure.mini.js"></script></div></body></html>