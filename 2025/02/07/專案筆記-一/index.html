



<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#FFF">
  <link rel="apple-touch-icon" sizes="180x180" href="/https:/pub-da440be71028438aa9683b63bef5ccf1.r2.devimages/apple-touch-icon.png">

<link rel="icon" type="image/ico" sizes="32x32" href="/https:/pub-da440be71028438aa9683b63bef5ccf1.r2.dev/favicon.ico">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">


<link rel="alternate" type="application/rss+xml" title="プログラムを書けないうさぎは、ただのうさぎだ。" href="https://rabbirreaper.github.io/rss.xml" />
<link rel="alternate" type="application/atom+xml" title="プログラムを書けないうさぎは、ただのうさぎだ。" href="https://rabbirreaper.github.io/atom.xml" />
<link rel="alternate" type="application/json" title="プログラムを書けないうさぎは、ただのうさぎだ。" href="https://rabbirreaper.github.io/feed.json" />

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="/css/app.css?v=0.2.5">

  

<link rel="canonical" href="https://rabbirreaper.github.io/2025/02/07/%E5%B0%88%E6%A1%88%E7%AD%86%E8%A8%98-%E4%B8%80/">



  <title>
專案筆記 (未完成) |
Rabbir Reaper = プログラムを書けないうさぎは、ただのうさぎだ。</title>
<meta name="generator" content="Hexo 8.1.1"></head>
<body itemscope itemtype="http://schema.org/WebPage">
  <div id="loading">
    <div class="cat">
      <div class="body"></div>
      <div class="head">
        <div class="face"></div>
      </div>
      <div class="foot">
        <div class="tummy-end"></div>
        <div class="bottom"></div>
        <div class="legs left"></div>
        <div class="legs right"></div>
      </div>
      <div class="paw">
        <div class="hands left"></div>
        <div class="hands right"></div>
      </div>
    </div>
  </div>
  <div id="container">
    <header id="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="inner">
        <div id="brand">
          <div class="pjax">
          
  <h1 itemprop="name headline">專案筆記 (未完成)
  </h1>
  
<div class="meta">
  <span class="item" title="創建時間：2025-02-07 15:13:50">
    <span class="icon">
      <i class="ic i-calendar"></i>
    </span>
    <span class="text">發表於</span>
    <time itemprop="dateCreated datePublished" datetime="2025-02-07T15:13:50+08:00">2025-02-07</time>
  </span>
  <span class="item" title="文章字數">
    <span class="icon">
      <i class="ic i-pen"></i>
    </span>
    <span class="text">文章字數</span>
    <span>114k</span>
    <span class="text">字</span>
  </span>
  <span class="item" title="所需閱讀時間">
    <span class="icon">
      <i class="ic i-clock"></i>
    </span>
    <span class="text">所需閱讀時間</span>
    <span>1:44</span>
  </span>
</div>


          </div>
        </div>
        <nav id="nav">
  <div class="inner">
    <div class="toggle">
      <div class="lines" aria-label="切換導航欄">
        <span class="line"></span>
        <span class="line"></span>
        <span class="line"></span>
      </div>
    </div>
    <ul class="menu">
      <li class="item title"><a href="/" rel="start">Rabbir Reaper</a></li>
    </ul>
    <ul class="right">
      <li class="item theme">
        <i class="ic i-sun"></i>
      </li>
      <li class="item search">
        <i class="ic i-search"></i>
      </li>
    </ul>
  </div>
</nav>

      </div>
      <div id="imgs" class="pjax">
        <ul>
          <li class="item" data-background-image="https://pub-da440be71028438aa9683b63bef5ccf1.r2.dev/51.jpg"></li>
          <li class="item" data-background-image="https://pub-da440be71028438aa9683b63bef5ccf1.r2.dev/16.jpg"></li>
          <li class="item" data-background-image="https://pub-da440be71028438aa9683b63bef5ccf1.r2.dev/62.jpg"></li>
          <li class="item" data-background-image="https://pub-da440be71028438aa9683b63bef5ccf1.r2.dev/49.jpg"></li>
          <li class="item" data-background-image="https://pub-da440be71028438aa9683b63bef5ccf1.r2.dev/29.jpg"></li>
          <li class="item" data-background-image="https://pub-da440be71028438aa9683b63bef5ccf1.r2.dev/45.jpg"></li>
        </ul>
      </div>
    </header>
    <div id="waves">
      <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
        <defs>
          <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
        </defs>
        <g class="parallax">
          <use xlink:href="#gentle-wave" x="48" y="0" />
          <use xlink:href="#gentle-wave" x="48" y="3" />
          <use xlink:href="#gentle-wave" x="48" y="5" />
          <use xlink:href="#gentle-wave" x="48" y="7" />
        </g>
      </svg>
    </div>
    <main>
      <div class="inner">
        <div id="main" class="pjax">
          
  <div class="article wrap">
    
<div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
<i class="ic i-home"></i>
<span><a href="/">首頁</a></span>
</div>

    <article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-TW">
  <link itemprop="mainEntityOfPage" href="https://rabbirreaper.github.io/2025/02/07/%E5%B0%88%E6%A1%88%E7%AD%86%E8%A8%98-%E4%B8%80/">

  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/https:/pub-da440be71028438aa9683b63bef5ccf1.r2.dev/images/avatar.jpg">
    <meta itemprop="name" content="Rabbir">
    <meta itemprop="description" content=", ">
  </span>

  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="プログラムを書けないうさぎは、ただのうさぎだ。">
  </span>

  <div class="body md" itemprop="articleBody">
    

    <h1 id="專案簡介"><a class="anchor" href="#專案簡介">#</a> 專案簡介</h1>
<p>這個專案由 <code>Vue3</code>  +  <code>mongoDB</code>  +  <code>Cloudflare R2</code>  打造</p>
<h1 id="schema-設計"><a class="anchor" href="#schema-設計">#</a> Schema 設計</h1>
<h2 id="dish"><a class="anchor" href="#dish">#</a> Dish</h2>
<p>餐點相關，餐點部分採用 <code>模板-實例</code> 設計</p>
<h3 id="dishtemplate"><a class="anchor" href="#dishtemplate">#</a> DishTemplate</h3>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">const</span> DishTemplateSchema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mongoose<span class="token punctuation">.</span>Schema</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token literal-property property">basePrice</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> Number<span class="token punctuation">,</span> <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token literal-property property">optionCategories</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token literal-property property">categoryId</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> mongoose<span class="token punctuation">.</span>Schema<span class="token punctuation">.</span>Types<span class="token punctuation">.</span>ObjectId<span class="token punctuation">,</span> <span class="token literal-property property">ref</span><span class="token operator">:</span> <span class="token string">'OptionCategory'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token literal-property property">order</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> Number<span class="token punctuation">,</span> <span class="token keyword">default</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token literal-property property">image</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token comment">// 圖片的實際連結，例如 R2 上的公網地址</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token comment">// 儲存在 R2 的 object key（等同於檔名，可用於刪除）</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token literal-property property">alt</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> String <span class="token punctuation">&#125;</span>                     <span class="token comment">// 可選：給前端 img alt 屬性</span></pre></td></tr><tr><td data-num="12"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="13"></td><td><pre>  <span class="token literal-property property">description</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> String <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="14"></td><td><pre>  <span class="token literal-property property">tags</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> String <span class="token punctuation">&#125;</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="dishinstance"><a class="anchor" href="#dishinstance">#</a> DishInstance</h3>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">const</span> DishInstanceSchema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mongoose<span class="token punctuation">.</span>Schema</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token literal-property property">templateId</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token literal-property property">type</span><span class="token operator">:</span> mongoose<span class="token punctuation">.</span>Schema<span class="token punctuation">.</span>Types<span class="token punctuation">.</span>ObjectId<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token literal-property property">ref</span><span class="token operator">:</span> <span class="token string">'DishTemplate'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token comment">// 冗餘儲存一些模板資訊</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token literal-property property">basePrice</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> Number<span class="token punctuation">,</span> <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token comment">// 客製化選項</span></pre></td></tr><tr><td data-num="11"></td><td><pre>  <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token literal-property property">_id</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token literal-property property">optionCategoryId</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> mongoose<span class="token punctuation">.</span>Schema<span class="token punctuation">.</span>Types<span class="token punctuation">.</span>ObjectId<span class="token punctuation">,</span> <span class="token literal-property property">ref</span><span class="token operator">:</span> <span class="token string">'OptionCategory'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token literal-property property">optionCategoryName</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token literal-property property">selections</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>      <span class="token literal-property property">optionId</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> mongoose<span class="token punctuation">.</span>Schema<span class="token punctuation">.</span>Types<span class="token punctuation">.</span>ObjectId<span class="token punctuation">,</span> <span class="token literal-property property">ref</span><span class="token operator">:</span> <span class="token string">'Option'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="17"></td><td><pre>      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="18"></td><td><pre>      <span class="token literal-property property">price</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> Number<span class="token punctuation">,</span> <span class="token keyword">default</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="20"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="21"></td><td><pre>  <span class="token literal-property property">specialInstructions</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token literal-property property">maxlength</span><span class="token operator">:</span> <span class="token number">200</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token comment">// 特殊要求</span></pre></td></tr><tr><td data-num="22"></td><td><pre>  <span class="token literal-property property">finalPrice</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> Number<span class="token punctuation">,</span> <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token comment">// 計算後的最終價格</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">timestamps</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="optioncategory"><a class="anchor" href="#optioncategory">#</a> OptionCategory</h3>
<p><code>refOption</code>  採取類別指向選項，而不是反過來<br />
原因： <code>options</code>  不會過多，這樣可以節省搜查效率 (<strong>O (1) 對比 O (logN)</strong>)</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">const</span> OptionCategorySchema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mongoose<span class="token punctuation">.</span>Schema</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token literal-property property">inputType</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token keyword">enum</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'single'</span><span class="token punctuation">,</span> <span class="token string">'multiple'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token literal-property property">refOption</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> mongoose<span class="token punctuation">.</span>Schema<span class="token punctuation">.</span>Types<span class="token punctuation">.</span>ObjectId<span class="token punctuation">,</span> <span class="token literal-property property">ref</span><span class="token operator">:</span> <span class="token string">'Option'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token literal-property property">order</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> Number<span class="token punctuation">,</span> <span class="token keyword">default</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="option"><a class="anchor" href="#option">#</a> Option</h3>
<p>refDishTemplate 可選<br />
用在庫存管理時可以連動</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">const</span> OptionSchema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mongoose<span class="token punctuation">.</span>Schema</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token literal-property property">refDishTemplate</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> mongoose<span class="token punctuation">.</span>Schema<span class="token punctuation">.</span>Types<span class="token punctuation">.</span>ObjectId<span class="token punctuation">,</span> <span class="token literal-property property">ref</span><span class="token operator">:</span> <span class="token string">'DishTemplate'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token literal-property property">price</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> Number<span class="token punctuation">,</span> <span class="token keyword">default</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h2 id="store"><a class="anchor" href="#store">#</a> Store</h2>
<h3 id="store-2"><a class="anchor" href="#store-2">#</a> Store</h3>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">const</span> storeSchema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mongoose<span class="token punctuation">.</span>Schema</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token comment">// 店家名稱</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token literal-property property">menuItem</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> mongoose<span class="token punctuation">.</span>Schema<span class="token punctuation">.</span>Types<span class="token punctuation">.</span>ObjectId<span class="token punctuation">,</span> <span class="token literal-property property">ref</span><span class="token operator">:</span> <span class="token string">'Menu'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token comment">// 菜單</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token literal-property property">announcements</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token comment">// 公告名稱</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token literal-property property">content</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span> <span class="token comment">// 公告內容</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token literal-property property">image</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token comment">// 圖片的實際連結，例如 R2 上的公網地址</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token comment">// 儲存在 R2 的 object key（等同於檔名，可用於刪除）</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token literal-property property">alt</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> String <span class="token punctuation">&#125;</span>                     <span class="token comment">// 可選：給前端 img alt 屬性</span></pre></td></tr><tr><td data-num="12"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="stocklog"><a class="anchor" href="#stocklog">#</a> StockLog</h3>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">const</span> StockLogSchema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mongoose<span class="token punctuation">.</span>Schema</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token literal-property property">dish</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> </pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token literal-property property">type</span><span class="token operator">:</span> mongoose<span class="token punctuation">.</span>Schema<span class="token punctuation">.</span>Types<span class="token punctuation">.</span>ObjectId<span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token literal-property property">ref</span><span class="token operator">:</span> <span class="token string">'DishTemplate'</span><span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span> </pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token literal-property property">dishName</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token comment">// 冗餘儲存餐點名稱，方便查詢</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token literal-property property">previousStock</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> Number<span class="token punctuation">,</span> <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token comment">// 變動前庫存</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token literal-property property">newStock</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> Number<span class="token punctuation">,</span> <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token comment">// 變動後庫存</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token literal-property property">changeAmount</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> Number<span class="token punctuation">,</span> <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token comment">// 變動數量 (正數為增加，負數為減少)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>  <span class="token literal-property property">changeType</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> </pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token keyword">enum</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'manual_add'</span><span class="token punctuation">,</span> <span class="token string">'manual_subtract'</span><span class="token punctuation">,</span> <span class="token string">'order'</span><span class="token punctuation">,</span> <span class="token string">'system_adjustment'</span><span class="token punctuation">,</span> <span class="token string">'initial_stock'</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span></pre></td></tr><tr><td data-num="15"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token comment">// 變動類型</span></pre></td></tr><tr><td data-num="16"></td><td><pre>  <span class="token literal-property property">reason</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> String <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token comment">// 變動原因說明 (手動調整時必須提供)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>  <span class="token literal-property property">order</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> </pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token literal-property property">type</span><span class="token operator">:</span> mongoose<span class="token punctuation">.</span>Schema<span class="token punctuation">.</span>Types<span class="token punctuation">.</span>ObjectId<span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token literal-property property">ref</span><span class="token operator">:</span> <span class="token string">'Order'</span> </pre></td></tr><tr><td data-num="20"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token comment">// 關聯訂單 (如果是訂單消耗)</span></pre></td></tr><tr><td data-num="21"></td><td><pre>  <span class="token literal-property property">admin</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> </pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token literal-property property">type</span><span class="token operator">:</span> mongoose<span class="token punctuation">.</span>Schema<span class="token punctuation">.</span>Types<span class="token punctuation">.</span>ObjectId<span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token literal-property property">ref</span><span class="token operator">:</span> <span class="token string">'Admin'</span> </pre></td></tr><tr><td data-num="24"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token comment">// 關聯管理員 (如果是手動調整)</span></pre></td></tr><tr><td data-num="25"></td><td><pre>  <span class="token literal-property property">createdAt</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> Date<span class="token punctuation">,</span> <span class="token keyword">default</span><span class="token operator">:</span> Date<span class="token punctuation">.</span>now <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token comment">// 變動時間</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h2 id="user"><a class="anchor" href="#user">#</a> User</h2>
<h1 id="管理員介面"><a class="anchor" href="#管理員介面">#</a> 管理員介面</h1>
<h2 id="管理員分級制度實作細節"><a class="anchor" href="#管理員分級制度實作細節">#</a> 管理員分級制度實作細節</h2>
<h2 id="登錄系統"><a class="anchor" href="#登錄系統">#</a> 登錄系統</h2>
<h3 id="後端設置"><a class="anchor" href="#後端設置">#</a> 後端設置</h3>
<p>路徑<strong> routes/authentication.js</strong></p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> express <span class="token keyword">from</span> <span class="token string">"express"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> bcrypt <span class="token keyword">from</span> <span class="token string">'bcrypt'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> session <span class="token keyword">from</span> <span class="token string">'express-session'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">import</span> Administrator <span class="token keyword">from</span> <span class="token string">'../schemas/administratorSchema.js'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">const</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>router<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>router<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token literal-property property">secret</span><span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">SESSION_SECRET</span> <span class="token operator">||</span> <span class="token string">'your-secret-key'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token literal-property property">resave</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="11"></td><td><pre>  <span class="token literal-property property">saveUninitialized</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="12"></td><td><pre>  <span class="token literal-property property">cookie</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token literal-property property">maxAge</span><span class="token operator">:</span> <span class="token number">30</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">1000</span> <span class="token comment">// 30 分鐘後過期</span></pre></td></tr><tr><td data-num="14"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre>router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> name<span class="token punctuation">,</span> password <span class="token punctuation">&#125;</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">const</span> admin <span class="token operator">=</span> <span class="token keyword">await</span> Administrator<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> name <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>admin<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// adminname not found</span></pre></td></tr><tr><td data-num="23"></td><td><pre>      <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">401</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'adminname or password arrors'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="25"></td><td><pre></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token keyword">const</span> validPassword <span class="token operator">=</span> <span class="token keyword">await</span> bcrypt<span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span>password<span class="token punctuation">,</span> admin<span class="token punctuation">.</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>validPassword<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>      req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>user_id <span class="token operator">=</span> admin<span class="token punctuation">.</span>_id<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>      <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Login successful'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span> <span class="token comment">// invalid password</span></pre></td></tr><tr><td data-num="31"></td><td><pre>      <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">401</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'adminname or password arrors'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Login error:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Internal server error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre></pre></td></tr><tr><td data-num="39"></td><td><pre>router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/logout'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="40"></td><td><pre>  req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>user_id <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>  res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Logout successful'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="43"></td><td><pre></pre></td></tr><tr><td data-num="44"></td><td><pre>router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/current_user'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>user_id<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="46"></td><td><pre>    <span class="token comment">// 根據需要回傳更多使用者資料</span></pre></td></tr><tr><td data-num="47"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">loggedIn</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token literal-property property">user_id</span><span class="token operator">:</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>user_id <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="48"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="49"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">loggedIn</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="50"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="51"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="52"></td><td><pre></pre></td></tr><tr><td data-num="53"></td><td><pre>router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/createUser'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="54"></td><td><pre>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="55"></td><td><pre>    <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> name<span class="token punctuation">,</span> password <span class="token punctuation">&#125;</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="56"></td><td><pre></pre></td></tr><tr><td data-num="57"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>user_id<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="58"></td><td><pre>      <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">401</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Unauthorized'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="59"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="60"></td><td><pre></pre></td></tr><tr><td data-num="61"></td><td><pre>    <span class="token keyword">const</span> salt <span class="token operator">=</span> <span class="token keyword">await</span> bcrypt<span class="token punctuation">.</span><span class="token function">genSalt</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="62"></td><td><pre>    <span class="token keyword">const</span> hashedPassword <span class="token operator">=</span> <span class="token keyword">await</span> bcrypt<span class="token punctuation">.</span><span class="token function">hash</span><span class="token punctuation">(</span>password<span class="token punctuation">,</span> salt<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="63"></td><td><pre></pre></td></tr><tr><td data-num="64"></td><td><pre>    <span class="token keyword">const</span> newAdmin <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Administrator</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="65"></td><td><pre>      name<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="66"></td><td><pre>      <span class="token literal-property property">password</span><span class="token operator">:</span> hashedPassword</pre></td></tr><tr><td data-num="67"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="68"></td><td><pre></pre></td></tr><tr><td data-num="69"></td><td><pre>    <span class="token keyword">await</span> newAdmin<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="70"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">201</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'User created successfully'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="71"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="72"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Create user error:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="73"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Internal server error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="74"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="75"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="76"></td><td><pre></pre></td></tr><tr><td data-num="77"></td><td><pre>router<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">'/deleteUser/:id'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="78"></td><td><pre>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="79"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>user_id<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="80"></td><td><pre>      <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">401</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Unauthorized'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="81"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="82"></td><td><pre></pre></td></tr><tr><td data-num="83"></td><td><pre>    <span class="token keyword">const</span> userId <span class="token operator">=</span> req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="84"></td><td><pre>    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> Administrator<span class="token punctuation">.</span><span class="token function">findByIdAndDelete</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="85"></td><td><pre></pre></td></tr><tr><td data-num="86"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>result<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="87"></td><td><pre>      <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'User not found'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="88"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="89"></td><td><pre></pre></td></tr><tr><td data-num="90"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'User deleted successfully'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="91"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="92"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Delete user error:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="93"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Internal server error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="94"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="95"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="96"></td><td><pre></pre></td></tr><tr><td data-num="97"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> router<span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="前端登錄頁面"><a class="anchor" href="#前端登錄頁面">#</a> 前端登錄頁面</h3>
<figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>login-container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>Login<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">@submit.prevent</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>handleLogin<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-group<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="6"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Username:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span> <span class="token attr-name">required</span> <span class="token punctuation">/></span></span></pre></td></tr><tr><td data-num="8"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="9"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-group<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Password:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">required</span> <span class="token punctuation">/></span></span></pre></td></tr><tr><td data-num="12"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="13"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Login<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="15"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> ref <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'vue'</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">'axios'</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> useRouter<span class="token punctuation">,</span> useRoute <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'vue-router'</span></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token keyword">const</span> username <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token keyword">const</span> password <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">useRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token keyword">const</span> route <span class="token operator">=</span> <span class="token function">useRoute</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token keyword">const</span> <span class="token constant">API_BASE_URL</span> <span class="token operator">=</span> <span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VITE_API_BASE_URL</span></pre></td></tr><tr><td data-num="28"></td><td><pre></pre></td></tr><tr><td data-num="29"></td><td><pre></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token comment">// 登入函數</span></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">handleLogin</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>    <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">API_BASE_URL</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/authentication/login</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>      <span class="token literal-property property">name</span><span class="token operator">:</span> username<span class="token punctuation">.</span>value<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="35"></td><td><pre>      <span class="token literal-property property">password</span><span class="token operator">:</span> password<span class="token punctuation">.</span>value</pre></td></tr><tr><td data-num="36"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="37"></td><td><pre></pre></td></tr><tr><td data-num="38"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>response<span class="token punctuation">.</span>data <span class="token operator">===</span> <span class="token string">'Login successful'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="39"></td><td><pre></pre></td></tr><tr><td data-num="40"></td><td><pre>      <span class="token comment">// 讀取 query 中的 redirect 參數，若無則預設跳轉到 /admin</span></pre></td></tr><tr><td data-num="41"></td><td><pre>      <span class="token keyword">const</span> redirectPath <span class="token operator">=</span> route<span class="token punctuation">.</span>query<span class="token punctuation">.</span>redirect <span class="token operator">||</span> <span class="token string">'/admin'</span></pre></td></tr><tr><td data-num="42"></td><td><pre>      router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>redirectPath<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="43"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Login failed:'</span><span class="token punctuation">,</span> error<span class="token punctuation">.</span>response <span class="token operator">?</span> error<span class="token punctuation">.</span>response<span class="token punctuation">.</span>data <span class="token operator">:</span> error<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="46"></td><td><pre>    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Login failed: '</span> <span class="token operator">+</span> <span class="token punctuation">(</span>error<span class="token punctuation">.</span>response <span class="token operator">?</span> error<span class="token punctuation">.</span>response<span class="token punctuation">.</span>data <span class="token operator">:</span> error<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="47"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="48"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="49"></td><td><pre></pre></td></tr><tr><td data-num="50"></td><td><pre><span class="token comment">// 共用登出函數（也可放在全局，方便其他元件調用）</span></pre></td></tr><tr><td data-num="51"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">handleLogout</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="52"></td><td><pre>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="53"></td><td><pre>    <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">API_BASE_URL</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/authentication/logout</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="54"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="55"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Logout error:'</span><span class="token punctuation">,</span> error<span class="token punctuation">.</span>response <span class="token operator">?</span> error<span class="token punctuation">.</span>response<span class="token punctuation">.</span>data <span class="token operator">:</span> error<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="56"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="57"></td><td><pre>    localStorage<span class="token punctuation">.</span><span class="token function">removeItem</span><span class="token punctuation">(</span><span class="token string">'authToken'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="58"></td><td><pre>    localStorage<span class="token punctuation">.</span><span class="token function">removeItem</span><span class="token punctuation">(</span><span class="token string">'loginTime'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="59"></td><td><pre>    <span class="token function">clearAutoLogout</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="60"></td><td><pre>    router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="61"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="62"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="63"></td><td><pre></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="64"></td><td><pre></pre></td></tr><tr><td data-num="65"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css"></pre></td></tr><tr><td data-num="66"></td><td><pre><span class="token selector">.login-container</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="67"></td><td><pre>  <span class="token property">max-width</span><span class="token punctuation">:</span> 400px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="68"></td><td><pre>  <span class="token property">margin</span><span class="token punctuation">:</span> 0 auto<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="69"></td><td><pre>  <span class="token property">padding</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="70"></td><td><pre>  <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="71"></td><td><pre>  <span class="token property">border-radius</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="72"></td><td><pre>  <span class="token property">box-shadow</span><span class="token punctuation">:</span> 0 0 10px <span class="token function">rgba</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0.1<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="73"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="74"></td><td><pre></pre></td></tr><tr><td data-num="75"></td><td><pre><span class="token selector">.form-group</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="76"></td><td><pre>  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 15px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="77"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="78"></td><td><pre></pre></td></tr><tr><td data-num="79"></td><td><pre><span class="token selector">label</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="80"></td><td><pre>  <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="81"></td><td><pre>  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="82"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="83"></td><td><pre></pre></td></tr><tr><td data-num="84"></td><td><pre><span class="token selector">input</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="85"></td><td><pre>  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="86"></td><td><pre>  <span class="token property">padding</span><span class="token punctuation">:</span> 8px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="87"></td><td><pre>  <span class="token property">box-sizing</span><span class="token punctuation">:</span> border-box<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="88"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="89"></td><td><pre></pre></td></tr><tr><td data-num="90"></td><td><pre><span class="token selector">button</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="91"></td><td><pre>  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="92"></td><td><pre>  <span class="token property">padding</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="93"></td><td><pre>  <span class="token property">background-color</span><span class="token punctuation">:</span> #007bff<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="94"></td><td><pre>  <span class="token property">color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="95"></td><td><pre>  <span class="token property">border</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="96"></td><td><pre>  <span class="token property">border-radius</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="97"></td><td><pre>  <span class="token property">cursor</span><span class="token punctuation">:</span> pointer<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="98"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="99"></td><td><pre></pre></td></tr><tr><td data-num="100"></td><td><pre><span class="token selector">button:hover</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="101"></td><td><pre>  <span class="token property">background-color</span><span class="token punctuation">:</span> #0056b3<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="102"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="103"></td><td><pre></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><h3 id="router-自動跳轉到登錄介面"><a class="anchor" href="#router-自動跳轉到登錄介面">#</a> router 自動跳轉到登錄介面</h3>
<p>在 <code>routes</code>  裡面設置 <code>meta: { requiresAuth: true }</code></p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">isLoggedIn</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/authentication/current_user</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">return</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>loggedIn<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'檢查登入狀態失敗'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>router<span class="token punctuation">.</span><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> from<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span>to<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>requiresAuth<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token keyword">const</span> loggedIn <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">isLoggedIn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>loggedIn<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>      <span class="token keyword">return</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/login'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token literal-property property">query</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">redirect</span><span class="token operator">:</span> to<span class="token punctuation">.</span>fullPath <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="文檔網址"><a class="anchor" href="#文檔網址">#</a> 文檔網址</h3>
<ul>
<li>express-session<br />
<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2V4cHJlc3Nqcy9zZXNzaW9u">https://github.com/expressjs/session</span></li>
<li>bcrypto<br />
<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2Jjb2luLW9yZy9iY3J5cHRv">https://github.com/bcoin-org/bcrypto</span></li>
</ul>
<h2 id="餐點顯示新增-修改與刪除介面"><a class="anchor" href="#餐點顯示新增-修改與刪除介面">#</a> 餐點顯示，新增、修改與刪除介面</h2>
<h3 id="api"><a class="anchor" href="#api">#</a> API</h3>
<p><code>src\api\modules\dishTemplate.js</code> <br />
 <code>src\api\modules\comboInstance.js</code> <br />
 <code>src\api\modules\comboTemplate.js</code> <br />
 <code>src\api\modules\optionCategory.js</code> <br />
 <code>src\api\modules\option.js</code> <br />
 <code>src\api\modules\image.js</code></p>
<h3 id="顯示"><a class="anchor" href="#顯示">#</a> 顯示</h3>
<ul>
<li>上方 navbar 需要有三項</li>
<li>[ <code>dishTemplate</code> , <code>combo</code> , <code>option</code> ]</li>
<li>每項顯示的方式都差不多每個是一個 card 點進去 進入到 edit 介面 裡面會有儲存修改 或是刪除的按鈕</li>
<li>option 因為沒有圖片 可以條列式顯示 這樣比較節省空間 顯示 optionCatrgory 即可</li>
<li>套餐模板頁面 需列出所有套餐 每個是一個 card 點進去 進入到 edit 介面 裡面會有儲存修改 或是刪除的按鈕</li>
<li>option 的模式是這樣的 外層是 optionCategory 新增修改刪除，然後 card 點進去會進去那個 optionCategory 裡面，這邊是 option 的新增修改刪除介面 (這裡的 option 可以調整順序)</li>
</ul>
<h3 id="新增及修改頁面"><a class="anchor" href="#新增及修改頁面">#</a> 新增及修改頁面</h3>
<ul>
<li>主要頁面是顯示頁面上個段落說明的，右上角會有新增頁面</li>
<li>主要三項新增頁面，</li>
<li>餐點模板 根據模板 <code>schema</code>  該有的要有，然後有選單從現有的 <code>optionCategory</code>  中選擇，可以調每個 <code>optionCategory</code>  的順序，這邊的寫法參考 <code>src\views\admin\menu\add.vue</code>  裡面的箭頭調整順序</li>
<li>修改頁面 跟新增頁面是同個頁面，差在修改頁面需要從資料庫拉原本的資料，然後<strong>儲存</strong>按鈕改成<strong>儲存修改</strong>然後多一個<strong>刪除</strong>按鈕</li>
</ul>
<h2 id="menu新增介面"><a class="anchor" href="#menu新增介面">#</a>  <code>menu</code>  新增介面</h2>
<h3 id="api-2"><a class="anchor" href="#api-2">#</a> API</h3>
<p>根據 <code>menuSchema.js</code>  還有一些身分驗證</p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> express <span class="token keyword">from</span> <span class="token string">'express'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> Menu <span class="token keyword">from</span> <span class="token string">'../schemas/menuSchema.js'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">const</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">checkAuth</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>user_id<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">401</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">'Unauthorized'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token comment">// 取得 menu</span></pre></td></tr><tr><td data-num="14"></td><td><pre>router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">const</span> menu <span class="token operator">=</span> <span class="token keyword">await</span> Menu<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>menu<span class="token punctuation">)</span> <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">error</span><span class="token operator">:</span> <span class="token string">'Menu not found'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>menu<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Error getting menu:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Internal server error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token comment">// 取得單個 menu</span></pre></td></tr><tr><td data-num="27"></td><td><pre></pre></td></tr><tr><td data-num="28"></td><td><pre>router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/:id'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> id <span class="token punctuation">&#125;</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>params<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token keyword">const</span> menu <span class="token operator">=</span> <span class="token keyword">await</span> Menu<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>menu<span class="token punctuation">)</span> <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">error</span><span class="token operator">:</span> <span class="token string">'Menu not found'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre></pre></td></tr><tr><td data-num="34"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>menu<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Error getting menu:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Internal server error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="40"></td><td><pre></pre></td></tr><tr><td data-num="41"></td><td><pre><span class="token comment">// 創建 menu</span></pre></td></tr><tr><td data-num="42"></td><td><pre>router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> checkAuth<span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>    <span class="token keyword">const</span> newMenu <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Menu</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>    <span class="token keyword">await</span> newMenu<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="46"></td><td><pre></pre></td></tr><tr><td data-num="47"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Menu created successfully'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="48"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="49"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Error creating menu:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="50"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Internal server error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="51"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="52"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="53"></td><td><pre></pre></td></tr><tr><td data-num="54"></td><td><pre><span class="token comment">// 更新 menu</span></pre></td></tr><tr><td data-num="55"></td><td><pre>router<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">'/:id'</span><span class="token punctuation">,</span> checkAuth<span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="56"></td><td><pre>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="57"></td><td><pre>    <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> id <span class="token punctuation">&#125;</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>params<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="58"></td><td><pre>    <span class="token keyword">await</span> Menu<span class="token punctuation">.</span><span class="token function">findByIdAndUpdate</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> req<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="59"></td><td><pre></pre></td></tr><tr><td data-num="60"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Menu updated successfully'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="61"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="62"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Error updating menu:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="63"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Internal server error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="64"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="65"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="66"></td><td><pre></pre></td></tr><tr><td data-num="67"></td><td><pre><span class="token comment">// 刪除 menu</span></pre></td></tr><tr><td data-num="68"></td><td><pre>router<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">'/:id'</span><span class="token punctuation">,</span> checkAuth<span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="69"></td><td><pre>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="70"></td><td><pre>    <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> id <span class="token punctuation">&#125;</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>params<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="71"></td><td><pre>    <span class="token keyword">await</span> Menu<span class="token punctuation">.</span><span class="token function">findByIdAndDelete</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="72"></td><td><pre></pre></td></tr><tr><td data-num="73"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Menu deleted successfully'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="74"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="75"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Error deleting menu:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="76"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Internal server error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="77"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="78"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="79"></td><td><pre></pre></td></tr><tr><td data-num="80"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> router<span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="新增"><a class="anchor" href="#新增">#</a> 新增</h3>
<figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container py-4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token comment">&lt;!-- 菜單名稱 --></span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>card mb-4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>card-body<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="6"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-label<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>菜單名稱<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> </pre></td></tr><tr><td data-num="8"></td><td><pre>          <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>menuName<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="9"></td><td><pre>          <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="10"></td><td><pre>          <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-control<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="11"></td><td><pre>          <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>輸入菜單名稱<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="12"></td><td><pre>        <span class="token punctuation">/></span></span></pre></td></tr><tr><td data-num="13"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="15"></td><td><pre>    </pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token comment">&lt;!-- 菜單類別列表 --></span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mb-4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="18"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>(category, categoryIndex) in menuData<span class="token punctuation">"</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>categoryIndex<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>card mb-3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>card-body<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="20"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>d-flex justify-content-between align-items-start mb-3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="21"></td><td><pre>            <span class="token comment">&lt;!-- 類別名稱 --></span></pre></td></tr><tr><td data-num="22"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>flex-grow-1 me-3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="23"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-label<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>類別名稱<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="24"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> </pre></td></tr><tr><td data-num="25"></td><td><pre>                <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>category.categoryName<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="26"></td><td><pre>                <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="27"></td><td><pre>                <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-control<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="28"></td><td><pre>                <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>輸入類別名稱（例如：主餐、附餐）<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="29"></td><td><pre>              <span class="token punctuation">/></span></span></pre></td></tr><tr><td data-num="30"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="31"></td><td><pre>            <span class="token comment">&lt;!-- 類別排序控制 --></span></pre></td></tr><tr><td data-num="32"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn-group<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="33"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> </pre></td></tr><tr><td data-num="34"></td><td><pre>                <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>moveCategory(categoryIndex, -1)<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="35"></td><td><pre>                <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-outline-secondary<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="36"></td><td><pre>                <span class="token attr-name">:disabled</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>categoryIndex === 0<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="37"></td><td><pre>              <span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="38"></td><td><pre>                ↑</pre></td></tr><tr><td data-num="39"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="40"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> </pre></td></tr><tr><td data-num="41"></td><td><pre>                <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>moveCategory(categoryIndex, 1)<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="42"></td><td><pre>                <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-outline-secondary<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="43"></td><td><pre>                <span class="token attr-name">:disabled</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>categoryIndex === menuData.length - 1<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="44"></td><td><pre>              <span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="45"></td><td><pre>                ↓</pre></td></tr><tr><td data-num="46"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="47"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="48"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="49"></td><td><pre></pre></td></tr><tr><td data-num="50"></td><td><pre>          <span class="token comment">&lt;!-- 餐點列表 --></span></pre></td></tr><tr><td data-num="51"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mb-3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="52"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h5</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>card-title<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>餐點項目<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h5</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="53"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>list-group<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="54"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> </pre></td></tr><tr><td data-num="55"></td><td><pre>                <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>(item, itemIndex) in category.items<span class="token punctuation">"</span></span> </pre></td></tr><tr><td data-num="56"></td><td><pre>                <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>itemIndex<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="57"></td><td><pre>                <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>list-group-item<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="58"></td><td><pre>              <span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="59"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>row align-items-center<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="60"></td><td><pre>                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>col<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="61"></td><td><pre>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> </pre></td></tr><tr><td data-num="62"></td><td><pre>                      <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item.itemModel<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="63"></td><td><pre>                      <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-select mb-2<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="64"></td><td><pre>                      <span class="token attr-name">@change</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item.itemId = null<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="65"></td><td><pre>                    <span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="66"></td><td><pre>                      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>選擇餐點類型<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="67"></td><td><pre>                      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>MainDish<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>主餐<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="68"></td><td><pre>                      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ElseDish<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>其他餐點<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="69"></td><td><pre>                      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>RawMeat<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>食材<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="70"></td><td><pre>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="71"></td><td><pre>                    </pre></td></tr><tr><td data-num="72"></td><td><pre>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> </pre></td></tr><tr><td data-num="73"></td><td><pre>                      <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item.itemModel<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="74"></td><td><pre>                      <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item.itemId<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="75"></td><td><pre>                      <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-select<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="76"></td><td><pre>                    <span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="77"></td><td><pre>                      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>選擇餐點<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="78"></td><td><pre>                      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> </pre></td></tr><tr><td data-num="79"></td><td><pre>                        <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dish in getDishes(item.itemModel)<span class="token punctuation">"</span></span> </pre></td></tr><tr><td data-num="80"></td><td><pre>                        <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dish._id<span class="token punctuation">"</span></span> </pre></td></tr><tr><td data-num="81"></td><td><pre>                        <span class="token attr-name">:value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dish._id<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="82"></td><td><pre>                      <span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="83"></td><td><pre>                        &#123;&#123; dish.name &#125;&#125; - $&#123;&#123; dish.price &#125;&#125;</pre></td></tr><tr><td data-num="84"></td><td><pre>                      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="85"></td><td><pre>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="86"></td><td><pre>                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="87"></td><td><pre>                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>col-auto<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="88"></td><td><pre>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn-group<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="89"></td><td><pre>                      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> </pre></td></tr><tr><td data-num="90"></td><td><pre>                        <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>moveItem(categoryIndex, itemIndex, -1)<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="91"></td><td><pre>                        <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-outline-secondary<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="92"></td><td><pre>                        <span class="token attr-name">:disabled</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>itemIndex === 0<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="93"></td><td><pre>                      <span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="94"></td><td><pre>                        ↑</pre></td></tr><tr><td data-num="95"></td><td><pre>                      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="96"></td><td><pre>                      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> </pre></td></tr><tr><td data-num="97"></td><td><pre>                        <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>moveItem(categoryIndex, itemIndex, 1)<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="98"></td><td><pre>                        <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-outline-secondary<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="99"></td><td><pre>                        <span class="token attr-name">:disabled</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>itemIndex === category.items.length - 1<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="100"></td><td><pre>                      <span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="101"></td><td><pre>                        ↓</pre></td></tr><tr><td data-num="102"></td><td><pre>                      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="103"></td><td><pre>                      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> </pre></td></tr><tr><td data-num="104"></td><td><pre>                        <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>removeItem(categoryIndex, itemIndex)<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="105"></td><td><pre>                        <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-outline-danger<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="106"></td><td><pre>                      <span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="107"></td><td><pre>                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>bi bi-trash<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="108"></td><td><pre>                      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="109"></td><td><pre>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="110"></td><td><pre>                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="111"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="112"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="113"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="114"></td><td><pre></pre></td></tr><tr><td data-num="115"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> </pre></td></tr><tr><td data-num="116"></td><td><pre>              <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>addItem(category)<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="117"></td><td><pre>              <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-outline-primary mt-2<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="118"></td><td><pre>            <span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="119"></td><td><pre>              新增餐點</pre></td></tr><tr><td data-num="120"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="121"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="122"></td><td><pre></pre></td></tr><tr><td data-num="123"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> </pre></td></tr><tr><td data-num="124"></td><td><pre>            <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>removeCategory(categoryIndex)<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="125"></td><td><pre>            <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-danger<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="126"></td><td><pre>          <span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="127"></td><td><pre>            刪除類別</pre></td></tr><tr><td data-num="128"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="129"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="130"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="131"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="132"></td><td><pre></pre></td></tr><tr><td data-num="133"></td><td><pre>    <span class="token comment">&lt;!-- 控制按鈕 --></span></pre></td></tr><tr><td data-num="134"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>d-flex gap-2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="135"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> </pre></td></tr><tr><td data-num="136"></td><td><pre>        <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>addCategory<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="137"></td><td><pre>        <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-primary<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="138"></td><td><pre>      <span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="139"></td><td><pre>        新增類別</pre></td></tr><tr><td data-num="140"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="141"></td><td><pre>      </pre></td></tr><tr><td data-num="142"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> </pre></td></tr><tr><td data-num="143"></td><td><pre>        <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>saveMenu<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="144"></td><td><pre>        <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-success<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="145"></td><td><pre>        <span class="token attr-name">:disabled</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>!isValid<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="146"></td><td><pre>      <span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="147"></td><td><pre>        儲存菜單</pre></td></tr><tr><td data-num="148"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="149"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="150"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="151"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="152"></td><td><pre></pre></td></tr><tr><td data-num="153"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"></pre></td></tr><tr><td data-num="154"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> ref<span class="token punctuation">,</span> computed<span class="token punctuation">,</span> onMounted <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'vue'</span></pre></td></tr><tr><td data-num="155"></td><td><pre><span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">'axios'</span></pre></td></tr><tr><td data-num="156"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> useRouter <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'vue-router'</span></pre></td></tr><tr><td data-num="157"></td><td><pre></pre></td></tr><tr><td data-num="158"></td><td><pre><span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">useRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="159"></td><td><pre><span class="token keyword">const</span> <span class="token constant">API_BASE_URL</span> <span class="token operator">=</span> <span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VITE_API_BASE_URL</span></pre></td></tr><tr><td data-num="160"></td><td><pre></pre></td></tr><tr><td data-num="161"></td><td><pre><span class="token comment">// 資料狀態</span></pre></td></tr><tr><td data-num="162"></td><td><pre><span class="token keyword">const</span> menuName <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="163"></td><td><pre><span class="token keyword">const</span> menuData <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="164"></td><td><pre><span class="token keyword">const</span> mainDishes <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="165"></td><td><pre><span class="token keyword">const</span> elseDishes <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="166"></td><td><pre><span class="token keyword">const</span> rawMeats <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="167"></td><td><pre></pre></td></tr><tr><td data-num="168"></td><td><pre><span class="token comment">// 根據餐點類型獲取對應的餐點列表</span></pre></td></tr><tr><td data-num="169"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">getDishes</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">itemModel</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="170"></td><td><pre>  <span class="token keyword">switch</span> <span class="token punctuation">(</span>itemModel<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="171"></td><td><pre>    <span class="token keyword">case</span> <span class="token string">'MainDish'</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="172"></td><td><pre>      <span class="token keyword">return</span> mainDishes<span class="token punctuation">.</span>value</pre></td></tr><tr><td data-num="173"></td><td><pre>    <span class="token keyword">case</span> <span class="token string">'ElseDish'</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="174"></td><td><pre>      <span class="token keyword">return</span> elseDishes<span class="token punctuation">.</span>value</pre></td></tr><tr><td data-num="175"></td><td><pre>    <span class="token keyword">case</span> <span class="token string">'RawMeat'</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="176"></td><td><pre>      <span class="token keyword">return</span> rawMeats<span class="token punctuation">.</span>value</pre></td></tr><tr><td data-num="177"></td><td><pre>    <span class="token keyword">default</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="178"></td><td><pre>      <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="179"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="180"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="181"></td><td><pre></pre></td></tr><tr><td data-num="182"></td><td><pre><span class="token comment">// 獲取指定類型的餐點</span></pre></td></tr><tr><td data-num="183"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">fetchDishes</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">endpoint</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="184"></td><td><pre>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="185"></td><td><pre>    <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">API_BASE_URL</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/dish</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>endpoint<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="186"></td><td><pre>    <span class="token keyword">return</span> response<span class="token punctuation">.</span>data</pre></td></tr><tr><td data-num="187"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="188"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Error fetching dishes:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="189"></td><td><pre>    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="190"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="191"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="192"></td><td><pre></pre></td></tr><tr><td data-num="193"></td><td><pre><span class="token comment">// 初始化時獲取所有類型的餐點</span></pre></td></tr><tr><td data-num="194"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">initializeDishes</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="195"></td><td><pre>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="196"></td><td><pre>    <span class="token keyword">const</span> <span class="token punctuation">[</span>mainResponse<span class="token punctuation">,</span> elseResponse<span class="token punctuation">,</span> rawResponse<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span></pre></td></tr><tr><td data-num="197"></td><td><pre>      <span class="token function">fetchDishes</span><span class="token punctuation">(</span><span class="token string">'/mainDish'</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="198"></td><td><pre>      <span class="token function">fetchDishes</span><span class="token punctuation">(</span><span class="token string">'/elseDish'</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="199"></td><td><pre>      <span class="token function">fetchDishes</span><span class="token punctuation">(</span><span class="token string">'/rawMeat'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="200"></td><td><pre>    <span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="201"></td><td><pre>    </pre></td></tr><tr><td data-num="202"></td><td><pre>    mainDishes<span class="token punctuation">.</span>value <span class="token operator">=</span> mainResponse</pre></td></tr><tr><td data-num="203"></td><td><pre>    elseDishes<span class="token punctuation">.</span>value <span class="token operator">=</span> elseResponse</pre></td></tr><tr><td data-num="204"></td><td><pre>    rawMeats<span class="token punctuation">.</span>value <span class="token operator">=</span> rawResponse</pre></td></tr><tr><td data-num="205"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="206"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Error initializing dishes:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="207"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="208"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="209"></td><td><pre></pre></td></tr><tr><td data-num="210"></td><td><pre><span class="token comment">// 新增類別</span></pre></td></tr><tr><td data-num="211"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">addCategory</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="212"></td><td><pre>  menuData<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="213"></td><td><pre>    <span class="token literal-property property">categoryName</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="214"></td><td><pre>    <span class="token literal-property property">items</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="215"></td><td><pre>    <span class="token literal-property property">order</span><span class="token operator">:</span> menuData<span class="token punctuation">.</span>value<span class="token punctuation">.</span>length</pre></td></tr><tr><td data-num="216"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="217"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="218"></td><td><pre></pre></td></tr><tr><td data-num="219"></td><td><pre><span class="token comment">// 刪除類別</span></pre></td></tr><tr><td data-num="220"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">removeCategory</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">index</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="221"></td><td><pre>  menuData<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="222"></td><td><pre>  <span class="token function">updateCategoryOrders</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="223"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="224"></td><td><pre></pre></td></tr><tr><td data-num="225"></td><td><pre><span class="token comment">// 新增餐點項目</span></pre></td></tr><tr><td data-num="226"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">addItem</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">category</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="227"></td><td><pre>  category<span class="token punctuation">.</span>items<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="228"></td><td><pre>    <span class="token literal-property property">itemModel</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="229"></td><td><pre>    <span class="token literal-property property">itemId</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="230"></td><td><pre>    <span class="token literal-property property">order</span><span class="token operator">:</span> category<span class="token punctuation">.</span>items<span class="token punctuation">.</span>length</pre></td></tr><tr><td data-num="231"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="232"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="233"></td><td><pre></pre></td></tr><tr><td data-num="234"></td><td><pre><span class="token comment">// 刪除餐點項目</span></pre></td></tr><tr><td data-num="235"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">removeItem</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">categoryIndex<span class="token punctuation">,</span> itemIndex</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="236"></td><td><pre>  menuData<span class="token punctuation">.</span>value<span class="token punctuation">[</span>categoryIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>items<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>itemIndex<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="237"></td><td><pre>  <span class="token function">updateItemOrders</span><span class="token punctuation">(</span>categoryIndex<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="238"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="239"></td><td><pre></pre></td></tr><tr><td data-num="240"></td><td><pre><span class="token comment">// 移動類別</span></pre></td></tr><tr><td data-num="241"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">moveCategory</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">categoryIndex<span class="token punctuation">,</span> direction</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="242"></td><td><pre>  <span class="token keyword">const</span> newIndex <span class="token operator">=</span> categoryIndex <span class="token operator">+</span> direction</pre></td></tr><tr><td data-num="243"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span>newIndex <span class="token operator">>=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> newIndex <span class="token operator">&lt;</span> menuData<span class="token punctuation">.</span>value<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="244"></td><td><pre>    <span class="token keyword">const</span> temp <span class="token operator">=</span> menuData<span class="token punctuation">.</span>value<span class="token punctuation">[</span>categoryIndex<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="245"></td><td><pre>    menuData<span class="token punctuation">.</span>value<span class="token punctuation">[</span>categoryIndex<span class="token punctuation">]</span> <span class="token operator">=</span> menuData<span class="token punctuation">.</span>value<span class="token punctuation">[</span>newIndex<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="246"></td><td><pre>    menuData<span class="token punctuation">.</span>value<span class="token punctuation">[</span>newIndex<span class="token punctuation">]</span> <span class="token operator">=</span> temp</pre></td></tr><tr><td data-num="247"></td><td><pre>    <span class="token function">updateCategoryOrders</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="248"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="249"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="250"></td><td><pre></pre></td></tr><tr><td data-num="251"></td><td><pre><span class="token comment">// 移動項目</span></pre></td></tr><tr><td data-num="252"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">moveItem</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">categoryIndex<span class="token punctuation">,</span> itemIndex<span class="token punctuation">,</span> direction</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="253"></td><td><pre>  <span class="token keyword">const</span> newIndex <span class="token operator">=</span> itemIndex <span class="token operator">+</span> direction</pre></td></tr><tr><td data-num="254"></td><td><pre>  <span class="token keyword">const</span> items <span class="token operator">=</span> menuData<span class="token punctuation">.</span>value<span class="token punctuation">[</span>categoryIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>items</pre></td></tr><tr><td data-num="255"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span>newIndex <span class="token operator">>=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> newIndex <span class="token operator">&lt;</span> items<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="256"></td><td><pre>    <span class="token keyword">const</span> temp <span class="token operator">=</span> items<span class="token punctuation">[</span>itemIndex<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="257"></td><td><pre>    items<span class="token punctuation">[</span>itemIndex<span class="token punctuation">]</span> <span class="token operator">=</span> items<span class="token punctuation">[</span>newIndex<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="258"></td><td><pre>    items<span class="token punctuation">[</span>newIndex<span class="token punctuation">]</span> <span class="token operator">=</span> temp</pre></td></tr><tr><td data-num="259"></td><td><pre>    <span class="token function">updateItemOrders</span><span class="token punctuation">(</span>categoryIndex<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="260"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="261"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="262"></td><td><pre></pre></td></tr><tr><td data-num="263"></td><td><pre><span class="token comment">// 更新類別順序</span></pre></td></tr><tr><td data-num="264"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">updateCategoryOrders</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="265"></td><td><pre>  menuData<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">category<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="266"></td><td><pre>    category<span class="token punctuation">.</span>order <span class="token operator">=</span> index</pre></td></tr><tr><td data-num="267"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="268"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="269"></td><td><pre></pre></td></tr><tr><td data-num="270"></td><td><pre><span class="token comment">// 更新項目順序</span></pre></td></tr><tr><td data-num="271"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">updateItemOrders</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">categoryIndex</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="272"></td><td><pre>  menuData<span class="token punctuation">.</span>value<span class="token punctuation">[</span>categoryIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>items<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="273"></td><td><pre>    item<span class="token punctuation">.</span>order <span class="token operator">=</span> index</pre></td></tr><tr><td data-num="274"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="275"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="276"></td><td><pre></pre></td></tr><tr><td data-num="277"></td><td><pre><span class="token comment">// 驗證表單</span></pre></td></tr><tr><td data-num="278"></td><td><pre><span class="token keyword">const</span> isValid <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="279"></td><td><pre>  <span class="token keyword">return</span> menuName<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token string">''</span> <span class="token operator">&amp;&amp;</span> </pre></td></tr><tr><td data-num="280"></td><td><pre>    menuData<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">every</span><span class="token punctuation">(</span><span class="token parameter">category</span> <span class="token operator">=></span> </pre></td></tr><tr><td data-num="281"></td><td><pre>      category<span class="token punctuation">.</span>categoryName<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token string">''</span> <span class="token operator">&amp;&amp;</span></pre></td></tr><tr><td data-num="282"></td><td><pre>      category<span class="token punctuation">.</span>items<span class="token punctuation">.</span><span class="token function">every</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=></span> </pre></td></tr><tr><td data-num="283"></td><td><pre>        item<span class="token punctuation">.</span>itemModel <span class="token operator">&amp;&amp;</span> item<span class="token punctuation">.</span>itemId</pre></td></tr><tr><td data-num="284"></td><td><pre>      <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="285"></td><td><pre>    <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="286"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="287"></td><td><pre></pre></td></tr><tr><td data-num="288"></td><td><pre><span class="token comment">// 儲存菜單</span></pre></td></tr><tr><td data-num="289"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">saveMenu</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="290"></td><td><pre>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="291"></td><td><pre>    <span class="token keyword">const</span> menuToSave <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="292"></td><td><pre>      <span class="token literal-property property">name</span><span class="token operator">:</span> menuName<span class="token punctuation">.</span>value<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="293"></td><td><pre>      <span class="token literal-property property">list</span><span class="token operator">:</span> menuData<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">category<span class="token punctuation">,</span> categoryIndex</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="294"></td><td><pre>        <span class="token literal-property property">categoryName</span><span class="token operator">:</span> category<span class="token punctuation">.</span>categoryName<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="295"></td><td><pre>        <span class="token literal-property property">order</span><span class="token operator">:</span> categoryIndex<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="296"></td><td><pre>        <span class="token literal-property property">items</span><span class="token operator">:</span> category<span class="token punctuation">.</span>items<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> itemIndex</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="297"></td><td><pre>          <span class="token literal-property property">itemModel</span><span class="token operator">:</span> item<span class="token punctuation">.</span>itemModel<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="298"></td><td><pre>          <span class="token literal-property property">itemId</span><span class="token operator">:</span> item<span class="token punctuation">.</span>itemId<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="299"></td><td><pre>          <span class="token literal-property property">order</span><span class="token operator">:</span> itemIndex</pre></td></tr><tr><td data-num="300"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="301"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="302"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="303"></td><td><pre>    </pre></td></tr><tr><td data-num="304"></td><td><pre>    <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">API_BASE_URL</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/menu</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> menuToSave<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="305"></td><td><pre>    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'菜單儲存成功！'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="306"></td><td><pre>    router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'./show'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="307"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="308"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Error saving menu:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="309"></td><td><pre>    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'儲存失敗，請稍後再試'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="310"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="311"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="312"></td><td><pre></pre></td></tr><tr><td data-num="313"></td><td><pre><span class="token comment">// 初始化</span></pre></td></tr><tr><td data-num="314"></td><td><pre><span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="315"></td><td><pre>  <span class="token function">initializeDishes</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="316"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="317"></td><td><pre></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><h3 id="顯示-2"><a class="anchor" href="#顯示-2">#</a> 顯示</h3>
<figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container py-4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>d-flex justify-content-between align-items-center mb-4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>菜單列表<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>./add<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-primary<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="6"></td><td><pre>        新增菜單</pre></td></tr><tr><td data-num="7"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token comment">&lt;!-- 讀取中提示 --></span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>loading<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text-center py-5<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="12"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>spinner-border<span class="token punctuation">"</span></span> <span class="token attr-name">role</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>status<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>visually-hidden<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Loading...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="14"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token comment">&lt;!-- 錯誤提示 --></span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-else-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>error<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>alert alert-danger<span class="token punctuation">"</span></span> <span class="token attr-name">role</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>alert<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="19"></td><td><pre>      &#123;&#123; error &#125;&#125;</pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token comment">&lt;!-- 菜單列表 --></span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-else</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>row g-4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="24"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>menu in menus<span class="token punctuation">"</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>menu._id<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>col-12<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="25"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>card h-100 hover-shadow<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">cursor</span><span class="token punctuation">:</span> pointer<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>goToEdit(menu._id)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="26"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>card-body<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="27"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>d-flex justify-content-between align-items-start<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="28"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="29"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h5</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>card-title<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>&#123;&#123; menu.name &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h5</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="30"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>card-text text-muted<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="31"></td><td><pre>                  &#123;&#123; menu.list.length &#125;&#125; 個類別，</pre></td></tr><tr><td data-num="32"></td><td><pre>                  總計 &#123;&#123; getTotalItems(menu) &#125;&#125; 個項目</pre></td></tr><tr><td data-num="33"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="34"></td><td><pre></pre></td></tr><tr><td data-num="35"></td><td><pre>                <span class="token comment">&lt;!-- 類別預覽 --></span></pre></td></tr><tr><td data-num="36"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>small text-muted<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="37"></td><td><pre>                  類別：</pre></td></tr><tr><td data-num="38"></td><td><pre>                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>(category, index) in menu.list<span class="token punctuation">"</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>index<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="39"></td><td><pre>                    &#123;&#123; category.categoryName &#125;&#125;&#123;&#123; index &lt; menu.list.length - 1 ? '、' : '' &#125;&#125; <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="40"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="41"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="42"></td><td><pre></pre></td></tr><tr><td data-num="43"></td><td><pre>              <span class="token comment">&lt;!-- 操作按鈕 --></span></pre></td></tr><tr><td data-num="44"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn-group<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="45"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-outline-primary btn-sm<span class="token punctuation">"</span></span> <span class="token attr-name">@click.stop</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>goToEdit(menu._id)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="46"></td><td><pre>                  編輯</pre></td></tr><tr><td data-num="47"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="48"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-outline-danger btn-sm<span class="token punctuation">"</span></span> <span class="token attr-name">@click.stop</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>confirmDelete(menu)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="49"></td><td><pre>                  刪除</pre></td></tr><tr><td data-num="50"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="51"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="52"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="53"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="54"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="55"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="56"></td><td><pre></pre></td></tr><tr><td data-num="57"></td><td><pre>      <span class="token comment">&lt;!-- 無資料提示 --></span></pre></td></tr><tr><td data-num="58"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>menus.length === 0<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>col-12<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="59"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text-center py-5 text-muted<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="60"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>目前沒有菜單<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="61"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>./add<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-primary<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="62"></td><td><pre>            新增第一個菜單</pre></td></tr><tr><td data-num="63"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="64"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="65"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="66"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="67"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="68"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="69"></td><td><pre></pre></td></tr><tr><td data-num="70"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"></pre></td></tr><tr><td data-num="71"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> ref<span class="token punctuation">,</span> onMounted <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'vue'</span></pre></td></tr><tr><td data-num="72"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> useRouter <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'vue-router'</span></pre></td></tr><tr><td data-num="73"></td><td><pre><span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">'axios'</span></pre></td></tr><tr><td data-num="74"></td><td><pre></pre></td></tr><tr><td data-num="75"></td><td><pre><span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">useRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="76"></td><td><pre><span class="token keyword">const</span> <span class="token constant">API_BASE_URL</span> <span class="token operator">=</span> <span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VITE_API_BASE_URL</span></pre></td></tr><tr><td data-num="77"></td><td><pre><span class="token keyword">const</span> menus <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="78"></td><td><pre><span class="token keyword">const</span> loading <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="79"></td><td><pre><span class="token keyword">const</span> error <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="80"></td><td><pre></pre></td></tr><tr><td data-num="81"></td><td><pre><span class="token comment">// 獲取所有菜單</span></pre></td></tr><tr><td data-num="82"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">fetchMenus</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="83"></td><td><pre>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="84"></td><td><pre>    loading<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span></pre></td></tr><tr><td data-num="85"></td><td><pre>    error<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">null</span></pre></td></tr><tr><td data-num="86"></td><td><pre>    <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">API_BASE_URL</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/menu</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="87"></td><td><pre>    menus<span class="token punctuation">.</span>value <span class="token operator">=</span> response<span class="token punctuation">.</span>data</pre></td></tr><tr><td data-num="88"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="89"></td><td><pre>    error<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">'獲取菜單列表失敗，請稍後再試'</span></pre></td></tr><tr><td data-num="90"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Error fetching menus:'</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="91"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="92"></td><td><pre>    loading<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span></pre></td></tr><tr><td data-num="93"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="94"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="95"></td><td><pre></pre></td></tr><tr><td data-num="96"></td><td><pre><span class="token comment">// 計算總項目數</span></pre></td></tr><tr><td data-num="97"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">getTotalItems</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">menu</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="98"></td><td><pre>  <span class="token keyword">return</span> menu<span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">total<span class="token punctuation">,</span> category</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="99"></td><td><pre>    <span class="token keyword">return</span> total <span class="token operator">+</span> category<span class="token punctuation">.</span>items<span class="token punctuation">.</span>length</pre></td></tr><tr><td data-num="100"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="101"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="102"></td><td><pre></pre></td></tr><tr><td data-num="103"></td><td><pre><span class="token comment">// 跳轉到菜單詳情頁</span></pre></td></tr><tr><td data-num="104"></td><td><pre><span class="token comment">// const goToMenu = (id) => &#123;</span></pre></td></tr><tr><td data-num="105"></td><td><pre><span class="token comment">// 	router.push(`/menu/$&#123;id&#125;`)</span></pre></td></tr><tr><td data-num="106"></td><td><pre><span class="token comment">// &#125;</span></pre></td></tr><tr><td data-num="107"></td><td><pre></pre></td></tr><tr><td data-num="108"></td><td><pre><span class="token comment">// 跳轉到編輯頁面</span></pre></td></tr><tr><td data-num="109"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">goToEdit</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="110"></td><td><pre>  router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">./</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>id<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="111"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="112"></td><td><pre></pre></td></tr><tr><td data-num="113"></td><td><pre><span class="token comment">// 確認刪除</span></pre></td></tr><tr><td data-num="114"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">confirmDelete</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">menu</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="115"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">confirm</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">確定要刪除菜單 "</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>menu<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">" 嗎？</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="116"></td><td><pre>    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="117"></td><td><pre>      <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">API_BASE_URL</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/menu/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>menu<span class="token punctuation">.</span>_id<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="118"></td><td><pre>      <span class="token keyword">await</span> <span class="token function">fetchMenus</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 重新獲取列表</span></pre></td></tr><tr><td data-num="119"></td><td><pre>    <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="120"></td><td><pre>      <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'刪除失敗，請稍後再試'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="121"></td><td><pre>      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Error deleting menu:'</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="122"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="123"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="124"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="125"></td><td><pre></pre></td></tr><tr><td data-num="126"></td><td><pre><span class="token comment">// 初始化</span></pre></td></tr><tr><td data-num="127"></td><td><pre><span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="128"></td><td><pre>  <span class="token function">fetchMenus</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="129"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="130"></td><td><pre></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="131"></td><td><pre></pre></td></tr><tr><td data-num="132"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css"></pre></td></tr><tr><td data-num="133"></td><td><pre><span class="token selector">.hover-shadow</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="134"></td><td><pre>  <span class="token property">transition</span><span class="token punctuation">:</span> box-shadow 0.3s ease<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="135"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="136"></td><td><pre></pre></td></tr><tr><td data-num="137"></td><td><pre><span class="token selector">.hover-shadow:hover</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="138"></td><td><pre>  <span class="token property">box-shadow</span><span class="token punctuation">:</span> 0 0.5rem 1rem <span class="token function">rgba</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0.15<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="139"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="140"></td><td><pre></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><h3 id="修改與刪除"><a class="anchor" href="#修改與刪除">#</a> 修改與刪除</h3>
<figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container py-4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token comment">&lt;!-- 載入中提示 --></span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>loading<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text-center py-5<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>spinner-border<span class="token punctuation">"</span></span> <span class="token attr-name">role</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>status<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="6"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>visually-hidden<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Loading...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token comment">&lt;!-- 錯誤提示 --></span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-else-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>error<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>alert alert-danger<span class="token punctuation">"</span></span> <span class="token attr-name">role</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>alert<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="12"></td><td><pre>      &#123;&#123; error &#125;&#125;</pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">v-else</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="16"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>d-flex justify-content-between align-items-center mb-4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>&#123;&#123; isEditing ? '編輯菜單' : '菜單詳情' &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn-group<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="19"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> </pre></td></tr><tr><td data-num="20"></td><td><pre>            <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>!isEditing<span class="token punctuation">"</span></span> </pre></td></tr><tr><td data-num="21"></td><td><pre>            <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>isEditing = true<span class="token punctuation">"</span></span> </pre></td></tr><tr><td data-num="22"></td><td><pre>            <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-primary<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="23"></td><td><pre>          <span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="24"></td><td><pre>            編輯</pre></td></tr><tr><td data-num="25"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="26"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> </pre></td></tr><tr><td data-num="27"></td><td><pre>            <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>!isEditing<span class="token punctuation">"</span></span> </pre></td></tr><tr><td data-num="28"></td><td><pre>            <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>confirmDelete<span class="token punctuation">"</span></span> </pre></td></tr><tr><td data-num="29"></td><td><pre>            <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-danger<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="30"></td><td><pre>          <span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="31"></td><td><pre>            刪除</pre></td></tr><tr><td data-num="32"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="33"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> </pre></td></tr><tr><td data-num="34"></td><td><pre>            <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>isEditing<span class="token punctuation">"</span></span> </pre></td></tr><tr><td data-num="35"></td><td><pre>            <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>cancelEdit<span class="token punctuation">"</span></span> </pre></td></tr><tr><td data-num="36"></td><td><pre>            <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-secondary<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="37"></td><td><pre>          <span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="38"></td><td><pre>            取消</pre></td></tr><tr><td data-num="39"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="40"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="41"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="42"></td><td><pre></pre></td></tr><tr><td data-num="43"></td><td><pre>      <span class="token comment">&lt;!-- 菜單內容 --></span></pre></td></tr><tr><td data-num="44"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="45"></td><td><pre>        <span class="token comment">&lt;!-- 菜單名稱 --></span></pre></td></tr><tr><td data-num="46"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>card mb-4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="47"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>card-body<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="48"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-label<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>菜單名稱<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="49"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> </pre></td></tr><tr><td data-num="50"></td><td><pre>              <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>menuName<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="51"></td><td><pre>              <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="52"></td><td><pre>              <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-control<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="53"></td><td><pre>              <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>輸入菜單名稱<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="54"></td><td><pre>              <span class="token attr-name">:disabled</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>!isEditing<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="55"></td><td><pre>            <span class="token punctuation">/></span></span></pre></td></tr><tr><td data-num="56"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="57"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="58"></td><td><pre>        </pre></td></tr><tr><td data-num="59"></td><td><pre>        <span class="token comment">&lt;!-- 菜單類別列表 --></span></pre></td></tr><tr><td data-num="60"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mb-4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="61"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>(category, categoryIndex) in menuData<span class="token punctuation">"</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>categoryIndex<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>card mb-3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="62"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>card-body<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="63"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>d-flex justify-content-between align-items-start mb-3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="64"></td><td><pre>                <span class="token comment">&lt;!-- 類別名稱 --></span></pre></td></tr><tr><td data-num="65"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>flex-grow-1 me-3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="66"></td><td><pre>                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-label<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>類別名稱<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="67"></td><td><pre>                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> </pre></td></tr><tr><td data-num="68"></td><td><pre>                    <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>category.categoryName<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="69"></td><td><pre>                    <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="70"></td><td><pre>                    <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-control<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="71"></td><td><pre>                    <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>輸入類別名稱（例如：主餐、附餐）<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="72"></td><td><pre>                    <span class="token attr-name">:disabled</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>!isEditing<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="73"></td><td><pre>                  <span class="token punctuation">/></span></span></pre></td></tr><tr><td data-num="74"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="75"></td><td><pre>                <span class="token comment">&lt;!-- 類別排序控制 --></span></pre></td></tr><tr><td data-num="76"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>isEditing<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn-group<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="77"></td><td><pre>                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> </pre></td></tr><tr><td data-num="78"></td><td><pre>                    <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>moveCategory(categoryIndex, -1)<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="79"></td><td><pre>                    <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-outline-secondary<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="80"></td><td><pre>                    <span class="token attr-name">:disabled</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>categoryIndex === 0<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="81"></td><td><pre>                  <span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="82"></td><td><pre>                    ↑</pre></td></tr><tr><td data-num="83"></td><td><pre>                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="84"></td><td><pre>                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> </pre></td></tr><tr><td data-num="85"></td><td><pre>                    <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>moveCategory(categoryIndex, 1)<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="86"></td><td><pre>                    <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-outline-secondary<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="87"></td><td><pre>                    <span class="token attr-name">:disabled</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>categoryIndex === menuData.length - 1<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="88"></td><td><pre>                  <span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="89"></td><td><pre>                    ↓</pre></td></tr><tr><td data-num="90"></td><td><pre>                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="91"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="92"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="93"></td><td><pre></pre></td></tr><tr><td data-num="94"></td><td><pre>              <span class="token comment">&lt;!-- 餐點列表 --></span></pre></td></tr><tr><td data-num="95"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mb-3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="96"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h5</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>card-title<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>餐點項目<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h5</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="97"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>list-group<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="98"></td><td><pre>                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> </pre></td></tr><tr><td data-num="99"></td><td><pre>                    <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>(item, itemIndex) in category.items<span class="token punctuation">"</span></span> </pre></td></tr><tr><td data-num="100"></td><td><pre>                    <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>itemIndex<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="101"></td><td><pre>                    <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>list-group-item<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="102"></td><td><pre>                  <span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="103"></td><td><pre>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>row align-items-center<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="104"></td><td><pre>                      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>col<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="105"></td><td><pre>                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> </pre></td></tr><tr><td data-num="106"></td><td><pre>                          <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item.itemModel<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="107"></td><td><pre>                          <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-select mb-2<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="108"></td><td><pre>                          <span class="token attr-name">@change</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item.itemId = null<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="109"></td><td><pre>                          <span class="token attr-name">:disabled</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>!isEditing<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="110"></td><td><pre>                        <span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="111"></td><td><pre>                          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>選擇餐點類型<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="112"></td><td><pre>                          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>MainDish<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>主餐<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="113"></td><td><pre>                          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ElseDish<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>其他餐點<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="114"></td><td><pre>                          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>RawMeat<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>食材<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="115"></td><td><pre>                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="116"></td><td><pre>                        </pre></td></tr><tr><td data-num="117"></td><td><pre>                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> </pre></td></tr><tr><td data-num="118"></td><td><pre>                          <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item.itemModel<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="119"></td><td><pre>                          <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item.itemId<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="120"></td><td><pre>                          <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-select<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="121"></td><td><pre>                          <span class="token attr-name">:disabled</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>!isEditing<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="122"></td><td><pre>                        <span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="123"></td><td><pre>                          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>選擇餐點<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="124"></td><td><pre>                          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> </pre></td></tr><tr><td data-num="125"></td><td><pre>                            <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dish in getDishes(item.itemModel)<span class="token punctuation">"</span></span> </pre></td></tr><tr><td data-num="126"></td><td><pre>                            <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dish._id<span class="token punctuation">"</span></span> </pre></td></tr><tr><td data-num="127"></td><td><pre>                            <span class="token attr-name">:value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dish._id<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="128"></td><td><pre>                          <span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="129"></td><td><pre>                            &#123;&#123; dish.name &#125;&#125; - $&#123;&#123; dish.price &#125;&#125;</pre></td></tr><tr><td data-num="130"></td><td><pre>                          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="131"></td><td><pre>                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="132"></td><td><pre>                      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="133"></td><td><pre>                      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>isEditing<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>col-auto<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="134"></td><td><pre>                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn-group<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="135"></td><td><pre>                          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> </pre></td></tr><tr><td data-num="136"></td><td><pre>                            <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>moveItem(categoryIndex, itemIndex, -1)<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="137"></td><td><pre>                            <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-outline-secondary<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="138"></td><td><pre>                            <span class="token attr-name">:disabled</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>itemIndex === 0<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="139"></td><td><pre>                          <span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="140"></td><td><pre>                            ↑</pre></td></tr><tr><td data-num="141"></td><td><pre>                          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="142"></td><td><pre>                          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> </pre></td></tr><tr><td data-num="143"></td><td><pre>                            <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>moveItem(categoryIndex, itemIndex, 1)<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="144"></td><td><pre>                            <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-outline-secondary<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="145"></td><td><pre>                            <span class="token attr-name">:disabled</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>itemIndex === category.items.length - 1<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="146"></td><td><pre>                          <span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="147"></td><td><pre>                            ↓</pre></td></tr><tr><td data-num="148"></td><td><pre>                          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="149"></td><td><pre>                          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> </pre></td></tr><tr><td data-num="150"></td><td><pre>                            <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>removeItem(categoryIndex, itemIndex)<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="151"></td><td><pre>                            <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-outline-danger<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="152"></td><td><pre>                          <span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="153"></td><td><pre>                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>bi bi-trash<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="154"></td><td><pre>                          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="155"></td><td><pre>                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="156"></td><td><pre>                      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="157"></td><td><pre>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="158"></td><td><pre>                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="159"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="160"></td><td><pre></pre></td></tr><tr><td data-num="161"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> </pre></td></tr><tr><td data-num="162"></td><td><pre>                  <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>isEditing<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="163"></td><td><pre>                  <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>addItem(category)<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="164"></td><td><pre>                  <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-outline-primary mt-2<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="165"></td><td><pre>                <span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="166"></td><td><pre>                  新增餐點</pre></td></tr><tr><td data-num="167"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="168"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="169"></td><td><pre></pre></td></tr><tr><td data-num="170"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> </pre></td></tr><tr><td data-num="171"></td><td><pre>                <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>isEditing<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="172"></td><td><pre>                <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>removeCategory(categoryIndex)<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="173"></td><td><pre>                <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-danger<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="174"></td><td><pre>              <span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="175"></td><td><pre>                刪除類別</pre></td></tr><tr><td data-num="176"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="177"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="178"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="179"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="180"></td><td><pre></pre></td></tr><tr><td data-num="181"></td><td><pre>        <span class="token comment">&lt;!-- 控制按鈕 --></span></pre></td></tr><tr><td data-num="182"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>isEditing<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>d-flex gap-2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="183"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> </pre></td></tr><tr><td data-num="184"></td><td><pre>            <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>addCategory<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="185"></td><td><pre>            <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-primary<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="186"></td><td><pre>          <span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="187"></td><td><pre>            新增類別</pre></td></tr><tr><td data-num="188"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="189"></td><td><pre>          </pre></td></tr><tr><td data-num="190"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> </pre></td></tr><tr><td data-num="191"></td><td><pre>            <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>saveMenu<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="192"></td><td><pre>            <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-success<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="193"></td><td><pre>            <span class="token attr-name">:disabled</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>!isValid<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="194"></td><td><pre>          <span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="195"></td><td><pre>            儲存菜單</pre></td></tr><tr><td data-num="196"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="197"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="198"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="199"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="200"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="201"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="202"></td><td><pre></pre></td></tr><tr><td data-num="203"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"></pre></td></tr><tr><td data-num="204"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> ref<span class="token punctuation">,</span> computed<span class="token punctuation">,</span> onMounted <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'vue'</span></pre></td></tr><tr><td data-num="205"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> useRoute<span class="token punctuation">,</span> useRouter <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'vue-router'</span></pre></td></tr><tr><td data-num="206"></td><td><pre><span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">'axios'</span></pre></td></tr><tr><td data-num="207"></td><td><pre></pre></td></tr><tr><td data-num="208"></td><td><pre><span class="token keyword">const</span> route <span class="token operator">=</span> <span class="token function">useRoute</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="209"></td><td><pre><span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">useRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="210"></td><td><pre><span class="token keyword">const</span> <span class="token constant">API_BASE_URL</span> <span class="token operator">=</span> <span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VITE_API_BASE_URL</span></pre></td></tr><tr><td data-num="211"></td><td><pre><span class="token keyword">const</span> menuId <span class="token operator">=</span> route<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id</pre></td></tr><tr><td data-num="212"></td><td><pre></pre></td></tr><tr><td data-num="213"></td><td><pre><span class="token comment">// 狀態</span></pre></td></tr><tr><td data-num="214"></td><td><pre><span class="token keyword">const</span> loading <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="215"></td><td><pre><span class="token keyword">const</span> error <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="216"></td><td><pre><span class="token keyword">const</span> isEditing <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="217"></td><td><pre><span class="token keyword">const</span> menuName <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="218"></td><td><pre><span class="token keyword">const</span> menuData <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="219"></td><td><pre><span class="token keyword">const</span> mainDishes <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="220"></td><td><pre><span class="token keyword">const</span> elseDishes <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="221"></td><td><pre><span class="token keyword">const</span> rawMeats <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="222"></td><td><pre></pre></td></tr><tr><td data-num="223"></td><td><pre><span class="token comment">// 從伺服器獲取菜單數據</span></pre></td></tr><tr><td data-num="224"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">fetchMenu</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="225"></td><td><pre>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="226"></td><td><pre>    loading<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span></pre></td></tr><tr><td data-num="227"></td><td><pre>    error<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">null</span></pre></td></tr><tr><td data-num="228"></td><td><pre>    <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">API_BASE_URL</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/menu/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>menuId<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="229"></td><td><pre>    <span class="token keyword">const</span> menu <span class="token operator">=</span> response<span class="token punctuation">.</span>data</pre></td></tr><tr><td data-num="230"></td><td><pre>    </pre></td></tr><tr><td data-num="231"></td><td><pre>    menuName<span class="token punctuation">.</span>value <span class="token operator">=</span> menu<span class="token punctuation">.</span>name</pre></td></tr><tr><td data-num="232"></td><td><pre>    menuData<span class="token punctuation">.</span>value <span class="token operator">=</span> menu<span class="token punctuation">.</span>list</pre></td></tr><tr><td data-num="233"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="234"></td><td><pre>    error<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">'獲取菜單數據失敗，請稍後再試'</span></pre></td></tr><tr><td data-num="235"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Error fetching menu:'</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="236"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="237"></td><td><pre>    loading<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span></pre></td></tr><tr><td data-num="238"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="239"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="240"></td><td><pre></pre></td></tr><tr><td data-num="241"></td><td><pre><span class="token comment">// 獲取指定類型的餐點</span></pre></td></tr><tr><td data-num="242"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">fetchDishes</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">endpoint</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="243"></td><td><pre>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="244"></td><td><pre>    <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">API_BASE_URL</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/dish</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>endpoint<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="245"></td><td><pre>    <span class="token keyword">return</span> response<span class="token punctuation">.</span>data</pre></td></tr><tr><td data-num="246"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="247"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Error fetching dishes:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="248"></td><td><pre>    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="249"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="250"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="251"></td><td><pre></pre></td></tr><tr><td data-num="252"></td><td><pre><span class="token comment">// 初始化時獲取所有類型的餐點</span></pre></td></tr><tr><td data-num="253"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">initializeDishes</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="254"></td><td><pre>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="255"></td><td><pre>    <span class="token keyword">const</span> <span class="token punctuation">[</span>mainResponse<span class="token punctuation">,</span> elseResponse<span class="token punctuation">,</span> rawResponse<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span></pre></td></tr><tr><td data-num="256"></td><td><pre>      <span class="token function">fetchDishes</span><span class="token punctuation">(</span><span class="token string">'/mainDish'</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="257"></td><td><pre>      <span class="token function">fetchDishes</span><span class="token punctuation">(</span><span class="token string">'/elseDish'</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="258"></td><td><pre>      <span class="token function">fetchDishes</span><span class="token punctuation">(</span><span class="token string">'/rawMeat'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="259"></td><td><pre>    <span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="260"></td><td><pre>    </pre></td></tr><tr><td data-num="261"></td><td><pre>    mainDishes<span class="token punctuation">.</span>value <span class="token operator">=</span> mainResponse</pre></td></tr><tr><td data-num="262"></td><td><pre>    elseDishes<span class="token punctuation">.</span>value <span class="token operator">=</span> elseResponse</pre></td></tr><tr><td data-num="263"></td><td><pre>    rawMeats<span class="token punctuation">.</span>value <span class="token operator">=</span> rawResponse</pre></td></tr><tr><td data-num="264"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="265"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Error initializing dishes:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="266"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="267"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="268"></td><td><pre></pre></td></tr><tr><td data-num="269"></td><td><pre><span class="token comment">// 根據餐點類型獲取對應的餐點列表</span></pre></td></tr><tr><td data-num="270"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">getDishes</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">itemModel</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="271"></td><td><pre>  <span class="token keyword">switch</span> <span class="token punctuation">(</span>itemModel<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="272"></td><td><pre>    <span class="token keyword">case</span> <span class="token string">'MainDish'</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="273"></td><td><pre>      <span class="token keyword">return</span> mainDishes<span class="token punctuation">.</span>value</pre></td></tr><tr><td data-num="274"></td><td><pre>    <span class="token keyword">case</span> <span class="token string">'ElseDish'</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="275"></td><td><pre>      <span class="token keyword">return</span> elseDishes<span class="token punctuation">.</span>value</pre></td></tr><tr><td data-num="276"></td><td><pre>    <span class="token keyword">case</span> <span class="token string">'RawMeat'</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="277"></td><td><pre>      <span class="token keyword">return</span> rawMeats<span class="token punctuation">.</span>value</pre></td></tr><tr><td data-num="278"></td><td><pre>    <span class="token keyword">default</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="279"></td><td><pre>      <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="280"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="281"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="282"></td><td><pre></pre></td></tr><tr><td data-num="283"></td><td><pre><span class="token comment">// 類別操作</span></pre></td></tr><tr><td data-num="284"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">addCategory</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="285"></td><td><pre>  menuData<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="286"></td><td><pre>    <span class="token literal-property property">categoryName</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="287"></td><td><pre>    <span class="token literal-property property">items</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="288"></td><td><pre>    <span class="token literal-property property">order</span><span class="token operator">:</span> menuData<span class="token punctuation">.</span>value<span class="token punctuation">.</span>length</pre></td></tr><tr><td data-num="289"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="290"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="291"></td><td><pre></pre></td></tr><tr><td data-num="292"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">removeCategory</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">index</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="293"></td><td><pre>  menuData<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="294"></td><td><pre>  <span class="token function">updateCategoryOrders</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="295"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="296"></td><td><pre></pre></td></tr><tr><td data-num="297"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">moveCategory</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">categoryIndex<span class="token punctuation">,</span> direction</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="298"></td><td><pre>  <span class="token keyword">const</span> newIndex <span class="token operator">=</span> categoryIndex <span class="token operator">+</span> direction</pre></td></tr><tr><td data-num="299"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span>newIndex <span class="token operator">>=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> newIndex <span class="token operator">&lt;</span> menuData<span class="token punctuation">.</span>value<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="300"></td><td><pre>    <span class="token keyword">const</span> temp <span class="token operator">=</span> menuData<span class="token punctuation">.</span>value<span class="token punctuation">[</span>categoryIndex<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="301"></td><td><pre>    menuData<span class="token punctuation">.</span>value<span class="token punctuation">[</span>categoryIndex<span class="token punctuation">]</span> <span class="token operator">=</span> menuData<span class="token punctuation">.</span>value<span class="token punctuation">[</span>newIndex<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="302"></td><td><pre>    menuData<span class="token punctuation">.</span>value<span class="token punctuation">[</span>newIndex<span class="token punctuation">]</span> <span class="token operator">=</span> temp</pre></td></tr><tr><td data-num="303"></td><td><pre>    <span class="token function">updateCategoryOrders</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="304"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="305"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="306"></td><td><pre></pre></td></tr><tr><td data-num="307"></td><td><pre><span class="token comment">// 項目操作</span></pre></td></tr><tr><td data-num="308"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">addItem</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">category</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="309"></td><td><pre>  category<span class="token punctuation">.</span>items<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="310"></td><td><pre>    <span class="token literal-property property">itemModel</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="311"></td><td><pre>    <span class="token literal-property property">itemId</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="312"></td><td><pre>    <span class="token literal-property property">order</span><span class="token operator">:</span> category<span class="token punctuation">.</span>items<span class="token punctuation">.</span>length</pre></td></tr><tr><td data-num="313"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="314"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="315"></td><td><pre></pre></td></tr><tr><td data-num="316"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">removeItem</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">categoryIndex<span class="token punctuation">,</span> itemIndex</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="317"></td><td><pre>  menuData<span class="token punctuation">.</span>value<span class="token punctuation">[</span>categoryIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>items<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>itemIndex<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="318"></td><td><pre>  <span class="token function">updateItemOrders</span><span class="token punctuation">(</span>categoryIndex<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="319"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="320"></td><td><pre></pre></td></tr><tr><td data-num="321"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">moveItem</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">categoryIndex<span class="token punctuation">,</span> itemIndex<span class="token punctuation">,</span> direction</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="322"></td><td><pre>  <span class="token keyword">const</span> newIndex <span class="token operator">=</span> itemIndex <span class="token operator">+</span> direction</pre></td></tr><tr><td data-num="323"></td><td><pre>  <span class="token keyword">const</span> items <span class="token operator">=</span> menuData<span class="token punctuation">.</span>value<span class="token punctuation">[</span>categoryIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>items</pre></td></tr><tr><td data-num="324"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span>newIndex <span class="token operator">>=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> newIndex <span class="token operator">&lt;</span> items<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="325"></td><td><pre>    <span class="token keyword">const</span> temp <span class="token operator">=</span> items<span class="token punctuation">[</span>itemIndex<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="326"></td><td><pre>    items<span class="token punctuation">[</span>itemIndex<span class="token punctuation">]</span> <span class="token operator">=</span> items<span class="token punctuation">[</span>newIndex<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="327"></td><td><pre>    items<span class="token punctuation">[</span>newIndex<span class="token punctuation">]</span> <span class="token operator">=</span> temp</pre></td></tr><tr><td data-num="328"></td><td><pre>    <span class="token function">updateItemOrders</span><span class="token punctuation">(</span>categoryIndex<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="329"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="330"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="331"></td><td><pre></pre></td></tr><tr><td data-num="332"></td><td><pre><span class="token comment">// 更新排序</span></pre></td></tr><tr><td data-num="333"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">updateCategoryOrders</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="334"></td><td><pre>  menuData<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">category<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="335"></td><td><pre>    category<span class="token punctuation">.</span>order <span class="token operator">=</span> index</pre></td></tr><tr><td data-num="336"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="337"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="338"></td><td><pre></pre></td></tr><tr><td data-num="339"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">updateItemOrders</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">categoryIndex</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="340"></td><td><pre>  menuData<span class="token punctuation">.</span>value<span class="token punctuation">[</span>categoryIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>items<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="341"></td><td><pre>    item<span class="token punctuation">.</span>order <span class="token operator">=</span> index</pre></td></tr><tr><td data-num="342"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="343"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="344"></td><td><pre></pre></td></tr><tr><td data-num="345"></td><td><pre><span class="token comment">// 表單驗證</span></pre></td></tr><tr><td data-num="346"></td><td><pre><span class="token keyword">const</span> isValid <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="347"></td><td><pre>  <span class="token keyword">return</span> menuName<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token string">''</span> <span class="token operator">&amp;&amp;</span> </pre></td></tr><tr><td data-num="348"></td><td><pre>    menuData<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">every</span><span class="token punctuation">(</span><span class="token parameter">category</span> <span class="token operator">=></span> </pre></td></tr><tr><td data-num="349"></td><td><pre>      category<span class="token punctuation">.</span>categoryName<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token string">''</span> <span class="token operator">&amp;&amp;</span></pre></td></tr><tr><td data-num="350"></td><td><pre>      category<span class="token punctuation">.</span>items<span class="token punctuation">.</span><span class="token function">every</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=></span> </pre></td></tr><tr><td data-num="351"></td><td><pre>        item<span class="token punctuation">.</span>itemModel <span class="token operator">&amp;&amp;</span> item<span class="token punctuation">.</span>itemId</pre></td></tr><tr><td data-num="352"></td><td><pre>      <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="353"></td><td><pre>    <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="354"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="355"></td><td><pre></pre></td></tr><tr><td data-num="356"></td><td><pre><span class="token comment">// 儲存菜單</span></pre></td></tr><tr><td data-num="357"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">saveMenu</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="358"></td><td><pre>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="359"></td><td><pre>    <span class="token keyword">const</span> menuToSave <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="360"></td><td><pre>      <span class="token literal-property property">name</span><span class="token operator">:</span> menuName<span class="token punctuation">.</span>value<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="361"></td><td><pre>      <span class="token literal-property property">list</span><span class="token operator">:</span> menuData<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">category<span class="token punctuation">,</span> categoryIndex</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="362"></td><td><pre>        <span class="token literal-property property">categoryName</span><span class="token operator">:</span> category<span class="token punctuation">.</span>categoryName<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="363"></td><td><pre>        <span class="token literal-property property">order</span><span class="token operator">:</span> categoryIndex<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="364"></td><td><pre>        <span class="token literal-property property">items</span><span class="token operator">:</span> category<span class="token punctuation">.</span>items<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> itemIndex</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="365"></td><td><pre>          <span class="token literal-property property">itemModel</span><span class="token operator">:</span> item<span class="token punctuation">.</span>itemModel<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="366"></td><td><pre>          <span class="token literal-property property">itemId</span><span class="token operator">:</span> item<span class="token punctuation">.</span>itemId<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="367"></td><td><pre>          <span class="token literal-property property">order</span><span class="token operator">:</span> itemIndex</pre></td></tr><tr><td data-num="368"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="369"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="370"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="371"></td><td><pre>    </pre></td></tr><tr><td data-num="372"></td><td><pre>    <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">API_BASE_URL</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/menu/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>menuId<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> menuToSave<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="373"></td><td><pre>    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'菜單更新成功！'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="374"></td><td><pre>    isEditing<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span></pre></td></tr><tr><td data-num="375"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="376"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Error saving menu:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="377"></td><td><pre>    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'儲存失敗，請稍後再試'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="378"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="379"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="380"></td><td><pre></pre></td></tr><tr><td data-num="381"></td><td><pre><span class="token comment">// 取消編輯</span></pre></td></tr><tr><td data-num="382"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">cancelEdit</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="383"></td><td><pre>  isEditing<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span></pre></td></tr><tr><td data-num="384"></td><td><pre>  <span class="token keyword">await</span> <span class="token function">fetchMenu</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 重新獲取數據，恢復原始狀態</span></pre></td></tr><tr><td data-num="385"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="386"></td><td><pre></pre></td></tr><tr><td data-num="387"></td><td><pre><span class="token comment">// 確認刪除</span></pre></td></tr><tr><td data-num="388"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">confirmDelete</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="389"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">confirm</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">確定要刪除菜單 "</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>menuName<span class="token punctuation">.</span>value<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">" 嗎？</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="390"></td><td><pre>    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="391"></td><td><pre>      <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">API_BASE_URL</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/menu/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>menuId<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="392"></td><td><pre>      router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'/menu'</span><span class="token punctuation">)</span> <span class="token comment">// 刪除後返回列表頁</span></pre></td></tr><tr><td data-num="393"></td><td><pre>    <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="394"></td><td><pre>      <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'刪除失敗，請稍後再試'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="395"></td><td><pre>      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Error deleting menu:'</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="396"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="397"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="398"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="399"></td><td><pre></pre></td></tr><tr><td data-num="400"></td><td><pre><span class="token comment">// 初始化</span></pre></td></tr><tr><td data-num="401"></td><td><pre><span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="402"></td><td><pre>  <span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span></pre></td></tr><tr><td data-num="403"></td><td><pre>    <span class="token function">fetchMenu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="404"></td><td><pre>    <span class="token function">initializeDishes</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="405"></td><td><pre>  <span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="406"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="407"></td><td><pre></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><h2 id="店家管理"><a class="anchor" href="#店家管理">#</a> 店家管理</h2>
<h3 id="api-3"><a class="anchor" href="#api-3">#</a> API</h3>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> express <span class="token keyword">from</span> <span class="token string">'express'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> Store <span class="token keyword">from</span> <span class="token string">'../schemas/storeSchema.js'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">const</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">// 取得 store</span></pre></td></tr><tr><td data-num="7"></td><td><pre>router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token keyword">await</span> Store<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>store<span class="token punctuation">)</span> <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">error</span><span class="token operator">:</span> <span class="token string">'Store not found'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Error getting store:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Internal server error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token comment">// 取得單個 store</span></pre></td></tr><tr><td data-num="20"></td><td><pre>router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/:id'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> id <span class="token punctuation">&#125;</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>params<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token keyword">await</span> Store<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">populate</span><span class="token punctuation">(</span><span class="token string">'menuItem'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>store<span class="token punctuation">)</span> <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">error</span><span class="token operator">:</span> <span class="token string">'Store not found'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre></pre></td></tr><tr><td data-num="26"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Error getting store:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Internal server error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token comment">// 創建 store</span></pre></td></tr><tr><td data-num="34"></td><td><pre>router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>    <span class="token keyword">const</span> newStore <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Store</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>    <span class="token keyword">await</span> newStore<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre></pre></td></tr><tr><td data-num="39"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Store created successfully'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="40"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Error creating store:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="42"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Internal server error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="44"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="45"></td><td><pre></pre></td></tr><tr><td data-num="46"></td><td><pre><span class="token comment">// 更新 store</span></pre></td></tr><tr><td data-num="47"></td><td><pre>router<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">'/:id'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="48"></td><td><pre>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="49"></td><td><pre>    <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> id <span class="token punctuation">&#125;</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>params<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="50"></td><td><pre>    <span class="token keyword">await</span> Store<span class="token punctuation">.</span><span class="token function">findByIdAndUpdate</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> req<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="51"></td><td><pre></pre></td></tr><tr><td data-num="52"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Store updated successfully'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="53"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="54"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Error updating store:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="55"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Internal server error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="56"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="57"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="58"></td><td><pre></pre></td></tr><tr><td data-num="59"></td><td><pre><span class="token comment">// 刪除 store</span></pre></td></tr><tr><td data-num="60"></td><td><pre>router<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">'/:id'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="61"></td><td><pre>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="62"></td><td><pre>    <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> id <span class="token punctuation">&#125;</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>params<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="63"></td><td><pre>    <span class="token keyword">await</span> Store<span class="token punctuation">.</span><span class="token function">findByIdAndDelete</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="64"></td><td><pre></pre></td></tr><tr><td data-num="65"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Store deleted successfully'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="66"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="67"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Error deleting store:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="68"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Internal server error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="69"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="70"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="71"></td><td><pre></pre></td></tr><tr><td data-num="72"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> router<span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="新增-2"><a class="anchor" href="#新增-2">#</a> 新增</h3>
<figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container py-4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>row justify-content-center<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>col-md-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>card<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="6"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>card-header<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mb-0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>新增店家<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="8"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="9"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>card-body<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="10"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">@submit.prevent</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>handleSubmit<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="11"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mb-3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="12"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>storeName<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-label<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>店家名稱<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="13"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span></pre></td></tr><tr><td data-num="14"></td><td><pre>                  <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="15"></td><td><pre>                  <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-control<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="16"></td><td><pre>                  <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>storeName<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="17"></td><td><pre>                  <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>storeForm.name<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="18"></td><td><pre>                  <span class="token attr-name">required</span></pre></td></tr><tr><td data-num="19"></td><td><pre>                <span class="token punctuation">/></span></span></pre></td></tr><tr><td data-num="20"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mb-3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="23"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>menuSelect<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-label<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>選擇菜單<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="24"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> </pre></td></tr><tr><td data-num="25"></td><td><pre>                  <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-select<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="26"></td><td><pre>                  <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>menuSelect<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="27"></td><td><pre>                  <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>storeForm.menuItem<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="28"></td><td><pre>                  <span class="token attr-name">required</span></pre></td></tr><tr><td data-num="29"></td><td><pre>                <span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="30"></td><td><pre>                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>請選擇菜單<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="31"></td><td><pre>                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> </pre></td></tr><tr><td data-num="32"></td><td><pre>                    <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>menu in menus<span class="token punctuation">"</span></span> </pre></td></tr><tr><td data-num="33"></td><td><pre>                    <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>menu._id<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="34"></td><td><pre>                    <span class="token attr-name">:value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>menu._id<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="35"></td><td><pre>                  <span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="36"></td><td><pre>                    &#123;&#123; menu.name &#125;&#125;</pre></td></tr><tr><td data-num="37"></td><td><pre>                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="38"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="39"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="40"></td><td><pre></pre></td></tr><tr><td data-num="41"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>d-flex justify-content-between<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="42"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>./show<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-secondary<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="43"></td><td><pre>                  返回</pre></td></tr><tr><td data-num="44"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="45"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-primary<span class="token punctuation">"</span></span> <span class="token attr-name">:disabled</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>loading<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="46"></td><td><pre>                  &#123;&#123; loading ? '儲存中...' : '儲存' &#125;&#125;</pre></td></tr><tr><td data-num="47"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="48"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="49"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="50"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="51"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="52"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="53"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="54"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="55"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="56"></td><td><pre></pre></td></tr><tr><td data-num="57"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"></pre></td></tr><tr><td data-num="58"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> ref<span class="token punctuation">,</span> onMounted <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'vue'</span></pre></td></tr><tr><td data-num="59"></td><td><pre><span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">'axios'</span></pre></td></tr><tr><td data-num="60"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> useRouter <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'vue-router'</span></pre></td></tr><tr><td data-num="61"></td><td><pre></pre></td></tr><tr><td data-num="62"></td><td><pre><span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">useRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="63"></td><td><pre><span class="token keyword">const</span> <span class="token constant">API_BASE_URL</span> <span class="token operator">=</span> <span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VITE_API_BASE_URL</span></pre></td></tr><tr><td data-num="64"></td><td><pre></pre></td></tr><tr><td data-num="65"></td><td><pre><span class="token keyword">const</span> loading <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="66"></td><td><pre><span class="token keyword">const</span> menus <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="67"></td><td><pre></pre></td></tr><tr><td data-num="68"></td><td><pre><span class="token keyword">const</span> storeForm <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="69"></td><td><pre>  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="70"></td><td><pre>  <span class="token literal-property property">menuItem</span><span class="token operator">:</span> <span class="token string">''</span></pre></td></tr><tr><td data-num="71"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="72"></td><td><pre></pre></td></tr><tr><td data-num="73"></td><td><pre><span class="token comment">// 獲取所有菜單</span></pre></td></tr><tr><td data-num="74"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">fetchMenus</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="75"></td><td><pre>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="76"></td><td><pre>    <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">API_BASE_URL</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/menu</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="77"></td><td><pre>    menus<span class="token punctuation">.</span>value <span class="token operator">=</span> response<span class="token punctuation">.</span>data</pre></td></tr><tr><td data-num="78"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="79"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'獲取菜單失敗:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="80"></td><td><pre>    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'獲取菜單失敗'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="81"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="82"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="83"></td><td><pre></pre></td></tr><tr><td data-num="84"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">handleSubmit</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="85"></td><td><pre>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="86"></td><td><pre>    loading<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span></pre></td></tr><tr><td data-num="87"></td><td><pre>    <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">API_BASE_URL</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/store</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> storeForm<span class="token punctuation">.</span>value<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="88"></td><td><pre>    <span class="token comment">//alert (' 新增成功！')</span></pre></td></tr><tr><td data-num="89"></td><td><pre>    router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'./show'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="90"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="91"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'新增失敗:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="92"></td><td><pre>    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'新增失敗，請稍後再試'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="93"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="94"></td><td><pre>    loading<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span></pre></td></tr><tr><td data-num="95"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="96"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="97"></td><td><pre></pre></td></tr><tr><td data-num="98"></td><td><pre><span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="99"></td><td><pre>  <span class="token function">fetchMenus</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="100"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="101"></td><td><pre></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><h3 id="修改與刪除-2"><a class="anchor" href="#修改與刪除-2">#</a> 修改與刪除</h3>
<figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container py-4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>row justify-content-center<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>col-md-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>card<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="6"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>card-header d-flex justify-content-between align-items-center<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mb-0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>編輯店家<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="8"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> </pre></td></tr><tr><td data-num="9"></td><td><pre>              <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-danger<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="10"></td><td><pre>              <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>handleDelete<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="11"></td><td><pre>              <span class="token attr-name">:disabled</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>loading<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="12"></td><td><pre>            <span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="13"></td><td><pre>              刪除店家</pre></td></tr><tr><td data-num="14"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="15"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="16"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>card-body<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="17"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>loading<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text-center py-4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="18"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>spinner-border<span class="token punctuation">"</span></span> <span class="token attr-name">role</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>status<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="19"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>visually-hidden<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Loading...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="20"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="21"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">v-else</span> <span class="token attr-name">@submit.prevent</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>handleSubmit<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="24"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mb-3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="25"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>storeName<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-label<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>店家名稱<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="26"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span></pre></td></tr><tr><td data-num="27"></td><td><pre>                  <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="28"></td><td><pre>                  <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-control<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="29"></td><td><pre>                  <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>storeName<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="30"></td><td><pre>                  <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>storeForm.name<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="31"></td><td><pre>                  <span class="token attr-name">required</span></pre></td></tr><tr><td data-num="32"></td><td><pre>                <span class="token punctuation">/></span></span></pre></td></tr><tr><td data-num="33"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="34"></td><td><pre></pre></td></tr><tr><td data-num="35"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mb-3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="36"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>menuSelect<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-label<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>選擇菜單<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="37"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> </pre></td></tr><tr><td data-num="38"></td><td><pre>                  <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-select<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="39"></td><td><pre>                  <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>menuSelect<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="40"></td><td><pre>                  <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>storeForm.menuItem<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="41"></td><td><pre>                  <span class="token attr-name">required</span></pre></td></tr><tr><td data-num="42"></td><td><pre>                <span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="43"></td><td><pre>                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>請選擇菜單<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="44"></td><td><pre>                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> </pre></td></tr><tr><td data-num="45"></td><td><pre>                    <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>menu in menus<span class="token punctuation">"</span></span> </pre></td></tr><tr><td data-num="46"></td><td><pre>                    <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>menu._id<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="47"></td><td><pre>                    <span class="token attr-name">:value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>menu._id<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="48"></td><td><pre>                  <span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="49"></td><td><pre>                    &#123;&#123; menu.name &#125;&#125;</pre></td></tr><tr><td data-num="50"></td><td><pre>                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="51"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="52"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="53"></td><td><pre></pre></td></tr><tr><td data-num="54"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>d-flex justify-content-between<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="55"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>./show<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-secondary<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="56"></td><td><pre>                  返回</pre></td></tr><tr><td data-num="57"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="58"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-primary<span class="token punctuation">"</span></span> <span class="token attr-name">:disabled</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>loading<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="59"></td><td><pre>                  &#123;&#123; loading ? '儲存中...' : '儲存' &#125;&#125;</pre></td></tr><tr><td data-num="60"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="61"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="62"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="63"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="64"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="65"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="66"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="67"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="68"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="69"></td><td><pre></pre></td></tr><tr><td data-num="70"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"></pre></td></tr><tr><td data-num="71"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> ref<span class="token punctuation">,</span> onMounted <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'vue'</span></pre></td></tr><tr><td data-num="72"></td><td><pre><span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">'axios'</span></pre></td></tr><tr><td data-num="73"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> useRouter<span class="token punctuation">,</span> useRoute <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'vue-router'</span></pre></td></tr><tr><td data-num="74"></td><td><pre></pre></td></tr><tr><td data-num="75"></td><td><pre><span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">useRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="76"></td><td><pre><span class="token keyword">const</span> route <span class="token operator">=</span> <span class="token function">useRoute</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="77"></td><td><pre><span class="token keyword">const</span> <span class="token constant">API_BASE_URL</span> <span class="token operator">=</span> <span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VITE_API_BASE_URL</span></pre></td></tr><tr><td data-num="78"></td><td><pre><span class="token keyword">const</span> loading <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="79"></td><td><pre><span class="token keyword">const</span> menus <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="80"></td><td><pre></pre></td></tr><tr><td data-num="81"></td><td><pre><span class="token keyword">const</span> storeForm <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="82"></td><td><pre>  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="83"></td><td><pre>  <span class="token literal-property property">menuItem</span><span class="token operator">:</span> <span class="token string">''</span></pre></td></tr><tr><td data-num="84"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="85"></td><td><pre></pre></td></tr><tr><td data-num="86"></td><td><pre><span class="token comment">// 獲取所有菜單</span></pre></td></tr><tr><td data-num="87"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">fetchMenus</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="88"></td><td><pre>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="89"></td><td><pre>    <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">API_BASE_URL</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/menu</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="90"></td><td><pre>    menus<span class="token punctuation">.</span>value <span class="token operator">=</span> response<span class="token punctuation">.</span>data</pre></td></tr><tr><td data-num="91"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="92"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'獲取菜單失敗:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="93"></td><td><pre>    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'獲取菜單失敗'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="94"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="95"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="96"></td><td><pre></pre></td></tr><tr><td data-num="97"></td><td><pre><span class="token comment">// 獲取店家資料</span></pre></td></tr><tr><td data-num="98"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">fetchStore</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="99"></td><td><pre>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="100"></td><td><pre>    loading<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span></pre></td></tr><tr><td data-num="101"></td><td><pre>    <span class="token keyword">const</span> storeId <span class="token operator">=</span> route<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id</pre></td></tr><tr><td data-num="102"></td><td><pre>    <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">data</span><span class="token operator">:</span> storeData <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">API_BASE_URL</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/store/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>storeId<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="103"></td><td><pre>    </pre></td></tr><tr><td data-num="104"></td><td><pre>    storeForm<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="105"></td><td><pre>      <span class="token literal-property property">name</span><span class="token operator">:</span> storeData<span class="token punctuation">.</span>name<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="106"></td><td><pre>      <span class="token literal-property property">menuItem</span><span class="token operator">:</span> storeData<span class="token punctuation">.</span>menuItem</pre></td></tr><tr><td data-num="107"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="108"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="109"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'獲取店家資料失敗:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="110"></td><td><pre>    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'獲取店家資料失敗'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="111"></td><td><pre>    router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'./show'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="112"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="113"></td><td><pre>    loading<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span></pre></td></tr><tr><td data-num="114"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="115"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="116"></td><td><pre></pre></td></tr><tr><td data-num="117"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">handleSubmit</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="118"></td><td><pre>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="119"></td><td><pre>    loading<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span></pre></td></tr><tr><td data-num="120"></td><td><pre>    <span class="token keyword">const</span> storeId <span class="token operator">=</span> route<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id</pre></td></tr><tr><td data-num="121"></td><td><pre>    </pre></td></tr><tr><td data-num="122"></td><td><pre>    <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">API_BASE_URL</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/store/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>storeId<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> storeForm<span class="token punctuation">.</span>value<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="123"></td><td><pre>    <span class="token comment">//alert (' 更新成功！')</span></pre></td></tr><tr><td data-num="124"></td><td><pre>    router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'./show'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="125"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="126"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'更新失敗:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="127"></td><td><pre>    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'更新失敗，請稍後再試'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="128"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="129"></td><td><pre>    loading<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span></pre></td></tr><tr><td data-num="130"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="131"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="132"></td><td><pre></pre></td></tr><tr><td data-num="133"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">handleDelete</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="134"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">confirm</span><span class="token punctuation">(</span><span class="token string">'確定要刪除這個店家嗎？'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span></pre></td></tr><tr><td data-num="135"></td><td><pre></pre></td></tr><tr><td data-num="136"></td><td><pre>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="137"></td><td><pre>    loading<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span></pre></td></tr><tr><td data-num="138"></td><td><pre>    <span class="token keyword">const</span> storeId <span class="token operator">=</span> route<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id</pre></td></tr><tr><td data-num="139"></td><td><pre>    <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">API_BASE_URL</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/store/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>storeId<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="140"></td><td><pre>    <span class="token comment">//alert (' 刪除成功！')</span></pre></td></tr><tr><td data-num="141"></td><td><pre>    router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'./show'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="142"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="143"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'刪除失敗:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="144"></td><td><pre>    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'刪除失敗，請稍後再試'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="145"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="146"></td><td><pre>    loading<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span></pre></td></tr><tr><td data-num="147"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="148"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="149"></td><td><pre></pre></td></tr><tr><td data-num="150"></td><td><pre><span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="151"></td><td><pre>  Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">fetchStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">fetchMenus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="152"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="153"></td><td><pre></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><h3 id="顯示-3"><a class="anchor" href="#顯示-3">#</a> 顯示</h3>
<figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container py-4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>d-flex justify-content-between align-items-center mb-4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>分店列表<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>./add<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-primary<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="6"></td><td><pre>        新增分店</pre></td></tr><tr><td data-num="7"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token comment">&lt;!-- 店家列表 --></span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>row<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="12"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>loading<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>col-12 text-center<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>spinner-border<span class="token punctuation">"</span></span> <span class="token attr-name">role</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>status<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="14"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>visually-hidden<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Loading...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="16"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-else-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stores.length === 0<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>col-12<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>alert alert-info<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="20"></td><td><pre>          目前還沒有任何分店資料</pre></td></tr><tr><td data-num="21"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="22"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="23"></td><td><pre></pre></td></tr><tr><td data-num="24"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-else</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>col-12<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="25"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>table-responsive<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="26"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>table table-hover<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="27"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>thead</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="28"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="29"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>分店名稱<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="30"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>操作<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="31"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="32"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>thead</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="33"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tbody</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="34"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>store in stores<span class="token punctuation">"</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>store._id<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="35"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>&#123;&#123; store.name &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="36"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="37"></td><td><pre>                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn-group<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="38"></td><td><pre>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> </pre></td></tr><tr><td data-num="39"></td><td><pre>                      <span class="token attr-name">:to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>`./$&#123;store._id&#125;`<span class="token punctuation">"</span></span> </pre></td></tr><tr><td data-num="40"></td><td><pre>                      <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-sm btn-outline-primary<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="41"></td><td><pre>                    <span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="42"></td><td><pre>                      編輯</pre></td></tr><tr><td data-num="43"></td><td><pre>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="44"></td><td><pre>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> </pre></td></tr><tr><td data-num="45"></td><td><pre>                      <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-sm btn-outline-danger<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="46"></td><td><pre>                      <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>handleDelete(store._id)<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="47"></td><td><pre>                    <span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="48"></td><td><pre>                      刪除</pre></td></tr><tr><td data-num="49"></td><td><pre>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="50"></td><td><pre>                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="51"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="52"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="53"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tbody</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="54"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="55"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="56"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="57"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="58"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="59"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="60"></td><td><pre></pre></td></tr><tr><td data-num="61"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"></pre></td></tr><tr><td data-num="62"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> ref<span class="token punctuation">,</span> onMounted <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'vue'</span></pre></td></tr><tr><td data-num="63"></td><td><pre><span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">'axios'</span></pre></td></tr><tr><td data-num="64"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> useRouter <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'vue-router'</span></pre></td></tr><tr><td data-num="65"></td><td><pre></pre></td></tr><tr><td data-num="66"></td><td><pre><span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">useRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="67"></td><td><pre><span class="token keyword">const</span> <span class="token constant">API_BASE_URL</span> <span class="token operator">=</span> <span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VITE_API_BASE_URL</span></pre></td></tr><tr><td data-num="68"></td><td><pre><span class="token keyword">const</span> stores <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="69"></td><td><pre><span class="token keyword">const</span> loading <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="70"></td><td><pre></pre></td></tr><tr><td data-num="71"></td><td><pre><span class="token comment">// 獲取所有店家資料</span></pre></td></tr><tr><td data-num="72"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">fetchStores</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="73"></td><td><pre>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="74"></td><td><pre>    loading<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span></pre></td></tr><tr><td data-num="75"></td><td><pre>    <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">API_BASE_URL</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/store</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="76"></td><td><pre>    stores<span class="token punctuation">.</span>value <span class="token operator">=</span> response<span class="token punctuation">.</span>data</pre></td></tr><tr><td data-num="77"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="78"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'獲取店家資料失敗:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="79"></td><td><pre>    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'獲取店家資料失敗'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="80"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="81"></td><td><pre>    loading<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span></pre></td></tr><tr><td data-num="82"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="83"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="84"></td><td><pre></pre></td></tr><tr><td data-num="85"></td><td><pre><span class="token comment">// 刪除店家</span></pre></td></tr><tr><td data-num="86"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">handleDelete</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">storeId</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="87"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">confirm</span><span class="token punctuation">(</span><span class="token string">'確定要刪除這個店家嗎？'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span></pre></td></tr><tr><td data-num="88"></td><td><pre></pre></td></tr><tr><td data-num="89"></td><td><pre>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="90"></td><td><pre>    <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">API_BASE_URL</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/store/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>storeId<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="91"></td><td><pre>    <span class="token keyword">await</span> <span class="token function">fetchStores</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 重新獲取列表</span></pre></td></tr><tr><td data-num="92"></td><td><pre>    <span class="token comment">//alert (' 刪除成功 ')</span></pre></td></tr><tr><td data-num="93"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="94"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'刪除店家失敗:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="95"></td><td><pre>    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'刪除店家失敗'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="96"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="97"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="98"></td><td><pre></pre></td></tr><tr><td data-num="99"></td><td><pre><span class="token comment">// 組件掛載時獲取資料</span></pre></td></tr><tr><td data-num="100"></td><td><pre><span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="101"></td><td><pre>  <span class="token function">fetchStores</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="102"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="103"></td><td><pre></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="104"></td><td><pre></pre></td></tr><tr><td data-num="105"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css"></pre></td></tr><tr><td data-num="106"></td><td><pre><span class="token selector">.table</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="107"></td><td><pre>  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="108"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="109"></td><td><pre></pre></td></tr><tr><td data-num="110"></td><td><pre><span class="token selector">.btn-group</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="111"></td><td><pre>  <span class="token property">gap</span><span class="token punctuation">:</span> 0.5rem<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="112"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="113"></td><td><pre></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><h2 id="訂單列表"><a class="anchor" href="#訂單列表">#</a> 訂單列表</h2>
<h3 id="訂單首頁"><a class="anchor" href="#訂單首頁">#</a> 訂單首頁</h3>
<p>首先分成兩部分</p>
<ol>
<li>上方選擇即設定部分 (頁面大約占 20%)</li>
</ol>
<ul>
<li>選擇要顯示的天數 [1,10,30]</li>
<li>兩個按鈕 [往前，往後]，假設上方是選擇 10 天那麼往後就是本來區間 [20:11] -&gt; [10:1]</li>
<li>移動區間範圍</li>
</ul>
<ol start="2">
<li>下方顯示訂單部分 (頁面大約佔 80%)</li>
</ol>
<ul>
<li>每個 <code>card</code>  代表一天</li>
<li><code>card header</code>  顯示當天利潤</li>
<li><code>card body</code>  顯示兩行 [總收入，手續費]</li>
<li>手續費 根據  <code>paymentMethod</code> : enum: [' 現金 ':0%,'linepay':3%,'FoodPanda':25%,'UberEat':33%]</li>
<li>現金沒有手續費，其他三種方式有，計算方式為：假設為 <code>UberEat</code>  收入是 150 那手續費是 150 * 0.33 = 49 (手續費皆為無條件捨去)</li>
<li>利潤 = 總收入 - 手續費</li>
<li>給個  <code>card</code>  都可以點擊 進入當天 detail</li>
</ul>
<h3 id="當天-detail"><a class="anchor" href="#當天-detail">#</a> 當天 detail</h3>
<ol>
<li>首先是圖表</li>
</ol>
<ul>
<li>圓餅圖：顯示當天總收入中，利潤與手續費所占的比率</li>
<li>圓餅圖：顯示 [內用，自取，Foodpanda,Ubereat] 各個得占比</li>
<li>直方圖：顯示當天個餐點銷量由大排到小 (加點肉品需加到那個肉品的銷量統計)</li>
<li>折線圖：顯示每半個小時為區間的，主餐數量，來判斷哪個區段的時間最為繁忙</li>
</ul>
<ol start="2">
<li>顯示所有訂單</li>
</ol>
<ul>
<li>每行需顯示 [store,orderNumber,platform,pickupMethod,paymentMethod,totalMoney,orderStatus] 最後有一個詳細資料的按鈕</li>
<li>點開詳細資料後 打開一個 modal 顯示所有資料</li>
</ul>
<p>我正在設計線上點餐系統的後台<br />
我在想怎麼設計 顯示那些東西 會是客戶真正需要的<br />
目前客戶 他覺得以前的系統不好 可是他不知道怎麼改善<br />
我現在有全部的決定權</p>
<p>這邊為顯示數據的部分<br />
我的想法首先第一個 page<br />
 每個 card header 顯示每日的營業額 body 為可切換三種模式第一種顯示所有餐點的銷售額即占比 % 數 第二種 顯示內用 外帶 外送 的銷售額即占比 第三種顯示現金付款與線上付款的占比 百分比統一四捨五入到小數點第一位 每個 card 可以點進去查看當日所有訂單的細節 因為訂單細節有點多 目前打算顯示 一些重要資料 後面放一個 詳細資料的按鈕 點擊會跳出一個 顯示所有資料個框框</p>
<p>第二個 page 顯示統計圖表<br />
第一個圖表為折線圖縱軸為銷售額 橫軸為星期 一星期連成一條線<br />
顯示一個月 共四星期 用來比較每日的銷售額與星期的關聯 還有各個星期的銷售數據<br />
第二個圖表 為圓餅圖顯示各個時段的銷售數據顯示一個月內的數據<br />
第三個圖表 為圓餅圖顯示各個餐點的銷售數據顯示一個月內的數據<br />
第四個圖表 為圓餅圖顯示線上付款與現金付款的占比數據 一個月內的數據</p>
<p>上述的四個圖表 下列再增加四個一樣的圖表只是改成 1 年的<br />
第一個圖表 共 12 個月 用來比較每月的銷售額與星期的關聯 還有各個月的銷售數據<br />
第二個圖表 為圓餅圖顯示各個時段的銷售數據顯示一年內的數據<br />
第三個圖表 為圓餅圖顯示各個餐點的銷售數據顯示一年內的數據<br />
第四個圖表 為圓餅圖顯示線上付款與現金付款的占比數據 一年的數據</p>
<h2 id="數據統計"><a class="anchor" href="#數據統計">#</a> 數據統計</h2>
<blockquote>
<p>想要呈現的資料：</p>
</blockquote>
<h1 id="客人點餐介面"><a class="anchor" href="#客人點餐介面">#</a> 客人點餐介面</h1>
<h2 id="需求"><a class="anchor" href="#需求">#</a> 需求</h2>
<ol>
<li>基本需求</li>
</ol>
<ul>
<li>網址 <code>/customer/:store</code></li>
<li>需要區分分店</li>
<li>需要區分內用與自取</li>
<li>內用需要有桌號</li>
<li>自取需要可以設定時間或是立即取餐</li>
<li>開頭一張圖片及店名</li>
<li>下方餐點上方有個 滾動導覽</li>
<li>餐點類別的 navbar</li>
<li>有個巢狀迴圈外迴圈是餐點類別，內迴圈是那個類別的各個餐點 (card)</li>
<li>每個餐點 card 上面是一張餐點圖 下方顯示名稱與價錢</li>
<li>點進去之後顯示 (同個網址不同 component) 點餐細節及加點，按鈕加入購物車旁邊顯示價錢</li>
<li>購物車內不為 0 時顯示於下方</li>
<li>點開購物車 (同個網址不同 component) 後顯示點餐的品項下方有前往結帳</li>
<li>換到下一個 (同個網址不同 component) 可以選內用，自取，外送</li>
<li>內用需要桌號</li>
<li>自許需要選時間 (需要填電話，姓名)，或是立即取餐 (不用填)</li>
<li>外送需要地址，電話，姓名</li>
<li>接下來按鈕是送出訂單</li>
<li>挑轉到完成訂單的介面 (不同網址)</li>
</ul>
<ol start="2">
<li>進階需求</li>
</ol>
<ul>
<li>需處理 <code>兌換券</code> 、 <code>折價券</code> 邏輯</li>
<li>使用 <code>nav-tags</code>  上方資訊結束後接著 [ <code>菜單</code> ， <code>兌換券</code> ， <code>折價券</code> ]</li>
<li></li>
</ul>
<h2 id="各個頁面"><a class="anchor" href="#各個頁面">#</a> 各個頁面</h2>
<h3 id="主要整合頁面"><a class="anchor" href="#主要整合頁面">#</a> 主要整合頁面</h3>
<figure class="highlight html"><figcaption data-lang="HTML"><span>l</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>main-container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>center-container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fade<span class="token punctuation">"</span></span> <span class="token attr-name">mode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>out-in<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>MenuListing</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>!selectedItem &amp;&amp; !showCart<span class="token punctuation">"</span></span> <span class="token attr-name">:store-name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>store.name<span class="token punctuation">"</span></span> <span class="token attr-name">:announcements</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>store.announcements<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="6"></td><td><pre>          <span class="token attr-name">:menu-list</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>menu.list<span class="token punctuation">"</span></span> <span class="token attr-name">:menu-items</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>menuItems<span class="token punctuation">"</span></span> <span class="token attr-name">@select-item</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>openItemDetails<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>transition</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fade<span class="token punctuation">"</span></span> <span class="token attr-name">mode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>out-in<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ItemDetail</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>selectedItem &amp;&amp; !showCart<span class="token punctuation">"</span></span> <span class="token attr-name">:item</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>selectedItem<span class="token punctuation">"</span></span> <span class="token attr-name">:addon-items</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>addonItems<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="11"></td><td><pre>          <span class="token attr-name">:menu-items</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>menuItems<span class="token punctuation">"</span></span> <span class="token attr-name">@close</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>closeItemDetails<span class="token punctuation">"</span></span> <span class="token attr-name">@add-to-cart</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>addToCart<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></pre></td></tr><tr><td data-num="12"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>transition</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fade<span class="token punctuation">"</span></span> <span class="token attr-name">mode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>out-in<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ShoppingCart</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>showCart<span class="token punctuation">"</span></span> <span class="token attr-name">:cart</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>cart<span class="token punctuation">"</span></span> <span class="token attr-name">:order-type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>orderType<span class="token punctuation">"</span></span> <span class="token attr-name">:store-id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>storeId<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="16"></td><td><pre>          <span class="token attr-name">:remove-from-cart</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>removeFromCart<span class="token punctuation">"</span></span> <span class="token attr-name">:update-cart-item-quantity</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>updateCartItemQuantity<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="17"></td><td><pre>          <span class="token attr-name">@go-back</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>showCart = false<span class="token punctuation">"</span></span> <span class="token attr-name">@edit-item</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>editCartItem<span class="token punctuation">"</span></span> <span class="token attr-name">@order-submitted</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>handleOrderSubmitted<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></pre></td></tr><tr><td data-num="18"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>transition</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre>      <span class="token comment">&lt;!-- Shopping Cart Button --></span></pre></td></tr><tr><td data-num="21"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>cart.length > 0 &amp;&amp; !selectedItem &amp;&amp; !showCart<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="22"></td><td><pre>        <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>position-fixed bottom-0 start-50 translate-middle-x mb-4<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">z-index</span><span class="token punctuation">:</span> 1030<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="23"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-primary rounded-pill shadow px-4 py-2<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>showCart = true<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="24"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>bi bi-cart-fill me-2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="25"></td><td><pre>          &#123;&#123; getTotalItems() &#125;&#125; 項商品 - $&#123;&#123; calculateTotal() &#125;&#125;</pre></td></tr><tr><td data-num="26"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="27"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="28"></td><td><pre></pre></td></tr><tr><td data-num="29"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="30"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="32"></td><td><pre></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> onMounted<span class="token punctuation">,</span> ref <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> useRoute<span class="token punctuation">,</span> useRouter <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'vue-router'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">'axios'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token keyword">import</span> MenuListing <span class="token keyword">from</span> <span class="token string">'@/components/OrderComponents/Main.vue'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token keyword">import</span> ItemDetail <span class="token keyword">from</span> <span class="token string">'@/components/OrderComponents/ItemDetail.vue'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token keyword">import</span> ShoppingCart <span class="token keyword">from</span> <span class="token string">'@/components/OrderComponents/ShoppingCart.vue'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="40"></td><td><pre></pre></td></tr><tr><td data-num="41"></td><td><pre></pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token keyword">const</span> route <span class="token operator">=</span> <span class="token function">useRoute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="43"></td><td><pre><span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">useRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="44"></td><td><pre><span class="token keyword">const</span> <span class="token constant">API_BASE_URL</span> <span class="token operator">=</span> <span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VITE_API_BASE_URL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="45"></td><td><pre><span class="token keyword">const</span> storeId <span class="token operator">=</span> route<span class="token punctuation">.</span>params<span class="token punctuation">.</span>store<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="46"></td><td><pre><span class="token keyword">const</span> queryOrderType <span class="token operator">=</span> route<span class="token punctuation">.</span>query<span class="token punctuation">.</span>orderType<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="47"></td><td><pre><span class="token keyword">const</span> queryTable <span class="token operator">=</span> route<span class="token punctuation">.</span>query<span class="token punctuation">.</span>table<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="48"></td><td><pre></pre></td></tr><tr><td data-num="49"></td><td><pre><span class="token comment">// State</span></pre></td></tr><tr><td data-num="50"></td><td><pre><span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="51"></td><td><pre><span class="token keyword">const</span> menu <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="52"></td><td><pre><span class="token keyword">const</span> menuItems <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="53"></td><td><pre><span class="token keyword">const</span> addonItems <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="54"></td><td><pre><span class="token keyword">const</span> orderType <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span>queryOrderType <span class="token operator">||</span> <span class="token string">'dineIn'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="55"></td><td><pre><span class="token keyword">const</span> tableNumber <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span>queryTable <span class="token operator">||</span> <span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="56"></td><td><pre><span class="token keyword">const</span> selectedItem <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="57"></td><td><pre><span class="token keyword">const</span> cart <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="58"></td><td><pre><span class="token keyword">const</span> showCart <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="59"></td><td><pre></pre></td></tr><tr><td data-num="60"></td><td><pre><span class="token comment">// Bootstrap modal instance</span></pre></td></tr><tr><td data-num="61"></td><td><pre><span class="token keyword">let</span> cartModal <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="62"></td><td><pre></pre></td></tr><tr><td data-num="63"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">fetchStore</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="64"></td><td><pre>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="65"></td><td><pre>    <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">API_BASE_URL</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/store/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>storeId<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="66"></td><td><pre>    store<span class="token punctuation">.</span>value <span class="token operator">=</span> response<span class="token punctuation">.</span>data<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="67"></td><td><pre>    <span class="token comment">// console.log(store.value);</span></pre></td></tr><tr><td data-num="68"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="69"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Error fetching store:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="70"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="71"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="72"></td><td><pre></pre></td></tr><tr><td data-num="73"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">fetchMenu</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="74"></td><td><pre>  menu<span class="token punctuation">.</span>value <span class="token operator">=</span> store<span class="token punctuation">.</span>value<span class="token punctuation">.</span>menuItem<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="75"></td><td><pre>  <span class="token comment">// console.log('menu', menu.value);</span></pre></td></tr><tr><td data-num="76"></td><td><pre></pre></td></tr><tr><td data-num="77"></td><td><pre>  <span class="token keyword">const</span> itemPromises <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="78"></td><td><pre>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> category <span class="token keyword">of</span> menu<span class="token punctuation">.</span>value<span class="token punctuation">.</span>list<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="79"></td><td><pre>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> item <span class="token keyword">of</span> category<span class="token punctuation">.</span>items<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="80"></td><td><pre>      itemPromises<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">API_BASE_URL</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/dish/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>item<span class="token punctuation">.</span>itemModel<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> item<span class="token punctuation">.</span>itemModel<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>item<span class="token punctuation">.</span>itemId<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="81"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="82"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="83"></td><td><pre></pre></td></tr><tr><td data-num="84"></td><td><pre>  <span class="token keyword">const</span> dishModelMapping <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="85"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span>menu<span class="token punctuation">.</span>value <span class="token operator">&amp;&amp;</span> menu<span class="token punctuation">.</span>value<span class="token punctuation">.</span>list<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="86"></td><td><pre>    menu<span class="token punctuation">.</span>value<span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">category</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="87"></td><td><pre>      category<span class="token punctuation">.</span>items<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="88"></td><td><pre>        dishModelMapping<span class="token punctuation">[</span>item<span class="token punctuation">.</span>itemId<span class="token punctuation">]</span> <span class="token operator">=</span> item<span class="token punctuation">.</span>itemModel<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="89"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="90"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="91"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="92"></td><td><pre>  <span class="token keyword">const</span> itemResponses <span class="token operator">=</span> <span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span>itemPromises<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="93"></td><td><pre>  menuItems<span class="token punctuation">.</span>value <span class="token operator">=</span> itemResponses<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="94"></td><td><pre>    <span class="token keyword">return</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="95"></td><td><pre>      <span class="token operator">...</span>response<span class="token punctuation">.</span>data<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="96"></td><td><pre>      <span class="token literal-property property">itemModel</span><span class="token operator">:</span> dishModelMapping<span class="token punctuation">[</span>response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>_id<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="97"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="98"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="99"></td><td><pre></pre></td></tr><tr><td data-num="100"></td><td><pre>  <span class="token comment">// console.log('menuItems', menuItems.value);</span></pre></td></tr><tr><td data-num="101"></td><td><pre>  <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">data</span><span class="token operator">:</span> addons <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">API_BASE_URL</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/dish/addon</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="102"></td><td><pre>  addonItems<span class="token punctuation">.</span>value <span class="token operator">=</span> addons<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="103"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="104"></td><td><pre></pre></td></tr><tr><td data-num="105"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">openItemDetails</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="106"></td><td><pre>  selectedItem<span class="token punctuation">.</span>value <span class="token operator">=</span> item<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="107"></td><td><pre>  <span class="token comment">// console.log(item);</span></pre></td></tr><tr><td data-num="108"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="109"></td><td><pre></pre></td></tr><tr><td data-num="110"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">closeItemDetails</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="111"></td><td><pre>  selectedItem<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="112"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="113"></td><td><pre></pre></td></tr><tr><td data-num="114"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">addToCart</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="115"></td><td><pre>  cart<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="116"></td><td><pre>  <span class="token comment">// console.log(cart.value);</span></pre></td></tr><tr><td data-num="117"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="118"></td><td><pre></pre></td></tr><tr><td data-num="119"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">openCartModal</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="120"></td><td><pre>  cartModal<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="121"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="122"></td><td><pre></pre></td></tr><tr><td data-num="123"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">updateCartItemQuantity</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">index<span class="token punctuation">,</span> change</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="124"></td><td><pre>  <span class="token keyword">const</span> newQuantity <span class="token operator">=</span> cart<span class="token punctuation">.</span>value<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>quantity <span class="token operator">+</span> change<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="125"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span>newQuantity <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="126"></td><td><pre>    cart<span class="token punctuation">.</span>value<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>quantity <span class="token operator">=</span> newQuantity<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="127"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="128"></td><td><pre>    <span class="token function">removeFromCart</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="129"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="130"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="131"></td><td><pre></pre></td></tr><tr><td data-num="132"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">removeFromCart</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">index</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="133"></td><td><pre>  cart<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="134"></td><td><pre></pre></td></tr><tr><td data-num="135"></td><td><pre>  <span class="token comment">// If cart is empty, go back to menu</span></pre></td></tr><tr><td data-num="136"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span>cart<span class="token punctuation">.</span>value<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="137"></td><td><pre>    showCart<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="138"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="139"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="140"></td><td><pre></pre></td></tr><tr><td data-num="141"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">editCartItem</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">index</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="142"></td><td><pre>  <span class="token keyword">const</span> item <span class="token operator">=</span> menuItems<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">menuItem</span> <span class="token operator">=></span> menuItem<span class="token punctuation">.</span>_id <span class="token operator">===</span> cart<span class="token punctuation">.</span>value<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="143"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="144"></td><td><pre>    <span class="token comment">// Remove the item from cart first</span></pre></td></tr><tr><td data-num="145"></td><td><pre>    <span class="token keyword">const</span> itemToEdit <span class="token operator">=</span> cart<span class="token punctuation">.</span>value<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="146"></td><td><pre>    <span class="token function">removeFromCart</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="147"></td><td><pre></pre></td></tr><tr><td data-num="148"></td><td><pre>    <span class="token comment">// Open the item detail with pre-filled selections</span></pre></td></tr><tr><td data-num="149"></td><td><pre>    selectedItem<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="150"></td><td><pre>      <span class="token operator">...</span>item<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="151"></td><td><pre>      <span class="token literal-property property">preFilled</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="152"></td><td><pre>        <span class="token literal-property property">quantity</span><span class="token operator">:</span> itemToEdit<span class="token punctuation">.</span>quantity<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="153"></td><td><pre>        <span class="token literal-property property">doneness</span><span class="token operator">:</span> itemToEdit<span class="token punctuation">.</span>doneness<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="154"></td><td><pre>        <span class="token literal-property property">sauce</span><span class="token operator">:</span> itemToEdit<span class="token punctuation">.</span>sauce<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="155"></td><td><pre>        <span class="token literal-property property">addons</span><span class="token operator">:</span> itemToEdit<span class="token punctuation">.</span>addons<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="156"></td><td><pre>        <span class="token literal-property property">additionalMeats</span><span class="token operator">:</span> itemToEdit<span class="token punctuation">.</span>additionalMeats<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="157"></td><td><pre>        <span class="token literal-property property">extraOptions</span><span class="token operator">:</span> itemToEdit<span class="token punctuation">.</span>extraOptions<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="158"></td><td><pre>        <span class="token literal-property property">remarks</span><span class="token operator">:</span> itemToEdit<span class="token punctuation">.</span>remarks</pre></td></tr><tr><td data-num="159"></td><td><pre>      <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="160"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="161"></td><td><pre></pre></td></tr><tr><td data-num="162"></td><td><pre>    showCart<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="163"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="164"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="165"></td><td><pre></pre></td></tr><tr><td data-num="166"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">handleOrderSubmitted</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">order</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="167"></td><td><pre>  <span class="token comment">// Clear the cart after order is submitted</span></pre></td></tr><tr><td data-num="168"></td><td><pre>  <span class="token comment">// console.log('Order submitted:', order);</span></pre></td></tr><tr><td data-num="169"></td><td><pre>  cart<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="170"></td><td><pre>  showCart<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="171"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="172"></td><td><pre></pre></td></tr><tr><td data-num="173"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">getTotalItems</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="174"></td><td><pre>  <span class="token keyword">return</span> cart<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">total<span class="token punctuation">,</span> item</span><span class="token punctuation">)</span> <span class="token operator">=></span> total <span class="token operator">+</span> item<span class="token punctuation">.</span>quantity<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="175"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="176"></td><td><pre></pre></td></tr><tr><td data-num="177"></td><td><pre></pre></td></tr><tr><td data-num="178"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">calculateTotal</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="179"></td><td><pre>  <span class="token keyword">return</span> cart<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">total<span class="token punctuation">,</span> item</span><span class="token punctuation">)</span> <span class="token operator">=></span> total <span class="token operator">+</span> <span class="token punctuation">(</span>item<span class="token punctuation">.</span>price <span class="token operator">*</span> item<span class="token punctuation">.</span>quantity<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="180"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="181"></td><td><pre></pre></td></tr><tr><td data-num="182"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">formatAddons</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">addons</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="183"></td><td><pre>  <span class="token keyword">return</span> addons<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">addon</span> <span class="token operator">=></span> addon<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">', '</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="184"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="185"></td><td><pre></pre></td></tr><tr><td data-num="186"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">formatAddationMeats</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">additionalMeats</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="187"></td><td><pre>  <span class="token keyword">return</span> additionalMeats<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">meat</span> <span class="token operator">=></span> meat<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">', '</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="188"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="189"></td><td><pre></pre></td></tr><tr><td data-num="190"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">checkout</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="191"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span>orderType<span class="token punctuation">.</span>value <span class="token operator">===</span> <span class="token string">'dineIn'</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>tableNumber<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="192"></td><td><pre>    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'請輸入桌號'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="193"></td><td><pre>    <span class="token keyword">return</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="194"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="195"></td><td><pre></pre></td></tr><tr><td data-num="196"></td><td><pre>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="197"></td><td><pre>    <span class="token keyword">const</span> orderItems <span class="token operator">=</span> cart<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="198"></td><td><pre>      <span class="token literal-property property">itemModel</span><span class="token operator">:</span> item<span class="token punctuation">.</span>itemModel<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="199"></td><td><pre>      <span class="token literal-property property">itemId</span><span class="token operator">:</span> item<span class="token punctuation">.</span>id<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="200"></td><td><pre>      <span class="token literal-property property">amount</span><span class="token operator">:</span> item<span class="token punctuation">.</span>quantity<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="201"></td><td><pre>      <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="202"></td><td><pre>        <span class="token literal-property property">doneness</span><span class="token operator">:</span> item<span class="token punctuation">.</span>doneness<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="203"></td><td><pre>        <span class="token literal-property property">sauce</span><span class="token operator">:</span> item<span class="token punctuation">.</span>sauce<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="204"></td><td><pre>        <span class="token literal-property property">addons</span><span class="token operator">:</span> item<span class="token punctuation">.</span>addons<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">a</span> <span class="token operator">=></span> a<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="205"></td><td><pre>        <span class="token literal-property property">extraOptions</span><span class="token operator">:</span> item<span class="token punctuation">.</span>extraOptions<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="206"></td><td><pre>        <span class="token literal-property property">additionalMeats</span><span class="token operator">:</span> item<span class="token punctuation">.</span>additionalMeats<span class="token operator">?.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">m</span> <span class="token operator">=></span> m<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="207"></td><td><pre>        <span class="token literal-property property">remarks</span><span class="token operator">:</span> item<span class="token punctuation">.</span>remarks</pre></td></tr><tr><td data-num="208"></td><td><pre>      <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="209"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="210"></td><td><pre></pre></td></tr><tr><td data-num="211"></td><td><pre>    <span class="token keyword">const</span> orderAmount <span class="token operator">=</span> <span class="token function">parseFloat</span><span class="token punctuation">(</span><span class="token function">calculateTotal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="212"></td><td><pre>    <span class="token keyword">const</span> orderData <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="213"></td><td><pre>      <span class="token literal-property property">store</span><span class="token operator">:</span> storeId<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="214"></td><td><pre>      <span class="token literal-property property">orderNumber</span><span class="token operator">:</span> <span class="token function">String</span><span class="token punctuation">(</span><span class="token keyword">await</span> <span class="token function">generateOrderNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="215"></td><td><pre>      <span class="token literal-property property">platform</span><span class="token operator">:</span> <span class="token string">'web'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="216"></td><td><pre>      <span class="token literal-property property">pickupMethod</span><span class="token operator">:</span> orderType<span class="token punctuation">.</span>value <span class="token operator">===</span> <span class="token string">'dineIn'</span> <span class="token operator">?</span> <span class="token string">'內用'</span> <span class="token operator">:</span> <span class="token string">'外帶'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="217"></td><td><pre>      <span class="token literal-property property">paymentMethod</span><span class="token operator">:</span> <span class="token string">'store'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="218"></td><td><pre>      orderAmount<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="219"></td><td><pre>      <span class="token literal-property property">totalPaid</span><span class="token operator">:</span> orderAmount<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="220"></td><td><pre>      <span class="token literal-property property">tableNumber</span><span class="token operator">:</span> orderType<span class="token punctuation">.</span>value <span class="token operator">===</span> <span class="token string">'dineIn'</span> <span class="token operator">?</span> tableNumber<span class="token punctuation">.</span>value <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="221"></td><td><pre>      <span class="token literal-property property">items</span><span class="token operator">:</span> orderItems<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="222"></td><td><pre>      <span class="token literal-property property">remarks</span><span class="token operator">:</span> cart<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=></span> item<span class="token punctuation">.</span>remarks<span class="token punctuation">)</span> <span class="token operator">?</span> cart<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=></span> item<span class="token punctuation">.</span>remarks<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>Boolean<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">' / '</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">null</span></pre></td></tr><tr><td data-num="223"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="224"></td><td><pre></pre></td></tr><tr><td data-num="225"></td><td><pre>    <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">data</span><span class="token operator">:</span> newOrder <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">API_BASE_URL</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/order</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> orderData<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="226"></td><td><pre>    cartModal<span class="token punctuation">.</span><span class="token function">hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="227"></td><td><pre>    router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/customer/confirmation/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>newOrder<span class="token punctuation">.</span>_id<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="228"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="229"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Error creating order:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="230"></td><td><pre>    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'訂單建立失敗，請重試'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="231"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="232"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="233"></td><td><pre></pre></td></tr><tr><td data-num="234"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">generateOrderNumber</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="235"></td><td><pre>  <span class="token keyword">const</span> number <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">API_BASE_URL</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/order/number</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="236"></td><td><pre>  <span class="token keyword">return</span> number<span class="token punctuation">.</span>data<span class="token punctuation">.</span>number<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="237"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="238"></td><td><pre></pre></td></tr><tr><td data-num="239"></td><td><pre><span class="token comment">// Initialize Bootstrap modal</span></pre></td></tr><tr><td data-num="240"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">initModal</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="241"></td><td><pre>  <span class="token comment">// Import Bootstrap's modal JavaScript</span></pre></td></tr><tr><td data-num="242"></td><td><pre>  <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'bootstrap/js/dist/modal'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">module</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="243"></td><td><pre>    <span class="token keyword">const</span> Modal <span class="token operator">=</span> module<span class="token punctuation">.</span>default<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="244"></td><td><pre></pre></td></tr><tr><td data-num="245"></td><td><pre>    <span class="token comment">// Initialize cart modal</span></pre></td></tr><tr><td data-num="246"></td><td><pre>    <span class="token keyword">const</span> cartModalElement <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'cartModal'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="247"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>cartModalElement<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="248"></td><td><pre>      cartModal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Modal</span><span class="token punctuation">(</span>cartModalElement<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="249"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="250"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="251"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="252"></td><td><pre></pre></td></tr><tr><td data-num="253"></td><td><pre><span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="254"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>store<span class="token punctuation">.</span>value<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="255"></td><td><pre>    <span class="token keyword">await</span> <span class="token function">fetchStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="256"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="257"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>menu<span class="token punctuation">.</span>value<span class="token punctuation">.</span>list <span class="token operator">||</span> menu<span class="token punctuation">.</span>value<span class="token punctuation">.</span>list<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="258"></td><td><pre>    <span class="token keyword">await</span> <span class="token function">fetchMenu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="259"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="260"></td><td><pre>  <span class="token function">initModal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="261"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="262"></td><td><pre></pre></td></tr><tr><td data-num="263"></td><td><pre></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="264"></td><td><pre></pre></td></tr><tr><td data-num="265"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css"></pre></td></tr><tr><td data-num="266"></td><td><pre><span class="token selector">.main-container</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="267"></td><td><pre>  <span class="token property">min-height</span><span class="token punctuation">:</span> 100vh<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="268"></td><td><pre>  <span class="token property">background-color</span><span class="token punctuation">:</span> #eaeae668<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="269"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="270"></td><td><pre></pre></td></tr><tr><td data-num="271"></td><td><pre><span class="token selector">.center-container</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="272"></td><td><pre>  <span class="token property">max-width</span><span class="token punctuation">:</span> 768px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="273"></td><td><pre>  <span class="token property">margin</span><span class="token punctuation">:</span> 0 auto<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="274"></td><td><pre>  <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="275"></td><td><pre>  <span class="token property">background-color</span><span class="token punctuation">:</span> #ffffff<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="276"></td><td><pre>  <span class="token property">min-height</span><span class="token punctuation">:</span> 100vh<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="277"></td><td><pre>  <span class="token property">box-shadow</span><span class="token punctuation">:</span> 0 0 10px <span class="token function">rgba</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0.2<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="278"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="279"></td><td><pre></pre></td></tr><tr><td data-num="280"></td><td><pre><span class="token comment">/* 定義過渡動畫 */</span></pre></td></tr><tr><td data-num="281"></td><td><pre><span class="token selector">.fade-enter-active,</pre></td></tr><tr><td data-num="282"></td><td><pre>.fade-leave-active</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="283"></td><td><pre>  <span class="token property">transition</span><span class="token punctuation">:</span> opacity 0.3s ease<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="284"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="285"></td><td><pre></pre></td></tr><tr><td data-num="286"></td><td><pre><span class="token selector">.fade-enter-from,</pre></td></tr><tr><td data-num="287"></td><td><pre>.fade-leave-to</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="288"></td><td><pre>  <span class="token property">opacity</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="289"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="290"></td><td><pre></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><h3 id="餐點列表-及-navbar"><a class="anchor" href="#餐點列表-及-navbar">#</a> 餐點列表 及 navbar</h3>
<ul>
<li>圖片高度 240px</li>
<li>餐點名稱</li>
<li>分隔線</li>
<li>細節選項</li>
<li>分隔線</li>
<li>備註</li>
<li>數量</li>
<li>加入購物車 (之後跳回主頁面)</li>
</ul>
<figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">&lt;!-- MenuListing.vue --></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nav-container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nav-wrapper autohide<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="6"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nav</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>navbar navbar-expand-lg navbar-light<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container-fluid<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="8"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>navbar-brand<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">font-weight</span><span class="token punctuation">:</span> bold<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>奔野牛排 &#123;&#123; storeName &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="9"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nav-link<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> Menu item <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="10"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>nav</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="12"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nav-border<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="13"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>content-wrapper<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">padding</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="16"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">max-height</span><span class="token punctuation">:</span> 200px<span class="token punctuation">;</span> <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span> <span class="token property">padding</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://media.discordapp.net/attachments/1180694061573750784/1343283614644699166/dsa95wawd9_Shinkai_Makoto_dark_city_ocean_mountain_Sword_Art_On_6bf493b4-a797-4e49-b8e8-6f026f259430.png?ex=67bcb5da&amp;is=67bb645a&amp;hm=526a63515c6780ee1600c34b89182880d9457752e869138f9dec2dc96477b88c&amp;=&amp;format=webp&amp;quality=lossless&amp;width=1202&amp;height=676<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pic<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>content-wrapper mt-4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="21"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fw-bold<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>奔野牛排 &#123;&#123; storeName &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="22"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>營業時間： 早上：11:30 ~ 13:30 晚上：5:00 ~ 8:30<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nav-border<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>content-wrapper mt-4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="26"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fw-bold<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>公告：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="27"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>(announcement, index) in announcements<span class="token punctuation">"</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>announcement._id<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="28"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mt-3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="29"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h5</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mb-2 fw-bold<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>&#123;&#123; announcement.title &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h5</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="30"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mb-0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>&#123;&#123; announcement.content &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="31"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="32"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>index &lt; announcements.length - 1<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>my-2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="33"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="34"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="35"></td><td><pre></pre></td></tr><tr><td data-num="36"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nav-border mt-4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="37"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>content-wrapper mt-4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="38"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fw-bold<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>菜單：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="39"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>category in menuList<span class="token punctuation">"</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>category._id<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="40"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h4</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fw-bold mt-3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>&#123;&#123; category.categoryName &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h4</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="41"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 g-4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="42"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item in getItemsInCategory(category)<span class="token punctuation">"</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item._id<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>col<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="43"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>card h-100 shadow-sm<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$emit('select-item', item)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="44"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>card-img-top<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">aspect-ratio</span><span class="token punctuation">:</span> 1/1<span class="token punctuation">;</span> <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="45"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item.image?.url || '/placeholder.jpg'<span class="token punctuation">"</span></span> <span class="token attr-name">:alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item.name<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>w-100 h-100<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="46"></td><td><pre>                  <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">object-fit</span><span class="token punctuation">:</span> cover<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="47"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="48"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>card-body<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="49"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h5</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>card-title<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>&#123;&#123; item.name &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h5</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="50"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>card-text text-danger fw-bold<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>$&#123;&#123; item.price &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="51"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="52"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="53"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="54"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="55"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nav-border mt-4<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">height</span><span class="token punctuation">:</span> 2px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="56"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="57"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="58"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="59"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="60"></td><td><pre></pre></td></tr><tr><td data-num="61"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"></pre></td></tr><tr><td data-num="62"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> onMounted<span class="token punctuation">,</span> onUnmounted <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="63"></td><td><pre></pre></td></tr><tr><td data-num="64"></td><td><pre><span class="token keyword">const</span> props <span class="token operator">=</span> <span class="token function">defineProps</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="65"></td><td><pre>  <span class="token literal-property property">storeName</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="66"></td><td><pre>    <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="67"></td><td><pre>    <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="68"></td><td><pre>    <span class="token keyword">default</span><span class="token operator">:</span> <span class="token string">''</span></pre></td></tr><tr><td data-num="69"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="70"></td><td><pre>  <span class="token literal-property property">announcements</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="71"></td><td><pre>    <span class="token literal-property property">type</span><span class="token operator">:</span> Array<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="72"></td><td><pre>    <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="73"></td><td><pre>    <span class="token function-variable function">default</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="74"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="75"></td><td><pre>  <span class="token literal-property property">menuList</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="76"></td><td><pre>    <span class="token literal-property property">type</span><span class="token operator">:</span> Array<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="77"></td><td><pre>    <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="78"></td><td><pre>    <span class="token function-variable function">default</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="79"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="80"></td><td><pre>  <span class="token literal-property property">menuItems</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="81"></td><td><pre>    <span class="token literal-property property">type</span><span class="token operator">:</span> Array<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="82"></td><td><pre>    <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="83"></td><td><pre>    <span class="token function-variable function">default</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="84"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="85"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="86"></td><td><pre></pre></td></tr><tr><td data-num="87"></td><td><pre><span class="token keyword">const</span> emit <span class="token operator">=</span> <span class="token function">defineEmits</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'select-item'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="88"></td><td><pre></pre></td></tr><tr><td data-num="89"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">getItemsInCategory</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">category</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="90"></td><td><pre>  <span class="token keyword">return</span> props<span class="token punctuation">.</span>menuItems<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="91"></td><td><pre>    <span class="token keyword">return</span> category<span class="token punctuation">.</span>items<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token parameter">catItem</span> <span class="token operator">=></span> catItem<span class="token punctuation">.</span>itemId <span class="token operator">===</span> item<span class="token punctuation">.</span>_id<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="92"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="93"></td><td><pre>    <span class="token keyword">const</span> aOrder <span class="token operator">=</span> category<span class="token punctuation">.</span>items<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=></span> item<span class="token punctuation">.</span>itemId <span class="token operator">===</span> a<span class="token punctuation">.</span>_id<span class="token punctuation">)</span><span class="token operator">?.</span>order <span class="token operator">||</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="94"></td><td><pre>    <span class="token keyword">const</span> bOrder <span class="token operator">=</span> category<span class="token punctuation">.</span>items<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=></span> item<span class="token punctuation">.</span>itemId <span class="token operator">===</span> b<span class="token punctuation">.</span>_id<span class="token punctuation">)</span><span class="token operator">?.</span>order <span class="token operator">||</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="95"></td><td><pre>    <span class="token keyword">return</span> aOrder <span class="token operator">-</span> bOrder<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="96"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="97"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="98"></td><td><pre></pre></td></tr><tr><td data-num="99"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">navbarInit</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="100"></td><td><pre>  <span class="token keyword">const</span> el_autohide <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'.autohide'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="101"></td><td><pre></pre></td></tr><tr><td data-num="102"></td><td><pre>  <span class="token keyword">const</span> navbar_height <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'.navbar'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>offsetHeight <span class="token operator">+</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="103"></td><td><pre>  document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'.content-wrapper'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>paddingTop <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>navbar_height<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">px</span><span class="token template-punctuation string">`</span></span></pre></td></tr><tr><td data-num="104"></td><td><pre></pre></td></tr><tr><td data-num="105"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span>el_autohide<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="106"></td><td><pre>    <span class="token keyword">let</span> last_scroll_top <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="107"></td><td><pre></pre></td></tr><tr><td data-num="108"></td><td><pre>    <span class="token keyword">const</span> <span class="token function-variable function">scrollHandler</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="109"></td><td><pre>      <span class="token keyword">const</span> scroll_top <span class="token operator">=</span> window<span class="token punctuation">.</span>scrollY</pre></td></tr><tr><td data-num="110"></td><td><pre></pre></td></tr><tr><td data-num="111"></td><td><pre>      <span class="token keyword">if</span> <span class="token punctuation">(</span>scroll_top <span class="token operator">></span> navbar_height<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="112"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span>scroll_top <span class="token operator">&lt;</span> last_scroll_top<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="113"></td><td><pre>          el_autohide<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token string">'scrolled-down'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="114"></td><td><pre>          el_autohide<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">'scrolled-up'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="115"></td><td><pre>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="116"></td><td><pre>          el_autohide<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token string">'scrolled-up'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="117"></td><td><pre>          el_autohide<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">'scrolled-down'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="118"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="119"></td><td><pre>      <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="120"></td><td><pre></pre></td></tr><tr><td data-num="121"></td><td><pre>      last_scroll_top <span class="token operator">=</span> scroll_top</pre></td></tr><tr><td data-num="122"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="123"></td><td><pre></pre></td></tr><tr><td data-num="124"></td><td><pre>    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'scroll'</span><span class="token punctuation">,</span> scrollHandler<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="125"></td><td><pre></pre></td></tr><tr><td data-num="126"></td><td><pre>    <span class="token function">onUnmounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="127"></td><td><pre>      window<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">'scroll'</span><span class="token punctuation">,</span> scrollHandler<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="128"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="129"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="130"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="131"></td><td><pre></pre></td></tr><tr><td data-num="132"></td><td><pre><span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="133"></td><td><pre>  <span class="token function">navbarInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="134"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="135"></td><td><pre></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="136"></td><td><pre></pre></td></tr><tr><td data-num="137"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css"></pre></td></tr><tr><td data-num="138"></td><td><pre><span class="token selector">.nav-container</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="139"></td><td><pre>  <span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="140"></td><td><pre>  <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="141"></td><td><pre>  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="142"></td><td><pre>  <span class="token property">max-width</span><span class="token punctuation">:</span> 768px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="143"></td><td><pre>  <span class="token property">z-index</span><span class="token punctuation">:</span> 1030<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="144"></td><td><pre>  <span class="token property">left</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="145"></td><td><pre>  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translateX</span><span class="token punctuation">(</span>-50%<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="146"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="147"></td><td><pre></pre></td></tr><tr><td data-num="148"></td><td><pre><span class="token selector">.nav-wrapper</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="149"></td><td><pre>  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="150"></td><td><pre>  <span class="token property">background-color</span><span class="token punctuation">:</span> #ffffff<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="151"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="152"></td><td><pre></pre></td></tr><tr><td data-num="153"></td><td><pre><span class="token selector">.navbar</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="154"></td><td><pre>  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="155"></td><td><pre>  <span class="token property">background-color</span><span class="token punctuation">:</span> #ffffff<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="156"></td><td><pre>  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="157"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="158"></td><td><pre></pre></td></tr><tr><td data-num="159"></td><td><pre><span class="token selector">.nav-border</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="160"></td><td><pre>  <span class="token property">height</span><span class="token punctuation">:</span> 1px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="161"></td><td><pre>  <span class="token property">background-color</span><span class="token punctuation">:</span> #dee2e6<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="162"></td><td><pre>  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="163"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="164"></td><td><pre></pre></td></tr><tr><td data-num="165"></td><td><pre><span class="token selector">.scrolled-down</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="166"></td><td><pre>  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translateY</span><span class="token punctuation">(</span>-100%<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="167"></td><td><pre>  <span class="token property">transition</span><span class="token punctuation">:</span> all 0.3s ease-in-out<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="168"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="169"></td><td><pre></pre></td></tr><tr><td data-num="170"></td><td><pre><span class="token selector">.scrolled-up</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="171"></td><td><pre>  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translateY</span><span class="token punctuation">(</span>0<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="172"></td><td><pre>  <span class="token property">transition</span><span class="token punctuation">:</span> all 0.3s ease-in-out<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="173"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="174"></td><td><pre></pre></td></tr><tr><td data-num="175"></td><td><pre><span class="token selector">.content-wrapper</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="176"></td><td><pre>  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="177"></td><td><pre>  <span class="token property">padding</span><span class="token punctuation">:</span> 0 15px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="178"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="179"></td><td><pre></pre></td></tr><tr><td data-num="180"></td><td><pre><span class="token selector">.card</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="181"></td><td><pre>  <span class="token property">cursor</span><span class="token punctuation">:</span> pointer<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="182"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="183"></td><td><pre></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><h3 id="各項餐點點餐detail"><a class="anchor" href="#各項餐點點餐detail">#</a> 各項餐點點餐 detail</h3>
<figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item-detail<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token comment">&lt;!-- Header with back button positioned over the image --></span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>header d-flex align-items-center p-3 position-absolute top-0 start-0 w-100 bg-transparent<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-sm rounded-circle shadow<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$emit('close')<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="6"></td><td><pre>        <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span>255<span class="token punctuation">,</span> 255<span class="token punctuation">,</span> 255<span class="token punctuation">,</span> 0.8<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token property">width</span><span class="token punctuation">:</span> 40px<span class="token punctuation">;</span> <span class="token property">height</span><span class="token punctuation">:</span> 40px<span class="token punctuation">;</span> <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span> <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span> <span class="token property">justify-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>bi bi-arrow-left fs-4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="8"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token comment">&lt;!-- Image --></span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>image-container<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">height</span><span class="token punctuation">:</span> 240px<span class="token punctuation">;</span> <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span> <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="13"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item.image?.url <span class="token punctuation">"</span></span> <span class="token attr-name">:alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item.name<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>w-100 h-100<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">object-fit</span><span class="token punctuation">:</span> cover<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token comment">&lt;!-- Item name and price --></span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>p-3 border-bottom<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="18"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h4</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mb-2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>&#123;&#123; item.name &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h4</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="19"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text-danger fw-bold mb-2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>$&#123;&#123; item.price &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="20"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text-muted small<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">white-space</span><span class="token punctuation">:</span> pre-line</span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>&#123;&#123; item.description &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token comment">&lt;!-- Options section --></span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>options p-3 border-bottom<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="25"></td><td><pre>      <span class="token comment">&lt;!-- Steak Doneness options (if applicable) --></span></pre></td></tr><tr><td data-num="26"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item.category === 'Steak'<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mb-4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="27"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h6</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fw-bold mb-2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>熟度選擇<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h6</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="28"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>d-flex flex-wrap<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="29"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>doneness in item.steakDoneness<span class="token punctuation">"</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>doneness<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-check me-3 mb-2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="30"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-check-input<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>radio<span class="token punctuation">"</span></span> <span class="token attr-name">:id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">'</span>doneness-' + doneness<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>selectedDoneness<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="31"></td><td><pre>              <span class="token attr-name">:value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>doneness<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="32"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-check-label<span class="token punctuation">"</span></span> <span class="token attr-name">:for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">'</span>doneness-' + doneness<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>&#123;&#123; doneness &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="33"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="34"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="35"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="36"></td><td><pre></pre></td></tr><tr><td data-num="37"></td><td><pre>      <span class="token comment">&lt;!-- Sauce options (if applicable) --></span></pre></td></tr><tr><td data-num="38"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item.sauceOptions &amp;&amp; item.sauceOptions.length<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mb-4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="39"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h6</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fw-bold mb-2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>醬料選擇<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h6</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="40"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>d-flex flex-wrap<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="41"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sauce in item.sauceOptions<span class="token punctuation">"</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sauce<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-check me-3 mb-2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="42"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-check-input<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>radio<span class="token punctuation">"</span></span> <span class="token attr-name">:id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">'</span>sauce-' + sauce<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>selectedSauce<span class="token punctuation">"</span></span> <span class="token attr-name">:value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sauce<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="43"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-check-label<span class="token punctuation">"</span></span> <span class="token attr-name">:for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">'</span>sauce-' + sauce<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>&#123;&#123; sauce &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="44"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="45"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="46"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="47"></td><td><pre></pre></td></tr><tr><td data-num="48"></td><td><pre>      <span class="token comment">&lt;!-- Add-ons (if applicable for MainDish) --></span></pre></td></tr><tr><td data-num="49"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>addonItems.length > 0 &amp;&amp; item.itemModel === 'MainDish'<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mb-4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="50"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h6</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fw-bold mb-2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>加點選項<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h6</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="51"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>d-flex flex-wrap<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="52"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>addon in addonItems<span class="token punctuation">"</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>addon._id<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-check me-3 mb-2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="53"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-check-input<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>checkbox<span class="token punctuation">"</span></span> <span class="token attr-name">:id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">'</span>addon-' + addon._id<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>selectedAddons<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="54"></td><td><pre>              <span class="token attr-name">:value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>addon._id<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="55"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-check-label<span class="token punctuation">"</span></span> <span class="token attr-name">:for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">'</span>addon-' + addon._id<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="56"></td><td><pre>              &#123;&#123; addon.name &#125;&#125; (+$&#123;&#123; addon.price &#125;&#125;)</pre></td></tr><tr><td data-num="57"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="58"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="59"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="60"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="61"></td><td><pre></pre></td></tr><tr><td data-num="62"></td><td><pre>      <span class="token comment">&lt;!-- Extra options (if applicable) --></span></pre></td></tr><tr><td data-num="63"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item.extraOptions &amp;&amp; item.extraOptions.length<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mb-4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="64"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h6</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fw-bold mb-2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>額外需求<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h6</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="65"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>d-flex flex-wrap<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="66"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>option in item.extraOptions<span class="token punctuation">"</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>option<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-check me-3 mb-2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="67"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-check-input<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>checkbox<span class="token punctuation">"</span></span> <span class="token attr-name">:id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">'</span>extra-' + option<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>selectedExtraOptions<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="68"></td><td><pre>              <span class="token attr-name">:value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>option<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="69"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-check-label<span class="token punctuation">"</span></span> <span class="token attr-name">:for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">'</span>extra-' + option<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="70"></td><td><pre>              &#123;&#123; option &#125;&#125;</pre></td></tr><tr><td data-num="71"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="72"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="73"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="74"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="75"></td><td><pre></pre></td></tr><tr><td data-num="76"></td><td><pre>      <span class="token comment">&lt;!-- Additional meat dishes (if applicable for MainDish) --></span></pre></td></tr><tr><td data-num="77"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>additionalMeatDishes.length > 0 &amp;&amp; item.itemModel === 'MainDish'<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mb-4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="78"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h6</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fw-bold mb-2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>加點其他肉食單品<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h6</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="79"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>d-flex flex-wrap<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="80"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>meat in additionalMeatDishes<span class="token punctuation">"</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>meat._id<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-check me-3 mb-2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="81"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-check-input<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>checkbox<span class="token punctuation">"</span></span> <span class="token attr-name">:id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">'</span>meat-' + meat._id<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>selectedMeatDishes<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="82"></td><td><pre>              <span class="token attr-name">:value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>meat._id<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="83"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-check-label<span class="token punctuation">"</span></span> <span class="token attr-name">:for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">'</span>meat-' + meat._id<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="84"></td><td><pre>              &#123;&#123; meat.name &#125;&#125; (+$&#123;&#123; meat.extraPrice &#125;&#125;)</pre></td></tr><tr><td data-num="85"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="86"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="87"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="88"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="89"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="90"></td><td><pre></pre></td></tr><tr><td data-num="91"></td><td><pre>    <span class="token comment">&lt;!-- Remarks section --></span></pre></td></tr><tr><td data-num="92"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>p-3 border-bottom<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="93"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h6</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fw-bold mb-2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>特殊要求<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h6</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="94"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>textarea</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-control<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>remarks<span class="token punctuation">"</span></span> <span class="token attr-name">rows</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>3<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>例如：不要洋蔥...<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>textarea</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="95"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="96"></td><td><pre></pre></td></tr><tr><td data-num="97"></td><td><pre>    <span class="token comment">&lt;!-- Quantity section --></span></pre></td></tr><tr><td data-num="98"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>p-3 d-flex align-items-center justify-content-between<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="99"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h6</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fw-bold mb-0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>數量<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h6</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="100"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>input-group<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span> 140px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="101"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-outline-secondary<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>decreaseQuantity<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>-<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="102"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-control text-center<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>&#123;&#123; quantity &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="103"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-outline-secondary<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>increaseQuantity<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>+<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="104"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="105"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="106"></td><td><pre></pre></td></tr><tr><td data-num="107"></td><td><pre>    <span class="token comment">&lt;!-- Add to cart button --></span></pre></td></tr><tr><td data-num="108"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>p-3 position-sticky bottom-0 bg-white border-top<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="109"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-primary w-100 py-2<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>addToCart<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="110"></td><td><pre>        加入購物車 - $&#123;&#123; calculateItemTotal() &#125;&#125;</pre></td></tr><tr><td data-num="111"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="112"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="113"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="114"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="115"></td><td><pre></pre></td></tr><tr><td data-num="116"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"></pre></td></tr><tr><td data-num="117"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> ref<span class="token punctuation">,</span> computed<span class="token punctuation">,</span> watch <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="118"></td><td><pre></pre></td></tr><tr><td data-num="119"></td><td><pre><span class="token keyword">const</span> props <span class="token operator">=</span> <span class="token function">defineProps</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="120"></td><td><pre>  <span class="token literal-property property">item</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="121"></td><td><pre>    <span class="token literal-property property">type</span><span class="token operator">:</span> Object<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="122"></td><td><pre>    <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span></pre></td></tr><tr><td data-num="123"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="124"></td><td><pre>  <span class="token literal-property property">addonItems</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="125"></td><td><pre>    <span class="token literal-property property">type</span><span class="token operator">:</span> Array<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="126"></td><td><pre>    <span class="token function-variable function">default</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="127"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="128"></td><td><pre>  <span class="token literal-property property">menuItems</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="129"></td><td><pre>    <span class="token literal-property property">type</span><span class="token operator">:</span> Array<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="130"></td><td><pre>    <span class="token function-variable function">default</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="131"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="132"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="133"></td><td><pre></pre></td></tr><tr><td data-num="134"></td><td><pre><span class="token keyword">const</span> emit <span class="token operator">=</span> <span class="token function">defineEmits</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'close'</span><span class="token punctuation">,</span> <span class="token string">'add-to-cart'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="135"></td><td><pre></pre></td></tr><tr><td data-num="136"></td><td><pre><span class="token comment">// State</span></pre></td></tr><tr><td data-num="137"></td><td><pre><span class="token keyword">const</span> quantity <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="138"></td><td><pre><span class="token keyword">const</span> remarks <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="139"></td><td><pre><span class="token keyword">const</span> selectedDoneness <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="140"></td><td><pre><span class="token keyword">const</span> selectedSauce <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="141"></td><td><pre><span class="token keyword">const</span> selectedAddons <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="142"></td><td><pre><span class="token keyword">const</span> selectedExtraOptions <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="143"></td><td><pre><span class="token keyword">const</span> selectedMeatDishes <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="144"></td><td><pre></pre></td></tr><tr><td data-num="145"></td><td><pre><span class="token comment">// Set default values when item changes</span></pre></td></tr><tr><td data-num="146"></td><td><pre><span class="token function">watch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> props<span class="token punctuation">.</span>item<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">newItem</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="147"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span>newItem<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="148"></td><td><pre>    quantity<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="149"></td><td><pre>    remarks<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="150"></td><td><pre>    selectedDoneness<span class="token punctuation">.</span>value <span class="token operator">=</span> newItem<span class="token punctuation">.</span>steakDoneness <span class="token operator">?</span> newItem<span class="token punctuation">.</span>steakDoneness<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="151"></td><td><pre>    selectedSauce<span class="token punctuation">.</span>value <span class="token operator">=</span> newItem<span class="token punctuation">.</span>sauceOptions <span class="token operator">?</span> newItem<span class="token punctuation">.</span>sauceOptions<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="152"></td><td><pre>    selectedAddons<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="153"></td><td><pre>    selectedExtraOptions<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="154"></td><td><pre>    selectedMeatDishes<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="155"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="156"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">immediate</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="157"></td><td><pre></pre></td></tr><tr><td data-num="158"></td><td><pre><span class="token comment">// Computed</span></pre></td></tr><tr><td data-num="159"></td><td><pre><span class="token keyword">const</span> additionalMeatDishes <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="160"></td><td><pre>  <span class="token keyword">return</span> props<span class="token punctuation">.</span>menuItems<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=></span></pre></td></tr><tr><td data-num="161"></td><td><pre>    item<span class="token punctuation">.</span>itemModel <span class="token operator">===</span> <span class="token string">'MainDish'</span> <span class="token operator">&amp;&amp;</span></pre></td></tr><tr><td data-num="162"></td><td><pre>    item<span class="token punctuation">.</span>extraPrice <span class="token operator">&amp;&amp;</span></pre></td></tr><tr><td data-num="163"></td><td><pre>    item<span class="token punctuation">.</span>_id <span class="token operator">!==</span> props<span class="token punctuation">.</span>item<span class="token operator">?.</span>_id</pre></td></tr><tr><td data-num="164"></td><td><pre>  <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="165"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="166"></td><td><pre></pre></td></tr><tr><td data-num="167"></td><td><pre><span class="token comment">// Methods</span></pre></td></tr><tr><td data-num="168"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">increaseQuantity</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="169"></td><td><pre>  quantity<span class="token punctuation">.</span>value<span class="token operator">++</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="170"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="171"></td><td><pre></pre></td></tr><tr><td data-num="172"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">decreaseQuantity</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="173"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span>quantity<span class="token punctuation">.</span>value <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="174"></td><td><pre>    quantity<span class="token punctuation">.</span>value<span class="token operator">--</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="175"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="176"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="177"></td><td><pre></pre></td></tr><tr><td data-num="178"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">calculateItemTotal</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="179"></td><td><pre>  <span class="token keyword">let</span> total <span class="token operator">=</span> props<span class="token punctuation">.</span>item<span class="token punctuation">.</span>price <span class="token operator">*</span> quantity<span class="token punctuation">.</span>value<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="180"></td><td><pre></pre></td></tr><tr><td data-num="181"></td><td><pre>  <span class="token comment">// Add price for selected addons</span></pre></td></tr><tr><td data-num="182"></td><td><pre>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> addonId <span class="token keyword">of</span> selectedAddons<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="183"></td><td><pre>    <span class="token keyword">const</span> addon <span class="token operator">=</span> props<span class="token punctuation">.</span>addonItems<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">a</span> <span class="token operator">=></span> a<span class="token punctuation">.</span>_id <span class="token operator">===</span> addonId<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="184"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>addon<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="185"></td><td><pre>      total <span class="token operator">+=</span> addon<span class="token punctuation">.</span>price <span class="token operator">*</span> quantity<span class="token punctuation">.</span>value<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="186"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="187"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="188"></td><td><pre></pre></td></tr><tr><td data-num="189"></td><td><pre>  <span class="token comment">// Add price for selected additional meat dishes</span></pre></td></tr><tr><td data-num="190"></td><td><pre>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> meatId <span class="token keyword">of</span> selectedMeatDishes<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="191"></td><td><pre>    <span class="token keyword">const</span> meat <span class="token operator">=</span> props<span class="token punctuation">.</span>menuItems<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">m</span> <span class="token operator">=></span> m<span class="token punctuation">.</span>_id <span class="token operator">===</span> meatId<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="192"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>meat <span class="token operator">&amp;&amp;</span> meat<span class="token punctuation">.</span>extraPrice<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="193"></td><td><pre>      total <span class="token operator">+=</span> meat<span class="token punctuation">.</span>extraPrice <span class="token operator">*</span> quantity<span class="token punctuation">.</span>value<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="194"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="195"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="196"></td><td><pre></pre></td></tr><tr><td data-num="197"></td><td><pre>  <span class="token keyword">return</span> total<span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="198"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="199"></td><td><pre></pre></td></tr><tr><td data-num="200"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">addToCart</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="201"></td><td><pre>  <span class="token comment">// Get selected addon details</span></pre></td></tr><tr><td data-num="202"></td><td><pre>  <span class="token keyword">const</span> addons <span class="token operator">=</span> selectedAddons<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">id</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="203"></td><td><pre>    <span class="token keyword">const</span> addon <span class="token operator">=</span> props<span class="token punctuation">.</span>addonItems<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">a</span> <span class="token operator">=></span> a<span class="token punctuation">.</span>_id <span class="token operator">===</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="204"></td><td><pre>    <span class="token keyword">return</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="205"></td><td><pre>      <span class="token literal-property property">id</span><span class="token operator">:</span> addon<span class="token punctuation">.</span>_id<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="206"></td><td><pre>      <span class="token literal-property property">name</span><span class="token operator">:</span> addon<span class="token punctuation">.</span>name<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="207"></td><td><pre>      <span class="token literal-property property">price</span><span class="token operator">:</span> addon<span class="token punctuation">.</span>price</pre></td></tr><tr><td data-num="208"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="209"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="210"></td><td><pre></pre></td></tr><tr><td data-num="211"></td><td><pre>  <span class="token comment">// Get selected additional meat dishes</span></pre></td></tr><tr><td data-num="212"></td><td><pre>  <span class="token keyword">const</span> additionalMeats <span class="token operator">=</span> selectedMeatDishes<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">id</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="213"></td><td><pre>    <span class="token keyword">const</span> meat <span class="token operator">=</span> props<span class="token punctuation">.</span>menuItems<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">m</span> <span class="token operator">=></span> m<span class="token punctuation">.</span>_id <span class="token operator">===</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="214"></td><td><pre>    <span class="token keyword">return</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="215"></td><td><pre>      <span class="token literal-property property">id</span><span class="token operator">:</span> meat<span class="token punctuation">.</span>_id<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="216"></td><td><pre>      <span class="token literal-property property">name</span><span class="token operator">:</span> meat<span class="token punctuation">.</span>name<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="217"></td><td><pre>      <span class="token literal-property property">price</span><span class="token operator">:</span> meat<span class="token punctuation">.</span>extraPrice</pre></td></tr><tr><td data-num="218"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="219"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="220"></td><td><pre></pre></td></tr><tr><td data-num="221"></td><td><pre>  <span class="token keyword">const</span> cartItem <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="222"></td><td><pre>    <span class="token literal-property property">id</span><span class="token operator">:</span> props<span class="token punctuation">.</span>item<span class="token punctuation">.</span>_id<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="223"></td><td><pre>    <span class="token literal-property property">itemModel</span><span class="token operator">:</span> props<span class="token punctuation">.</span>item<span class="token punctuation">.</span>itemModel<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="224"></td><td><pre>    <span class="token literal-property property">name</span><span class="token operator">:</span> props<span class="token punctuation">.</span>item<span class="token punctuation">.</span>name<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="225"></td><td><pre>    <span class="token literal-property property">price</span><span class="token operator">:</span> <span class="token function">calculateItemTotal</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> quantity<span class="token punctuation">.</span>value<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="226"></td><td><pre>    <span class="token literal-property property">quantity</span><span class="token operator">:</span> quantity<span class="token punctuation">.</span>value<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="227"></td><td><pre>    <span class="token literal-property property">doneness</span><span class="token operator">:</span> selectedDoneness<span class="token punctuation">.</span>value<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="228"></td><td><pre>    <span class="token literal-property property">sauce</span><span class="token operator">:</span> selectedSauce<span class="token punctuation">.</span>value<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="229"></td><td><pre>    addons<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="230"></td><td><pre>    <span class="token literal-property property">extraOptions</span><span class="token operator">:</span> selectedExtraOptions<span class="token punctuation">.</span>value<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="231"></td><td><pre>    additionalMeats<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="232"></td><td><pre>    <span class="token literal-property property">remarks</span><span class="token operator">:</span> remarks<span class="token punctuation">.</span>value</pre></td></tr><tr><td data-num="233"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="234"></td><td><pre></pre></td></tr><tr><td data-num="235"></td><td><pre>  <span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'add-to-cart'</span><span class="token punctuation">,</span> cartItem<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="236"></td><td><pre>  <span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'close'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="237"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="238"></td><td><pre></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="239"></td><td><pre></pre></td></tr><tr><td data-num="240"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css"></pre></td></tr><tr><td data-num="241"></td><td><pre><span class="token selector">.item-detail</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="242"></td><td><pre>  <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="243"></td><td><pre>  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="244"></td><td><pre>  <span class="token property">flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="245"></td><td><pre>  <span class="token property">background-color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="246"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="247"></td><td><pre></pre></td></tr><tr><td data-num="248"></td><td><pre><span class="token selector">.header</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="249"></td><td><pre>  <span class="token property">background-color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="250"></td><td><pre>  <span class="token property">position</span><span class="token punctuation">:</span> sticky<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="251"></td><td><pre>  <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="252"></td><td><pre>  <span class="token property">z-index</span><span class="token punctuation">:</span> 10<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="253"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="254"></td><td><pre></pre></td></tr><tr><td data-num="255"></td><td><pre><span class="token selector">.options</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="256"></td><td><pre>  <span class="token property">overflow-y</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="257"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="258"></td><td><pre></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><h3 id="shoppingcart"><a class="anchor" href="#shoppingcart">#</a> ShoppingCart</h3>
<ul>
<li>最上層有個返回按鈕 還有中間顯示購物車</li>
<li>分隔線</li>
<li>訂單內容 顯示所有訂購餐點 每個餐點的細節也都顯示，熟度 (如果是牛排)，醬料，加點 (如果有)，加點肉品 (如果有)，額外需求 (如果有)，備註</li>
<li>顯示餐點價格跟刪除還有修改按鈕</li>
<li>訂單備註</li>
<li>會員折價券</li>
<li>取餐時間</li>
<li>付款方式</li>
<li>總計金額</li>
<li>送出訂單 (按鈕 顯示總價)，會有確認 modal 跳出</li>
</ul>
<figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>cart-page<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token comment">&lt;!-- Header --></span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>cart-header p-3 d-flex align-items-center bg-white shadow-sm<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-link text-dark p-0<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>goBack<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="6"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>bi bi-arrow-left fs-4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="8"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h5</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mb-0 mx-auto<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>購物車<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h5</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>divider<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token comment">&lt;!-- Empty Cart Message --></span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>cart.length === 0<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text-center p-5 text-muted<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="15"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>bi bi-cart-x fs-1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="16"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mt-3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>購物車是空的<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="17"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-primary mt-3<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>goBack<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>返回菜單<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token comment">&lt;!-- Cart Content --></span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-else</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>cart-content p-3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="22"></td><td><pre>      <span class="token comment">&lt;!-- Order Items --></span></pre></td></tr><tr><td data-num="23"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>order-items mb-4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h6</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mb-3 fw-bold<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>訂單內容<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h6</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="25"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>(item, index) in cart<span class="token punctuation">"</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>index<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>cart-item card mb-3 border-0 shadow-sm<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="26"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>card-body<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="27"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>d-flex justify-content-between align-items-start mb-2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="28"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h6</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>card-title mb-0 fw-bold<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>&#123;&#123; item.name &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h6</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="29"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item-price fw-bold<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>$&#123;&#123; (item.price * item.quantity) &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="30"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="31"></td><td><pre></pre></td></tr><tr><td data-num="32"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item-details mb-3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="33"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>card-text small mb-1<span class="token punctuation">"</span></span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item.doneness<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>熟度: &#123;&#123; item.doneness &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="34"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>card-text small mb-1<span class="token punctuation">"</span></span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item.sauce<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>醬料: &#123;&#123; item.sauce &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="35"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>card-text small mb-1<span class="token punctuation">"</span></span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item.addons &amp;&amp; item.addons.length<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="36"></td><td><pre>                加點: &#123;&#123; formatAddons(item.addons) &#125;&#125;</pre></td></tr><tr><td data-num="37"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="38"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>card-text small mb-1<span class="token punctuation">"</span></span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item.additionalMeats &amp;&amp; item.additionalMeats.length<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="39"></td><td><pre>                加點肉品: &#123;&#123; formatAdditionalMeats(item.additionalMeats) &#125;&#125;</pre></td></tr><tr><td data-num="40"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="41"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>card-text small mb-1<span class="token punctuation">"</span></span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item.extraOptions &amp;&amp; item.extraOptions.length<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="42"></td><td><pre>                額外需求: &#123;&#123; item.extraOptions.join(', ') &#125;&#125;</pre></td></tr><tr><td data-num="43"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="44"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>card-text small mb-1<span class="token punctuation">"</span></span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item.remarks<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="45"></td><td><pre>                備註: &#123;&#123; item.remarks &#125;&#125;</pre></td></tr><tr><td data-num="46"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="47"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="48"></td><td><pre></pre></td></tr><tr><td data-num="49"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>d-flex justify-content-between align-items-center<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="50"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>d-flex<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="51"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-sm btn-outline-danger me-2<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>removeFromCart(index)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="52"></td><td><pre>                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>bi bi-trash<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="53"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="54"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-sm btn-outline-secondary<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>editItem(index)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="55"></td><td><pre>                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>bi bi-pencil<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="56"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="57"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="58"></td><td><pre></pre></td></tr><tr><td data-num="59"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>quantity-control d-flex align-items-center<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="60"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-sm btn-outline-secondary<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>updateCartItemQuantity(index, -1)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>-<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="61"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mx-2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>&#123;&#123; item.quantity &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="62"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-sm btn-outline-secondary<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>updateCartItemQuantity(index, 1)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>+<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="63"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="64"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="65"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="66"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="67"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="68"></td><td><pre></pre></td></tr><tr><td data-num="69"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>divider<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="70"></td><td><pre></pre></td></tr><tr><td data-num="71"></td><td><pre>      <span class="token comment">&lt;!-- Order Notes --></span></pre></td></tr><tr><td data-num="72"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>order-notes mb-4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="73"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h6</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mb-3 fw-bold<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>訂單備註<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h6</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="74"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>textarea</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-control<span class="token punctuation">"</span></span> <span class="token attr-name">rows</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>有特殊需求嗎？請告訴我們<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>orderRemarks<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>textarea</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="75"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="76"></td><td><pre></pre></td></tr><tr><td data-num="77"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>divider<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="78"></td><td><pre></pre></td></tr><tr><td data-num="79"></td><td><pre>      <span class="token comment">&lt;!-- Member Coupon --></span></pre></td></tr><tr><td data-num="80"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>member-coupon mb-4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="81"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h6</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mb-3 fw-bold<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>會員折價券<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h6</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="82"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>d-flex align-items-center<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="83"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-select<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>selectedCoupon<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="84"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>不使用優惠券<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="85"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>coupon in availableCoupons<span class="token punctuation">"</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>coupon.id<span class="token punctuation">"</span></span> <span class="token attr-name">:value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>coupon.id<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="86"></td><td><pre>              &#123;&#123; coupon.name &#125;&#125; - 折抵 $&#123;&#123; coupon.value &#125;&#125;</pre></td></tr><tr><td data-num="87"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="88"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="89"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="90"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="91"></td><td><pre></pre></td></tr><tr><td data-num="92"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>divider<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="93"></td><td><pre></pre></td></tr><tr><td data-num="94"></td><td><pre>      <span class="token comment">&lt;!-- Pickup Method --></span></pre></td></tr><tr><td data-num="95"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pickup-method mb-4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="96"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h6</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mb-3 fw-bold<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>取餐方式<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h6</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="97"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>d-flex flex-wrap<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="98"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-check me-4 mb-3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="99"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-check-input<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>radio<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pickupMethod<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dineIn<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dineIn<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pickupMethod<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="100"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-check-label<span class="token punctuation">"</span></span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dineIn<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>內用<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="101"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="102"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-check me-4 mb-3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="103"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-check-input<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>radio<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pickupMethod<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>selfPickup<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>selfPickup<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pickupMethod<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="104"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-check-label<span class="token punctuation">"</span></span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>selfPickup<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>自取<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="105"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="106"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-check mb-3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="107"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-check-input<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>radio<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pickupMethod<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>delivery<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>delivery<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pickupMethod<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="108"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-check-label<span class="token punctuation">"</span></span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>delivery<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>外送<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="109"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="110"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="111"></td><td><pre></pre></td></tr><tr><td data-num="112"></td><td><pre>        <span class="token comment">&lt;!-- Conditional fields based on pickup method --></span></pre></td></tr><tr><td data-num="113"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pickupMethod === 'dineIn'<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mt-3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="114"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>tableNumber<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-label<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>桌號<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="115"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-control<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>tableNumber<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>tableNumber<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>請輸入桌號<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="116"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="117"></td><td><pre></pre></td></tr><tr><td data-num="118"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pickupMethod === 'delivery'<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mt-3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="119"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>deliveryAddress<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-label<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>外送地址<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="120"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>textarea</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-control<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>deliveryAddress<span class="token punctuation">"</span></span> <span class="token attr-name">rows</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>deliveryAddress<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>請輸入詳細外送地址<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>textarea</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="121"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="122"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="123"></td><td><pre></pre></td></tr><tr><td data-num="124"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>divider<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="125"></td><td><pre></pre></td></tr><tr><td data-num="126"></td><td><pre>      <span class="token comment">&lt;!-- Pickup Time --></span></pre></td></tr><tr><td data-num="127"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pickup-time mt-2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="128"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h6</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mb-3 fw-bold<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>取餐時間<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h6</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="129"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>d-flex<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="130"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-check me-4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="131"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-check-input<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>radio<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pickupTime<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>asap<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>asap<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pickupTime<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="132"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-check-label<span class="token punctuation">"</span></span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>asap<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>盡快取餐<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="133"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="134"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-check<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="135"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-check-input<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>radio<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pickupTime<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>scheduled<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>scheduled<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="136"></td><td><pre>              <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pickupTime<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="137"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-check-label<span class="token punctuation">"</span></span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>scheduled<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>預約時間<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="138"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="139"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="140"></td><td><pre></pre></td></tr><tr><td data-num="141"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pickupTime === 'scheduled'<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mt-3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="142"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>datetime-local<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-control<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>scheduledTime<span class="token punctuation">"</span></span> <span class="token attr-name">:min</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>minPickupTime<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="143"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="144"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="145"></td><td><pre></pre></td></tr><tr><td data-num="146"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>divider<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="147"></td><td><pre></pre></td></tr><tr><td data-num="148"></td><td><pre>      <span class="token comment">&lt;!-- Payment Method --></span></pre></td></tr><tr><td data-num="149"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>payment-method mt-2 mb-2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="150"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h6</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mb-3 fw-bold<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>付款方式<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h6</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="151"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>d-flex flex-wrap<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="152"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-check me-4 mb-2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="153"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-check-input<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>radio<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>paymentMethod<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>cash<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>cash<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="154"></td><td><pre>              <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>paymentMethod<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="155"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-check-label<span class="token punctuation">"</span></span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>cash<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>現金支付<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="156"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="157"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-check me-4 mb-2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="158"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-check-input<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>radio<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>paymentMethod<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>creditCard<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>creditCard<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="159"></td><td><pre>              <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>paymentMethod<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="160"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-check-label<span class="token punctuation">"</span></span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>creditCard<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>信用卡<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="161"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="162"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-check mb-2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="163"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-check-input<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>radio<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>paymentMethod<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>linePay<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>linePay<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="164"></td><td><pre>              <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>paymentMethod<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="165"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-check-label<span class="token punctuation">"</span></span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>linePay<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>LINE Pay<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="166"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="167"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="168"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="169"></td><td><pre></pre></td></tr><tr><td data-num="170"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>divider<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="171"></td><td><pre></pre></td></tr><tr><td data-num="172"></td><td><pre>      <span class="token comment">&lt;!-- Order Total --></span></pre></td></tr><tr><td data-num="173"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>order-total mb-4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="174"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>d-flex justify-content-between mb-2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="175"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>小計<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="176"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>$&#123;&#123; calculateSubtotal() &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="177"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="178"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>d-flex justify-content-between mb-2<span class="token punctuation">"</span></span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>couponDiscount > 0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="179"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>優惠折扣<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="180"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>-$&#123;&#123; couponDiscount &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="181"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="182"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>d-flex justify-content-between mb-2<span class="token punctuation">"</span></span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>deliveryFee > 0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="183"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>外送費<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="184"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>$&#123;&#123; deliveryFee &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="185"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="186"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>d-flex justify-content-between fw-bold<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="187"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>總計<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="188"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>$&#123;&#123; calculateTotal() &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="189"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="190"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="191"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="192"></td><td><pre></pre></td></tr><tr><td data-num="193"></td><td><pre>    <span class="token comment">&lt;!-- Fixed Bottom Button --></span></pre></td></tr><tr><td data-num="194"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>cart.length > 0<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="195"></td><td><pre>      <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>checkout-button position-fixed bottom-0 start-25 w-100 bg-white p-3 shadow-lg d-flex justify-content-center<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">max-width</span><span class="token punctuation">:</span> 768px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="196"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container-button<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">max-width</span><span class="token punctuation">:</span> 768px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="197"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn w-100 py-2 checkout-btn<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>showConfirmation<span class="token punctuation">"</span></span> <span class="token attr-name">:disabled</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>isSubmitDisabled<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="198"></td><td><pre>          前往結帳 - $&#123;&#123; calculateTotal() &#125;&#125;</pre></td></tr><tr><td data-num="199"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="200"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="201"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="202"></td><td><pre></pre></td></tr><tr><td data-num="203"></td><td><pre>    <span class="token comment">&lt;!-- Confirmation Modal --></span></pre></td></tr><tr><td data-num="204"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>modal fade<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>confirmOrderModal<span class="token punctuation">"</span></span> <span class="token attr-name">tabindex</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>-1<span class="token punctuation">"</span></span> <span class="token attr-name">aria-labelledby</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>confirmOrderModalLabel<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="205"></td><td><pre>      <span class="token attr-name">aria-hidden</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="206"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>modal-dialog modal-dialog-centered<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="207"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>modal-content<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="208"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>modal-header<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="209"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h5</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>modal-title<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>confirmOrderModalLabel<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>確認訂單<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h5</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="210"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn-close<span class="token punctuation">"</span></span> <span class="token attr-name">data-bs-dismiss</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>modal<span class="token punctuation">"</span></span> <span class="token attr-name">aria-label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Close<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="211"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="212"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>modal-body<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="213"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>請確認您的訂單資訊：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="214"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mb-3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="215"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>strong</span><span class="token punctuation">></span></span>取餐方式：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>strong</span><span class="token punctuation">></span></span> &#123;&#123; formatPickupMethod() &#125;&#125;</pre></td></tr><tr><td data-num="216"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pickupMethod === 'dineIn'<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>（桌號：&#123;&#123; tableNumber &#125;&#125;）<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="217"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pickupMethod === 'delivery'<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mt-2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="218"></td><td><pre>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>strong</span><span class="token punctuation">></span></span>外送地址：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>strong</span><span class="token punctuation">></span></span> &#123;&#123; deliveryAddress &#125;&#125;</pre></td></tr><tr><td data-num="219"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="220"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="221"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mb-3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="222"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>strong</span><span class="token punctuation">></span></span>取餐時間：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>strong</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="223"></td><td><pre>              &#123;&#123; pickupTime === 'asap' ? '盡快取餐' : '預約時間：' + formatScheduledTime() &#125;&#125;</pre></td></tr><tr><td data-num="224"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="225"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mb-3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="226"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>strong</span><span class="token punctuation">></span></span>付款方式：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>strong</span><span class="token punctuation">></span></span> &#123;&#123; formatPaymentMethod() &#125;&#125;</pre></td></tr><tr><td data-num="227"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="228"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mb-3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="229"></td><td><pre>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>strong</span><span class="token punctuation">></span></span>總金額：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>strong</span><span class="token punctuation">></span></span> $&#123;&#123; calculateTotal() &#125;&#125;</pre></td></tr><tr><td data-num="230"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="231"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="232"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>modal-footer<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="233"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-secondary<span class="token punctuation">"</span></span> <span class="token attr-name">data-bs-dismiss</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>modal<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>返回修改<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="234"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-primary<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submitOrder<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>確認送出<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="235"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="236"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="237"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="238"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="239"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="240"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="241"></td><td><pre></pre></td></tr><tr><td data-num="242"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"></pre></td></tr><tr><td data-num="243"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> ref<span class="token punctuation">,</span> computed<span class="token punctuation">,</span> onMounted<span class="token punctuation">,</span> watch <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="244"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> useRouter<span class="token punctuation">,</span> useRoute <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'vue-router'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="245"></td><td><pre><span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">'axios'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="246"></td><td><pre></pre></td></tr><tr><td data-num="247"></td><td><pre><span class="token keyword">const</span> props <span class="token operator">=</span> <span class="token function">defineProps</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="248"></td><td><pre>  <span class="token literal-property property">cart</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="249"></td><td><pre>    <span class="token literal-property property">type</span><span class="token operator">:</span> Array<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="250"></td><td><pre>    <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span></pre></td></tr><tr><td data-num="251"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="252"></td><td><pre>  <span class="token literal-property property">storeId</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="253"></td><td><pre>    <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="254"></td><td><pre>    <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span></pre></td></tr><tr><td data-num="255"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="256"></td><td><pre>  <span class="token literal-property property">removeFromCart</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="257"></td><td><pre>    <span class="token literal-property property">type</span><span class="token operator">:</span> Function<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="258"></td><td><pre>    <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span></pre></td></tr><tr><td data-num="259"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="260"></td><td><pre>  <span class="token literal-property property">updateCartItemQuantity</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="261"></td><td><pre>    <span class="token literal-property property">type</span><span class="token operator">:</span> Function<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="262"></td><td><pre>    <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span></pre></td></tr><tr><td data-num="263"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="264"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="265"></td><td><pre></pre></td></tr><tr><td data-num="266"></td><td><pre><span class="token keyword">const</span> emit <span class="token operator">=</span> <span class="token function">defineEmits</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'goBack'</span><span class="token punctuation">,</span> <span class="token string">'editItem'</span><span class="token punctuation">,</span> <span class="token string">'orderSubmitted'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="267"></td><td><pre></pre></td></tr><tr><td data-num="268"></td><td><pre><span class="token keyword">const</span> route <span class="token operator">=</span> <span class="token function">useRoute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="269"></td><td><pre><span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">useRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="270"></td><td><pre><span class="token keyword">const</span> <span class="token constant">API_BASE_URL</span> <span class="token operator">=</span> <span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VITE_API_BASE_URL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="271"></td><td><pre></pre></td></tr><tr><td data-num="272"></td><td><pre><span class="token comment">// Query parameters</span></pre></td></tr><tr><td data-num="273"></td><td><pre><span class="token keyword">const</span> queryPickupMethod <span class="token operator">=</span> route<span class="token punctuation">.</span>query<span class="token punctuation">.</span>pickupMethod<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="274"></td><td><pre><span class="token keyword">const</span> queryTable <span class="token operator">=</span> route<span class="token punctuation">.</span>query<span class="token punctuation">.</span>table<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="275"></td><td><pre></pre></td></tr><tr><td data-num="276"></td><td><pre><span class="token comment">// State</span></pre></td></tr><tr><td data-num="277"></td><td><pre><span class="token keyword">const</span> orderRemarks <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="278"></td><td><pre><span class="token keyword">const</span> selectedCoupon <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="279"></td><td><pre><span class="token keyword">const</span> pickupTime <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">'asap'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="280"></td><td><pre><span class="token keyword">const</span> scheduledTime <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="281"></td><td><pre><span class="token keyword">const</span> paymentMethod <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">'cash'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="282"></td><td><pre><span class="token keyword">const</span> confirmModal <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="283"></td><td><pre><span class="token keyword">const</span> couponDiscount <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="284"></td><td><pre></pre></td></tr><tr><td data-num="285"></td><td><pre><span class="token comment">// Pickup method state</span></pre></td></tr><tr><td data-num="286"></td><td><pre><span class="token keyword">const</span> pickupMethod <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span>queryPickupMethod <span class="token operator">||</span> <span class="token string">'selfPickup'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Default to self-pickup</span></pre></td></tr><tr><td data-num="287"></td><td><pre><span class="token keyword">const</span> tableNumber <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span>queryTable <span class="token operator">||</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// For dine-in</span></pre></td></tr><tr><td data-num="288"></td><td><pre><span class="token keyword">const</span> deliveryAddress <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// For delivery</span></pre></td></tr><tr><td data-num="289"></td><td><pre><span class="token keyword">const</span> deliveryFee <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Delivery fee</span></pre></td></tr><tr><td data-num="290"></td><td><pre></pre></td></tr><tr><td data-num="291"></td><td><pre><span class="token comment">// Sample available coupons (would be fetched from API in real implementation)</span></pre></td></tr><tr><td data-num="292"></td><td><pre><span class="token keyword">const</span> availableCoupons <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span></pre></td></tr><tr><td data-num="293"></td><td><pre>  <span class="token punctuation">&#123;</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">'coupon1'</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'新會員折扣'</span><span class="token punctuation">,</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">50</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="294"></td><td><pre>  <span class="token punctuation">&#123;</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">'coupon2'</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'生日特惠'</span><span class="token punctuation">,</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">100</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="295"></td><td><pre>  <span class="token punctuation">&#123;</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">'coupon3'</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'滿千折百'</span><span class="token punctuation">,</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">100</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="296"></td><td><pre><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="297"></td><td><pre></pre></td></tr><tr><td data-num="298"></td><td><pre><span class="token comment">// Minimum pickup time (current time + 15 minutes)</span></pre></td></tr><tr><td data-num="299"></td><td><pre><span class="token keyword">const</span> minPickupTime <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="300"></td><td><pre>  <span class="token keyword">const</span> date <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="301"></td><td><pre>  date<span class="token punctuation">.</span><span class="token function">setMinutes</span><span class="token punctuation">(</span>date<span class="token punctuation">.</span><span class="token function">getMinutes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="302"></td><td><pre>  <span class="token keyword">return</span> date<span class="token punctuation">.</span><span class="token function">toISOString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="303"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="304"></td><td><pre></pre></td></tr><tr><td data-num="305"></td><td><pre><span class="token comment">// Check if submit button should be disabled</span></pre></td></tr><tr><td data-num="306"></td><td><pre><span class="token keyword">const</span> isSubmitDisabled <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="307"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span>pickupMethod<span class="token punctuation">.</span>value <span class="token operator">===</span> <span class="token string">'dineIn'</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>tableNumber<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="308"></td><td><pre>    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="309"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="310"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span>pickupMethod<span class="token punctuation">.</span>value <span class="token operator">===</span> <span class="token string">'delivery'</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>deliveryAddress<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="311"></td><td><pre>    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="312"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="313"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span>pickupTime<span class="token punctuation">.</span>value <span class="token operator">===</span> <span class="token string">'scheduled'</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>scheduledTime<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="314"></td><td><pre>    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="315"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="316"></td><td><pre>  <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="317"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="318"></td><td><pre></pre></td></tr><tr><td data-num="319"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">calculateSubtotal</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="320"></td><td><pre>  <span class="token keyword">return</span> props<span class="token punctuation">.</span>cart<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">total<span class="token punctuation">,</span> item</span><span class="token punctuation">)</span> <span class="token operator">=></span> total <span class="token operator">+</span> <span class="token punctuation">(</span>item<span class="token punctuation">.</span>price <span class="token operator">*</span> item<span class="token punctuation">.</span>quantity<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="321"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="322"></td><td><pre></pre></td></tr><tr><td data-num="323"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">calculateTotal</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="324"></td><td><pre>  <span class="token keyword">const</span> subtotal <span class="token operator">=</span> <span class="token function">parseFloat</span><span class="token punctuation">(</span><span class="token function">calculateSubtotal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="325"></td><td><pre>  <span class="token keyword">return</span> <span class="token punctuation">(</span>subtotal <span class="token operator">-</span> couponDiscount<span class="token punctuation">.</span>value <span class="token operator">+</span> deliveryFee<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="326"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="327"></td><td><pre></pre></td></tr><tr><td data-num="328"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">formatAddons</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">addons</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="329"></td><td><pre>  <span class="token keyword">return</span> addons<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">addon</span> <span class="token operator">=></span> addon<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">', '</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="330"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="331"></td><td><pre></pre></td></tr><tr><td data-num="332"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">formatAdditionalMeats</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">additionalMeats</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="333"></td><td><pre>  <span class="token keyword">return</span> additionalMeats<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">meat</span> <span class="token operator">=></span> meat<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">', '</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="334"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="335"></td><td><pre></pre></td></tr><tr><td data-num="336"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">formatPaymentMethod</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="337"></td><td><pre>  <span class="token keyword">const</span> methods <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="338"></td><td><pre>    <span class="token string-property property">'cash'</span><span class="token operator">:</span> <span class="token string">'現金支付'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="339"></td><td><pre>    <span class="token string-property property">'creditCard'</span><span class="token operator">:</span> <span class="token string">'信用卡'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="340"></td><td><pre>    <span class="token string-property property">'linePay'</span><span class="token operator">:</span> <span class="token string">'LINE Pay'</span></pre></td></tr><tr><td data-num="341"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="342"></td><td><pre>  <span class="token keyword">return</span> methods<span class="token punctuation">[</span>paymentMethod<span class="token punctuation">.</span>value<span class="token punctuation">]</span> <span class="token operator">||</span> paymentMethod<span class="token punctuation">.</span>value<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="343"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="344"></td><td><pre></pre></td></tr><tr><td data-num="345"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">formatPickupMethod</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="346"></td><td><pre>  <span class="token keyword">const</span> methods <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="347"></td><td><pre>    <span class="token string-property property">'dineIn'</span><span class="token operator">:</span> <span class="token string">'內用'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="348"></td><td><pre>    <span class="token string-property property">'selfPickup'</span><span class="token operator">:</span> <span class="token string">'自取'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="349"></td><td><pre>    <span class="token string-property property">'delivery'</span><span class="token operator">:</span> <span class="token string">'外送'</span></pre></td></tr><tr><td data-num="350"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="351"></td><td><pre>  <span class="token keyword">return</span> methods<span class="token punctuation">[</span>pickupMethod<span class="token punctuation">.</span>value<span class="token punctuation">]</span> <span class="token operator">||</span> pickupMethod<span class="token punctuation">.</span>value<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="352"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="353"></td><td><pre></pre></td></tr><tr><td data-num="354"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">formatScheduledTime</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="355"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>scheduledTime<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="356"></td><td><pre></pre></td></tr><tr><td data-num="357"></td><td><pre>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="358"></td><td><pre>    <span class="token keyword">const</span> date <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>scheduledTime<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="359"></td><td><pre>    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>date<span class="token punctuation">.</span><span class="token function">toLocaleDateString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>date<span class="token punctuation">.</span><span class="token function">toLocaleTimeString</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">hour</span><span class="token operator">:</span> <span class="token string">'2-digit'</span><span class="token punctuation">,</span> <span class="token literal-property property">minute</span><span class="token operator">:</span> <span class="token string">'2-digit'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="360"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="361"></td><td><pre>    <span class="token keyword">return</span> scheduledTime<span class="token punctuation">.</span>value<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="362"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="363"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="364"></td><td><pre></pre></td></tr><tr><td data-num="365"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">goBack</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="366"></td><td><pre>  <span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'goBack'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="367"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="368"></td><td><pre></pre></td></tr><tr><td data-num="369"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">editItem</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">index</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="370"></td><td><pre>  <span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'editItem'</span><span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="371"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="372"></td><td><pre></pre></td></tr><tr><td data-num="373"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">showConfirmation</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="374"></td><td><pre>  confirmModal<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="375"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="376"></td><td><pre></pre></td></tr><tr><td data-num="377"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">generateOrderNumber</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="378"></td><td><pre>  <span class="token keyword">const</span> number <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">API_BASE_URL</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/order/number</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="379"></td><td><pre>  <span class="token keyword">return</span> number<span class="token punctuation">.</span>data<span class="token punctuation">.</span>number<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="380"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="381"></td><td><pre></pre></td></tr><tr><td data-num="382"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">submitOrder</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="383"></td><td><pre>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="384"></td><td><pre>    <span class="token keyword">const</span> orderItems <span class="token operator">=</span> props<span class="token punctuation">.</span>cart<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="385"></td><td><pre>      <span class="token literal-property property">itemModel</span><span class="token operator">:</span> item<span class="token punctuation">.</span>itemModel<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="386"></td><td><pre>      <span class="token literal-property property">itemId</span><span class="token operator">:</span> item<span class="token punctuation">.</span>id<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="387"></td><td><pre>      <span class="token literal-property property">amount</span><span class="token operator">:</span> item<span class="token punctuation">.</span>quantity<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="388"></td><td><pre>      <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="389"></td><td><pre>        <span class="token literal-property property">doneness</span><span class="token operator">:</span> item<span class="token punctuation">.</span>doneness<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="390"></td><td><pre>        <span class="token literal-property property">sauce</span><span class="token operator">:</span> item<span class="token punctuation">.</span>sauce<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="391"></td><td><pre>        <span class="token literal-property property">addons</span><span class="token operator">:</span> item<span class="token punctuation">.</span>addons<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">a</span> <span class="token operator">=></span> a<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="392"></td><td><pre>        <span class="token literal-property property">extraOptions</span><span class="token operator">:</span> item<span class="token punctuation">.</span>extraOptions<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="393"></td><td><pre>        <span class="token literal-property property">additionalMeats</span><span class="token operator">:</span> item<span class="token punctuation">.</span>additionalMeats<span class="token operator">?.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">m</span> <span class="token operator">=></span> m<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="394"></td><td><pre>        <span class="token literal-property property">remarks</span><span class="token operator">:</span> item<span class="token punctuation">.</span>remarks</pre></td></tr><tr><td data-num="395"></td><td><pre>      <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="396"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="397"></td><td><pre></pre></td></tr><tr><td data-num="398"></td><td><pre>    <span class="token keyword">const</span> orderAmount <span class="token operator">=</span> <span class="token function">parseFloat</span><span class="token punctuation">(</span><span class="token function">calculateTotal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="399"></td><td><pre>    <span class="token keyword">const</span> pickupTimeValue <span class="token operator">=</span> pickupTime<span class="token punctuation">.</span>value <span class="token operator">===</span> <span class="token string">'asap'</span> <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token operator">:</span> scheduledTime<span class="token punctuation">.</span>value<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="400"></td><td><pre></pre></td></tr><tr><td data-num="401"></td><td><pre>    <span class="token keyword">const</span> orderData <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="402"></td><td><pre>      <span class="token literal-property property">store</span><span class="token operator">:</span> props<span class="token punctuation">.</span>storeId<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="403"></td><td><pre>      <span class="token literal-property property">orderNumber</span><span class="token operator">:</span> <span class="token function">String</span><span class="token punctuation">(</span><span class="token keyword">await</span> <span class="token function">generateOrderNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="404"></td><td><pre>      <span class="token literal-property property">platform</span><span class="token operator">:</span> <span class="token string">'web'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="405"></td><td><pre>      <span class="token literal-property property">pickupMethod</span><span class="token operator">:</span> <span class="token function">formatPickupMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="406"></td><td><pre>      <span class="token literal-property property">paymentMethod</span><span class="token operator">:</span> paymentMethod<span class="token punctuation">.</span>value<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="407"></td><td><pre>      orderAmount<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="408"></td><td><pre>      <span class="token literal-property property">totalMoney</span><span class="token operator">:</span> orderAmount<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="409"></td><td><pre>      <span class="token literal-property property">tableNumber</span><span class="token operator">:</span> pickupMethod<span class="token punctuation">.</span>value <span class="token operator">===</span> <span class="token string">'dineIn'</span> <span class="token operator">?</span> tableNumber<span class="token punctuation">.</span>value <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="410"></td><td><pre>      <span class="token literal-property property">deliveryAddress</span><span class="token operator">:</span> pickupMethod<span class="token punctuation">.</span>value <span class="token operator">===</span> <span class="token string">'delivery'</span> <span class="token operator">?</span> deliveryAddress<span class="token punctuation">.</span>value <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="411"></td><td><pre>      <span class="token literal-property property">items</span><span class="token operator">:</span> orderItems<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="412"></td><td><pre>      <span class="token literal-property property">remarks</span><span class="token operator">:</span> orderRemarks<span class="token punctuation">.</span>value <span class="token operator">||</span> <span class="token keyword">null</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="413"></td><td><pre>      <span class="token literal-property property">scheduledPickupTime</span><span class="token operator">:</span> pickupTimeValue<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="414"></td><td><pre>      <span class="token literal-property property">couponId</span><span class="token operator">:</span> selectedCoupon<span class="token punctuation">.</span>value <span class="token operator">||</span> <span class="token keyword">null</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="415"></td><td><pre>      <span class="token literal-property property">deliveryFee</span><span class="token operator">:</span> pickupMethod<span class="token punctuation">.</span>value <span class="token operator">===</span> <span class="token string">'delivery'</span> <span class="token operator">?</span> deliveryFee<span class="token punctuation">.</span>value <span class="token operator">:</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="416"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="417"></td><td><pre></pre></td></tr><tr><td data-num="418"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Submitting order:'</span><span class="token punctuation">,</span> orderData<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="419"></td><td><pre>    <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">data</span><span class="token operator">:</span> newOrder <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">API_BASE_URL</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/order</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> orderData<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="420"></td><td><pre>    confirmModal<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="421"></td><td><pre></pre></td></tr><tr><td data-num="422"></td><td><pre>    <span class="token comment">// Emit event that order was submitted</span></pre></td></tr><tr><td data-num="423"></td><td><pre>    <span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'orderSubmitted'</span><span class="token punctuation">,</span> newOrder<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="424"></td><td><pre></pre></td></tr><tr><td data-num="425"></td><td><pre>    <span class="token comment">// Redirect to confirmation page</span></pre></td></tr><tr><td data-num="426"></td><td><pre>    router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/confirmation/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>newOrder<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="427"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="428"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Error creating order:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="429"></td><td><pre>    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'訂單建立失敗，請重試'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="430"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="431"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="432"></td><td><pre></pre></td></tr><tr><td data-num="433"></td><td><pre><span class="token comment">// Watch for coupon selection</span></pre></td></tr><tr><td data-num="434"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">updateCouponDiscount</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="435"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span>selectedCoupon<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="436"></td><td><pre>    <span class="token keyword">const</span> coupon <span class="token operator">=</span> availableCoupons<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">c</span> <span class="token operator">=></span> c<span class="token punctuation">.</span>id <span class="token operator">===</span> selectedCoupon<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="437"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>coupon<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="438"></td><td><pre>      couponDiscount<span class="token punctuation">.</span>value <span class="token operator">=</span> coupon<span class="token punctuation">.</span>value<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="439"></td><td><pre>      <span class="token keyword">return</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="440"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="441"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="442"></td><td><pre>  couponDiscount<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="443"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="444"></td><td><pre></pre></td></tr><tr><td data-num="445"></td><td><pre><span class="token comment">// Set delivery fee when pickup method changes</span></pre></td></tr><tr><td data-num="446"></td><td><pre><span class="token function">watch</span><span class="token punctuation">(</span>pickupMethod<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">newValue</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="447"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span>newValue <span class="token operator">===</span> <span class="token string">'delivery'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="448"></td><td><pre>    deliveryFee<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">60</span><span class="token punctuation">;</span> <span class="token comment">// Set a default delivery fee</span></pre></td></tr><tr><td data-num="449"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="450"></td><td><pre>    deliveryFee<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="451"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="452"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="453"></td><td><pre></pre></td></tr><tr><td data-num="454"></td><td><pre><span class="token comment">// Initialize Bootstrap modal</span></pre></td></tr><tr><td data-num="455"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">initModal</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="456"></td><td><pre>  <span class="token comment">// Import Bootstrap's modal JavaScript</span></pre></td></tr><tr><td data-num="457"></td><td><pre>  <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'bootstrap/js/dist/modal'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">module</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="458"></td><td><pre>    <span class="token keyword">const</span> Modal <span class="token operator">=</span> module<span class="token punctuation">.</span>default<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="459"></td><td><pre></pre></td></tr><tr><td data-num="460"></td><td><pre>    <span class="token comment">// Initialize confirmation modal</span></pre></td></tr><tr><td data-num="461"></td><td><pre>    <span class="token keyword">const</span> confirmOrderModalElement <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'confirmOrderModal'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="462"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>confirmOrderModalElement<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="463"></td><td><pre>      confirmModal<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Modal</span><span class="token punctuation">(</span>confirmOrderModalElement<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="464"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="465"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="466"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="467"></td><td><pre></pre></td></tr><tr><td data-num="468"></td><td><pre><span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="469"></td><td><pre>  <span class="token function">initModal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="470"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>scheduledTime<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="471"></td><td><pre>    scheduledTime<span class="token punctuation">.</span>value <span class="token operator">=</span> minPickupTime<span class="token punctuation">.</span>value<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="472"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="473"></td><td><pre>  </pre></td></tr><tr><td data-num="474"></td><td><pre>  <span class="token comment">// Watch for coupon changes</span></pre></td></tr><tr><td data-num="475"></td><td><pre>  <span class="token function">watch</span><span class="token punctuation">(</span>selectedCoupon<span class="token punctuation">,</span> updateCouponDiscount<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="476"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="477"></td><td><pre></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="478"></td><td><pre></pre></td></tr><tr><td data-num="479"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css"></pre></td></tr><tr><td data-num="480"></td><td><pre><span class="token selector">.cart-page</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="481"></td><td><pre>  <span class="token property">min-height</span><span class="token punctuation">:</span> 100vh<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="482"></td><td><pre>  <span class="token property">background-color</span><span class="token punctuation">:</span> #f8f9fa<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="483"></td><td><pre>  <span class="token property">padding-bottom</span><span class="token punctuation">:</span> 80px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="484"></td><td><pre>  <span class="token comment">/* Space for the fixed bottom button */</span></pre></td></tr><tr><td data-num="485"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="486"></td><td><pre></pre></td></tr><tr><td data-num="487"></td><td><pre><span class="token selector">.cart-header</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="488"></td><td><pre>  <span class="token property">position</span><span class="token punctuation">:</span> sticky<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="489"></td><td><pre>  <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="490"></td><td><pre>  <span class="token property">z-index</span><span class="token punctuation">:</span> 1000<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="491"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="492"></td><td><pre></pre></td></tr><tr><td data-num="493"></td><td><pre><span class="token selector">.divider</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="494"></td><td><pre>  <span class="token property">height</span><span class="token punctuation">:</span> 8px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="495"></td><td><pre>  <span class="token property">background-color</span><span class="token punctuation">:</span> #f0f0f0<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="496"></td><td><pre>  <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="497"></td><td><pre>  <span class="token property">width</span><span class="token punctuation">:</span> 100%</pre></td></tr><tr><td data-num="498"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="499"></td><td><pre></pre></td></tr><tr><td data-num="500"></td><td><pre><span class="token selector">.cart-item</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="501"></td><td><pre>  <span class="token property">border-radius</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="502"></td><td><pre>  <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="503"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="504"></td><td><pre></pre></td></tr><tr><td data-num="505"></td><td><pre><span class="token selector">.quantity-control</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="506"></td><td><pre>  <span class="token property">min-width</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="507"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="508"></td><td><pre></pre></td></tr><tr><td data-num="509"></td><td><pre><span class="token selector">.quantity-control button</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="510"></td><td><pre>  <span class="token property">width</span><span class="token punctuation">:</span> 30px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="511"></td><td><pre>  <span class="token property">height</span><span class="token punctuation">:</span> 30px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="512"></td><td><pre>  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="513"></td><td><pre>  <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="514"></td><td><pre>  <span class="token property">justify-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="515"></td><td><pre>  <span class="token property">padding</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="516"></td><td><pre>  <span class="token property">border-radius</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="517"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="518"></td><td><pre></pre></td></tr><tr><td data-num="519"></td><td><pre><span class="token selector">.checkout-btn</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="520"></td><td><pre>  <span class="token property">border-radius</span><span class="token punctuation">:</span> 8px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="521"></td><td><pre>  <span class="token property">background-color</span><span class="token punctuation">:</span> #7a5b0c<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="522"></td><td><pre>  <span class="token property">color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="523"></td><td><pre>  <span class="token property">transition</span><span class="token punctuation">:</span> background-color 0.3s<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="524"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="525"></td><td><pre></pre></td></tr><tr><td data-num="526"></td><td><pre><span class="token selector">.checkout-btn:hover:not(:disabled)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="527"></td><td><pre>  <span class="token property">background-color</span><span class="token punctuation">:</span> #4a7dde<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="528"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="529"></td><td><pre></pre></td></tr><tr><td data-num="530"></td><td><pre><span class="token selector">.checkout-btn:disabled</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="531"></td><td><pre>  <span class="token property">background-color</span><span class="token punctuation">:</span> #b9cdf2<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="532"></td><td><pre>  <span class="token property">color</span><span class="token punctuation">:</span> #ffffff<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="533"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="534"></td><td><pre></pre></td></tr><tr><td data-num="535"></td><td><pre><span class="token selector">.container-button</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="536"></td><td><pre>  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="537"></td><td><pre>  <span class="token property">padding</span><span class="token punctuation">:</span> 0 15px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="538"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="539"></td><td><pre></pre></td></tr><tr><td data-num="540"></td><td><pre><span class="token comment">/* Fix for iOS input styling */</span></pre></td></tr><tr><td data-num="541"></td><td><pre><span class="token selector">input[type="datetime-local"]</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="542"></td><td><pre>  <span class="token property">appearance</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="543"></td><td><pre>  <span class="token property">-webkit-appearance</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="544"></td><td><pre>  <span class="token property">-moz-appearance</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="545"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="546"></td><td><pre></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><h2 id="訂單object"><a class="anchor" href="#訂單object">#</a> 訂單 Object</h2>
<pre><code>//第一單
{
  &quot;_id&quot;: &quot;67c1459c5c73c8569433776f&quot;,
  &quot;store&quot;: &quot;67bc667213a41635fe5129fb&quot;,
  &quot;orderNumber&quot;: &quot;2&quot;,
  &quot;scheduledPickupTime&quot;: null,
  &quot;platform&quot;: &quot;web&quot;,
  &quot;pickupMethod&quot;: &quot;內用&quot;,
  &quot;paymentMethod&quot;: &quot;cash&quot;,
  &quot;orderAmount&quot;: 1295,
  &quot;discounts&quot;: 0,
  &quot;pointsDiscount&quot;: 0,
  &quot;deliveryFee&quot;: 0,
  &quot;totalMoney&quot;: 1295,
  &quot;isCancelled&quot;: false,
  &quot;orderStatus&quot;: &quot;Unpaid&quot;,
  &quot;tableNumber&quot;: &quot;1&quot;,
  &quot;remarks&quot;: &quot;訂單備註&quot;,
  &quot;deliveryAddress&quot;: null,
  &quot;logisticsCancelled&quot;: false,
  &quot;couponId&quot;: null,
  &quot;items&quot;: [
    {
      &quot;options&quot;: {
        &quot;doneness&quot;: &quot;7分熟&quot;,
        &quot;sauce&quot;: &quot;綜合醬&quot;,
        &quot;addons&quot;: [
          &quot;67bc62c813a41635fe512851&quot;,
          &quot;67bc62d213a41635fe512855&quot;,
          &quot;67bc630b13a41635fe512858&quot;
        ],
        &quot;extraOptions&quot;: [
          &quot;加麵&quot;
        ],
        &quot;additionalMeats&quot;: [
          &quot;67bc601713a41635fe512829&quot;,
          &quot;67bc612613a41635fe512831&quot;,
          &quot;67bc615513a41635fe512834&quot;,
          &quot;67bc619b13a41635fe512837&quot;,
          &quot;67bc5fe313a41635fe512824&quot;
        ],
        &quot;remarks&quot;: &quot;特殊要求&quot;
      },
      &quot;itemModel&quot;: &quot;MainDish&quot;,
      &quot;itemId&quot;: &quot;67bc61c313a41635fe51283a&quot;,
      &quot;amount&quot;: 1,
      &quot;_id&quot;: &quot;67c1459c5c73c85694337770&quot;
    }
  ],
  &quot;createdAt&quot;: &quot;2025-02-28T13:11:56.003Z&quot;,
  &quot;updatedAt&quot;: &quot;2025-02-28T13:11:56.003Z&quot;,
  &quot;weekday&quot;: &quot;Friday&quot;,
  &quot;__v&quot;: 0
}
// 第二單
{
  &quot;_id&quot;: &quot;67c1475c5c73c85694337795&quot;,
  &quot;store&quot;: &quot;67bc667213a41635fe5129fb&quot;,
  &quot;orderNumber&quot;: &quot;3&quot;,
  &quot;scheduledPickupTime&quot;: null,
  &quot;platform&quot;: &quot;web&quot;,
  &quot;pickupMethod&quot;: &quot;自取&quot;,
  &quot;paymentMethod&quot;: &quot;cash&quot;,
  &quot;orderAmount&quot;: 1640,
  &quot;discounts&quot;: 0,
  &quot;pointsDiscount&quot;: 0,
  &quot;deliveryFee&quot;: 0,
  &quot;totalMoney&quot;: 1640,
  &quot;isCancelled&quot;: false,
  &quot;orderStatus&quot;: &quot;Unpaid&quot;,
  &quot;tableNumber&quot;: null,
  &quot;remarks&quot;: null,
  &quot;deliveryAddress&quot;: null,
  &quot;logisticsCancelled&quot;: false,
  &quot;couponId&quot;: null,
  &quot;items&quot;: [
    {
      &quot;options&quot;: {
        &quot;doneness&quot;: &quot;7分熟&quot;,
        &quot;sauce&quot;: &quot;黑胡椒醬&quot;,
        &quot;addons&quot;: [
          &quot;67bc62c813a41635fe512851&quot;
        ],
        &quot;extraOptions&quot;: [
          &quot;加麵&quot;
        ],
        &quot;additionalMeats&quot;: [
          &quot;67bc619b13a41635fe512837&quot;
        ],
        &quot;remarks&quot;: &quot;特殊要求&quot;
      },
      &quot;itemModel&quot;: &quot;MainDish&quot;,
      &quot;itemId&quot;: &quot;67bc601713a41635fe512829&quot;,
      &quot;amount&quot;: 1,
      &quot;_id&quot;: &quot;67c1475c5c73c85694337796&quot;
    },
    {
      &quot;options&quot;: {
        &quot;doneness&quot;: &quot;&quot;,
        &quot;sauce&quot;: &quot;&quot;,
        &quot;addons&quot;: [],
        &quot;extraOptions&quot;: [],
        &quot;additionalMeats&quot;: [],
        &quot;remarks&quot;: &quot;&quot;
      },
      &quot;itemModel&quot;: &quot;ElseDish&quot;,
      &quot;itemId&quot;: &quot;67bc627b13a41635fe512848&quot;,
      &quot;amount&quot;: 1,
      &quot;_id&quot;: &quot;67c1475c5c73c85694337797&quot;
    },
    {
      &quot;options&quot;: {
        &quot;doneness&quot;: &quot;9分熟&quot;,
        &quot;sauce&quot;: &quot;黑胡椒醬&quot;,
        &quot;addons&quot;: [
          &quot;67bc62d213a41635fe512855&quot;
        ],
        &quot;extraOptions&quot;: [
          &quot;麵換蛋&quot;
        ],
        &quot;additionalMeats&quot;: [
          &quot;67bc612613a41635fe512831&quot;,
          &quot;67bc5fe313a41635fe512824&quot;
        ],
        &quot;remarks&quot;: &quot;特殊要求&quot;
      },
      &quot;itemModel&quot;: &quot;MainDish&quot;,
      &quot;itemId&quot;: &quot;67bc61c313a41635fe51283a&quot;,
      &quot;amount&quot;: 1,
      &quot;_id&quot;: &quot;67c1475c5c73c85694337798&quot;
    },
    {
      &quot;options&quot;: {
        &quot;doneness&quot;: &quot;&quot;,
        &quot;sauce&quot;: &quot;&quot;,
        &quot;addons&quot;: [],
        &quot;extraOptions&quot;: [],
        &quot;additionalMeats&quot;: [],
        &quot;remarks&quot;: &quot;特殊要求&quot;
      },
      &quot;itemModel&quot;: &quot;ElseDish&quot;,
      &quot;itemId&quot;: &quot;67bc62a813a41635fe51284c&quot;,
      &quot;amount&quot;: 3,
      &quot;_id&quot;: &quot;67c1475c5c73c85694337799&quot;
    },
    {
      &quot;options&quot;: {
        &quot;doneness&quot;: &quot;5分熟&quot;,
        &quot;sauce&quot;: &quot;綜合醬&quot;,
        &quot;addons&quot;: [],
        &quot;extraOptions&quot;: [],
        &quot;additionalMeats&quot;: [],
        &quot;remarks&quot;: &quot;&quot;
      },
      &quot;itemModel&quot;: &quot;MainDish&quot;,
      &quot;itemId&quot;: &quot;67bc612613a41635fe512831&quot;,
      &quot;amount&quot;: 1,
      &quot;_id&quot;: &quot;67c1475c5c73c8569433779a&quot;
    }
  ],
  &quot;createdAt&quot;: &quot;2025-02-28T13:19:24.708Z&quot;,
  &quot;updatedAt&quot;: &quot;2025-02-28T13:19:24.708Z&quot;,
  &quot;weekday&quot;: &quot;Friday&quot;,
  &quot;__v&quot;: 0
}
</code></pre>
<h2 id="完成訂單的介面"><a class="anchor" href="#完成訂單的介面">#</a> 完成訂單的介面</h2>
<p><code>:confirmation/:id</code></p>
<ul>
<li>顯示 內用或自取</li>
<li>內用顯示桌號</li>
<li>顯示流水編號</li>
<li>顯示餐點細節</li>
</ul>
<figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>main-container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>center-container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fade<span class="token punctuation">"</span></span> <span class="token attr-name">mode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>out-in<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>MenuListing</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>!selectedItem &amp;&amp; !showCart<span class="token punctuation">"</span></span> <span class="token attr-name">:store-name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>store.name<span class="token punctuation">"</span></span> <span class="token attr-name">:announcements</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>store.announcements<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="6"></td><td><pre>          <span class="token attr-name">:menu-list</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>menu.list<span class="token punctuation">"</span></span> <span class="token attr-name">:menu-items</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>menuItems<span class="token punctuation">"</span></span> <span class="token attr-name">@select-item</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>openItemDetails<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>transition</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fade<span class="token punctuation">"</span></span> <span class="token attr-name">mode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>out-in<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ItemDetail</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>selectedItem &amp;&amp; !showCart<span class="token punctuation">"</span></span> <span class="token attr-name">:item</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>selectedItem<span class="token punctuation">"</span></span> <span class="token attr-name">:addon-items</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>addonItems<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="11"></td><td><pre>          <span class="token attr-name">:menu-items</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>menuItems<span class="token punctuation">"</span></span> <span class="token attr-name">@close</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>closeItemDetails<span class="token punctuation">"</span></span> <span class="token attr-name">@add-to-cart</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>addToCart<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></pre></td></tr><tr><td data-num="12"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>transition</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fade<span class="token punctuation">"</span></span> <span class="token attr-name">mode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>out-in<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ShoppingCart</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>showCart<span class="token punctuation">"</span></span> <span class="token attr-name">:cart</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>cart<span class="token punctuation">"</span></span> <span class="token attr-name">:order-type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>orderType<span class="token punctuation">"</span></span> <span class="token attr-name">:store-id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>storeId<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="16"></td><td><pre>          <span class="token attr-name">:remove-from-cart</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>removeFromCart<span class="token punctuation">"</span></span> <span class="token attr-name">:update-cart-item-quantity</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>updateCartItemQuantity<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="17"></td><td><pre>          <span class="token attr-name">@go-back</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>showCart = false<span class="token punctuation">"</span></span> <span class="token attr-name">@edit-item</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>editCartItem<span class="token punctuation">"</span></span> <span class="token attr-name">@order-submitted</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>handleOrderSubmitted<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></pre></td></tr><tr><td data-num="18"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>transition</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre>      <span class="token comment">&lt;!-- Shopping Cart Button --></span></pre></td></tr><tr><td data-num="21"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>cart.length > 0 &amp;&amp; !selectedItem &amp;&amp; !showCart<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="22"></td><td><pre>        <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>position-fixed bottom-0 start-50 translate-middle-x mb-4<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">z-index</span><span class="token punctuation">:</span> 1030<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="23"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn btn-primary rounded-pill shadow px-4 py-2<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>showCart = true<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="24"></td><td><pre>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>bi bi-cart-fill me-2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="25"></td><td><pre>          &#123;&#123; getTotalItems() &#125;&#125; 項商品 - $&#123;&#123; calculateTotal() &#125;&#125;</pre></td></tr><tr><td data-num="26"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="27"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="28"></td><td><pre></pre></td></tr><tr><td data-num="29"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="30"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="32"></td><td><pre></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> onMounted<span class="token punctuation">,</span> ref <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> useRoute<span class="token punctuation">,</span> useRouter <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'vue-router'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">'axios'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token keyword">import</span> MenuListing <span class="token keyword">from</span> <span class="token string">'@/components/OrderComponents/Main.vue'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token keyword">import</span> ItemDetail <span class="token keyword">from</span> <span class="token string">'@/components/OrderComponents/ItemDetail.vue'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token keyword">import</span> ShoppingCart <span class="token keyword">from</span> <span class="token string">'@/components/OrderComponents/ShoppingCart.vue'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="40"></td><td><pre></pre></td></tr><tr><td data-num="41"></td><td><pre></pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token keyword">const</span> route <span class="token operator">=</span> <span class="token function">useRoute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="43"></td><td><pre><span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">useRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="44"></td><td><pre><span class="token keyword">const</span> <span class="token constant">API_BASE_URL</span> <span class="token operator">=</span> <span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VITE_API_BASE_URL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="45"></td><td><pre><span class="token keyword">const</span> storeId <span class="token operator">=</span> route<span class="token punctuation">.</span>params<span class="token punctuation">.</span>store<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="46"></td><td><pre><span class="token keyword">const</span> queryOrderType <span class="token operator">=</span> route<span class="token punctuation">.</span>query<span class="token punctuation">.</span>orderType<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="47"></td><td><pre><span class="token keyword">const</span> queryTable <span class="token operator">=</span> route<span class="token punctuation">.</span>query<span class="token punctuation">.</span>table<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="48"></td><td><pre></pre></td></tr><tr><td data-num="49"></td><td><pre><span class="token comment">// State</span></pre></td></tr><tr><td data-num="50"></td><td><pre><span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="51"></td><td><pre><span class="token keyword">const</span> menu <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="52"></td><td><pre><span class="token keyword">const</span> menuItems <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="53"></td><td><pre><span class="token keyword">const</span> addonItems <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="54"></td><td><pre><span class="token keyword">const</span> orderType <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span>queryOrderType <span class="token operator">||</span> <span class="token string">'dineIn'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="55"></td><td><pre><span class="token keyword">const</span> tableNumber <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span>queryTable <span class="token operator">||</span> <span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="56"></td><td><pre><span class="token keyword">const</span> selectedItem <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="57"></td><td><pre><span class="token keyword">const</span> cart <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="58"></td><td><pre><span class="token keyword">const</span> showCart <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="59"></td><td><pre></pre></td></tr><tr><td data-num="60"></td><td><pre><span class="token comment">// Bootstrap modal instance</span></pre></td></tr><tr><td data-num="61"></td><td><pre><span class="token keyword">let</span> cartModal <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="62"></td><td><pre></pre></td></tr><tr><td data-num="63"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">fetchStore</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="64"></td><td><pre>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="65"></td><td><pre>    <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">API_BASE_URL</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/store/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>storeId<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="66"></td><td><pre>    store<span class="token punctuation">.</span>value <span class="token operator">=</span> response<span class="token punctuation">.</span>data<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="67"></td><td><pre>    <span class="token comment">// console.log(store.value);</span></pre></td></tr><tr><td data-num="68"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="69"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Error fetching store:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="70"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="71"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="72"></td><td><pre></pre></td></tr><tr><td data-num="73"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">fetchMenu</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="74"></td><td><pre>  menu<span class="token punctuation">.</span>value <span class="token operator">=</span> store<span class="token punctuation">.</span>value<span class="token punctuation">.</span>menuItem<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="75"></td><td><pre>  <span class="token comment">// console.log('menu', menu.value);</span></pre></td></tr><tr><td data-num="76"></td><td><pre></pre></td></tr><tr><td data-num="77"></td><td><pre>  <span class="token keyword">const</span> itemPromises <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="78"></td><td><pre>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> category <span class="token keyword">of</span> menu<span class="token punctuation">.</span>value<span class="token punctuation">.</span>list<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="79"></td><td><pre>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> item <span class="token keyword">of</span> category<span class="token punctuation">.</span>items<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="80"></td><td><pre>      itemPromises<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">API_BASE_URL</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/dish/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>item<span class="token punctuation">.</span>itemModel<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> item<span class="token punctuation">.</span>itemModel<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>item<span class="token punctuation">.</span>itemId<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="81"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="82"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="83"></td><td><pre></pre></td></tr><tr><td data-num="84"></td><td><pre>  <span class="token keyword">const</span> dishModelMapping <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="85"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span>menu<span class="token punctuation">.</span>value <span class="token operator">&amp;&amp;</span> menu<span class="token punctuation">.</span>value<span class="token punctuation">.</span>list<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="86"></td><td><pre>    menu<span class="token punctuation">.</span>value<span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">category</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="87"></td><td><pre>      category<span class="token punctuation">.</span>items<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="88"></td><td><pre>        dishModelMapping<span class="token punctuation">[</span>item<span class="token punctuation">.</span>itemId<span class="token punctuation">]</span> <span class="token operator">=</span> item<span class="token punctuation">.</span>itemModel<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="89"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="90"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="91"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="92"></td><td><pre>  <span class="token keyword">const</span> itemResponses <span class="token operator">=</span> <span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span>itemPromises<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="93"></td><td><pre>  menuItems<span class="token punctuation">.</span>value <span class="token operator">=</span> itemResponses<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="94"></td><td><pre>    <span class="token keyword">return</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="95"></td><td><pre>      <span class="token operator">...</span>response<span class="token punctuation">.</span>data<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="96"></td><td><pre>      <span class="token literal-property property">itemModel</span><span class="token operator">:</span> dishModelMapping<span class="token punctuation">[</span>response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>_id<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="97"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="98"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="99"></td><td><pre></pre></td></tr><tr><td data-num="100"></td><td><pre>  <span class="token comment">// console.log('menuItems', menuItems.value);</span></pre></td></tr><tr><td data-num="101"></td><td><pre>  <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">data</span><span class="token operator">:</span> addons <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">API_BASE_URL</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/dish/addon</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="102"></td><td><pre>  addonItems<span class="token punctuation">.</span>value <span class="token operator">=</span> addons<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="103"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="104"></td><td><pre></pre></td></tr><tr><td data-num="105"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">openItemDetails</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="106"></td><td><pre>  selectedItem<span class="token punctuation">.</span>value <span class="token operator">=</span> item<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="107"></td><td><pre>  <span class="token comment">// console.log(item);</span></pre></td></tr><tr><td data-num="108"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="109"></td><td><pre></pre></td></tr><tr><td data-num="110"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">closeItemDetails</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="111"></td><td><pre>  selectedItem<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="112"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="113"></td><td><pre></pre></td></tr><tr><td data-num="114"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">addToCart</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="115"></td><td><pre>  cart<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="116"></td><td><pre>  <span class="token comment">// console.log(cart.value);</span></pre></td></tr><tr><td data-num="117"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="118"></td><td><pre></pre></td></tr><tr><td data-num="119"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">openCartModal</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="120"></td><td><pre>  cartModal<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="121"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="122"></td><td><pre></pre></td></tr><tr><td data-num="123"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">updateCartItemQuantity</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">index<span class="token punctuation">,</span> change</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="124"></td><td><pre>  <span class="token keyword">const</span> newQuantity <span class="token operator">=</span> cart<span class="token punctuation">.</span>value<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>quantity <span class="token operator">+</span> change<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="125"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span>newQuantity <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="126"></td><td><pre>    cart<span class="token punctuation">.</span>value<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>quantity <span class="token operator">=</span> newQuantity<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="127"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="128"></td><td><pre>    <span class="token function">removeFromCart</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="129"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="130"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="131"></td><td><pre></pre></td></tr><tr><td data-num="132"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">removeFromCart</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">index</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="133"></td><td><pre>  cart<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="134"></td><td><pre></pre></td></tr><tr><td data-num="135"></td><td><pre>  <span class="token comment">// If cart is empty, go back to menu</span></pre></td></tr><tr><td data-num="136"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span>cart<span class="token punctuation">.</span>value<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="137"></td><td><pre>    showCart<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="138"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="139"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="140"></td><td><pre></pre></td></tr><tr><td data-num="141"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">editCartItem</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">index</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="142"></td><td><pre>  <span class="token keyword">const</span> item <span class="token operator">=</span> menuItems<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">menuItem</span> <span class="token operator">=></span> menuItem<span class="token punctuation">.</span>_id <span class="token operator">===</span> cart<span class="token punctuation">.</span>value<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="143"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="144"></td><td><pre>    <span class="token comment">// Remove the item from cart first</span></pre></td></tr><tr><td data-num="145"></td><td><pre>    <span class="token keyword">const</span> itemToEdit <span class="token operator">=</span> cart<span class="token punctuation">.</span>value<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="146"></td><td><pre>    <span class="token function">removeFromCart</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="147"></td><td><pre></pre></td></tr><tr><td data-num="148"></td><td><pre>    <span class="token comment">// Open the item detail with pre-filled selections</span></pre></td></tr><tr><td data-num="149"></td><td><pre>    selectedItem<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="150"></td><td><pre>      <span class="token operator">...</span>item<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="151"></td><td><pre>      <span class="token literal-property property">preFilled</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="152"></td><td><pre>        <span class="token literal-property property">quantity</span><span class="token operator">:</span> itemToEdit<span class="token punctuation">.</span>quantity<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="153"></td><td><pre>        <span class="token literal-property property">doneness</span><span class="token operator">:</span> itemToEdit<span class="token punctuation">.</span>doneness<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="154"></td><td><pre>        <span class="token literal-property property">sauce</span><span class="token operator">:</span> itemToEdit<span class="token punctuation">.</span>sauce<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="155"></td><td><pre>        <span class="token literal-property property">addons</span><span class="token operator">:</span> itemToEdit<span class="token punctuation">.</span>addons<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="156"></td><td><pre>        <span class="token literal-property property">additionalMeats</span><span class="token operator">:</span> itemToEdit<span class="token punctuation">.</span>additionalMeats<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="157"></td><td><pre>        <span class="token literal-property property">extraOptions</span><span class="token operator">:</span> itemToEdit<span class="token punctuation">.</span>extraOptions<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="158"></td><td><pre>        <span class="token literal-property property">remarks</span><span class="token operator">:</span> itemToEdit<span class="token punctuation">.</span>remarks</pre></td></tr><tr><td data-num="159"></td><td><pre>      <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="160"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="161"></td><td><pre></pre></td></tr><tr><td data-num="162"></td><td><pre>    showCart<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="163"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="164"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="165"></td><td><pre></pre></td></tr><tr><td data-num="166"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">handleOrderSubmitted</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">order</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="167"></td><td><pre>  <span class="token comment">// Clear the cart after order is submitted</span></pre></td></tr><tr><td data-num="168"></td><td><pre>  <span class="token comment">// console.log('Order submitted:', order);</span></pre></td></tr><tr><td data-num="169"></td><td><pre>  cart<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="170"></td><td><pre>  showCart<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="171"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="172"></td><td><pre></pre></td></tr><tr><td data-num="173"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">getTotalItems</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="174"></td><td><pre>  <span class="token keyword">return</span> cart<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">total<span class="token punctuation">,</span> item</span><span class="token punctuation">)</span> <span class="token operator">=></span> total <span class="token operator">+</span> item<span class="token punctuation">.</span>quantity<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="175"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="176"></td><td><pre></pre></td></tr><tr><td data-num="177"></td><td><pre></pre></td></tr><tr><td data-num="178"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">calculateTotal</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="179"></td><td><pre>  <span class="token keyword">return</span> cart<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">total<span class="token punctuation">,</span> item</span><span class="token punctuation">)</span> <span class="token operator">=></span> total <span class="token operator">+</span> <span class="token punctuation">(</span>item<span class="token punctuation">.</span>price <span class="token operator">*</span> item<span class="token punctuation">.</span>quantity<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="180"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="181"></td><td><pre></pre></td></tr><tr><td data-num="182"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">formatAddons</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">addons</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="183"></td><td><pre>  <span class="token keyword">return</span> addons<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">addon</span> <span class="token operator">=></span> addon<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">', '</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="184"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="185"></td><td><pre></pre></td></tr><tr><td data-num="186"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">formatAddationMeats</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">additionalMeats</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="187"></td><td><pre>  <span class="token keyword">return</span> additionalMeats<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">meat</span> <span class="token operator">=></span> meat<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">', '</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="188"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="189"></td><td><pre></pre></td></tr><tr><td data-num="190"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">checkout</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="191"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span>orderType<span class="token punctuation">.</span>value <span class="token operator">===</span> <span class="token string">'dineIn'</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>tableNumber<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="192"></td><td><pre>    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'請輸入桌號'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="193"></td><td><pre>    <span class="token keyword">return</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="194"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="195"></td><td><pre></pre></td></tr><tr><td data-num="196"></td><td><pre>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="197"></td><td><pre>    <span class="token keyword">const</span> orderItems <span class="token operator">=</span> cart<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="198"></td><td><pre>      <span class="token literal-property property">itemModel</span><span class="token operator">:</span> item<span class="token punctuation">.</span>itemModel<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="199"></td><td><pre>      <span class="token literal-property property">itemId</span><span class="token operator">:</span> item<span class="token punctuation">.</span>id<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="200"></td><td><pre>      <span class="token literal-property property">amount</span><span class="token operator">:</span> item<span class="token punctuation">.</span>quantity<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="201"></td><td><pre>      <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="202"></td><td><pre>        <span class="token literal-property property">doneness</span><span class="token operator">:</span> item<span class="token punctuation">.</span>doneness<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="203"></td><td><pre>        <span class="token literal-property property">sauce</span><span class="token operator">:</span> item<span class="token punctuation">.</span>sauce<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="204"></td><td><pre>        <span class="token literal-property property">addons</span><span class="token operator">:</span> item<span class="token punctuation">.</span>addons<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">a</span> <span class="token operator">=></span> a<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="205"></td><td><pre>        <span class="token literal-property property">extraOptions</span><span class="token operator">:</span> item<span class="token punctuation">.</span>extraOptions<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="206"></td><td><pre>        <span class="token literal-property property">additionalMeats</span><span class="token operator">:</span> item<span class="token punctuation">.</span>additionalMeats<span class="token operator">?.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">m</span> <span class="token operator">=></span> m<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="207"></td><td><pre>        <span class="token literal-property property">remarks</span><span class="token operator">:</span> item<span class="token punctuation">.</span>remarks</pre></td></tr><tr><td data-num="208"></td><td><pre>      <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="209"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="210"></td><td><pre></pre></td></tr><tr><td data-num="211"></td><td><pre>    <span class="token keyword">const</span> orderAmount <span class="token operator">=</span> <span class="token function">parseFloat</span><span class="token punctuation">(</span><span class="token function">calculateTotal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="212"></td><td><pre>    <span class="token keyword">const</span> orderData <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="213"></td><td><pre>      <span class="token literal-property property">store</span><span class="token operator">:</span> storeId<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="214"></td><td><pre>      <span class="token literal-property property">orderNumber</span><span class="token operator">:</span> <span class="token function">String</span><span class="token punctuation">(</span><span class="token keyword">await</span> <span class="token function">generateOrderNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="215"></td><td><pre>      <span class="token literal-property property">platform</span><span class="token operator">:</span> <span class="token string">'web'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="216"></td><td><pre>      <span class="token literal-property property">pickupMethod</span><span class="token operator">:</span> orderType<span class="token punctuation">.</span>value <span class="token operator">===</span> <span class="token string">'dineIn'</span> <span class="token operator">?</span> <span class="token string">'內用'</span> <span class="token operator">:</span> <span class="token string">'外帶'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="217"></td><td><pre>      <span class="token literal-property property">paymentMethod</span><span class="token operator">:</span> <span class="token string">'store'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="218"></td><td><pre>      orderAmount<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="219"></td><td><pre>      <span class="token literal-property property">totalPaid</span><span class="token operator">:</span> orderAmount<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="220"></td><td><pre>      <span class="token literal-property property">tableNumber</span><span class="token operator">:</span> orderType<span class="token punctuation">.</span>value <span class="token operator">===</span> <span class="token string">'dineIn'</span> <span class="token operator">?</span> tableNumber<span class="token punctuation">.</span>value <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="221"></td><td><pre>      <span class="token literal-property property">items</span><span class="token operator">:</span> orderItems<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="222"></td><td><pre>      <span class="token literal-property property">remarks</span><span class="token operator">:</span> cart<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=></span> item<span class="token punctuation">.</span>remarks<span class="token punctuation">)</span> <span class="token operator">?</span> cart<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=></span> item<span class="token punctuation">.</span>remarks<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>Boolean<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">' / '</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">null</span></pre></td></tr><tr><td data-num="223"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="224"></td><td><pre></pre></td></tr><tr><td data-num="225"></td><td><pre>    <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">data</span><span class="token operator">:</span> newOrder <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">API_BASE_URL</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/order</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> orderData<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="226"></td><td><pre>    cartModal<span class="token punctuation">.</span><span class="token function">hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="227"></td><td><pre>    router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/customer/confirmation/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>newOrder<span class="token punctuation">.</span>_id<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="228"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="229"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Error creating order:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="230"></td><td><pre>    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'訂單建立失敗，請重試'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="231"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="232"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="233"></td><td><pre></pre></td></tr><tr><td data-num="234"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">generateOrderNumber</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="235"></td><td><pre>  <span class="token keyword">const</span> number <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">API_BASE_URL</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/order/number</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="236"></td><td><pre>  <span class="token keyword">return</span> number<span class="token punctuation">.</span>data<span class="token punctuation">.</span>number<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="237"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="238"></td><td><pre></pre></td></tr><tr><td data-num="239"></td><td><pre><span class="token comment">// Initialize Bootstrap modal</span></pre></td></tr><tr><td data-num="240"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">initModal</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="241"></td><td><pre>  <span class="token comment">// Import Bootstrap's modal JavaScript</span></pre></td></tr><tr><td data-num="242"></td><td><pre>  <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'bootstrap/js/dist/modal'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">module</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="243"></td><td><pre>    <span class="token keyword">const</span> Modal <span class="token operator">=</span> module<span class="token punctuation">.</span>default<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="244"></td><td><pre></pre></td></tr><tr><td data-num="245"></td><td><pre>    <span class="token comment">// Initialize cart modal</span></pre></td></tr><tr><td data-num="246"></td><td><pre>    <span class="token keyword">const</span> cartModalElement <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'cartModal'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="247"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>cartModalElement<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="248"></td><td><pre>      cartModal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Modal</span><span class="token punctuation">(</span>cartModalElement<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="249"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="250"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="251"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="252"></td><td><pre></pre></td></tr><tr><td data-num="253"></td><td><pre><span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="254"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>store<span class="token punctuation">.</span>value<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="255"></td><td><pre>    <span class="token keyword">await</span> <span class="token function">fetchStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="256"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="257"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>menu<span class="token punctuation">.</span>value<span class="token punctuation">.</span>list <span class="token operator">||</span> menu<span class="token punctuation">.</span>value<span class="token punctuation">.</span>list<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="258"></td><td><pre>    <span class="token keyword">await</span> <span class="token function">fetchMenu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="259"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="260"></td><td><pre>  <span class="token function">initModal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="261"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="262"></td><td><pre></pre></td></tr><tr><td data-num="263"></td><td><pre></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="264"></td><td><pre></pre></td></tr><tr><td data-num="265"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css"></pre></td></tr><tr><td data-num="266"></td><td><pre><span class="token selector">.main-container</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="267"></td><td><pre>  <span class="token property">min-height</span><span class="token punctuation">:</span> 100vh<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="268"></td><td><pre>  <span class="token property">background-color</span><span class="token punctuation">:</span> #eaeae668<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="269"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="270"></td><td><pre></pre></td></tr><tr><td data-num="271"></td><td><pre><span class="token selector">.center-container</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="272"></td><td><pre>  <span class="token property">max-width</span><span class="token punctuation">:</span> 768px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="273"></td><td><pre>  <span class="token property">margin</span><span class="token punctuation">:</span> 0 auto<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="274"></td><td><pre>  <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="275"></td><td><pre>  <span class="token property">background-color</span><span class="token punctuation">:</span> #ffffff<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="276"></td><td><pre>  <span class="token property">min-height</span><span class="token punctuation">:</span> 100vh<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="277"></td><td><pre>  <span class="token property">box-shadow</span><span class="token punctuation">:</span> 0 0 10px <span class="token function">rgba</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0.2<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="278"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="279"></td><td><pre></pre></td></tr><tr><td data-num="280"></td><td><pre><span class="token comment">/* 定義過渡動畫 */</span></pre></td></tr><tr><td data-num="281"></td><td><pre><span class="token selector">.fade-enter-active,</pre></td></tr><tr><td data-num="282"></td><td><pre>.fade-leave-active</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="283"></td><td><pre>  <span class="token property">transition</span><span class="token punctuation">:</span> opacity 0.3s ease<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="284"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="285"></td><td><pre></pre></td></tr><tr><td data-num="286"></td><td><pre><span class="token selector">.fade-enter-from,</pre></td></tr><tr><td data-num="287"></td><td><pre>.fade-leave-to</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="288"></td><td><pre>  <span class="token property">opacity</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="289"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="290"></td><td><pre></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><h1 id="員工點餐介面"><a class="anchor" href="#員工點餐介面">#</a> 員工點餐介面</h1>
<h2 id="頁面需求"><a class="anchor" href="#頁面需求">#</a> 頁面需求</h2>
<p><code>staff/:store</code></p>
<ul>
<li>
<p>獲取今日 order api  <code>/store/:id'</code></p>
</li>
<li>
<p>左側 navbar 由上到下 顯示日期時間 內用 (button) 外帶 (button) 訂單 (button)</p>
</li>
<li>
<p>中間為顯示選的哪個 component</p>
</li>
<li>
<p>右邊 右中上顯示訂單細節 右下顯示取消訂單 重印定單 結帳 如果為訂單頁面 component 這三個按鈕不能點</p>
</li>
<li>
<p>內用頁面</p>
</li>
<li>
<p>這個頁面需要把中間切成兩半 上半部顯示所有主餐所有附餐點擊後新增然後選定為當前餐點 下半部為加點或額外需求選項</p>
</li>
<li>
<p>新增的餐點會在右上角顯示</p>
</li>
<li>
<p>餐點額外選項 用顏色分區</p>
</li>
<li>
<p>外帶頁面</p>
</li>
<li>
<p>這個頁面需要把中間切成兩半 上半部顯示所有主餐所有附餐點擊後新增然後選定為當前餐點 下半部為加點或額外需求選項</p>
</li>
<li>
<p>新增的餐點會在右上角顯示</p>
</li>
<li>
<p>訂單頁面</p>
</li>
<li>
<p>訂單列表 由左至右顯示 updatedAt orderNumber pickupMethod totalMoney orderStatus</p>
</li>
<li>
<p>中間每個訂單都可以選擇</p>
</li>
<li>
<p>線上付款：訂單直接完成 paymentMethod 寫入 &quot;線上付款&quot;</p>
</li>
<li>
<p>現場付款</p>
</li>
<li>
<p>右側顯示 另外一個 modal 是一個計算機 顯示應付金額與輸入金額還有找錢金額</p>
</li>
<li>
<p>輸入金額是 店員手動輸入的 顯示找錢金額 (輸入金額 - 應付金額) 方便店員快速計算</p>
</li>
<li>
<p>下方一個完成按鈕 paymentMethod 寫入 &quot;現金&quot;</p>
</li>
<li>
<p>以上兩種方法 最終都會到訂單完成</p>
</li>
</ul>
<h2 id="語法筆記"><a class="anchor" href="#語法筆記">#</a> 語法筆記</h2>
<ol>
<li><strong>在設定 <code>.table-striped.table-active</code>  遇到了一些問題</strong><br />
檔案:  <code>src\components\Staff\Orders.vue</code> <br />
<strong> 問題分析：</strong></li>
</ol>
<p>Bootstrap 5 的表格樣式機制：</p>
<p>Bootstrap 5 使用 CSS 變數 (如 --bs-table-accent-bg, --bs-table-striped-bg, --bs-table-active-bg) 來控制表格的背景顏色。<br />
當同時使用 .table-striped 和 .table-active 時，它們都試圖設置同一個變數 --bs-table-accent-bg，但因為選擇器特異性 (specificity) 和執行順序的關係，.table-striped 的設置可能會覆蓋 .table-active 的設置。</p>
<p>CSS 變數覆蓋問題：</p>
<p>在 Bootstrap 5 中，.table-striped 會為奇數 / 偶數行設置 --bs-table-accent-bg: var (--bs-table-striped-bg)<br />
 而 .table-active 會設置 --bs-table-accent-bg: var (--bs-table-active-bg)<br />
 當一個元素同時具有這兩個類時，根據 CSS 規則的加載順序和特異性，後一個設定可能會覆蓋前一個</p>
<p>您之前嘗試的方法無效的原因：</p>
<p>即使您用！important 直接設置了 background-color，但 Bootstrap 的樣式是通過 CSS 變數工作的，所以您的樣式並不會覆蓋 Bootstrap 的 CSS 變數機制。</p>
<blockquote>
<p>解決方案是在 .table-active 類上直接設置 Bootstrap 的 CSS 變數：</p>
</blockquote>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">.</span>table<span class="token operator">-</span>active <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token operator">--</span>bs<span class="token operator">-</span>table<span class="token operator">-</span>active<span class="token operator">-</span>bg<span class="token operator">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span><span class="token number">83</span><span class="token punctuation">,</span> <span class="token number">109</span><span class="token punctuation">,</span> <span class="token number">254</span><span class="token punctuation">,</span> <span class="token number">0.35</span><span class="token punctuation">)</span> <span class="token operator">!</span>important<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token comment">/* 被選中行」的文字顏色 */</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token operator">--</span>bs<span class="token operator">-</span>table<span class="token operator">-</span>active<span class="token operator">-</span>color<span class="token operator">:</span> #<span class="token number">000</span> <span class="token operator">!</span>important<span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token comment">/* 當滑鼠懸停 (hover) 在表格行時，背景色變為 --bs-table-active-bg */</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token operator">--</span>bs<span class="token operator">-</span>table<span class="token operator">-</span>hover<span class="token operator">-</span>bg<span class="token operator">:</span> <span class="token keyword">var</span><span class="token punctuation">(</span><span class="token operator">--</span>bs<span class="token operator">-</span>table<span class="token operator">-</span>active<span class="token operator">-</span>bg<span class="token punctuation">)</span> <span class="token operator">!</span>important<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token comment">/* 當滑鼠懸停 (hover) 在表格行時，文字顏色變為黑色 */</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token operator">--</span>bs<span class="token operator">-</span>table<span class="token operator">-</span>hover<span class="token operator">-</span>color<span class="token operator">:</span> <span class="token keyword">var</span><span class="token punctuation">(</span><span class="token operator">--</span>bs<span class="token operator">-</span>table<span class="token operator">-</span>active<span class="token operator">-</span>color<span class="token punctuation">)</span> <span class="token operator">!</span>important<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h1 id="會員功能"><a class="anchor" href="#會員功能">#</a> 會員功能</h1>
<h2 id="會員儲存"><a class="anchor" href="#會員儲存">#</a> 會員儲存</h2>
<ol>
<li>
<p>整個系統統一儲存會員</p>
</li>
<li>
<p>每個分店各別儲存會員</p>
</li>
</ol>
<blockquote>
<p><code>1.</code>  與 <code>2.</code>  的選擇會影響到集點系統的設計</p>
</blockquote>
<h2 id="前端畫面"><a class="anchor" href="#前端畫面">#</a> 前端畫面</h2>
<p>線上點餐網址 改為 <code>/customer/ordering/:store_id</code></p>
<ol>
<li>登入 / 註冊畫面 <code>/customer/login</code></li>
</ol>
<ul>
<li>上方顯示  <code>會員登入/註冊</code></li>
<li>接續一張圖片 中間文字 <code>犇野牛排 {{ storeName }}</code></li>
<li>圖片下方 接續文字  <code>登入／註冊 iCHEF 帳號，即可加入餐廳會員。</code></li>
<li>一個選單 選擇電話前面格式 預設為  <code>+886</code></li>
<li>輸入電話號碼</li>
<li>下一步按鈕</li>
</ul>
<ol start="2">
<li>如果電話號碼未註冊 跳到 <code>帳號註冊</code> 頁面 (網址不變 不同 component)  <code>/customer/login</code></li>
</ol>
<ul>
<li>
<p>上方顯示 帳號註冊 大標題 與一個上一步按鈕</p>
</li>
<li>
<p>下面顯示 手機號碼 (+886) 09xxxxxxxx 尚未註冊過 犇野牛排 帳號，請點擊「註冊帳號」按鈕，系統將寄送驗證訊息到此手機號碼。</p>
</li>
<li>
<p>註冊帳號按鈕</p>
</li>
<li>
<p>驗證碼輸入</p>
</li>
<li>
<p>確認送出</p>
</li>
<li>
<p>重新傳送驗證碼 (60s cd)</p>
</li>
<li>
<p>註冊畫面要有</p>
</li>
<li>
<p>姓名</p>
</li>
<li>
<p>生日 (可選)</p>
</li>
<li>
<p>性別 (可選)</p>
</li>
<li>
<p>地址 (可選)</p>
</li>
<li>
<p>密碼 (規定 8 ~ 32 個字元，英數及常見特殊符號 (這邊是可選不是客人必要))</p>
</li>
<li>
<p>重複輸入一次密碼</p>
</li>
<li>
<p>通過後 跳出 modal 跳回登入畫面 (避免使用 alert 這對手機使用者體驗不好 都改用 modal 設計)</p>
</li>
</ul>
<ol start="3">
<li>登入畫面  <code>/customer/login</code></li>
</ol>
<ul>
<li>根據上面輸入過的電話號碼</li>
<li>這邊顯示 大標題 <code>登入</code>  接續 <code>請輸入密碼。</code></li>
<li>密碼輸入框</li>
<li>忘記密碼按鈕</li>
<li>登入</li>
<li>登入後跳回 <code>/customer/ordering/:store_id</code>  然後遠本右上角登入的字改為客戶名字</li>
</ul>
<ol start="4">
<li>忘記密碼頁面  <code>/customer/login</code></li>
</ol>
<ul>
<li>這個頁面使用簡訊重新傳送驗證碼至客戶電話號碼</li>
<li>簡訊驗證碼已發送至 (+886) 0979999412，請於 5 分鐘內完成驗證。</li>
<li>驗證碼輸入正確就 跳至重新輸入密碼 component</li>
</ul>
<ol start="5">
<li>重新輸入密碼 component <code>/customer/login</code></li>
</ol>
<ul>
<li>新密碼</li>
<li>重複新密碼</li>
<li>送出</li>
<li>沒問題的話跳回登入畫面</li>
</ul>
<ol start="6">
<li>會員專區  <code>/customer/my-account</code></li>
</ol>
<ul>
<li>
<p>登入後客人再次點擊右上角按鈕</p>
</li>
<li>
<p>接下來會有一連串 <code>&lt;a&gt;</code></p>
</li>
<li>
<p><code>{{customer.name}} {{customer.phoneNumber}} </code>  to  <code>/customer/my-account/edit</code></p>
</li>
<li>
<p>我的點數  <code>/customer/my-account/points</code></p>
</li>
<li>
<p>我的優惠券  <code>/customer/my-account/coupons</code></p>
</li>
<li>
<p>我的訂單 <code>/customer/my-account/orders</code></p>
</li>
<li>
<p>修改密碼 <code>/customer/my-account/password/edit</code></p>
</li>
<li>
<p>登出 直接登使用 API 登出 跳回 <code>/customer/ordering/:store_id</code></p>
</li>
<li>
<p>一堆問題 待修正</p>
</li>
</ul>
<h1 id="各類銷售系統"><a class="anchor" href="#各類銷售系統">#</a> 各類銷售系統</h1>
<ol>
<li><strong>直接購買</strong></li>
</ol>
<ul>
<li>定義：使用金錢 (包括現金或是線上付款) 購買</li>
<li>可以在 <code>主要點餐頁面</code> 直接購買餐點</li>
<li>可以在 <code>兌換券購買頁面</code> 購買兌換券 (會有促銷活動，例如：一次買 10 張會有優惠 (是否能混搭需要再討論))</li>
</ul>
<ol start="2">
<li><strong>點數獲得</strong></li>
</ol>
<ul>
<li>無法購買，由<strong>直接購買</strong>時依據機制獲得</li>
<li>點數可以在 <code>兌換券/折價券購買頁面</code> 購買兌換券或折價券</li>
</ul>
<ol start="3">
<li><strong>兌換券兌換及折價券使用</strong></li>
</ol>
<ul>
<li>兌換券獲得：由上述兩種方式獲得的兌換券</li>
<li>折價券獲得：只能由點數購買</li>
<li>這邊的獲得只包括一般情況，不包括特殊活動獲得</li>
<li>如何使用<strong>兌換券及折價券</strong>？: 在購物車的地方，會顯示所有可以使用<strong>兌換券兌換及折價券</strong> <code>card</code>  並且會有一個複選框，讓顧客自由選擇是否使用，使用後會將折扣顯示出來一橫排並扣掉價錢。</li>
<li>如果使用完後價錢為負的，則警告客人不會退還多出的的金額，並且最後金額顯示為 <code>0</code> 。</li>
</ul>
<ol start="4">
<li>技術總結</li>
</ol>
<ul>
<li>點數儲存在顧客的 <code>schema</code></li>
<li>集點機制另外增加一個 <code>schema</code> ，店家可以創建多種機制，方便不同時期切換活動</li>
<li>一張兌換券只能兌換一種商品，不論是一個加點、一個餐點、一個套餐，限定為特定一個</li>
<li>一張折價券可以折價多種商品，所以需要記錄所有可以折價的商品或是所有商品都可折扣，如果折價項目為空代表所有商品皆可折價</li>
<li>一張折價券是否只能折價一份餐點這需要在確認，或是以總金額折價的方式</li>
<li></li>
</ul>
<h2 id="集點機制"><a class="anchor" href="#集點機制">#</a> 集點機制</h2>
<ul>
<li>消費滿<strong> x</strong> 元獲得 <code>1</code>  點</li>
<li>滿<strong> 2x</strong> 元獲得 <code>2</code>  點</li>
<li>採固定累進機制</li>
</ul>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> mongoose <span class="token keyword">from</span> <span class="token string">"mongoose"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">const</span> pointSystemSchema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mongoose<span class="token punctuation">.</span>Schema</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token comment">// 例如 "標準轉換" 或 "雙倍點數日"</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token literal-property property">minAmount</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> Number<span class="token punctuation">,</span> <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token comment">// 最低消費金額</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token literal-property property">formula</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token comment">// 儲存公式，如 "floor (x/300)"</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token literal-property property">desciption</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> String <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token comment">// 描述</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token literal-property property">active</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> Boolean<span class="token punctuation">,</span> <span class="token keyword">default</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token comment">// 是否啟用</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">"PointSystem"</span><span class="token punctuation">,</span> pointSystemSchema<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h2 id="折價券"><a class="anchor" href="#折價券">#</a> 折價券</h2>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">const</span> discountCouponSchema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mongoose<span class="token punctuation">.</span>Schema</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token literal-property property">discount</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token literal-property property">type</span><span class="token operator">:</span> Number<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token literal-property property">admitItems</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token literal-property property">itemModel</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>      <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="13"></td><td><pre>      <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token literal-property property">itemId</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>      <span class="token literal-property property">type</span><span class="token operator">:</span> mongoose<span class="token punctuation">.</span>Schema<span class="token punctuation">.</span>Types<span class="token punctuation">.</span>ObjectId<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="17"></td><td><pre>      <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="18"></td><td><pre>      <span class="token literal-property property">refPath</span><span class="token operator">:</span> <span class="token string">'admitItems.itemModel'</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="20"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="21"></td><td><pre>  <span class="token literal-property property">description</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token literal-property property">type</span><span class="token operator">:</span> String</pre></td></tr><tr><td data-num="23"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="24"></td><td><pre>  <span class="token literal-property property">isUsed</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token literal-property property">type</span><span class="token operator">:</span> Boolean<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token keyword">default</span><span class="token operator">:</span> <span class="token boolean">false</span></pre></td></tr><tr><td data-num="27"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="28"></td><td><pre>  <span class="token literal-property property">startAt</span><span class="token operator">:</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>    <span class="token literal-property property">type</span><span class="token operator">:</span> Date<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="30"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="31"></td><td><pre>  <span class="token literal-property property">expireAt</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token literal-property property">type</span><span class="token operator">:</span> Date<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="33"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="34"></td><td><pre>  <span class="token literal-property property">owner</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>    <span class="token literal-property property">type</span><span class="token operator">:</span> mongoose<span class="token punctuation">.</span>Schema<span class="token punctuation">.</span>Types<span class="token punctuation">.</span>ObjectId<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="36"></td><td><pre>    <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="37"></td><td><pre>    <span class="token literal-property property">ref</span><span class="token operator">:</span> <span class="token string">'Customer'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="38"></td><td><pre>    <span class="token literal-property property">index</span><span class="token operator">:</span> <span class="token boolean">true</span></pre></td></tr><tr><td data-num="39"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h2 id="預購券"><a class="anchor" href="#預購券">#</a> 預購券</h2>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">const</span> exchangeCouponSchema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mongoose<span class="token punctuation">.</span>Schema</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token literal-property property">exchangeItem</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token literal-property property">itemModel</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>      <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="9"></td><td><pre>      <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token literal-property property">itemId</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>      <span class="token literal-property property">type</span><span class="token operator">:</span> mongoose<span class="token punctuation">.</span>Schema<span class="token punctuation">.</span>Types<span class="token punctuation">.</span>ObjectId<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="13"></td><td><pre>      <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="14"></td><td><pre>      <span class="token literal-property property">refPath</span><span class="token operator">:</span> <span class="token string">'exchangeItem.itemModel'</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="16"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="17"></td><td><pre>  <span class="token literal-property property">description</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token literal-property property">type</span><span class="token operator">:</span> String</pre></td></tr><tr><td data-num="19"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="20"></td><td><pre>  <span class="token literal-property property">isUsed</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token literal-property property">type</span><span class="token operator">:</span> Boolean<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token keyword">default</span><span class="token operator">:</span> <span class="token boolean">false</span></pre></td></tr><tr><td data-num="23"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="24"></td><td><pre>  <span class="token literal-property property">startAt</span><span class="token operator">:</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token literal-property property">type</span><span class="token operator">:</span> Date<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="26"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="27"></td><td><pre>  <span class="token literal-property property">expireAt</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token literal-property property">type</span><span class="token operator">:</span> Date<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="29"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="30"></td><td><pre>  <span class="token literal-property property">owner</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token literal-property property">type</span><span class="token operator">:</span> mongoose<span class="token punctuation">.</span>Schema<span class="token punctuation">.</span>Types<span class="token punctuation">.</span>ObjectId<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="33"></td><td><pre>    <span class="token literal-property property">ref</span><span class="token operator">:</span> <span class="token string">'Customer'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="34"></td><td><pre>    <span class="token literal-property property">index</span><span class="token operator">:</span> <span class="token boolean">true</span></pre></td></tr><tr><td data-num="35"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h1 id="伺服器流量計算"><a class="anchor" href="#伺服器流量計算">#</a> 伺服器流量計算</h1>
<h2 id="mongodb"><a class="anchor" href="#mongodb">#</a> mongoDB</h2>
<h3 id="免費額度"><a class="anchor" href="#免費額度">#</a> 免費額度</h3>
<ul>
<li>STORAGE 512MB</li>
<li>RAM Shared</li>
<li>vCPU Shared</li>
</ul>
<h3 id="預計用量"><a class="anchor" href="#預計用量">#</a> 預計用量</h3>
<ul>
<li>假設每張訂單資料約 2KB (實際不到 2KB)</li>
<li>每月新增訂單資料：1,500 訂單 × 2KB 約 3MB / 月</li>
<li>商店、菜單和商品資料 因為不會一直增加所以忽略</li>
<li>總計：約 3MB / 月</li>
<li>免費額度：512MB</li>
<li>每月使用比例：約 0.5%</li>
</ul>
<h3 id="結論"><a class="anchor" href="#結論">#</a> 結論</h3>
<blockquote>
<p>可以使用超過 100 個月<br />
遠小於免費用量</p>
</blockquote>
<h2 id="google-run"><a class="anchor" href="#google-run">#</a> google run</h2>
<h3 id="免費額度-2"><a class="anchor" href="#免費額度-2">#</a> 免費額度</h3>
<ul>
<li>CPU 每月前 240,000 vCPU - 秒免費</li>
<li>記憶體 每月前 450,000 GiB - 秒免費</li>
</ul>
<h3 id="預計用量-2"><a class="anchor" href="#預計用量-2">#</a> 預計用量</h3>
<ul>
<li>每次 API 請求平均消耗約 0.1 CPU 秒</li>
<li>每個訂單流程約需 20 次 API 請求 (菜單載入、商品查詢、下單等)</li>
<li>後臺使用每日大約 200 次 API 請求 (訂單列表載入)</li>
<li>每日 API 請求：50 訂單 × 20 次請求 + 200 次請求 = 1,200 次請求 / 日</li>
<li>每月 CPU 使用量：1,200 次請求 × 0.1 CPU 秒 × 30 天 = 3,600 CPU 秒 / 月</li>
<li>免費額度：240,000 CPU 秒 / 月</li>
<li>使用比例：約 1.5%</li>
</ul>
<h3 id="結論-2"><a class="anchor" href="#結論-2">#</a> 結論</h3>
<blockquote>
<p>CPU 和記憶體使用量僅佔免費額度的約 1.5%</p>
</blockquote>
<h2 id="cloudinary"><a class="anchor" href="#cloudinary">#</a> cloudinary</h2>
<h3 id="免費額度-3"><a class="anchor" href="#免費額度-3">#</a> 免費額度</h3>
<ul>
<li>1 單位 Credit = 1K Transformations ,1 GB ,1 GB Bandwidth</li>
<li>每月有 25 個 Credit 免費使用量</li>
</ul>
<h3 id="預計用量-3"><a class="anchor" href="#預計用量-3">#</a> 預計用量</h3>
<ol>
<li>儲存空間</li>
</ol>
<ul>
<li>20 張圖片 × 200KB = 4MB = 0.004GB</li>
<li>需要：0.004 Credit</li>
</ul>
<ol start="2">
<li>圖片轉換</li>
</ol>
<ul>
<li>假設每月 20 次轉換 = 0.02K 轉換</li>
<li>需要：0.02 Credit</li>
</ul>
<ol start="3">
<li>頻寬使用量</li>
</ol>
<ul>
<li>每日：50 訂單 × 20 張圖片 × 200KB = 195.31MB / 日</li>
<li>每月：195.31MB × 30 天 = 5,859.3MB = 5.72GB</li>
<li>需要：5.72 Credits</li>
</ul>
<p>總計使用量</p>
<p>總計需要：5.72 Credits / 月<br />
免費額度：25 Credits / 月<br />
使用比例：約 22.8%</p>
<h3 id="結論-3"><a class="anchor" href="#結論-3">#</a> 結論</h3>
<blockquote>
<p>每月使用率小於免費額度的四分之一</p>
</blockquote>
<h1 id="測試編寫"><a class="anchor" href="#測試編寫">#</a> 測試編寫</h1>
<p>我現在要開始為每個檔案 編寫測試單元<br />
由於目前專案已經有一定程度<br />
現在開始會是一項大工程 不過這是必須的<br />
參考我現在的檔案結構<br />
告訴我每個階段該如何實作<br />
給我大方向 必要的第三方套件<br />
編寫測試的順序<br />
以及如何連動在 GITHUB 上面這樣之後 push 上去後會自動測試</p>
<h1 id="暫時筆記"><a class="anchor" href="#暫時筆記">#</a> 暫時筆記</h1>
<h2 id="代辦事項"><a class="anchor" href="#代辦事項">#</a> 代辦事項</h2>
<p>後台總營收</p>
<p>外帶 Uber 33%<br />
foodpanda 25%<br />
 信用卡 line pay 3%</p>
<ul>
<li>
<p><s>counter 庫存管理</s></p>
</li>
<li>
<p>counter 贈送 coupon (?)</p>
</li>
<li>
<p>記帳系統</p>
</li>
<li>
<p><s>處理 menu dish 切換不流暢問題</s></p>
</li>
<li>
<p><s>order 顧客分析</s></p>
</li>
<li>
<p><s>點數系統修改</s></p>
</li>
<li>
<p><s>庫存管理 修改人員沒有正確顯示</s></p>
</li>
<li>
<p>line 端整合</p>
</li>
<li>
<p>後台支援外送平台</p>
</li>
<li>
<p>處理 schema</p>
</li>
<li>
<p>修改 component</p>
</li>
<li>
<p>優先支援抓取 order</p>
</li>
<li>
<p>處裡檔案耦合</p>
</li>
<li>
<p>信用卡 line pay API</p>
</li>
</ul>
<h2 id="資料夾命名規則"><a class="anchor" href="#資料夾命名規則">#</a> <strong>資料夾命名規則</strong></h2>
<ul>
<li>頂層目錄命名 (使用 camelCase)</li>
<li>業務邏輯子目錄 (使用 PascalCase)</li>
<li>組件目錄 (使用 PascalCase)</li>
<li>視圖目錄 (使用 camelCase)</li>
</ul>
<h2 id="檔案命名規則詳解"><a class="anchor" href="#檔案命名規則詳解">#</a> <strong>檔案命名規則詳解</strong></h2>
<ol>
<li>模型檔案 (Models)</li>
</ol>
<p>命名風格：PascalCase + 單數<br />
原因：代表類或構造函數，符合 OOP 原則<br />
範例：MainDish.js, Order.js</p>
<ol start="2">
<li>Vue 組件檔案 (Components)</li>
</ol>
<p>命名風格：PascalCase<br />
 原因：Vue 官方建議，與元件註冊名稱一致<br />
範例：CartItem.vue, MenuList.vue</p>
<ol start="3">
<li>視圖檔案 (Views)</li>
</ol>
<p>命名風格：PascalCase<br />
 原因：實際上也是 Vue 組件，遵循相同規則<br />
範例：Dashboard.vue, MenuPage.vue</p>
<ol start="4">
<li>工具函數檔案</li>
</ol>
<p>命名風格：camelCase<br />
 原因：包含普通函數，符合 JavaScript 慣例<br />
範例：priceCalculator.js, dateFormatter.js</p>
<ol start="5">
<li>Store 檔案</li>
</ol>
<p>命名風格：camelCase<br />
 原因：主要導出物件或函數，符合模組命名慣例<br />
範例：cartStore.js, userStore.js</p>
<h2 id="權限控制"><a class="anchor" href="#權限控制">#</a> 權限控制</h2>
<h3 id="admin-schema"><a class="anchor" href="#admin-schema">#</a> admin schema</h3>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> mongoose <span class="token keyword">from</span> <span class="token string">'mongoose'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> bcrypt <span class="token keyword">from</span> <span class="token string">'bcrypt'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">const</span> AdminSchema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mongoose<span class="token punctuation">.</span>Schema</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token string">'admin name cannot be blank'</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token literal-property property">unique</span><span class="token operator">:</span> <span class="token boolean">true</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token literal-property property">password</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token string">'password cannot be blank'</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token literal-property property">select</span><span class="token operator">:</span> <span class="token boolean">false</span></pre></td></tr><tr><td data-num="14"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="15"></td><td><pre>  <span class="token literal-property property">role</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">enum</span><span class="token operator">:</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="18"></td><td><pre>      <span class="token string">'primary_system_admin'</span><span class="token punctuation">,</span>    <span class="token comment">// 系統主管理員</span></pre></td></tr><tr><td data-num="19"></td><td><pre>      <span class="token string">'system_admin'</span><span class="token punctuation">,</span>            <span class="token comment">// 系統管理員</span></pre></td></tr><tr><td data-num="20"></td><td><pre>      <span class="token string">'primary_brand_admin'</span><span class="token punctuation">,</span>     <span class="token comment">// 品牌主管理員</span></pre></td></tr><tr><td data-num="21"></td><td><pre>      <span class="token string">'brand_admin'</span><span class="token punctuation">,</span>             <span class="token comment">// 品牌管理員</span></pre></td></tr><tr><td data-num="22"></td><td><pre>      <span class="token string">'primary_store_admin'</span><span class="token punctuation">,</span>     <span class="token comment">// 店鋪主管理員</span></pre></td></tr><tr><td data-num="23"></td><td><pre>      <span class="token string">'store_admin'</span><span class="token punctuation">,</span>             <span class="token comment">// 店鋪管理員</span></pre></td></tr><tr><td data-num="24"></td><td><pre>      <span class="token string">'employee'</span>                 <span class="token comment">// 員工</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span></pre></td></tr><tr><td data-num="27"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="28"></td><td><pre>  <span class="token comment">// 所屬品牌 (系統級角色不需要)</span></pre></td></tr><tr><td data-num="29"></td><td><pre>  <span class="token literal-property property">brand</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    <span class="token literal-property property">type</span><span class="token operator">:</span> mongoose<span class="token punctuation">.</span>Schema<span class="token punctuation">.</span>Types<span class="token punctuation">.</span>ObjectId<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token literal-property property">ref</span><span class="token operator">:</span> <span class="token string">'Brand'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token function-variable function">required</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>      <span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">[</span><span class="token string">'primary_system_admin'</span><span class="token punctuation">,</span> <span class="token string">'system_admin'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>role<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="35"></td><td><pre>    <span class="token literal-property property">validate</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>      <span class="token function-variable function">validator</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>        <span class="token comment">// 系統級角色不應該有品牌</span></pre></td></tr><tr><td data-num="38"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'primary_system_admin'</span><span class="token punctuation">,</span> <span class="token string">'system_admin'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>role<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>          <span class="token keyword">return</span> <span class="token operator">!</span>value<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="40"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>        <span class="token comment">// 其他角色必須有品牌</span></pre></td></tr><tr><td data-num="42"></td><td><pre>        <span class="token keyword">return</span> <span class="token operator">!</span><span class="token operator">!</span>value<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="44"></td><td><pre>      <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">'角色與品牌設定不符'</span></pre></td></tr><tr><td data-num="45"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="46"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="47"></td><td><pre>  <span class="token comment">// 所屬店鋪 (只有店鋪級角色需要)</span></pre></td></tr><tr><td data-num="48"></td><td><pre>  <span class="token literal-property property">store</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="49"></td><td><pre>    <span class="token literal-property property">type</span><span class="token operator">:</span> mongoose<span class="token punctuation">.</span>Schema<span class="token punctuation">.</span>Types<span class="token punctuation">.</span>ObjectId<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="50"></td><td><pre>    <span class="token literal-property property">ref</span><span class="token operator">:</span> <span class="token string">'Store'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="51"></td><td><pre>    <span class="token function-variable function">required</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="52"></td><td><pre>      <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token string">'primary_store_admin'</span><span class="token punctuation">,</span> <span class="token string">'store_admin'</span><span class="token punctuation">,</span> <span class="token string">'employee'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>role<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="53"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="54"></td><td><pre>    <span class="token literal-property property">validate</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="55"></td><td><pre>      <span class="token function-variable function">validator</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="56"></td><td><pre>        <span class="token comment">// 店鋪級角色必須有店鋪</span></pre></td></tr><tr><td data-num="57"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'primary_store_admin'</span><span class="token punctuation">,</span> <span class="token string">'store_admin'</span><span class="token punctuation">,</span> <span class="token string">'employee'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>role<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="58"></td><td><pre>          <span class="token keyword">return</span> <span class="token operator">!</span><span class="token operator">!</span>value<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="59"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="60"></td><td><pre>        <span class="token comment">// 其他角色不應該有店鋪</span></pre></td></tr><tr><td data-num="61"></td><td><pre>        <span class="token keyword">return</span> <span class="token operator">!</span>value<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="62"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="63"></td><td><pre>      <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">'角色與店鋪設定不符'</span></pre></td></tr><tr><td data-num="64"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="65"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="66"></td><td><pre>  <span class="token literal-property property">isActive</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="67"></td><td><pre>    <span class="token literal-property property">type</span><span class="token operator">:</span> Boolean<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="68"></td><td><pre>    <span class="token keyword">default</span><span class="token operator">:</span> <span class="token boolean">true</span></pre></td></tr><tr><td data-num="69"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="70"></td><td><pre>  <span class="token literal-property property">lastLogin</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="71"></td><td><pre>    <span class="token literal-property property">type</span><span class="token operator">:</span> Date</pre></td></tr><tr><td data-num="72"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="73"></td><td><pre>  <span class="token literal-property property">createdBy</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="74"></td><td><pre>    <span class="token literal-property property">type</span><span class="token operator">:</span> mongoose<span class="token punctuation">.</span>Schema<span class="token punctuation">.</span>Types<span class="token punctuation">.</span>ObjectId<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="75"></td><td><pre>    <span class="token literal-property property">ref</span><span class="token operator">:</span> <span class="token string">'Admin'</span></pre></td></tr><tr><td data-num="76"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token comment">// 記錄是誰創建的，用於權限追蹤</span></pre></td></tr><tr><td data-num="77"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">timestamps</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="78"></td><td><pre></pre></td></tr><tr><td data-num="79"></td><td><pre><span class="token comment">// 索引設定</span></pre></td></tr><tr><td data-num="80"></td><td><pre>AdminSchema<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">role</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="81"></td><td><pre>AdminSchema<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">brand</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">role</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="82"></td><td><pre>AdminSchema<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">store</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">role</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="83"></td><td><pre>AdminSchema<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">brand</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">store</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="84"></td><td><pre></pre></td></tr><tr><td data-num="85"></td><td><pre><span class="token comment">// 唯一性約束：確保 primary 角色的唯一性</span></pre></td></tr><tr><td data-num="86"></td><td><pre>AdminSchema<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="87"></td><td><pre>  <span class="token punctuation">&#123;</span> <span class="token literal-property property">role</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="88"></td><td><pre>  <span class="token punctuation">&#123;</span> </pre></td></tr><tr><td data-num="89"></td><td><pre>    <span class="token literal-property property">unique</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="90"></td><td><pre>    <span class="token literal-property property">partialFilterExpression</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">role</span><span class="token operator">:</span> <span class="token string">'primary_system_admin'</span> <span class="token punctuation">&#125;</span> </pre></td></tr><tr><td data-num="91"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="92"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="93"></td><td><pre></pre></td></tr><tr><td data-num="94"></td><td><pre>AdminSchema<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="95"></td><td><pre>  <span class="token punctuation">&#123;</span> <span class="token literal-property property">brand</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">role</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="96"></td><td><pre>  <span class="token punctuation">&#123;</span> </pre></td></tr><tr><td data-num="97"></td><td><pre>    <span class="token literal-property property">unique</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="98"></td><td><pre>    <span class="token literal-property property">partialFilterExpression</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">role</span><span class="token operator">:</span> <span class="token string">'primary_brand_admin'</span> <span class="token punctuation">&#125;</span> </pre></td></tr><tr><td data-num="99"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="100"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="101"></td><td><pre></pre></td></tr><tr><td data-num="102"></td><td><pre>AdminSchema<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="103"></td><td><pre>  <span class="token punctuation">&#123;</span> <span class="token literal-property property">store</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">role</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="104"></td><td><pre>  <span class="token punctuation">&#123;</span> </pre></td></tr><tr><td data-num="105"></td><td><pre>    <span class="token literal-property property">unique</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="106"></td><td><pre>    <span class="token literal-property property">partialFilterExpression</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">role</span><span class="token operator">:</span> <span class="token string">'primary_store_admin'</span> <span class="token punctuation">&#125;</span> </pre></td></tr><tr><td data-num="107"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="108"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="109"></td><td><pre></pre></td></tr><tr><td data-num="110"></td><td><pre><span class="token comment">// 密碼加密</span></pre></td></tr><tr><td data-num="111"></td><td><pre>AdminSchema<span class="token punctuation">.</span><span class="token function">pre</span><span class="token punctuation">(</span><span class="token string">'save'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="112"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">isModified</span><span class="token punctuation">(</span><span class="token string">'password'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="113"></td><td><pre></pre></td></tr><tr><td data-num="114"></td><td><pre>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="115"></td><td><pre>    <span class="token keyword">const</span> salt <span class="token operator">=</span> <span class="token keyword">await</span> bcrypt<span class="token punctuation">.</span><span class="token function">genSalt</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="116"></td><td><pre>    <span class="token keyword">this</span><span class="token punctuation">.</span>password <span class="token operator">=</span> <span class="token keyword">await</span> bcrypt<span class="token punctuation">.</span><span class="token function">hash</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>password<span class="token punctuation">,</span> salt<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="117"></td><td><pre>    <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="118"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="119"></td><td><pre>    <span class="token function">next</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="120"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="121"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="122"></td><td><pre></pre></td></tr><tr><td data-num="123"></td><td><pre><span class="token comment">// 驗證密碼方法</span></pre></td></tr><tr><td data-num="124"></td><td><pre>AdminSchema<span class="token punctuation">.</span>methods<span class="token punctuation">.</span><span class="token function-variable function">comparePassword</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">candidatePassword</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="125"></td><td><pre>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="126"></td><td><pre>    <span class="token keyword">return</span> <span class="token keyword">await</span> bcrypt<span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span>candidatePassword<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="127"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="128"></td><td><pre>    <span class="token keyword">throw</span> error<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="129"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="130"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="131"></td><td><pre></pre></td></tr><tr><td data-num="132"></td><td><pre><span class="token comment">// 獲取角色權限級別的靜態方法</span></pre></td></tr><tr><td data-num="133"></td><td><pre>AdminSchema<span class="token punctuation">.</span>statics<span class="token punctuation">.</span><span class="token function-variable function">getRoleLevel</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">role</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="134"></td><td><pre>  <span class="token keyword">const</span> levels <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="135"></td><td><pre>    <span class="token string-property property">'primary_system_admin'</span><span class="token operator">:</span> <span class="token number">7</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="136"></td><td><pre>    <span class="token string-property property">'system_admin'</span><span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="137"></td><td><pre>    <span class="token string-property property">'primary_brand_admin'</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="138"></td><td><pre>    <span class="token string-property property">'brand_admin'</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="139"></td><td><pre>    <span class="token string-property property">'primary_store_admin'</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="140"></td><td><pre>    <span class="token string-property property">'store_admin'</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="141"></td><td><pre>    <span class="token string-property property">'employee'</span><span class="token operator">:</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="142"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="143"></td><td><pre>  <span class="token keyword">return</span> levels<span class="token punctuation">[</span>role<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="144"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="145"></td><td><pre></pre></td></tr><tr><td data-num="146"></td><td><pre><span class="token comment">// 檢查是否為 primary 角色的實例方法</span></pre></td></tr><tr><td data-num="147"></td><td><pre>AdminSchema<span class="token punctuation">.</span>methods<span class="token punctuation">.</span><span class="token function-variable function">isPrimaryRole</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="148"></td><td><pre>  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>role<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">'primary_'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="149"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="150"></td><td><pre></pre></td></tr><tr><td data-num="151"></td><td><pre><span class="token comment">// 檢查角色層級的實例方法</span></pre></td></tr><tr><td data-num="152"></td><td><pre>AdminSchema<span class="token punctuation">.</span>methods<span class="token punctuation">.</span><span class="token function-variable function">getRoleScope</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="153"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'primary_system_admin'</span><span class="token punctuation">,</span> <span class="token string">'system_admin'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>role<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="154"></td><td><pre>    <span class="token keyword">return</span> <span class="token string">'system'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="155"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="156"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'primary_brand_admin'</span><span class="token punctuation">,</span> <span class="token string">'brand_admin'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>role<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="157"></td><td><pre>    <span class="token keyword">return</span> <span class="token string">'brand'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="158"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="159"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'primary_store_admin'</span><span class="token punctuation">,</span> <span class="token string">'store_admin'</span><span class="token punctuation">,</span> <span class="token string">'employee'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>role<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="160"></td><td><pre>    <span class="token keyword">return</span> <span class="token string">'store'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="161"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="162"></td><td><pre>  <span class="token keyword">return</span> <span class="token string">'unknown'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="163"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="164"></td><td><pre></pre></td></tr><tr><td data-num="165"></td><td><pre><span class="token comment">// 檢查是否可以管理特定角色的實例方法</span></pre></td></tr><tr><td data-num="166"></td><td><pre>AdminSchema<span class="token punctuation">.</span>methods<span class="token punctuation">.</span><span class="token function-variable function">canManageRole</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">targetRole</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="167"></td><td><pre>  <span class="token keyword">const</span> currentLevel <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>constructor<span class="token punctuation">.</span><span class="token function">getRoleLevel</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>role<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="168"></td><td><pre>  <span class="token keyword">const</span> targetLevel <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>constructor<span class="token punctuation">.</span><span class="token function">getRoleLevel</span><span class="token punctuation">(</span>targetRole<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="169"></td><td><pre>  </pre></td></tr><tr><td data-num="170"></td><td><pre>  <span class="token comment">// 必須是 primary 角色才能管理成員</span></pre></td></tr><tr><td data-num="171"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">isPrimaryRole</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="172"></td><td><pre>    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="173"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="174"></td><td><pre>  </pre></td></tr><tr><td data-num="175"></td><td><pre>  <span class="token comment">// 只能管理同級或下級角色</span></pre></td></tr><tr><td data-num="176"></td><td><pre>  <span class="token keyword">return</span> currentLevel <span class="token operator">></span> targetLevel<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="177"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="178"></td><td><pre></pre></td></tr><tr><td data-num="179"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'Admin'</span><span class="token punctuation">,</span> AdminSchema<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h1 id="temp"><a class="anchor" href="#temp">#</a> temp</h1>
<p>假設燒一壺水你現在有一個空水壺 需要五個步驟</p>
<ul>
<li>裝滿水</li>
<li>砍柴</li>
<li>燒柴</li>
<li>把水放到爐架上</li>
<li>等待五分鐘</li>
</ul>
<p>如果你現在 有一個裝半滿水的水壺 你該怎麼做？</p>
<ul>
<li>把水倒出重複上面的動作</li>
</ul>
<p><strong>遷移檔案</strong></p>
<figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> mongoose <span class="token keyword">from</span> <span class="token string">'mongoose'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> dotenv <span class="token keyword">from</span> <span class="token string">'dotenv'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>dotenv<span class="token punctuation">.</span><span class="token function">config</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">migrateAdminIndexes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">await</span> mongoose<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>MongoDB_url<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"MongoDB connected"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">const</span> collection <span class="token operator">=</span> mongoose<span class="token punctuation">.</span>connection<span class="token punctuation">.</span>db<span class="token punctuation">.</span><span class="token function">collection</span><span class="token punctuation">(</span><span class="token string">'admins'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"開始索引遷移..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token comment">// 1. 檢查現有索引</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"檢查現有索引..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">const</span> existingIndexes <span class="token operator">=</span> <span class="token keyword">await</span> collection<span class="token punctuation">.</span><span class="token function">indexes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"現有索引:"</span><span class="token punctuation">,</span> existingIndexes<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">idx</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">name</span><span class="token operator">:</span> idx<span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token literal-property property">key</span><span class="token operator">:</span> idx<span class="token punctuation">.</span>key <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token comment">// 2. 檢查是否存在有問題的 name 唯一索引</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token keyword">const</span> problematicIndex <span class="token operator">=</span> existingIndexes<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">idx</span> <span class="token operator">=></span></pre></td></tr><tr><td data-num="22"></td><td><pre>      idx<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">'name_1'</span> <span class="token operator">||</span></pre></td></tr><tr><td data-num="23"></td><td><pre>      <span class="token punctuation">(</span>idx<span class="token punctuation">.</span>key<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> idx<span class="token punctuation">.</span>unique <span class="token operator">===</span> <span class="token boolean">true</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>idx<span class="token punctuation">.</span>partialFilterExpression<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>problematicIndex<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">發現有問題的索引: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>problematicIndex<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">刪除索引: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>problematicIndex<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>      <span class="token keyword">await</span> collection<span class="token punctuation">.</span><span class="token function">dropIndex</span><span class="token punctuation">(</span>problematicIndex<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"索引刪除成功"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="32"></td><td><pre></pre></td></tr><tr><td data-num="33"></td><td><pre>    <span class="token comment">// 3. 檢查數據一致性</span></pre></td></tr><tr><td data-num="34"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"檢查數據一致性..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre></pre></td></tr><tr><td data-num="36"></td><td><pre>    <span class="token comment">// 為系統級管理員添加特殊的 brand 標識</span></pre></td></tr><tr><td data-num="37"></td><td><pre>    <span class="token keyword">const</span> systemAdmins <span class="token operator">=</span> <span class="token keyword">await</span> collection<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>      <span class="token literal-property property">role</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> $<span class="token keyword">in</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'primary_system_admin'</span><span class="token punctuation">,</span> <span class="token string">'system_admin'</span><span class="token punctuation">]</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="39"></td><td><pre>      <span class="token literal-property property">$or</span><span class="token operator">:</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="40"></td><td><pre>        <span class="token punctuation">&#123;</span> <span class="token literal-property property">brand</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">$exists</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="41"></td><td><pre>        <span class="token punctuation">&#123;</span> <span class="token literal-property property">brand</span><span class="token operator">:</span> <span class="token keyword">null</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="42"></td><td><pre>      <span class="token punctuation">]</span></pre></td></tr><tr><td data-num="43"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="44"></td><td><pre></pre></td></tr><tr><td data-num="45"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">發現 </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>systemAdmins<span class="token punctuation">.</span>length<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string"> 個系統級管理員需要處理</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="46"></td><td><pre></pre></td></tr><tr><td data-num="47"></td><td><pre>    <span class="token comment">// 為系統級管理員設置特殊的 brand 值</span></pre></td></tr><tr><td data-num="48"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>systemAdmins<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="49"></td><td><pre>      <span class="token keyword">await</span> collection<span class="token punctuation">.</span><span class="token function">updateMany</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="50"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="51"></td><td><pre>          <span class="token literal-property property">role</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> $<span class="token keyword">in</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'primary_system_admin'</span><span class="token punctuation">,</span> <span class="token string">'system_admin'</span><span class="token punctuation">]</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="52"></td><td><pre>          <span class="token literal-property property">$or</span><span class="token operator">:</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="53"></td><td><pre>            <span class="token punctuation">&#123;</span> <span class="token literal-property property">brand</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">$exists</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="54"></td><td><pre>            <span class="token punctuation">&#123;</span> <span class="token literal-property property">brand</span><span class="token operator">:</span> <span class="token keyword">null</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="55"></td><td><pre>          <span class="token punctuation">]</span></pre></td></tr><tr><td data-num="56"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="57"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="58"></td><td><pre>          <span class="token literal-property property">$set</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">brand</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">mongoose<span class="token punctuation">.</span>Types<span class="token punctuation">.</span>ObjectId</span><span class="token punctuation">(</span><span class="token string">'000000000000000000000000'</span><span class="token punctuation">)</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="59"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="60"></td><td><pre>      <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="61"></td><td><pre>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">已為 </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>systemAdmins<span class="token punctuation">.</span>length<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string"> 個系統級管理員設置特殊品牌標識</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="62"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="63"></td><td><pre></pre></td></tr><tr><td data-num="64"></td><td><pre>    <span class="token comment">// 4. 檢查是否有重複的 brand+name 組合</span></pre></td></tr><tr><td data-num="65"></td><td><pre>    <span class="token keyword">const</span> duplicates <span class="token operator">=</span> <span class="token keyword">await</span> collection<span class="token punctuation">.</span><span class="token function">aggregate</span><span class="token punctuation">(</span><span class="token punctuation">[</span></pre></td></tr><tr><td data-num="66"></td><td><pre>      <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="67"></td><td><pre>        <span class="token literal-property property">$group</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="68"></td><td><pre>          <span class="token literal-property property">_id</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">brand</span><span class="token operator">:</span> <span class="token string">"$brand"</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"$name"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="69"></td><td><pre>          <span class="token literal-property property">count</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">$sum</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="70"></td><td><pre>          <span class="token literal-property property">docs</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">$push</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">"$_id"</span><span class="token punctuation">,</span> <span class="token literal-property property">role</span><span class="token operator">:</span> <span class="token string">"$role"</span> <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="71"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="72"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="73"></td><td><pre>      <span class="token punctuation">&#123;</span> <span class="token literal-property property">$match</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">count</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">$gt</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="74"></td><td><pre>    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="75"></td><td><pre></pre></td></tr><tr><td data-num="76"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>duplicates<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="77"></td><td><pre>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"警告：發現重複的品牌+名稱組合："</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="78"></td><td><pre>      duplicates<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">dup</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="79"></td><td><pre>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">品牌 </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>dup<span class="token punctuation">.</span>_id<span class="token punctuation">.</span>brand<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string"> 的名稱 "</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>dup<span class="token punctuation">.</span>_id<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">" 重複 </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>dup<span class="token punctuation">.</span>count<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string"> 次:</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="80"></td><td><pre>        dup<span class="token punctuation">.</span>docs<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">doc</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="81"></td><td><pre>          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">  - ID: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>doc<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">, Role: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>doc<span class="token punctuation">.</span>role<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="82"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="83"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="84"></td><td><pre>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"請先處理重複數據，然後重新運行此腳本"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="85"></td><td><pre>      <span class="token keyword">return</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="86"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="87"></td><td><pre></pre></td></tr><tr><td data-num="88"></td><td><pre>    <span class="token comment">// 5. 創建新的複合唯一索引</span></pre></td></tr><tr><td data-num="89"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"創建品牌+名稱複合唯一索引..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="90"></td><td><pre></pre></td></tr><tr><td data-num="91"></td><td><pre>    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="92"></td><td><pre>      <span class="token keyword">await</span> collection<span class="token punctuation">.</span><span class="token function">createIndex</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="93"></td><td><pre>        <span class="token punctuation">&#123;</span> <span class="token literal-property property">brand</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="94"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="95"></td><td><pre>          <span class="token literal-property property">unique</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="96"></td><td><pre>          <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"brand_name_unique"</span></pre></td></tr><tr><td data-num="97"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="98"></td><td><pre>      <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="99"></td><td><pre>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"✓ 品牌+名稱複合唯一索引創建成功"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="100"></td><td><pre>    <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="101"></td><td><pre>      <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">.</span>code <span class="token operator">===</span> <span class="token number">85</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="102"></td><td><pre>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"品牌+名稱複合唯一索引已存在"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="103"></td><td><pre>      <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="104"></td><td><pre>        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"創建索引失敗:"</span><span class="token punctuation">,</span> error<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="105"></td><td><pre>        <span class="token keyword">throw</span> error<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="106"></td><td><pre>      <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="107"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="108"></td><td><pre></pre></td></tr><tr><td data-num="109"></td><td><pre>    <span class="token comment">// 6. 驗證最終索引狀態</span></pre></td></tr><tr><td data-num="110"></td><td><pre>    <span class="token keyword">const</span> finalIndexes <span class="token operator">=</span> <span class="token keyword">await</span> collection<span class="token punctuation">.</span><span class="token function">indexes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="111"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"\n最終索引狀態:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="112"></td><td><pre>    finalIndexes<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">idx</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="113"></td><td><pre>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">- </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>idx<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>idx<span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>idx<span class="token punctuation">.</span>unique <span class="token operator">?</span> <span class="token string">'(唯一)'</span> <span class="token operator">:</span> <span class="token string">''</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="114"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="115"></td><td><pre></pre></td></tr><tr><td data-num="116"></td><td><pre>    <span class="token comment">// 7. 測試索引效果</span></pre></td></tr><tr><td data-num="117"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"\n測試索引效果..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="118"></td><td><pre></pre></td></tr><tr><td data-num="119"></td><td><pre>    <span class="token keyword">const</span> totalAdmins <span class="token operator">=</span> <span class="token keyword">await</span> collection<span class="token punctuation">.</span><span class="token function">countDocuments</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="120"></td><td><pre>    <span class="token keyword">const</span> systemAdminsCount <span class="token operator">=</span> <span class="token keyword">await</span> collection<span class="token punctuation">.</span><span class="token function">countDocuments</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="121"></td><td><pre>      <span class="token literal-property property">brand</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">mongoose<span class="token punctuation">.</span>Types<span class="token punctuation">.</span>ObjectId</span><span class="token punctuation">(</span><span class="token string">'000000000000000000000000'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="122"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="123"></td><td><pre>    <span class="token keyword">const</span> brandAdminsCount <span class="token operator">=</span> <span class="token keyword">await</span> collection<span class="token punctuation">.</span><span class="token function">countDocuments</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="124"></td><td><pre>      <span class="token literal-property property">brand</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">$ne</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">mongoose<span class="token punctuation">.</span>Types<span class="token punctuation">.</span>ObjectId</span><span class="token punctuation">(</span><span class="token string">'000000000000000000000000'</span><span class="token punctuation">)</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="125"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="126"></td><td><pre></pre></td></tr><tr><td data-num="127"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">總管理員數量: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>totalAdmins<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="128"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">系統級管理員: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>systemAdminsCount<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="129"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">品牌級管理員: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>brandAdminsCount<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="130"></td><td><pre></pre></td></tr><tr><td data-num="131"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"\n索引遷移完成！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="132"></td><td><pre></pre></td></tr><tr><td data-num="133"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="134"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'索引遷移失敗:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="135"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="136"></td><td><pre>    <span class="token keyword">await</span> mongoose<span class="token punctuation">.</span><span class="token function">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="137"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="138"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="139"></td><td><pre></pre></td></tr><tr><td data-num="140"></td><td><pre><span class="token function">migrateAdminIndexes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong>促銷系統規劃</strong></p>
<ul>
<li>
<p>先完成 現金購買 到達累積金額 獲得相對應 point</p>
</li>
<li>
<p>新增 point 商店，使用 point 可購買商品的 pages</p>
</li>
<li>
<p>需要有 point menu，需要調整 models</p>
</li>
<li>
<p>新增預購券商店，可用現金購買預購券</p>
</li>
<li>
<p>新增綑綁販售功能，例如 5 張豬排兌換券 綁在一起販售 然後是自訂義的價格</p>
</li>
<li>
<p>綑綁販售實作邏輯，我打算紀錄 menu 裡面， 可以調整數量，最後覆蓋一個價格，然後後端 API 自動創建多張兌換券 這樣就達到我要的效果</p>
</li>
<li>
<p>兌換券 的 point system 可以與現金購買頁面的 point system 獨立處理，例如為了鼓勵預購兌換券 轉換比例可以高一點</p>
</li>
<li>
<p>是否需要支援可以同時購買餐點及預購兌換券，需要處理 point system 轉換率的問題</p>
</li>
</ul>
<pre class="mermaid"><svg id="mermaid-1767940343114" width="100%" xmlns="http://www.w3.org/2000/svg" height="1203" style="max-width: 1480px;" viewBox="-50 -10 1480 1203"><style>#mermaid-1767940343114{font-family:"trebuchet ms",verdana,arial;font-size:16px;fill:#333;}#mermaid-1767940343114 .error-icon{fill:#552222;}#mermaid-1767940343114 .error-text{fill:#552222;stroke:#552222;}#mermaid-1767940343114 .edge-thickness-normal{stroke-width:2px;}#mermaid-1767940343114 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1767940343114 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1767940343114 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1767940343114 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1767940343114 .marker{fill:#333333;}#mermaid-1767940343114 .marker.cross{stroke:#333333;}#mermaid-1767940343114 svg{font-family:"trebuchet ms",verdana,arial;font-size:16px;}#mermaid-1767940343114 .actor{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;}#mermaid-1767940343114 text.actor &gt; tspan{fill:black;stroke:none;}#mermaid-1767940343114 .actor-line{stroke:grey;}#mermaid-1767940343114 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333;}#mermaid-1767940343114 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333;}#mermaid-1767940343114 #arrowhead path{fill:#333;stroke:#333;}#mermaid-1767940343114 .sequenceNumber{fill:white;}#mermaid-1767940343114 #sequencenumber{fill:#333;}#mermaid-1767940343114 #crosshead path{fill:#333;stroke:#333;}#mermaid-1767940343114 .messageText{fill:#333;stroke:#333;}#mermaid-1767940343114 .labelBox{stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:#ECECFF;}#mermaid-1767940343114 .labelText,#mermaid-1767940343114 .labelText &gt; tspan{fill:black;stroke:none;}#mermaid-1767940343114 .loopText,#mermaid-1767940343114 .loopText &gt; tspan{fill:black;stroke:none;}#mermaid-1767940343114 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243,59.7765363128%,87.9019607843%);fill:hsl(259.6261682243,59.7765363128%,87.9019607843%);}#mermaid-1767940343114 .note{stroke:#aaaa33;fill:#fff5ad;}#mermaid-1767940343114 .noteText,#mermaid-1767940343114 .noteText &gt; tspan{fill:black;stroke:none;}#mermaid-1767940343114 .activation0{fill:#f4f4f4;stroke:#666;}#mermaid-1767940343114 .activation1{fill:#f4f4f4;stroke:#666;}#mermaid-1767940343114 .activation2{fill:#f4f4f4;stroke:#666;}#mermaid-1767940343114:root{--mermaid-font-family:"trebuchet ms",verdana,arial;}#mermaid-1767940343114 sequence{fill:apa;}</style><g></g><g><line id="actor0" x1="75" y1="5" x2="75" y2="1192" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="0" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="75" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, sans-serif;"><tspan x="75" dy="0">用戶</tspan></text></g><g><line id="actor1" x1="385" y1="5" x2="385" y2="1192" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="310" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="385" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, sans-serif;"><tspan x="385" dy="0">前端</tspan></text></g><g><line id="actor2" x1="711" y1="5" x2="711" y2="1192" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="636" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="711" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, sans-serif;"><tspan x="711" dy="0">後端API</tspan></text></g><g><line id="actor3" x1="1105" y1="5" x2="1105" y2="1192" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="1030" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="1105" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, sans-serif;"><tspan x="1105" dy="0">支付服務提供商</tspan></text></g><g><line id="actor4" x1="1305" y1="5" x2="1305" y2="1192" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="1230" y="0" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="1305" y="32.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, sans-serif;"><tspan x="1305" dy="0">資料庫</tspan></text></g><defs><marker id="arrowhead" refX="5" refY="2" markerWidth="6" markerHeight="4" orient="auto"><path d="M 0,0 V 4 L6,2 Z"></path></marker></defs><defs><marker id="crosshead" markerWidth="15" markerHeight="8" orient="auto" refX="16" refY="4"><path fill="black" stroke="#000000" stroke-width="1px" d="M 9,2 V 6 L16,4 Z" style="stroke-dasharray: 0, 0;"></path><path fill="none" stroke="#000000" stroke-width="1px" d="M 0,1 L 6,7 M 6,1 L 0,7" style="stroke-dasharray: 0, 0;"></path></marker></defs><defs><marker id="sequencenumber" refX="15" refY="15" markerWidth="60" markerHeight="40" orient="auto"><circle cx="15" cy="15" r="6"></circle></marker></defs><text x="230" y="80" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">選擇支付方式並提交訂單</text><line x1="75" y1="113" x2="385" y2="113" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" style="fill: none;"></line><text x="548" y="128" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">POST /api/order/:orderId/payment</text><line x1="385" y1="161" x2="711" y2="161" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" style="fill: none;"></line><text x="1008" y="176" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">檢查訂單狀態(是否為待支付)</text><line x1="711" y1="209" x2="1305" y2="209" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" style="fill: none;"></line><text x="1008" y="224" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">返回訂單資訊</text><line x1="1305" y1="257" x2="711" y2="257" class="messageLine1" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line><text x="908" y="272" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">發起支付請求(建立交易)</text><line x1="711" y1="305" x2="1105" y2="305" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" style="fill: none;"></line><text x="908" y="320" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">返回支付URL/參數</text><line x1="1105" y1="353" x2="711" y2="353" class="messageLine1" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line><text x="1008" y="368" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">更新訂單狀態為"處理中"</text><line x1="711" y1="401" x2="1305" y2="401" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" style="fill: none;"></line><text x="548" y="416" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">返回支付URL/參數</text><line x1="711" y1="449" x2="385" y2="449" class="messageLine1" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line><text x="230" y="464" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">顯示支付頁面或重定向至支付網址</text><line x1="385" y1="497" x2="75" y2="497" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" style="fill: none;"></line><text x="590" y="512" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">進行支付操作</text><line x1="75" y1="545" x2="1105" y2="545" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" style="fill: none;"></line><text x="908" y="560" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">POST /api/order/:orderId/payment/callback</text><line x1="1105" y1="593" x2="711" y2="593" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" style="fill: none;"></line><text x="711" y="608" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">驗證回調請求的真實性</text><path d="M 711,641 C 771,631 771,671 711,661" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" style="fill: none;"></path><text x="1008" y="686" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">更新訂單狀態(已支付/失敗)</text><line x1="711" y1="719" x2="1305" y2="719" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" style="fill: none;"></line><text x="908" y="779" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">確認收到(200 OK)</text><line x1="711" y1="812" x2="1105" y2="812" class="messageLine1" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line><text x="548" y="827" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">推送支付成功通知(可選)</text><line x1="711" y1="860" x2="385" y2="860" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" style="fill: none;"></line><text x="230" y="875" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">顯示支付成功頁面</text><line x1="385" y1="908" x2="75" y2="908" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" style="fill: none;"></line><text x="908" y="968" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">確認收到(200 OK)</text><line x1="711" y1="1001" x2="1105" y2="1001" class="messageLine1" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" style="stroke-dasharray: 3, 3; fill: none;"></line><text x="548" y="1016" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">推送支付失敗通知(可選)</text><line x1="711" y1="1049" x2="385" y2="1049" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" style="fill: none;"></line><text x="230" y="1064" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="messageText" dy="1em" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">顯示支付失敗，提供重試選項</text><line x1="385" y1="1097" x2="75" y2="1097" class="messageLine0" stroke-width="2" stroke="none" marker-end="url(#arrowhead)" style="fill: none;"></line><g><line x1="65" y1="729" x2="1115" y2="729" class="loopLine"></line><line x1="1115" y1="729" x2="1115" y2="1107" class="loopLine"></line><line x1="65" y1="1107" x2="1115" y2="1107" class="loopLine"></line><line x1="65" y1="729" x2="65" y2="1107" class="loopLine"></line><line x1="65" y1="923" x2="1115" y2="923" class="loopLine" style="stroke-dasharray: 3, 3;"></line><polygon points="65,729 115,729 115,742 106.6,749 65,749" class="labelBox"></polygon><text x="90" y="742" text-anchor="middle" dominant-baseline="middle" alignment-baseline="middle" class="labelText" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">alt</text><text x="615" y="747" text-anchor="middle" class="loopText" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;"><tspan x="615">[支付成功]</tspan></text><text x="590" y="941" text-anchor="middle" class="loopText" style="font-family: &quot;trebuchet ms&quot;, verdana, arial; font-size: 16px; font-weight: 400;">[支付失敗]</text></g><g><rect x="0" y="1127" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="75" y="1159.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, sans-serif;"><tspan x="75" dy="0">用戶</tspan></text></g><g><rect x="310" y="1127" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="385" y="1159.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, sans-serif;"><tspan x="385" dy="0">前端</tspan></text></g><g><rect x="636" y="1127" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="711" y="1159.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, sans-serif;"><tspan x="711" dy="0">後端API</tspan></text></g><g><rect x="1030" y="1127" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="1105" y="1159.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, sans-serif;"><tspan x="1105" dy="0">支付服務提供商</tspan></text></g><g><rect x="1230" y="1127" fill="#eaeaea" stroke="#666" width="150" height="65" rx="3" ry="3" class="actor"></rect><text x="1305" y="1159.5" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, sans-serif;"><tspan x="1305" dy="0">資料庫</tspan></text></g></svg></pre><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> createRouter<span class="token punctuation">,</span> createWebHistory <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'vue-router'</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> api <span class="token keyword">from</span> <span class="token string">'@/api'</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">// 檢查管理員登入狀態</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">checkAdminAuth</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token comment">// 測試階段直接返回已登入狀態和最高權限</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token keyword">return</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token literal-property property">loggedIn</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token literal-property property">role</span><span class="token operator">:</span> <span class="token string">'boss'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token literal-property property">manage</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">// 可以根據需要添加模擬的店鋪權限</span></pre></td></tr><tr><td data-num="11"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre>  <span class="token comment">// try &#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>  <span class="token comment">//   const response = await api.auth.checkAdmin()</span></pre></td></tr><tr><td data-num="15"></td><td><pre>  <span class="token comment">//   return &#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>  <span class="token comment">//     loggedIn: response.data.loggedIn,</span></pre></td></tr><tr><td data-num="17"></td><td><pre>  <span class="token comment">//     role: response.data.role,</span></pre></td></tr><tr><td data-num="18"></td><td><pre>  <span class="token comment">//     manage: response.data.manage || []</span></pre></td></tr><tr><td data-num="19"></td><td><pre>  <span class="token comment">//   &#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>  <span class="token comment">// &#125; catch (error) &#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>  <span class="token comment">//   console.error (' 檢查管理員登入狀態失敗 ', error)</span></pre></td></tr><tr><td data-num="22"></td><td><pre>  <span class="token comment">//   return &#123; loggedIn: false, role: null, manage: [] &#125;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>  <span class="token comment">// &#125;</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="25"></td><td><pre></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token comment">// 檢查會員登入狀態 (目前在測試階段暫時不使用)</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">checkUserAuth</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>  <span class="token comment">// 測試階段直接返回已登入狀態</span></pre></td></tr><tr><td data-num="29"></td><td><pre>  <span class="token keyword">return</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    <span class="token literal-property property">loggedIn</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token literal-property property">userData</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">'test-user-id'</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'測試用戶'</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="33"></td><td><pre></pre></td></tr><tr><td data-num="34"></td><td><pre>  <span class="token comment">// 正式環境程式碼 (暫時註解)</span></pre></td></tr><tr><td data-num="35"></td><td><pre>  <span class="token comment">/*</pre></td></tr><tr><td data-num="36"></td><td><pre>  try &#123;</pre></td></tr><tr><td data-num="37"></td><td><pre>    const response = await api.auth.checkUser ()</pre></td></tr><tr><td data-num="38"></td><td><pre>    return &#123;</pre></td></tr><tr><td data-num="39"></td><td><pre>      loggedIn: response.data.loggedIn,</pre></td></tr><tr><td data-num="40"></td><td><pre>      userData: response.data.user</pre></td></tr><tr><td data-num="41"></td><td><pre>    &#125;</pre></td></tr><tr><td data-num="42"></td><td><pre>  &#125; catch (error) &#123;</pre></td></tr><tr><td data-num="43"></td><td><pre>    console.error (' 檢查會員登入狀態失敗 ', error)</pre></td></tr><tr><td data-num="44"></td><td><pre>    return &#123; loggedIn: false, userData: null &#125;</pre></td></tr><tr><td data-num="45"></td><td><pre>  &#125;</pre></td></tr><tr><td data-num="46"></td><td><pre>  */</span></pre></td></tr><tr><td data-num="47"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="48"></td><td><pre></pre></td></tr><tr><td data-num="49"></td><td><pre><span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">createRouter</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="50"></td><td><pre>  <span class="token literal-property property">history</span><span class="token operator">:</span> <span class="token function">createWebHistory</span><span class="token punctuation">(</span><span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">BASE_URL</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="51"></td><td><pre>  <span class="token literal-property property">routes</span><span class="token operator">:</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="52"></td><td><pre>    <span class="token comment">//// 首頁 - 重定向到適當的頁面</span></pre></td></tr><tr><td data-num="53"></td><td><pre>    <span class="token comment">// &#123;</span></pre></td></tr><tr><td data-num="54"></td><td><pre>    <span class="token comment">//   path: '/',</span></pre></td></tr><tr><td data-num="55"></td><td><pre>    <span class="token comment">//   name: 'home',</span></pre></td></tr><tr><td data-num="56"></td><td><pre>    <span class="token comment">//   redirect: to => &#123;</span></pre></td></tr><tr><td data-num="57"></td><td><pre>    <span class="token comment">//     // 可以根據登入狀態決定重定向到哪個頁面</span></pre></td></tr><tr><td data-num="58"></td><td><pre>    <span class="token comment">//     return &#123; path: '/customer/stores' &#125;</span></pre></td></tr><tr><td data-num="59"></td><td><pre>    <span class="token comment">//   &#125;</span></pre></td></tr><tr><td data-num="60"></td><td><pre>    <span class="token comment">// &#125;,</span></pre></td></tr><tr><td data-num="61"></td><td><pre></pre></td></tr><tr><td data-num="62"></td><td><pre>    <span class="token comment">//// 管理員認證</span></pre></td></tr><tr><td data-num="63"></td><td><pre>    <span class="token comment">// &#123;</span></pre></td></tr><tr><td data-num="64"></td><td><pre>    <span class="token comment">//   path: '/admin/login',</span></pre></td></tr><tr><td data-num="65"></td><td><pre>    <span class="token comment">//   name: 'admin-login',</span></pre></td></tr><tr><td data-num="66"></td><td><pre>    <span class="token comment">//   component: () => import('@/views/auth/loginView.vue'),</span></pre></td></tr><tr><td data-num="67"></td><td><pre>    <span class="token comment">//   meta: &#123; guest: true &#125;</span></pre></td></tr><tr><td data-num="68"></td><td><pre>    <span class="token comment">// &#125;,</span></pre></td></tr><tr><td data-num="69"></td><td><pre></pre></td></tr><tr><td data-num="70"></td><td><pre>    <span class="token comment">// 管理員後台</span></pre></td></tr><tr><td data-num="71"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="72"></td><td><pre>      <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/admin'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="73"></td><td><pre>      <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/admin/index.vue'</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="74"></td><td><pre>      <span class="token literal-property property">meta</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">requiresAdminAuth</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="75"></td><td><pre>      <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="76"></td><td><pre>        <span class="token comment">//     &#123;</span></pre></td></tr><tr><td data-num="77"></td><td><pre>        <span class="token comment">//       path: '',</span></pre></td></tr><tr><td data-num="78"></td><td><pre>        <span class="token comment">//       name: 'admin-dashboard',</span></pre></td></tr><tr><td data-num="79"></td><td><pre>        <span class="token comment">//       component: () => import('@/views/admin/dashboard.vue')</span></pre></td></tr><tr><td data-num="80"></td><td><pre>        <span class="token comment">//     &#125;,</span></pre></td></tr><tr><td data-num="81"></td><td><pre>        <span class="token comment">//     // 餐點模板管理</span></pre></td></tr><tr><td data-num="82"></td><td><pre>        <span class="token comment">//     &#123;</span></pre></td></tr><tr><td data-num="83"></td><td><pre>        <span class="token comment">//       path: 'dish-templates',</span></pre></td></tr><tr><td data-num="84"></td><td><pre>        <span class="token comment">//       name: 'admin-dish-templates',</span></pre></td></tr><tr><td data-num="85"></td><td><pre>        <span class="token comment">//       component: () => import('@/views/admin/dish/templates.vue')</span></pre></td></tr><tr><td data-num="86"></td><td><pre>        <span class="token comment">//     &#125;,</span></pre></td></tr><tr><td data-num="87"></td><td><pre>        <span class="token comment">//     &#123;</span></pre></td></tr><tr><td data-num="88"></td><td><pre>        <span class="token comment">//       path: 'dish-templates/create',</span></pre></td></tr><tr><td data-num="89"></td><td><pre>        <span class="token comment">//       name: 'admin-dish-template-create',</span></pre></td></tr><tr><td data-num="90"></td><td><pre>        <span class="token comment">//       component: () => import('@/views/admin/dish/templateForm.vue')</span></pre></td></tr><tr><td data-num="91"></td><td><pre>        <span class="token comment">//     &#125;,</span></pre></td></tr><tr><td data-num="92"></td><td><pre>        <span class="token comment">//     &#123;</span></pre></td></tr><tr><td data-num="93"></td><td><pre>        <span class="token comment">//       path: 'dish-templates/:id',</span></pre></td></tr><tr><td data-num="94"></td><td><pre>        <span class="token comment">//       name: 'admin-dish-template-edit',</span></pre></td></tr><tr><td data-num="95"></td><td><pre>        <span class="token comment">//       component: () => import('@/views/admin/dish/templateForm.vue')</span></pre></td></tr><tr><td data-num="96"></td><td><pre>        <span class="token comment">//     &#125;,</span></pre></td></tr><tr><td data-num="97"></td><td><pre>        <span class="token comment">//     // 選項類別管理</span></pre></td></tr><tr><td data-num="98"></td><td><pre>        <span class="token comment">//     &#123;</span></pre></td></tr><tr><td data-num="99"></td><td><pre>        <span class="token comment">//       path: 'option-categories',</span></pre></td></tr><tr><td data-num="100"></td><td><pre>        <span class="token comment">//       name: 'admin-option-categories',</span></pre></td></tr><tr><td data-num="101"></td><td><pre>        <span class="token comment">//       component: () => import('@/views/admin/option/categories.vue')</span></pre></td></tr><tr><td data-num="102"></td><td><pre>        <span class="token comment">//     &#125;,</span></pre></td></tr><tr><td data-num="103"></td><td><pre>        <span class="token comment">//     &#123;</span></pre></td></tr><tr><td data-num="104"></td><td><pre>        <span class="token comment">//       path: 'option-categories/create',</span></pre></td></tr><tr><td data-num="105"></td><td><pre>        <span class="token comment">//       name: 'admin-option-category-create',</span></pre></td></tr><tr><td data-num="106"></td><td><pre>        <span class="token comment">//       component: () => import('@/views/admin/option/categoryForm.vue')</span></pre></td></tr><tr><td data-num="107"></td><td><pre>        <span class="token comment">//     &#125;,</span></pre></td></tr><tr><td data-num="108"></td><td><pre>        <span class="token comment">//     &#123;</span></pre></td></tr><tr><td data-num="109"></td><td><pre>        <span class="token comment">//       path: 'option-categories/:id',</span></pre></td></tr><tr><td data-num="110"></td><td><pre>        <span class="token comment">//       name: 'admin-option-category-edit',</span></pre></td></tr><tr><td data-num="111"></td><td><pre>        <span class="token comment">//       component: () => import('@/views/admin/option/categoryForm.vue')</span></pre></td></tr><tr><td data-num="112"></td><td><pre>        <span class="token comment">//     &#125;,</span></pre></td></tr><tr><td data-num="113"></td><td><pre>        <span class="token comment">//     // 選項管理</span></pre></td></tr><tr><td data-num="114"></td><td><pre>        <span class="token comment">//     &#123;</span></pre></td></tr><tr><td data-num="115"></td><td><pre>        <span class="token comment">//       path: 'options',</span></pre></td></tr><tr><td data-num="116"></td><td><pre>        <span class="token comment">//       name: 'admin-options',</span></pre></td></tr><tr><td data-num="117"></td><td><pre>        <span class="token comment">//       component: () => import('@/views/admin/option/options.vue')</span></pre></td></tr><tr><td data-num="118"></td><td><pre>        <span class="token comment">//     &#125;,</span></pre></td></tr><tr><td data-num="119"></td><td><pre>        <span class="token comment">//     &#123;</span></pre></td></tr><tr><td data-num="120"></td><td><pre>        <span class="token comment">//       path: 'options/create',</span></pre></td></tr><tr><td data-num="121"></td><td><pre>        <span class="token comment">//       name: 'admin-option-create',</span></pre></td></tr><tr><td data-num="122"></td><td><pre>        <span class="token comment">//       component: () => import('@/views/admin/option/optionForm.vue')</span></pre></td></tr><tr><td data-num="123"></td><td><pre>        <span class="token comment">//     &#125;,</span></pre></td></tr><tr><td data-num="124"></td><td><pre>        <span class="token comment">//     &#123;</span></pre></td></tr><tr><td data-num="125"></td><td><pre>        <span class="token comment">//       path: 'options/:id',</span></pre></td></tr><tr><td data-num="126"></td><td><pre>        <span class="token comment">//       name: 'admin-option-edit',</span></pre></td></tr><tr><td data-num="127"></td><td><pre>        <span class="token comment">//       component: () => import('@/views/admin/option/optionForm.vue')</span></pre></td></tr><tr><td data-num="128"></td><td><pre>        <span class="token comment">//     &#125;,</span></pre></td></tr><tr><td data-num="129"></td><td><pre>        <span class="token comment">//     // 品牌管理</span></pre></td></tr><tr><td data-num="130"></td><td><pre>        <span class="token comment">//     &#123;</span></pre></td></tr><tr><td data-num="131"></td><td><pre>        <span class="token comment">//       path: 'brands',</span></pre></td></tr><tr><td data-num="132"></td><td><pre>        <span class="token comment">//       name: 'admin-brands',</span></pre></td></tr><tr><td data-num="133"></td><td><pre>        <span class="token comment">//       component: () => import('@/views/admin/brand/list.vue'),</span></pre></td></tr><tr><td data-num="134"></td><td><pre>        <span class="token comment">//       meta: &#123; role: 'boss' &#125;</span></pre></td></tr><tr><td data-num="135"></td><td><pre>        <span class="token comment">//     &#125;,</span></pre></td></tr><tr><td data-num="136"></td><td><pre>        <span class="token comment">//     &#123;</span></pre></td></tr><tr><td data-num="137"></td><td><pre>        <span class="token comment">//       path: 'brands/create',</span></pre></td></tr><tr><td data-num="138"></td><td><pre>        <span class="token comment">//       name: 'admin-brand-create',</span></pre></td></tr><tr><td data-num="139"></td><td><pre>        <span class="token comment">//       component: () => import('@/views/admin/brand/form.vue'),</span></pre></td></tr><tr><td data-num="140"></td><td><pre>        <span class="token comment">//       meta: &#123; role: 'boss' &#125;</span></pre></td></tr><tr><td data-num="141"></td><td><pre>        <span class="token comment">//     &#125;,</span></pre></td></tr><tr><td data-num="142"></td><td><pre>        <span class="token comment">//     &#123;</span></pre></td></tr><tr><td data-num="143"></td><td><pre>        <span class="token comment">//       path: 'brands/:id',</span></pre></td></tr><tr><td data-num="144"></td><td><pre>        <span class="token comment">//       name: 'admin-brand-edit',</span></pre></td></tr><tr><td data-num="145"></td><td><pre>        <span class="token comment">//       component: () => import('@/views/admin/brand/form.vue'),</span></pre></td></tr><tr><td data-num="146"></td><td><pre>        <span class="token comment">//       meta: &#123; role: 'boss' &#125;</span></pre></td></tr><tr><td data-num="147"></td><td><pre>        <span class="token comment">//     &#125;,</span></pre></td></tr><tr><td data-num="148"></td><td><pre>        <span class="token comment">//     // 店鋪管理</span></pre></td></tr><tr><td data-num="149"></td><td><pre>        <span class="token comment">//     &#123;</span></pre></td></tr><tr><td data-num="150"></td><td><pre>        <span class="token comment">//       path: 'stores',</span></pre></td></tr><tr><td data-num="151"></td><td><pre>        <span class="token comment">//       name: 'admin-stores',</span></pre></td></tr><tr><td data-num="152"></td><td><pre>        <span class="token comment">//       component: () => import('@/views/admin/store/list.vue')</span></pre></td></tr><tr><td data-num="153"></td><td><pre>        <span class="token comment">//     &#125;,</span></pre></td></tr><tr><td data-num="154"></td><td><pre>        <span class="token comment">//     &#123;</span></pre></td></tr><tr><td data-num="155"></td><td><pre>        <span class="token comment">//       path: 'stores/create',</span></pre></td></tr><tr><td data-num="156"></td><td><pre>        <span class="token comment">//       name: 'admin-store-create',</span></pre></td></tr><tr><td data-num="157"></td><td><pre>        <span class="token comment">//       component: () => import('@/views/admin/store/form.vue'),</span></pre></td></tr><tr><td data-num="158"></td><td><pre>        <span class="token comment">//       meta: &#123; role: 'boss' &#125;</span></pre></td></tr><tr><td data-num="159"></td><td><pre>        <span class="token comment">//     &#125;,</span></pre></td></tr><tr><td data-num="160"></td><td><pre>        <span class="token comment">//     &#123;</span></pre></td></tr><tr><td data-num="161"></td><td><pre>        <span class="token comment">//       path: 'stores/:id',</span></pre></td></tr><tr><td data-num="162"></td><td><pre>        <span class="token comment">//       name: 'admin-store-edit',</span></pre></td></tr><tr><td data-num="163"></td><td><pre>        <span class="token comment">//       component: () => import('@/views/admin/store/form.vue')</span></pre></td></tr><tr><td data-num="164"></td><td><pre>        <span class="token comment">//     &#125;,</span></pre></td></tr><tr><td data-num="165"></td><td><pre>        <span class="token comment">//     // 菜單管理</span></pre></td></tr><tr><td data-num="166"></td><td><pre>        <span class="token comment">//     &#123;</span></pre></td></tr><tr><td data-num="167"></td><td><pre>        <span class="token comment">//       path: 'menus',</span></pre></td></tr><tr><td data-num="168"></td><td><pre>        <span class="token comment">//       name: 'admin-menus',</span></pre></td></tr><tr><td data-num="169"></td><td><pre>        <span class="token comment">//       component: () => import('@/views/admin/menu/list.vue')</span></pre></td></tr><tr><td data-num="170"></td><td><pre>        <span class="token comment">//     &#125;,</span></pre></td></tr><tr><td data-num="171"></td><td><pre>        <span class="token comment">//     &#123;</span></pre></td></tr><tr><td data-num="172"></td><td><pre>        <span class="token comment">//       path: 'menus/create',</span></pre></td></tr><tr><td data-num="173"></td><td><pre>        <span class="token comment">//       name: 'admin-menu-create',</span></pre></td></tr><tr><td data-num="174"></td><td><pre>        <span class="token comment">//       component: () => import('@/views/admin/menu/form.vue')</span></pre></td></tr><tr><td data-num="175"></td><td><pre>        <span class="token comment">//     &#125;,</span></pre></td></tr><tr><td data-num="176"></td><td><pre>        <span class="token comment">//     &#123;</span></pre></td></tr><tr><td data-num="177"></td><td><pre>        <span class="token comment">//       path: 'menus/:id',</span></pre></td></tr><tr><td data-num="178"></td><td><pre>        <span class="token comment">//       name: 'admin-menu-edit',</span></pre></td></tr><tr><td data-num="179"></td><td><pre>        <span class="token comment">//       component: () => import('@/views/admin/menu/form.vue')</span></pre></td></tr><tr><td data-num="180"></td><td><pre>        <span class="token comment">//     &#125;,</span></pre></td></tr><tr><td data-num="181"></td><td><pre>        <span class="token comment">//     // 庫存管理</span></pre></td></tr><tr><td data-num="182"></td><td><pre>        <span class="token comment">//     &#123;</span></pre></td></tr><tr><td data-num="183"></td><td><pre>        <span class="token comment">//       path: 'inventory/:storeId',</span></pre></td></tr><tr><td data-num="184"></td><td><pre>        <span class="token comment">//       name: 'admin-inventory',</span></pre></td></tr><tr><td data-num="185"></td><td><pre>        <span class="token comment">//       component: () => import('@/views/admin/inventory/list.vue')</span></pre></td></tr><tr><td data-num="186"></td><td><pre>        <span class="token comment">//     &#125;,</span></pre></td></tr><tr><td data-num="187"></td><td><pre>        <span class="token comment">//     // 訂單管理</span></pre></td></tr><tr><td data-num="188"></td><td><pre>        <span class="token comment">//     &#123;</span></pre></td></tr><tr><td data-num="189"></td><td><pre>        <span class="token comment">//       path: 'orders/:storeId',</span></pre></td></tr><tr><td data-num="190"></td><td><pre>        <span class="token comment">//       name: 'admin-orders',</span></pre></td></tr><tr><td data-num="191"></td><td><pre>        <span class="token comment">//       component: () => import('@/views/admin/order/list.vue')</span></pre></td></tr><tr><td data-num="192"></td><td><pre>        <span class="token comment">//     &#125;,</span></pre></td></tr><tr><td data-num="193"></td><td><pre>        <span class="token comment">//     &#123;</span></pre></td></tr><tr><td data-num="194"></td><td><pre>        <span class="token comment">//       path: 'orders/:storeId/:orderId',</span></pre></td></tr><tr><td data-num="195"></td><td><pre>        <span class="token comment">//       name: 'admin-order-detail',</span></pre></td></tr><tr><td data-num="196"></td><td><pre>        <span class="token comment">//       component: () => import('@/views/admin/order/detail.vue')</span></pre></td></tr><tr><td data-num="197"></td><td><pre>        <span class="token comment">//     &#125;,</span></pre></td></tr><tr><td data-num="198"></td><td><pre>        <span class="token comment">//     // 點數與優惠券管理</span></pre></td></tr><tr><td data-num="199"></td><td><pre>        <span class="token comment">//     &#123;</span></pre></td></tr><tr><td data-num="200"></td><td><pre>        <span class="token comment">//       path: 'point-rules',</span></pre></td></tr><tr><td data-num="201"></td><td><pre>        <span class="token comment">//       name: 'admin-point-rules',</span></pre></td></tr><tr><td data-num="202"></td><td><pre>        <span class="token comment">//       component: () => import('@/views/admin/promotion/pointRules.vue')</span></pre></td></tr><tr><td data-num="203"></td><td><pre>        <span class="token comment">//     &#125;,</span></pre></td></tr><tr><td data-num="204"></td><td><pre>        <span class="token comment">//     &#123;</span></pre></td></tr><tr><td data-num="205"></td><td><pre>        <span class="token comment">//       path: 'coupons',</span></pre></td></tr><tr><td data-num="206"></td><td><pre>        <span class="token comment">//       name: 'admin-coupons',</span></pre></td></tr><tr><td data-num="207"></td><td><pre>        <span class="token comment">//       component: () => import('@/views/admin/promotion/coupons.vue')</span></pre></td></tr><tr><td data-num="208"></td><td><pre>        <span class="token comment">//     &#125;,</span></pre></td></tr><tr><td data-num="209"></td><td><pre>        <span class="token comment">//     // 管理員管理</span></pre></td></tr><tr><td data-num="210"></td><td><pre>        <span class="token comment">//     &#123;</span></pre></td></tr><tr><td data-num="211"></td><td><pre>        <span class="token comment">//       path: 'admins',</span></pre></td></tr><tr><td data-num="212"></td><td><pre>        <span class="token comment">//       name: 'admin-admins',</span></pre></td></tr><tr><td data-num="213"></td><td><pre>        <span class="token comment">//       component: () => import('@/views/admin/admin/list.vue'),</span></pre></td></tr><tr><td data-num="214"></td><td><pre>        <span class="token comment">//       meta: &#123; role: 'boss' &#125;</span></pre></td></tr><tr><td data-num="215"></td><td><pre>        <span class="token comment">//     &#125;,</span></pre></td></tr><tr><td data-num="216"></td><td><pre>        <span class="token comment">//     &#123;</span></pre></td></tr><tr><td data-num="217"></td><td><pre>        <span class="token comment">//       path: 'admins/create',</span></pre></td></tr><tr><td data-num="218"></td><td><pre>        <span class="token comment">//       name: 'admin-admin-create',</span></pre></td></tr><tr><td data-num="219"></td><td><pre>        <span class="token comment">//       component: () => import('@/views/admin/admin/form.vue'),</span></pre></td></tr><tr><td data-num="220"></td><td><pre>        <span class="token comment">//       meta: &#123; role: 'boss' &#125;</span></pre></td></tr><tr><td data-num="221"></td><td><pre>        <span class="token comment">//     &#125;,</span></pre></td></tr><tr><td data-num="222"></td><td><pre>        <span class="token comment">//     &#123;</span></pre></td></tr><tr><td data-num="223"></td><td><pre>        <span class="token comment">//       path: 'admins/:id',</span></pre></td></tr><tr><td data-num="224"></td><td><pre>        <span class="token comment">//       name: 'admin-admin-edit',</span></pre></td></tr><tr><td data-num="225"></td><td><pre>        <span class="token comment">//       component: () => import('@/views/admin/admin/form.vue'),</span></pre></td></tr><tr><td data-num="226"></td><td><pre>        <span class="token comment">//       meta: &#123; role: 'boss' &#125;</span></pre></td></tr><tr><td data-num="227"></td><td><pre>        <span class="token comment">//     &#125;,</span></pre></td></tr><tr><td data-num="228"></td><td><pre>        <span class="token comment">//     // 用戶管理</span></pre></td></tr><tr><td data-num="229"></td><td><pre>        <span class="token comment">//     &#123;</span></pre></td></tr><tr><td data-num="230"></td><td><pre>        <span class="token comment">//       path: 'users',</span></pre></td></tr><tr><td data-num="231"></td><td><pre>        <span class="token comment">//       name: 'admin-users',</span></pre></td></tr><tr><td data-num="232"></td><td><pre>        <span class="token comment">//       component: () => import('@/views/admin/user/list.vue')</span></pre></td></tr><tr><td data-num="233"></td><td><pre>        <span class="token comment">//     &#125;,</span></pre></td></tr><tr><td data-num="234"></td><td><pre>        <span class="token comment">//     &#123;</span></pre></td></tr><tr><td data-num="235"></td><td><pre>        <span class="token comment">//       path: 'users/:id',</span></pre></td></tr><tr><td data-num="236"></td><td><pre>        <span class="token comment">//       name: 'admin-user-detail',</span></pre></td></tr><tr><td data-num="237"></td><td><pre>        <span class="token comment">//       component: () => import('@/views/admin/user/detail.vue')</span></pre></td></tr><tr><td data-num="238"></td><td><pre>        <span class="token comment">//     &#125;</span></pre></td></tr><tr><td data-num="239"></td><td><pre>      <span class="token punctuation">]</span></pre></td></tr><tr><td data-num="240"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="241"></td><td><pre></pre></td></tr><tr><td data-num="242"></td><td><pre>    <span class="token comment">//// 店員前台 (點餐系統)</span></pre></td></tr><tr><td data-num="243"></td><td><pre>    <span class="token comment">// &#123;</span></pre></td></tr><tr><td data-num="244"></td><td><pre>    <span class="token comment">//   path: '/staff/:storeId',</span></pre></td></tr><tr><td data-num="245"></td><td><pre>    <span class="token comment">//   name: 'staff',</span></pre></td></tr><tr><td data-num="246"></td><td><pre>    <span class="token comment">//   component: () => import('@/views/staff/index.vue'),</span></pre></td></tr><tr><td data-num="247"></td><td><pre>    <span class="token comment">//   meta: &#123; requiresAdminAuth: true &#125;</span></pre></td></tr><tr><td data-num="248"></td><td><pre>    <span class="token comment">// &#125;,</span></pre></td></tr><tr><td data-num="249"></td><td><pre></pre></td></tr><tr><td data-num="250"></td><td><pre>    <span class="token comment">//// 客人前台</span></pre></td></tr><tr><td data-num="251"></td><td><pre>    <span class="token comment">// &#123;</span></pre></td></tr><tr><td data-num="252"></td><td><pre>    <span class="token comment">//   path: '/customer',</span></pre></td></tr><tr><td data-num="253"></td><td><pre>    <span class="token comment">//   component: () => import('@/views/customer/layout.vue'),</span></pre></td></tr><tr><td data-num="254"></td><td><pre>    <span class="token comment">//   children: [</span></pre></td></tr><tr><td data-num="255"></td><td><pre>    <span class="token comment">//     // 店鋪列表</span></pre></td></tr><tr><td data-num="256"></td><td><pre>    <span class="token comment">//     &#123;</span></pre></td></tr><tr><td data-num="257"></td><td><pre>    <span class="token comment">//       path: 'stores',</span></pre></td></tr><tr><td data-num="258"></td><td><pre>    <span class="token comment">//       name: 'customer-stores',</span></pre></td></tr><tr><td data-num="259"></td><td><pre>    <span class="token comment">//       component: () => import('@/views/customer/stores.vue')</span></pre></td></tr><tr><td data-num="260"></td><td><pre>    <span class="token comment">//     &#125;,</span></pre></td></tr><tr><td data-num="261"></td><td><pre>    <span class="token comment">//     // 點餐頁面</span></pre></td></tr><tr><td data-num="262"></td><td><pre>    <span class="token comment">//     &#123;</span></pre></td></tr><tr><td data-num="263"></td><td><pre>    <span class="token comment">//       path: 'ordering/:storeId',</span></pre></td></tr><tr><td data-num="264"></td><td><pre>    <span class="token comment">//       name: 'customer-ordering',</span></pre></td></tr><tr><td data-num="265"></td><td><pre>    <span class="token comment">//       component: () => import('@/views/customer/ordering.vue')</span></pre></td></tr><tr><td data-num="266"></td><td><pre>    <span class="token comment">//     &#125;,</span></pre></td></tr><tr><td data-num="267"></td><td><pre>    <span class="token comment">//     // 訂單確認頁面</span></pre></td></tr><tr><td data-num="268"></td><td><pre>    <span class="token comment">//     &#123;</span></pre></td></tr><tr><td data-num="269"></td><td><pre>    <span class="token comment">//       path: 'confirmation/:orderId',</span></pre></td></tr><tr><td data-num="270"></td><td><pre>    <span class="token comment">//       name: 'customer-confirmation',</span></pre></td></tr><tr><td data-num="271"></td><td><pre>    <span class="token comment">//       component: () => import('@/views/customer/confirmation.vue')</span></pre></td></tr><tr><td data-num="272"></td><td><pre>    <span class="token comment">//     &#125;,</span></pre></td></tr><tr><td data-num="273"></td><td><pre>    <span class="token comment">//     // 會員登入 / 註冊</span></pre></td></tr><tr><td data-num="274"></td><td><pre>    <span class="token comment">//     &#123;</span></pre></td></tr><tr><td data-num="275"></td><td><pre>    <span class="token comment">//       path: 'login',</span></pre></td></tr><tr><td data-num="276"></td><td><pre>    <span class="token comment">//       name: 'customer-login',</span></pre></td></tr><tr><td data-num="277"></td><td><pre>    <span class="token comment">//       component: () => import('@/views/customer/loginView.vue'),</span></pre></td></tr><tr><td data-num="278"></td><td><pre>    <span class="token comment">//       meta: &#123; customerGuest: true &#125;,</span></pre></td></tr><tr><td data-num="279"></td><td><pre>    <span class="token comment">//       children: [</span></pre></td></tr><tr><td data-num="280"></td><td><pre>    <span class="token comment">//         &#123;</span></pre></td></tr><tr><td data-num="281"></td><td><pre>    <span class="token comment">//           path: '',</span></pre></td></tr><tr><td data-num="282"></td><td><pre>    <span class="token comment">//           name: 'customer-login-form',</span></pre></td></tr><tr><td data-num="283"></td><td><pre>    <span class="token comment">//           component: () => import('@/components/Customer/LoginForm.vue')</span></pre></td></tr><tr><td data-num="284"></td><td><pre>    <span class="token comment">//         &#125;,</span></pre></td></tr><tr><td data-num="285"></td><td><pre>    <span class="token comment">//         &#123;</span></pre></td></tr><tr><td data-num="286"></td><td><pre>    <span class="token comment">//           path: 'register',</span></pre></td></tr><tr><td data-num="287"></td><td><pre>    <span class="token comment">//           name: 'customer-register',</span></pre></td></tr><tr><td data-num="288"></td><td><pre>    <span class="token comment">//           component: () => import('@/components/Customer/Register.vue')</span></pre></td></tr><tr><td data-num="289"></td><td><pre>    <span class="token comment">//         &#125;,</span></pre></td></tr><tr><td data-num="290"></td><td><pre>    <span class="token comment">//         &#123;</span></pre></td></tr><tr><td data-num="291"></td><td><pre>    <span class="token comment">//           path: 'forgot-password',</span></pre></td></tr><tr><td data-num="292"></td><td><pre>    <span class="token comment">//           name: 'customer-forgot-password',</span></pre></td></tr><tr><td data-num="293"></td><td><pre>    <span class="token comment">//           component: () => import('@/components/Customer/ForgotPassword.vue')</span></pre></td></tr><tr><td data-num="294"></td><td><pre>    <span class="token comment">//         &#125;</span></pre></td></tr><tr><td data-num="295"></td><td><pre>    <span class="token comment">//       ]</span></pre></td></tr><tr><td data-num="296"></td><td><pre>    <span class="token comment">//     &#125;,</span></pre></td></tr><tr><td data-num="297"></td><td><pre>    <span class="token comment">//     // 會員中心</span></pre></td></tr><tr><td data-num="298"></td><td><pre>    <span class="token comment">//     &#123;</span></pre></td></tr><tr><td data-num="299"></td><td><pre>    <span class="token comment">//       path: 'my-account',</span></pre></td></tr><tr><td data-num="300"></td><td><pre>    <span class="token comment">//       name: 'customer-my-account',</span></pre></td></tr><tr><td data-num="301"></td><td><pre>    <span class="token comment">//       component: () => import('@/views/customer/myAccount.vue'),</span></pre></td></tr><tr><td data-num="302"></td><td><pre>    <span class="token comment">//       meta: &#123; requiresCustomerAuth: true &#125;,</span></pre></td></tr><tr><td data-num="303"></td><td><pre>    <span class="token comment">//       children: [</span></pre></td></tr><tr><td data-num="304"></td><td><pre>    <span class="token comment">//         &#123;</span></pre></td></tr><tr><td data-num="305"></td><td><pre>    <span class="token comment">//           path: '',</span></pre></td></tr><tr><td data-num="306"></td><td><pre>    <span class="token comment">//           name: 'customer-account-home',</span></pre></td></tr><tr><td data-num="307"></td><td><pre>    <span class="token comment">//           component: () => import('@/components/Customer/AccountHome.vue')</span></pre></td></tr><tr><td data-num="308"></td><td><pre>    <span class="token comment">//         &#125;,</span></pre></td></tr><tr><td data-num="309"></td><td><pre>    <span class="token comment">//         &#123;</span></pre></td></tr><tr><td data-num="310"></td><td><pre>    <span class="token comment">//           path: 'edit',</span></pre></td></tr><tr><td data-num="311"></td><td><pre>    <span class="token comment">//           name: 'customer-account-edit',</span></pre></td></tr><tr><td data-num="312"></td><td><pre>    <span class="token comment">//           component: () => import('@/components/Customer/AccountEdit.vue')</span></pre></td></tr><tr><td data-num="313"></td><td><pre>    <span class="token comment">//         &#125;,</span></pre></td></tr><tr><td data-num="314"></td><td><pre>    <span class="token comment">//         &#123;</span></pre></td></tr><tr><td data-num="315"></td><td><pre>    <span class="token comment">//           path: 'points',</span></pre></td></tr><tr><td data-num="316"></td><td><pre>    <span class="token comment">//           name: 'customer-points',</span></pre></td></tr><tr><td data-num="317"></td><td><pre>    <span class="token comment">//           component: () => import('@/components/Customer/Points.vue')</span></pre></td></tr><tr><td data-num="318"></td><td><pre>    <span class="token comment">//         &#125;,</span></pre></td></tr><tr><td data-num="319"></td><td><pre>    <span class="token comment">//         &#123;</span></pre></td></tr><tr><td data-num="320"></td><td><pre>    <span class="token comment">//           path: 'coupons',</span></pre></td></tr><tr><td data-num="321"></td><td><pre>    <span class="token comment">//           name: 'customer-coupons',</span></pre></td></tr><tr><td data-num="322"></td><td><pre>    <span class="token comment">//           component: () => import('@/components/Customer/Coupons.vue')</span></pre></td></tr><tr><td data-num="323"></td><td><pre>    <span class="token comment">//         &#125;,</span></pre></td></tr><tr><td data-num="324"></td><td><pre>    <span class="token comment">//         &#123;</span></pre></td></tr><tr><td data-num="325"></td><td><pre>    <span class="token comment">//           path: 'orders',</span></pre></td></tr><tr><td data-num="326"></td><td><pre>    <span class="token comment">//           name: 'customer-orders',</span></pre></td></tr><tr><td data-num="327"></td><td><pre>    <span class="token comment">//           component: () => import('@/components/Customer/Orders.vue')</span></pre></td></tr><tr><td data-num="328"></td><td><pre>    <span class="token comment">//         &#125;</span></pre></td></tr><tr><td data-num="329"></td><td><pre>    <span class="token comment">//       ]</span></pre></td></tr><tr><td data-num="330"></td><td><pre>    <span class="token comment">//     &#125;</span></pre></td></tr><tr><td data-num="331"></td><td><pre>    <span class="token comment">//   ]</span></pre></td></tr><tr><td data-num="332"></td><td><pre>    <span class="token comment">// &#125;,</span></pre></td></tr><tr><td data-num="333"></td><td><pre></pre></td></tr><tr><td data-num="334"></td><td><pre>    <span class="token comment">// 404 頁面</span></pre></td></tr><tr><td data-num="335"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="336"></td><td><pre>      <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/:pathMatch(.*)*'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="337"></td><td><pre>      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'not-found'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="338"></td><td><pre>      <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/notFound.vue'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="339"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="340"></td><td><pre>  <span class="token punctuation">]</span></pre></td></tr><tr><td data-num="341"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="342"></td><td><pre></pre></td></tr><tr><td data-num="343"></td><td><pre><span class="token comment">// 全局前置守衛</span></pre></td></tr><tr><td data-num="344"></td><td><pre>router<span class="token punctuation">.</span><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> from<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="345"></td><td><pre>  <span class="token comment">// 管理員授權檢查</span></pre></td></tr><tr><td data-num="346"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span>to<span class="token punctuation">.</span>matched<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token parameter">record</span> <span class="token operator">=></span> record<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>requiresAdminAuth<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="347"></td><td><pre>    <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> loggedIn<span class="token punctuation">,</span> role<span class="token punctuation">,</span> manage <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">checkAdminAuth</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="348"></td><td><pre></pre></td></tr><tr><td data-num="349"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>loggedIn<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="350"></td><td><pre>      <span class="token keyword">return</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="351"></td><td><pre>        <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/admin/login'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="352"></td><td><pre>        <span class="token literal-property property">query</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">redirect</span><span class="token operator">:</span> to<span class="token punctuation">.</span>fullPath <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="353"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="354"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="355"></td><td><pre></pre></td></tr><tr><td data-num="356"></td><td><pre>    <span class="token comment">// 檢查角色權限</span></pre></td></tr><tr><td data-num="357"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>to<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>role <span class="token operator">&amp;&amp;</span> to<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>role <span class="token operator">!==</span> role<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="358"></td><td><pre>      <span class="token keyword">if</span> <span class="token punctuation">(</span>role <span class="token operator">===</span> <span class="token string">'boss'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="359"></td><td><pre>        <span class="token comment">// 老闆擁有所有權限</span></pre></td></tr><tr><td data-num="360"></td><td><pre>        <span class="token keyword">return</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="361"></td><td><pre>      <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="362"></td><td><pre></pre></td></tr><tr><td data-num="363"></td><td><pre>      <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'您沒有權限訪問此頁面'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="364"></td><td><pre>      <span class="token keyword">return</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token string">'/admin'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="365"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="366"></td><td><pre></pre></td></tr><tr><td data-num="367"></td><td><pre>    <span class="token comment">// 檢查店鋪權限</span></pre></td></tr><tr><td data-num="368"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>to<span class="token punctuation">.</span>params<span class="token punctuation">.</span>storeId <span class="token operator">&amp;&amp;</span> role <span class="token operator">!==</span> <span class="token string">'boss'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="369"></td><td><pre>      <span class="token keyword">const</span> hasStorePermission <span class="token operator">=</span> manage<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="370"></td><td><pre>        <span class="token parameter">m</span> <span class="token operator">=></span> m<span class="token punctuation">.</span>store <span class="token operator">===</span> to<span class="token punctuation">.</span>params<span class="token punctuation">.</span>storeId</pre></td></tr><tr><td data-num="371"></td><td><pre>      <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="372"></td><td><pre></pre></td></tr><tr><td data-num="373"></td><td><pre>      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>hasStorePermission<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="374"></td><td><pre>        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'您沒有權限管理此店鋪'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="375"></td><td><pre>        <span class="token keyword">return</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token string">'/admin'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="376"></td><td><pre>      <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="377"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="378"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="379"></td><td><pre></pre></td></tr><tr><td data-num="380"></td><td><pre>  <span class="token comment">// 會員授權檢查</span></pre></td></tr><tr><td data-num="381"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span>to<span class="token punctuation">.</span>matched<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token parameter">record</span> <span class="token operator">=></span> record<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>requiresCustomerAuth<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="382"></td><td><pre>    <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> loggedIn <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">checkUserAuth</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="383"></td><td><pre></pre></td></tr><tr><td data-num="384"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>loggedIn<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="385"></td><td><pre>      <span class="token keyword">return</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="386"></td><td><pre>        <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/customer/login'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="387"></td><td><pre>        <span class="token literal-property property">query</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">redirect</span><span class="token operator">:</span> to<span class="token punctuation">.</span>fullPath <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="388"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="389"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="390"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="391"></td><td><pre></pre></td></tr><tr><td data-num="392"></td><td><pre>  <span class="token comment">// 已登入用戶重定向</span></pre></td></tr><tr><td data-num="393"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span>to<span class="token punctuation">.</span>matched<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token parameter">record</span> <span class="token operator">=></span> record<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>guest<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token keyword">await</span> <span class="token function">checkAdminAuth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>loggedIn<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="394"></td><td><pre>    <span class="token keyword">return</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token string">'/admin'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="395"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="396"></td><td><pre></pre></td></tr><tr><td data-num="397"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span>to<span class="token punctuation">.</span>matched<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token parameter">record</span> <span class="token operator">=></span> record<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>customerGuest<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token keyword">await</span> <span class="token function">checkUserAuth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>loggedIn<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="398"></td><td><pre>    <span class="token keyword">return</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token string">'/customer/my-account'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="399"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="400"></td><td><pre></pre></td></tr><tr><td data-num="401"></td><td><pre>  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="402"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="403"></td><td><pre></pre></td></tr><tr><td data-num="404"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> router</pre></td></tr></table></figure><p>collapse 模板</p>
<figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token comment">&lt;!-- 折疊標題區域 --></span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>collapse-header<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>toggleCollapse<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre>      &#123;&#123; title &#125;&#125;</pre></td></tr><tr><td data-num="6"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>isExpanded ? 'icon-up' : 'icon-down'<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="8"></td><td><pre>    </pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token comment">&lt;!-- 折疊內容區域 --></span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> </pre></td></tr><tr><td data-num="11"></td><td><pre>      <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>collapse-content<span class="token punctuation">"</span></span> </pre></td></tr><tr><td data-num="12"></td><td><pre>      <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>collapseContentRef<span class="token punctuation">"</span></span></pre></td></tr><tr><td data-num="13"></td><td><pre>      <span class="token attr-name">:style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>&#123; maxHeight: contentStyle &#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="14"></td><td><pre>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="16"></td><td><pre>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> ref<span class="token punctuation">,</span> computed<span class="token punctuation">,</span> onMounted<span class="token punctuation">,</span> watch<span class="token punctuation">,</span> nextTick <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token comment">// 接收的屬性</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token keyword">const</span> props <span class="token operator">=</span> <span class="token function">defineProps</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>  <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token keyword">default</span><span class="token operator">:</span> <span class="token string">'折疊項目'</span></pre></td></tr><tr><td data-num="27"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="28"></td><td><pre>  <span class="token comment">// 可選屬性：初始是否展開</span></pre></td></tr><tr><td data-num="29"></td><td><pre>  <span class="token literal-property property">initialExpanded</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    <span class="token literal-property property">type</span><span class="token operator">:</span> Boolean<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token keyword">default</span><span class="token operator">:</span> <span class="token boolean">false</span></pre></td></tr><tr><td data-num="32"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token comment">// 響應式狀態</span></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token keyword">const</span> isExpanded <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>initialExpanded<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 是否展開的狀態</span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token keyword">const</span> collapseContentRef <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 對折疊內容的引用</span></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token keyword">const</span> actualHeight <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 保存實際高度值 (數字形式)</span></pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token keyword">const</span> forceUpdate <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 用來強制更新 computed 的標記</span></pre></td></tr><tr><td data-num="40"></td><td><pre></pre></td></tr><tr><td data-num="41"></td><td><pre><span class="token comment">// 使用 computed 來計算內容樣式</span></pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token keyword">const</span> contentStyle <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>  <span class="token comment">// 強制更新標記，當需要重新計算高度時增加此值</span></pre></td></tr><tr><td data-num="44"></td><td><pre>  forceUpdate<span class="token punctuation">.</span>value<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="45"></td><td><pre>  </pre></td></tr><tr><td data-num="46"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isExpanded<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">'0px'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="47"></td><td><pre>  </pre></td></tr><tr><td data-num="48"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span>collapseContentRef<span class="token punctuation">.</span>value <span class="token operator">&amp;&amp;</span> actualHeight<span class="token punctuation">.</span>value <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="49"></td><td><pre>    <span class="token comment">// 需要計算高度</span></pre></td></tr><tr><td data-num="50"></td><td><pre>    <span class="token function">updateActualHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="51"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="52"></td><td><pre>  </pre></td></tr><tr><td data-num="53"></td><td><pre>  <span class="token keyword">return</span> actualHeight<span class="token punctuation">.</span>value <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>actualHeight<span class="token punctuation">.</span>value<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">px</span><span class="token template-punctuation string">`</span></span> <span class="token operator">:</span> <span class="token string">'auto'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="54"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="55"></td><td><pre></pre></td></tr><tr><td data-num="56"></td><td><pre><span class="token comment">// 更新實際高度的函數</span></pre></td></tr><tr><td data-num="57"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">updateActualHeight</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="58"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>collapseContentRef<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="59"></td><td><pre>  </pre></td></tr><tr><td data-num="60"></td><td><pre>  <span class="token comment">// 臨時移除高度限制來測量真實高度</span></pre></td></tr><tr><td data-num="61"></td><td><pre>  <span class="token keyword">const</span> originalStyle <span class="token operator">=</span> collapseContentRef<span class="token punctuation">.</span>value<span class="token punctuation">.</span>style<span class="token punctuation">.</span>maxHeight<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="62"></td><td><pre>  collapseContentRef<span class="token punctuation">.</span>value<span class="token punctuation">.</span>style<span class="token punctuation">.</span>maxHeight <span class="token operator">=</span> <span class="token string">'none'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="63"></td><td><pre>  </pre></td></tr><tr><td data-num="64"></td><td><pre>  <span class="token comment">// 獲取實際高度</span></pre></td></tr><tr><td data-num="65"></td><td><pre>  actualHeight<span class="token punctuation">.</span>value <span class="token operator">=</span> collapseContentRef<span class="token punctuation">.</span>value<span class="token punctuation">.</span>scrollHeight<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="66"></td><td><pre>  </pre></td></tr><tr><td data-num="67"></td><td><pre>  <span class="token comment">// 恢復原始樣式</span></pre></td></tr><tr><td data-num="68"></td><td><pre>  collapseContentRef<span class="token punctuation">.</span>value<span class="token punctuation">.</span>style<span class="token punctuation">.</span>maxHeight <span class="token operator">=</span> originalStyle<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="69"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="70"></td><td><pre></pre></td></tr><tr><td data-num="71"></td><td><pre><span class="token comment">// 切換折疊狀態</span></pre></td></tr><tr><td data-num="72"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">toggleCollapse</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="73"></td><td><pre>  isExpanded<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token operator">!</span>isExpanded<span class="token punctuation">.</span>value<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="74"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="75"></td><td><pre></pre></td></tr><tr><td data-num="76"></td><td><pre><span class="token comment">// 處理窗口大小調整</span></pre></td></tr><tr><td data-num="77"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">handleResize</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="78"></td><td><pre>  <span class="token comment">// 重置高度並觸發重新計算</span></pre></td></tr><tr><td data-num="79"></td><td><pre>  actualHeight<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="80"></td><td><pre>  forceUpdate<span class="token punctuation">.</span>value<span class="token operator">++</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="81"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="82"></td><td><pre></pre></td></tr><tr><td data-num="83"></td><td><pre><span class="token comment">// 組件掛載後</span></pre></td></tr><tr><td data-num="84"></td><td><pre><span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="85"></td><td><pre>  <span class="token comment">// 初始計算內容高度</span></pre></td></tr><tr><td data-num="86"></td><td><pre>  <span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="87"></td><td><pre>    <span class="token function">updateActualHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="88"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="89"></td><td><pre>  </pre></td></tr><tr><td data-num="90"></td><td><pre>  <span class="token comment">// 監聽窗口大小變化，使用防抖處理優化性能</span></pre></td></tr><tr><td data-num="91"></td><td><pre>  window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'resize'</span><span class="token punctuation">,</span> handleResize<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="92"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="93"></td><td><pre></pre></td></tr><tr><td data-num="94"></td><td><pre><span class="token comment">// 監聽內容變化</span></pre></td></tr><tr><td data-num="95"></td><td><pre><span class="token function">watch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> collapseContentRef<span class="token punctuation">.</span>value<span class="token operator">?.</span>innerHTML<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="96"></td><td><pre>  <span class="token comment">// 內容變化時強制更新高度</span></pre></td></tr><tr><td data-num="97"></td><td><pre>  <span class="token function">handleResize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="98"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">deep</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="99"></td><td><pre></pre></td></tr><tr><td data-num="100"></td><td><pre><span class="token comment">// 組件卸載時清除事件監聽</span></pre></td></tr><tr><td data-num="101"></td><td><pre><span class="token function">onUnmounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="102"></td><td><pre>  window<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">'resize'</span><span class="token punctuation">,</span> handleResize<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="103"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="104"></td><td><pre></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="105"></td><td><pre></pre></td></tr><tr><td data-num="106"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css"></pre></td></tr><tr><td data-num="107"></td><td><pre><span class="token selector">.collapse-header</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="108"></td><td><pre>  <span class="token property">cursor</span><span class="token punctuation">:</span> pointer<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="109"></td><td><pre>  <span class="token property">user-select</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="110"></td><td><pre>  <span class="token property">padding</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="111"></td><td><pre>  <span class="token property">background-color</span><span class="token punctuation">:</span> #f1f1f1<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="112"></td><td><pre>  <span class="token property">border-radius</span><span class="token punctuation">:</span> 4px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="113"></td><td><pre>  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="114"></td><td><pre>  <span class="token property">justify-content</span><span class="token punctuation">:</span> space-between<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="115"></td><td><pre>  <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="116"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="117"></td><td><pre></pre></td></tr><tr><td data-num="118"></td><td><pre><span class="token selector">.collapse-content</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="119"></td><td><pre>  <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="120"></td><td><pre>  <span class="token property">transition</span><span class="token punctuation">:</span> max-height 0.5s ease<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="121"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="122"></td><td><pre></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><pre class="mermaid"><div id="dmermaid-1767940343521" style="font-family: &quot;trebuchet ms&quot;, verdana, arial;"><svg id="mermaid-1767940343521" width="400" xmlns="http://www.w3.org/2000/svg" height="100" viewBox="768 0 512 512"><style>#mermaid-1767940343521{font-family:"trebuchet ms",verdana,arial;font-size:16px;fill:#333;}#mermaid-1767940343521 .error-icon{fill:#552222;}#mermaid-1767940343521 .error-text{fill:#552222;stroke:#552222;}#mermaid-1767940343521 .edge-thickness-normal{stroke-width:2px;}#mermaid-1767940343521 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1767940343521 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1767940343521 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1767940343521 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1767940343521 .marker{fill:#333333;}#mermaid-1767940343521 .marker.cross{stroke:#333333;}#mermaid-1767940343521 svg{font-family:"trebuchet ms",verdana,arial;font-size:16px;}#mermaid-1767940343521 .label{font-family:"trebuchet ms",verdana,arial;color:#333;}#mermaid-1767940343521 .label text{fill:#333;}#mermaid-1767940343521 .node rect,#mermaid-1767940343521 .node circle,#mermaid-1767940343521 .node ellipse,#mermaid-1767940343521 .node polygon,#mermaid-1767940343521 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-1767940343521 .node .label{text-align:center;}#mermaid-1767940343521 .node.clickable{cursor:pointer;}#mermaid-1767940343521 .arrowheadPath{fill:#333333;}#mermaid-1767940343521 .edgePath .path{stroke:#333333;stroke-width:1.5px;}#mermaid-1767940343521 .flowchart-link{stroke:#333333;fill:none;}#mermaid-1767940343521 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-1767940343521 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-1767940343521 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-1767940343521 .cluster text{fill:#333;}#mermaid-1767940343521 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial;font-size:12px;background:hsl(80,100%,96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-1767940343521:root{--mermaid-font-family:"trebuchet ms",verdana,arial;}#mermaid-1767940343521 flowchart-v2{fill:apa;}</style><g></g><g><path class="error-icon" d="m411.313,123.313c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32-9.375,9.375-20.688-20.688c-12.484-12.5-32.766-12.5-45.25,0l-16,16c-1.261,1.261-2.304,2.648-3.31,4.051-21.739-8.561-45.324-13.426-70.065-13.426-105.867,0-192,86.133-192,192s86.133,192 192,192 192-86.133 192-192c0-24.741-4.864-48.327-13.426-70.065 1.402-1.007 2.79-2.049 4.051-3.31l16-16c12.5-12.492 12.5-32.758 0-45.25l-20.688-20.688 9.375-9.375 32.001-31.999zm-219.313,100.687c-52.938,0-96,43.063-96,96 0,8.836-7.164,16-16,16s-16-7.164-16-16c0-70.578 57.422-128 128-128 8.836,0 16,7.164 16,16s-7.164,16-16,16z"></path><path class="error-icon" d="m459.02,148.98c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l16,16c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16.001-16z"></path><path class="error-icon" d="m340.395,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16-16c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l15.999,16z"></path><path class="error-icon" d="m400,64c8.844,0 16-7.164 16-16v-32c0-8.836-7.156-16-16-16-8.844,0-16,7.164-16,16v32c0,8.836 7.156,16 16,16z"></path><path class="error-icon" d="m496,96.586h-32c-8.844,0-16,7.164-16,16 0,8.836 7.156,16 16,16h32c8.844,0 16-7.164 16-16 0-8.836-7.156-16-16-16z"></path><path class="error-icon" d="m436.98,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688l32-32c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32c-6.251,6.25-6.251,16.375-0.001,22.625z"></path><text class="error-text" x="1240" y="250" font-size="150px" style="text-anchor: middle;">Syntax error in graph</text><text class="error-text" x="1050" y="400" font-size="100px" style="text-anchor: middle;">mermaid version 8.8.1</text></g></svg></div></pre>
  </div>

   <footer>

    <div class="meta">
  <span class="item">
    <span class="icon">
      <i class="ic i-calendar-check"></i>
    </span>
    <span class="text">更新於</span>
    <time title="修改時間：2026-01-08 23:46:49" itemprop="dateModified" datetime="2026-01-08T23:46:49+08:00">2026-01-08</time>
  </span>
  <span id="2025/02/07/專案筆記-一/" class="item leancloud_visitors" data-flag-title="專案筆記 (未完成)" title="閱讀次數">
      <span class="icon">
        <i class="ic i-eye"></i>
      </span>
      <span class="text">閱讀次數</span>
      <span class="leancloud-visitors-count"></span>
      <span class="text">次</span>
  </span>
</div>

      

<div id="copyright">
<ul>
  <li class="author">
    <strong>作者： </strong>Rabbir <i class="ic i-at"><em>@</em></i>プログラムを書けないうさぎは、ただのうさぎだ。
  </li>
  <li class="link">
    <strong>文章連結：</strong>
    <a href="https://rabbirreaper.github.io/2025/02/07/%E5%B0%88%E6%A1%88%E7%AD%86%E8%A8%98-%E4%B8%80/" title="專案筆記 (未完成)">https://rabbirreaper.github.io/2025/02/07/專案筆記-一/</a>
  </li>
  <li class="license">
    <strong>版權聲明： </strong>本網誌所有文章除特別聲明外，均採用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 許可協議。轉載請註明出處！
  </li>
</ul>
</div>

  </footer>

</article>

  </div>
  

<div class="post-nav">
    <div class="item left">
      

  <a href="/2025/01/22/cookie-parser-%E8%AA%9E%E6%B3%95%E7%AD%86%E8%A8%98/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;pub-da440be71028438aa9683b63bef5ccf1.r2.dev&#x2F;79.jpg" title="cookie-parser 語法筆記">
  <span class="type">上一篇</span>
  <span class="category"><i class="ic i-flag"></i> node.js</span>
  <h3>cookie-parser 語法筆記</h3>
  </a>

    </div>
    <div class="item right">
      

  <a href="/2025/02/21/Vue3-%E8%AA%9E%E6%B3%95%E7%AD%86%E8%A8%98/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;pub-da440be71028438aa9683b63bef5ccf1.r2.dev&#x2F;25.jpg" title="Vue3 語法筆記">
  <span class="type">下一篇</span>
  <span class="category"><i class="ic i-flag"></i> </span>
  <h3>Vue3 語法筆記</h3>
  </a>

    </div>
</div>

  
  <div class="wrap" id="comments"></div>


        </div>
        <div id="sidebar">
          

<div class="inner">

  <div class="panels">
    <div class="inner">
      <div class="contents panel pjax" data-title="文章目錄">
          <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B0%88%E6%A1%88%E7%B0%A1%E4%BB%8B"><span class="toc-number">1.</span> <span class="toc-text"> 專案簡介</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#schema-%E8%A8%AD%E8%A8%88"><span class="toc-number">2.</span> <span class="toc-text"> Schema 設計</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#dish"><span class="toc-number">2.1.</span> <span class="toc-text"> Dish</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#dishtemplate"><span class="toc-number">2.1.1.</span> <span class="toc-text"> DishTemplate</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dishinstance"><span class="toc-number">2.1.2.</span> <span class="toc-text"> DishInstance</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#optioncategory"><span class="toc-number">2.1.3.</span> <span class="toc-text"> OptionCategory</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#option"><span class="toc-number">2.1.4.</span> <span class="toc-text"> Option</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#store"><span class="toc-number">2.2.</span> <span class="toc-text"> Store</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#store-2"><span class="toc-number">2.2.1.</span> <span class="toc-text"> Store</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#stocklog"><span class="toc-number">2.2.2.</span> <span class="toc-text"> StockLog</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#user"><span class="toc-number">2.3.</span> <span class="toc-text"> User</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AE%A1%E7%90%86%E5%93%A1%E4%BB%8B%E9%9D%A2"><span class="toc-number">3.</span> <span class="toc-text"> 管理員介面</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%A1%E7%90%86%E5%93%A1%E5%88%86%E7%B4%9A%E5%88%B6%E5%BA%A6%E5%AF%A6%E4%BD%9C%E7%B4%B0%E7%AF%80"><span class="toc-number">3.1.</span> <span class="toc-text"> 管理員分級制度實作細節</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%99%BB%E9%8C%84%E7%B3%BB%E7%B5%B1"><span class="toc-number">3.2.</span> <span class="toc-text"> 登錄系統</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BE%8C%E7%AB%AF%E8%A8%AD%E7%BD%AE"><span class="toc-number">3.2.1.</span> <span class="toc-text"> 後端設置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E7%99%BB%E9%8C%84%E9%A0%81%E9%9D%A2"><span class="toc-number">3.2.2.</span> <span class="toc-text"> 前端登錄頁面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#router-%E8%87%AA%E5%8B%95%E8%B7%B3%E8%BD%89%E5%88%B0%E7%99%BB%E9%8C%84%E4%BB%8B%E9%9D%A2"><span class="toc-number">3.2.3.</span> <span class="toc-text"> router 自動跳轉到登錄介面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E6%AA%94%E7%B6%B2%E5%9D%80"><span class="toc-number">3.2.4.</span> <span class="toc-text"> 文檔網址</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A4%90%E9%BB%9E%E9%A1%AF%E7%A4%BA%E6%96%B0%E5%A2%9E-%E4%BF%AE%E6%94%B9%E8%88%87%E5%88%AA%E9%99%A4%E4%BB%8B%E9%9D%A2"><span class="toc-number">3.3.</span> <span class="toc-text"> 餐點顯示，新增、修改與刪除介面</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#api"><span class="toc-number">3.3.1.</span> <span class="toc-text"> API</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%AF%E7%A4%BA"><span class="toc-number">3.3.2.</span> <span class="toc-text"> 顯示</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B0%E5%A2%9E%E5%8F%8A%E4%BF%AE%E6%94%B9%E9%A0%81%E9%9D%A2"><span class="toc-number">3.3.3.</span> <span class="toc-text"> 新增及修改頁面</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#menu%E6%96%B0%E5%A2%9E%E4%BB%8B%E9%9D%A2"><span class="toc-number">3.4.</span> <span class="toc-text">  menu  新增介面</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#api-2"><span class="toc-number">3.4.1.</span> <span class="toc-text"> API</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B0%E5%A2%9E"><span class="toc-number">3.4.2.</span> <span class="toc-text"> 新增</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%AF%E7%A4%BA-2"><span class="toc-number">3.4.3.</span> <span class="toc-text"> 顯示</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E8%88%87%E5%88%AA%E9%99%A4"><span class="toc-number">3.4.4.</span> <span class="toc-text"> 修改與刪除</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BA%97%E5%AE%B6%E7%AE%A1%E7%90%86"><span class="toc-number">3.5.</span> <span class="toc-text"> 店家管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#api-3"><span class="toc-number">3.5.1.</span> <span class="toc-text"> API</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B0%E5%A2%9E-2"><span class="toc-number">3.5.2.</span> <span class="toc-text"> 新增</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E8%88%87%E5%88%AA%E9%99%A4-2"><span class="toc-number">3.5.3.</span> <span class="toc-text"> 修改與刪除</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%AF%E7%A4%BA-3"><span class="toc-number">3.5.4.</span> <span class="toc-text"> 顯示</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A8%82%E5%96%AE%E5%88%97%E8%A1%A8"><span class="toc-number">3.6.</span> <span class="toc-text"> 訂單列表</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A8%82%E5%96%AE%E9%A6%96%E9%A0%81"><span class="toc-number">3.6.1.</span> <span class="toc-text"> 訂單首頁</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%95%B6%E5%A4%A9-detail"><span class="toc-number">3.6.2.</span> <span class="toc-text"> 當天 detail</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B8%E6%93%9A%E7%B5%B1%E8%A8%88"><span class="toc-number">3.7.</span> <span class="toc-text"> 數據統計</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%A2%E4%BA%BA%E9%BB%9E%E9%A4%90%E4%BB%8B%E9%9D%A2"><span class="toc-number">4.</span> <span class="toc-text"> 客人點餐介面</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9C%80%E6%B1%82"><span class="toc-number">4.1.</span> <span class="toc-text"> 需求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%84%E5%80%8B%E9%A0%81%E9%9D%A2"><span class="toc-number">4.2.</span> <span class="toc-text"> 各個頁面</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E8%A6%81%E6%95%B4%E5%90%88%E9%A0%81%E9%9D%A2"><span class="toc-number">4.2.1.</span> <span class="toc-text"> 主要整合頁面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A4%90%E9%BB%9E%E5%88%97%E8%A1%A8-%E5%8F%8A-navbar"><span class="toc-number">4.2.2.</span> <span class="toc-text"> 餐點列表 及 navbar</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%84%E9%A0%85%E9%A4%90%E9%BB%9E%E9%BB%9E%E9%A4%90detail"><span class="toc-number">4.2.3.</span> <span class="toc-text"> 各項餐點點餐 detail</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#shoppingcart"><span class="toc-number">4.2.4.</span> <span class="toc-text"> ShoppingCart</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A8%82%E5%96%AEobject"><span class="toc-number">4.3.</span> <span class="toc-text"> 訂單 Object</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%8C%E6%88%90%E8%A8%82%E5%96%AE%E7%9A%84%E4%BB%8B%E9%9D%A2"><span class="toc-number">4.4.</span> <span class="toc-text"> 完成訂單的介面</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%93%A1%E5%B7%A5%E9%BB%9E%E9%A4%90%E4%BB%8B%E9%9D%A2"><span class="toc-number">5.</span> <span class="toc-text"> 員工點餐介面</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A0%81%E9%9D%A2%E9%9C%80%E6%B1%82"><span class="toc-number">5.1.</span> <span class="toc-text"> 頁面需求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AA%9E%E6%B3%95%E7%AD%86%E8%A8%98"><span class="toc-number">5.2.</span> <span class="toc-text"> 語法筆記</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9C%83%E5%93%A1%E5%8A%9F%E8%83%BD"><span class="toc-number">6.</span> <span class="toc-text"> 會員功能</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%83%E5%93%A1%E5%84%B2%E5%AD%98"><span class="toc-number">6.1.</span> <span class="toc-text"> 會員儲存</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E7%95%AB%E9%9D%A2"><span class="toc-number">6.2.</span> <span class="toc-text"> 前端畫面</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%90%84%E9%A1%9E%E9%8A%B7%E5%94%AE%E7%B3%BB%E7%B5%B1"><span class="toc-number">7.</span> <span class="toc-text"> 各類銷售系統</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9B%86%E9%BB%9E%E6%A9%9F%E5%88%B6"><span class="toc-number">7.1.</span> <span class="toc-text"> 集點機制</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8A%98%E5%83%B9%E5%88%B8"><span class="toc-number">7.2.</span> <span class="toc-text"> 折價券</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A0%90%E8%B3%BC%E5%88%B8"><span class="toc-number">7.3.</span> <span class="toc-text"> 預購券</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BC%BA%E6%9C%8D%E5%99%A8%E6%B5%81%E9%87%8F%E8%A8%88%E7%AE%97"><span class="toc-number">8.</span> <span class="toc-text"> 伺服器流量計算</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#mongodb"><span class="toc-number">8.1.</span> <span class="toc-text"> mongoDB</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%8D%E8%B2%BB%E9%A1%8D%E5%BA%A6"><span class="toc-number">8.1.1.</span> <span class="toc-text"> 免費額度</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A0%90%E8%A8%88%E7%94%A8%E9%87%8F"><span class="toc-number">8.1.2.</span> <span class="toc-text"> 預計用量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B5%90%E8%AB%96"><span class="toc-number">8.1.3.</span> <span class="toc-text"> 結論</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#google-run"><span class="toc-number">8.2.</span> <span class="toc-text"> google run</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%8D%E8%B2%BB%E9%A1%8D%E5%BA%A6-2"><span class="toc-number">8.2.1.</span> <span class="toc-text"> 免費額度</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A0%90%E8%A8%88%E7%94%A8%E9%87%8F-2"><span class="toc-number">8.2.2.</span> <span class="toc-text"> 預計用量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B5%90%E8%AB%96-2"><span class="toc-number">8.2.3.</span> <span class="toc-text"> 結論</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cloudinary"><span class="toc-number">8.3.</span> <span class="toc-text"> cloudinary</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%8D%E8%B2%BB%E9%A1%8D%E5%BA%A6-3"><span class="toc-number">8.3.1.</span> <span class="toc-text"> 免費額度</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A0%90%E8%A8%88%E7%94%A8%E9%87%8F-3"><span class="toc-number">8.3.2.</span> <span class="toc-text"> 預計用量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B5%90%E8%AB%96-3"><span class="toc-number">8.3.3.</span> <span class="toc-text"> 結論</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%B8%AC%E8%A9%A6%E7%B7%A8%E5%AF%AB"><span class="toc-number">9.</span> <span class="toc-text"> 測試編寫</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9A%AB%E6%99%82%E7%AD%86%E8%A8%98"><span class="toc-number">10.</span> <span class="toc-text"> 暫時筆記</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A3%E8%BE%A6%E4%BA%8B%E9%A0%85"><span class="toc-number">10.1.</span> <span class="toc-text"> 代辦事項</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B3%87%E6%96%99%E5%A4%BE%E5%91%BD%E5%90%8D%E8%A6%8F%E5%89%87"><span class="toc-number">10.2.</span> <span class="toc-text"> 資料夾命名規則</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AA%94%E6%A1%88%E5%91%BD%E5%90%8D%E8%A6%8F%E5%89%87%E8%A9%B3%E8%A7%A3"><span class="toc-number">10.3.</span> <span class="toc-text"> 檔案命名規則詳解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AC%8A%E9%99%90%E6%8E%A7%E5%88%B6"><span class="toc-number">10.4.</span> <span class="toc-text"> 權限控制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#admin-schema"><span class="toc-number">10.4.1.</span> <span class="toc-text"> admin schema</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#temp"><span class="toc-number">11.</span> <span class="toc-text"> temp</span></a></li></ol>
      </div>
      <div class="related panel pjax" data-title="系列文章">
      </div>
      <div class="overview panel" data-title="本站概要">
        <div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="image" itemprop="image" alt="Rabbir"
      data-src="/images/avatar.jpg">
  <p class="name" itemprop="name">Rabbir</p>
  <div class="description" itemprop="description"></div>
</div>

<nav class="state">
    <div class="item posts">
      <a href="/archives/">
        <span class="count">86</span>
        <span class="name">文章</span>
      </a>
    </div>
    <div class="item categories">
      <a href="/categories/">
        <span class="count">12</span>
        <span class="name">分類</span>
      </a>
    </div>
    <div class="item tags">
      <a href="/tags/">
        <span class="count">36</span>
        <span class="name">標籤</span>
      </a>
    </div>
</nav>

<div class="social">
</div>

<ul class="menu">
  
    
  <li class="item">
    <a href="/" rel="section"><i class="ic i-home"></i>首頁</a>
  </li>

    
  <li class="item">
    <a href="/about/" rel="section"><i class="ic i-user"></i>關於</a>
  </li>

        
  <li class="item dropdown">
      <a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a>
    <ul class="submenu">

        
  <li class="item">
    <a href="/archives/" rel="section"><i class="ic i-list-alt"></i>歸檔</a>
  </li>

        
  <li class="item">
    <a href="/categories/" rel="section"><i class="ic i-th"></i>分類</a>
  </li>

        
  <li class="item">
    <a href="/tags/" rel="section"><i class="ic i-tags"></i>標籤</a>
  </li>

  </ul>

</ul>

      </div>
    </div>
  </div>

  <ul id="quick">
    <li class="prev pjax">
        <a href="/2025/01/22/cookie-parser-%E8%AA%9E%E6%B3%95%E7%AD%86%E8%A8%98/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a>
    </li>
    <li class="up"><i class="ic i-arrow-up"></i></li>
    <li class="down"><i class="ic i-arrow-down"></i></li>
    <li class="next pjax">
        <a href="/2025/02/21/Vue3-%E8%AA%9E%E6%B3%95%E7%AD%86%E8%A8%98/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a>
    </li>
    <li class="percent"></li>
  </ul>
</div>


        </div>
        <div class="dimmer"></div>
      </div>
    </main>
    <footer id="footer">
      <div class="inner">
        <div class="widgets">
          
<div class="rpost pjax">
  <h2>隨機文章</h2>
  <ul>
      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E8%A7%A3%E9%A1%8C%E7%B4%80%E9%8C%84/" title="分類於 解題紀錄">解題紀錄</a>
<i class="ic i-angle-right"></i>
<a href="/categories/%E8%A7%A3%E9%A1%8C%E7%B4%80%E9%8C%84/APCS/" title="分類於 APCS">APCS</a>
</div>

    <span><a href="/2025/01/19/c575-APCS-2017-0304-4%E5%9F%BA%E5%9C%B0%E5%8F%B0/" title="c575. APCS 2017-0304-4基地台">c575. APCS 2017-0304-4基地台</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E8%A7%A3%E9%A1%8C%E7%B4%80%E9%8C%84/" title="分類於 解題紀錄">解題紀錄</a>
<i class="ic i-angle-right"></i>
<a href="/categories/%E8%A7%A3%E9%A1%8C%E7%B4%80%E9%8C%84/AP325/" title="分類於 AP325">AP325</a>
</div>

    <span><a href="/2025/01/19/Q-8-12-%E4%BD%94%E9%A0%98%E9%80%A3%E7%BA%8C%E7%9A%84%E5%9F%8E%E9%8E%AE/" title="Q-8-12. 佔領連續的城鎮">Q-8-12. 佔領連續的城鎮</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E8%A7%A3%E9%A1%8C%E7%B4%80%E9%8C%84/" title="分類於 解題紀錄">解題紀錄</a>
<i class="ic i-angle-right"></i>
<a href="/categories/%E8%A7%A3%E9%A1%8C%E7%B4%80%E9%8C%84/AP325/" title="分類於 AP325">AP325</a>
</div>

    <span><a href="/2025/01/18/Q-4-8-%E5%85%88%E5%88%B0%E5%85%88%E6%9C%8D%E5%8B%99/" title="Q-4-8. 先到先服務 (*)">Q-4-8. 先到先服務 (*)</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E8%A7%A3%E9%A1%8C%E7%B4%80%E9%8C%84/" title="分類於 解題紀錄">解題紀錄</a>
<i class="ic i-angle-right"></i>
<a href="/categories/%E8%A7%A3%E9%A1%8C%E7%B4%80%E9%8C%84/AP325/" title="分類於 AP325">AP325</a>
</div>

    <span><a href="/2025/01/18/Q-4-6-%E5%B0%91%E6%9E%97%E5%AF%BA%E7%9A%84%E8%87%AA%E5%8B%95%E5%AF%84%E7%89%A9%E6%AB%83-APCS/" title="Q-4-6. 少林寺的自動寄物櫃(APCS)">Q-4-6. 少林寺的自動寄物櫃(APCS)</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E8%A7%A3%E9%A1%8C%E7%B4%80%E9%8C%84/" title="分類於 解題紀錄">解題紀錄</a>
<i class="ic i-angle-right"></i>
<a href="/categories/%E8%A7%A3%E9%A1%8C%E7%B4%80%E9%8C%84/AP325/" title="分類於 AP325">AP325</a>
</div>

    <span><a href="/2025/01/18/Q-3-12-%E5%AE%8C%E7%BE%8E%E5%BD%A9%E5%B8%B6/" title="Q-3-12. 完美彩帶">Q-3-12. 完美彩帶</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E8%A7%A3%E9%A1%8C%E7%B4%80%E9%8C%84/" title="分類於 解題紀錄">解題紀錄</a>
<i class="ic i-angle-right"></i>
<a href="/categories/%E8%A7%A3%E9%A1%8C%E7%B4%80%E9%8C%84/APCS/" title="分類於 APCS">APCS</a>
</div>

    <span><a href="/2025/01/18/b965-2-%E7%9F%A9%E9%99%A3%E8%BD%89%E6%8F%9B/" title="b965. 2. 矩陣轉換">b965. 2. 矩陣轉換</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E8%A7%A3%E9%A1%8C%E7%B4%80%E9%8C%84/" title="分類於 解題紀錄">解題紀錄</a>
<i class="ic i-angle-right"></i>
<a href="/categories/%E8%A7%A3%E9%A1%8C%E7%B4%80%E9%8C%84/APCS-%E6%A8%A1%E6%93%AC%E5%9C%98%E9%9A%8A/" title="分類於 APCS 模擬團隊">APCS 模擬團隊</a>
</div>

    <span><a href="/2025/01/18/apcs0404-C-CPP-%E9%A1%AF%E5%8D%A1%E7%88%AD%E9%9C%B8%E6%88%B0-Graphics-Card-Battle/" title="apcs0404-C-CPP:顯卡爭霸戰(Graphics Card Battle)">apcs0404-C-CPP:顯卡爭霸戰(Graphics Card Battle)</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E5%8A%A0%E5%AF%86%E6%96%87%E7%AB%A0/" title="分類於 加密文章">加密文章</a>
<i class="ic i-angle-right"></i>
<a href="/categories/%E5%8A%A0%E5%AF%86%E6%96%87%E7%AB%A0/%E5%85%89%E9%80%9F%E9%BB%9E%E9%A4%90/" title="分類於 光速點餐">光速點餐</a>
</div>

    <span><a href="/2026/01/22/%E5%85%89%E9%80%9F%E9%BB%9E%E9%A4%90/" title="光速點餐">光速點餐</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E8%A7%A3%E9%A1%8C%E7%B4%80%E9%8C%84/" title="分類於 解題紀錄">解題紀錄</a>
<i class="ic i-angle-right"></i>
<a href="/categories/%E8%A7%A3%E9%A1%8C%E7%B4%80%E9%8C%84/AP325/" title="分類於 AP325">AP325</a>
</div>

    <span><a href="/2025/01/18/Q-6-12-%E6%A5%8A%E9%90%B5%E5%BF%83%E5%81%9A-1-%E4%BC%91-K/" title="Q-6-12. 楊鐵心做 1 休 K">Q-6-12. 楊鐵心做 1 休 K</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2026/01/05/CPE%E6%BA%96%E5%82%99%E7%B4%80%E9%8C%84/" title="CPE 準備紀錄">CPE 準備紀錄</a></span>
  </li>

  </ul>
</div>
<div>
  <h2>最新評論</h2>
  <ul class="leancloud-recent-comment"></ul>
</div>

        </div>
        <div class="status">
  <div class="copyright">
    
    &copy; 2025 – 
    <span itemprop="copyrightYear">2026</span>
    <span class="with-love">
      <i class="ic i-sakura rotate"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Rabbir @ Rabbir Reaper</span>
  </div>
  <div class="count">
    <span class="post-meta-item-icon">
      <i class="ic i-chart-area"></i>
    </span>
    <span title="總字數">301k 字</span>

    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="ic i-coffee"></i>
    </span>
    <span title="所需總閱讀時間">4:34</span>
  </div>
  <div class="powered-by">
    基於 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span>
  </div>
</div>

      </div>
    </footer>
  </div>
<script data-config type="text/javascript">
  var LOCAL = {
    path: '2025/02/07/專案筆記-一/',
    favicon: {
      show: "（●´3｀●）復活成功",
      hide: "(´Д｀)瀏覽器崩潰啦"
    },
    search : {
      placeholder: "文章搜尋",
      empty: "關於 「 ${query} 」 ，什麼也沒搜到",
      stats: "${time} ms 內找到 ${hits} 條結果"
    },
    valine: true,fancybox: true,
    copyright: '複製成功，轉載請遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 協議。',
    ignores : [
      function(uri) {
        return uri.includes('#');
      },
      function(uri) {
        return new RegExp(LOCAL.path+"$").test(uri);
      }
    ]
  };
</script>

<script src="https://cdn.polyfill.io/v2/polyfill.js"></script>

<script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script>

<script src="/js/app.js?v=0.2.5"></script>




</body>
</html>
